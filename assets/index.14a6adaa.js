(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var gi=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},Xt=[],zt=[],Xh=typeof Uint8Array<"u"?Uint8Array:Array,ho=!1;function Sl(){ho=!0;for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,t=r.length;e<t;++e)Xt[e]=r[e],zt[r.charCodeAt(e)]=e;zt["-".charCodeAt(0)]=62,zt["_".charCodeAt(0)]=63}function Zh(r){ho||Sl();var e,t,i,n,a,o,s=r.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=r[s-2]==="="?2:r[s-1]==="="?1:0,o=new Xh(s*3/4-a),i=a>0?s-4:s;var l=0;for(e=0,t=0;e<i;e+=4,t+=3)n=zt[r.charCodeAt(e)]<<18|zt[r.charCodeAt(e+1)]<<12|zt[r.charCodeAt(e+2)]<<6|zt[r.charCodeAt(e+3)],o[l++]=n>>16&255,o[l++]=n>>8&255,o[l++]=n&255;return a===2?(n=zt[r.charCodeAt(e)]<<2|zt[r.charCodeAt(e+1)]>>4,o[l++]=n&255):a===1&&(n=zt[r.charCodeAt(e)]<<10|zt[r.charCodeAt(e+1)]<<4|zt[r.charCodeAt(e+2)]>>2,o[l++]=n>>8&255,o[l++]=n&255),o}function Kh(r){return Xt[r>>18&63]+Xt[r>>12&63]+Xt[r>>6&63]+Xt[r&63]}function Qh(r,e,t){for(var i,n=[],a=e;a<t;a+=3)i=(r[a]<<16)+(r[a+1]<<8)+r[a+2],n.push(Kh(i));return n.join("")}function qo(r){ho||Sl();for(var e,t=r.length,i=t%3,n="",a=[],o=16383,s=0,l=t-i;s<l;s+=o)a.push(Qh(r,s,s+o>l?l:s+o));return i===1?(e=r[t-1],n+=Xt[e>>2],n+=Xt[e<<4&63],n+="=="):i===2&&(e=(r[t-2]<<8)+r[t-1],n+=Xt[e>>10],n+=Xt[e>>4&63],n+=Xt[e<<2&63],n+="="),a.push(n),a.join("")}function ta(r,e,t,i,n){var a,o,s=n*8-i-1,l=(1<<s)-1,u=l>>1,h=-7,f=t?n-1:0,d=t?-1:1,c=r[e+f];for(f+=d,a=c&(1<<-h)-1,c>>=-h,h+=s;h>0;a=a*256+r[e+f],f+=d,h-=8);for(o=a&(1<<-h)-1,a>>=-h,h+=i;h>0;o=o*256+r[e+f],f+=d,h-=8);if(a===0)a=1-u;else{if(a===l)return o?NaN:(c?-1:1)*(1/0);o=o+Math.pow(2,i),a=a-u}return(c?-1:1)*o*Math.pow(2,a-i)}function Cl(r,e,t,i,n,a){var o,s,l,u=a*8-n-1,h=(1<<u)-1,f=h>>1,d=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=i?0:a-1,v=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+f>=1?e+=d/l:e+=d*Math.pow(2,1-f),e*l>=2&&(o++,l/=2),o+f>=h?(s=0,o=h):o+f>=1?(s=(e*l-1)*Math.pow(2,n),o=o+f):(s=e*Math.pow(2,f-1)*Math.pow(2,n),o=0));n>=8;r[t+c]=s&255,c+=v,s/=256,n-=8);for(o=o<<n|s,u+=n;u>0;r[t+c]=o&255,c+=v,o/=256,u-=8);r[t+c-v]|=g*128}var jh={}.toString,Dl=Array.isArray||function(r){return jh.call(r)=="[object Array]"},Jh=50;ve.TYPED_ARRAY_SUPPORT=gi.TYPED_ARRAY_SUPPORT!==void 0?gi.TYPED_ARRAY_SUPPORT:!0;Un();function Un(){return ve.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ir(r,e){if(Un()<e)throw new RangeError("Invalid typed array length");return ve.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e),r.__proto__=ve.prototype):(r===null&&(r=new ve(e)),r.length=e),r}function ve(r,e,t){if(!ve.TYPED_ARRAY_SUPPORT&&!(this instanceof ve))return new ve(r,e,t);if(typeof r=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return fo(this,r)}return Rl(this,r,e,t)}ve.poolSize=8192;ve._augment=function(r){return r.__proto__=ve.prototype,r};function Rl(r,e,t,i){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?tf(r,e,t,i):typeof e=="string"?ef(r,e,t):rf(r,e)}ve.from=function(r,e,t){return Rl(null,r,e,t)};ve.TYPED_ARRAY_SUPPORT&&(ve.prototype.__proto__=Uint8Array.prototype,ve.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&ve[Symbol.species]);function Pl(r){if(typeof r!="number")throw new TypeError('"size" argument must be a number');if(r<0)throw new RangeError('"size" argument must not be negative')}function $h(r,e,t,i){return Pl(e),e<=0?ir(r,e):t!==void 0?typeof i=="string"?ir(r,e).fill(t,i):ir(r,e).fill(t):ir(r,e)}ve.alloc=function(r,e,t){return $h(null,r,e,t)};function fo(r,e){if(Pl(e),r=ir(r,e<0?0:co(e)|0),!ve.TYPED_ARRAY_SUPPORT)for(var t=0;t<e;++t)r[t]=0;return r}ve.allocUnsafe=function(r){return fo(null,r)};ve.allocUnsafeSlow=function(r){return fo(null,r)};function ef(r,e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!ve.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');var i=Ll(e,t)|0;r=ir(r,i);var n=r.write(e,t);return n!==i&&(r=r.slice(0,n)),r}function Za(r,e){var t=e.length<0?0:co(e.length)|0;r=ir(r,t);for(var i=0;i<t;i+=1)r[i]=e[i]&255;return r}function tf(r,e,t,i){if(e.byteLength,t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(i||0))throw new RangeError("'length' is out of bounds");return t===void 0&&i===void 0?e=new Uint8Array(e):i===void 0?e=new Uint8Array(e,t):e=new Uint8Array(e,t,i),ve.TYPED_ARRAY_SUPPORT?(r=e,r.__proto__=ve.prototype):r=Za(r,e),r}function rf(r,e){if(Qt(e)){var t=co(e.length)|0;return r=ir(r,t),r.length===0||e.copy(r,0,0,t),r}if(e){if(typeof ArrayBuffer<"u"&&e.buffer instanceof ArrayBuffer||"length"in e)return typeof e.length!="number"||bf(e.length)?ir(r,0):Za(r,e);if(e.type==="Buffer"&&Dl(e.data))return Za(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function co(r){if(r>=Un())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Un().toString(16)+" bytes");return r|0}ve.isBuffer=Mt;function Qt(r){return!!(r!=null&&r._isBuffer)}ve.compare=function(e,t){if(!Qt(e)||!Qt(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,a=0,o=Math.min(i,n);a<o;++a)if(e[a]!==t[a]){i=e[a],n=t[a];break}return i<n?-1:n<i?1:0};ve.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};ve.concat=function(e,t){if(!Dl(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return ve.alloc(0);var i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=ve.allocUnsafe(t),a=0;for(i=0;i<e.length;++i){var o=e[i];if(!Qt(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,a),a+=o.length}return n};function Ll(r,e){if(Qt(r))return r.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;typeof r!="string"&&(r=""+r);var t=r.length;if(t===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return Gn(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Fl(r).length;default:if(i)return Gn(r).length;e=(""+e).toLowerCase(),i=!0}}ve.byteLength=Ll;function nf(r,e,t){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return vf(this,e,t);case"utf8":case"utf-8":return Nl(this,e,t);case"ascii":return cf(this,e,t);case"latin1":case"binary":return df(this,e,t);case"base64":return hf(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return gf(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}ve.prototype._isBuffer=!0;function zr(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}ve.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)zr(this,t,t+1);return this};ve.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)zr(this,t,t+3),zr(this,t+1,t+2);return this};ve.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)zr(this,t,t+7),zr(this,t+1,t+6),zr(this,t+2,t+5),zr(this,t+3,t+4);return this};ve.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?Nl(this,0,e):nf.apply(this,arguments)};ve.prototype.equals=function(e){if(!Qt(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:ve.compare(this,e)===0};ve.prototype.inspect=function(){var e="",t=Jh;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"};ve.prototype.compare=function(e,t,i,n,a){if(!Qt(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),a===void 0&&(a=this.length),t<0||i>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&t>=i)return 0;if(n>=a)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,a>>>=0,this===e)return 0;for(var o=a-n,s=i-t,l=Math.min(o,s),u=this.slice(n,a),h=e.slice(t,i),f=0;f<l;++f)if(u[f]!==h[f]){o=u[f],s=h[f];break}return o<s?-1:s<o?1:0};function Ol(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=ve.from(e,i)),Qt(e))return e.length===0?-1:Yo(r,e,t,i,n);if(typeof e=="number")return e=e&255,ve.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Yo(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function Yo(r,e,t,i,n){var a=1,o=r.length,s=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;a=2,o/=2,s/=2,t/=2}function l(c,v){return a===1?c[v]:c.readUInt16BE(v*a)}var u;if(n){var h=-1;for(u=t;u<o;u++)if(l(r,u)===l(e,h===-1?0:u-h)){if(h===-1&&(h=u),u-h+1===s)return h*a}else h!==-1&&(u-=u-h),h=-1}else for(t+s>o&&(t=o-s),u=t;u>=0;u--){for(var f=!0,d=0;d<s;d++)if(l(r,u+d)!==l(e,d)){f=!1;break}if(f)return u}return-1}ve.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};ve.prototype.indexOf=function(e,t,i){return Ol(this,e,t,i,!0)};ve.prototype.lastIndexOf=function(e,t,i){return Ol(this,e,t,i,!1)};function af(r,e,t,i){t=Number(t)||0;var n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;var a=e.length;if(a%2!==0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(e.substr(o*2,2),16);if(isNaN(s))return o;r[t+o]=s}return o}function of(r,e,t,i){return na(Gn(e,r.length-t),r,t,i)}function Ml(r,e,t,i){return na(Ef(e),r,t,i)}function sf(r,e,t,i){return Ml(r,e,t,i)}function lf(r,e,t,i){return na(Fl(e),r,t,i)}function uf(r,e,t,i){return na(Tf(e,r.length-t),r,t,i)}ve.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t|0,isFinite(i)?(i=i|0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a=this.length-t;if((i===void 0||i>a)&&(i=a),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return af(this,e,t,i);case"utf8":case"utf-8":return of(this,e,t,i);case"ascii":return Ml(this,e,t,i);case"latin1":case"binary":return sf(this,e,t,i);case"base64":return lf(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return uf(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};ve.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function hf(r,e,t){return e===0&&t===r.length?qo(r):qo(r.slice(e,t))}function Nl(r,e,t){t=Math.min(r.length,t);for(var i=[],n=e;n<t;){var a=r[n],o=null,s=a>239?4:a>223?3:a>191?2:1;if(n+s<=t){var l,u,h,f;switch(s){case 1:a<128&&(o=a);break;case 2:l=r[n+1],(l&192)===128&&(f=(a&31)<<6|l&63,f>127&&(o=f));break;case 3:l=r[n+1],u=r[n+2],(l&192)===128&&(u&192)===128&&(f=(a&15)<<12|(l&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:l=r[n+1],u=r[n+2],h=r[n+3],(l&192)===128&&(u&192)===128&&(h&192)===128&&(f=(a&15)<<18|(l&63)<<12|(u&63)<<6|h&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=s}return ff(i)}var Xo=4096;function ff(r){var e=r.length;if(e<=Xo)return String.fromCharCode.apply(String,r);for(var t="",i=0;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=Xo));return t}function cf(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function df(r,e,t){var i="";t=Math.min(r.length,t);for(var n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function vf(r,e,t){var i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);for(var n="",a=e;a<t;++a)n+=wf(r[a]);return n}function gf(r,e,t){for(var i=r.slice(e,t),n="",a=0;a<i.length;a+=2)n+=String.fromCharCode(i[a]+i[a+1]*256);return n}ve.prototype.slice=function(e,t){var i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);var n;if(ve.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=ve.prototype;else{var a=t-e;n=new ve(a,void 0);for(var o=0;o<a;++o)n[o]=this[o+e]}return n};function pt(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}ve.prototype.readUIntLE=function(e,t,i){e=e|0,t=t|0,i||pt(e,t,this.length);for(var n=this[e],a=1,o=0;++o<t&&(a*=256);)n+=this[e+o]*a;return n};ve.prototype.readUIntBE=function(e,t,i){e=e|0,t=t|0,i||pt(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n};ve.prototype.readUInt8=function(e,t){return t||pt(e,1,this.length),this[e]};ve.prototype.readUInt16LE=function(e,t){return t||pt(e,2,this.length),this[e]|this[e+1]<<8};ve.prototype.readUInt16BE=function(e,t){return t||pt(e,2,this.length),this[e]<<8|this[e+1]};ve.prototype.readUInt32LE=function(e,t){return t||pt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};ve.prototype.readUInt32BE=function(e,t){return t||pt(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};ve.prototype.readIntLE=function(e,t,i){e=e|0,t=t|0,i||pt(e,t,this.length);for(var n=this[e],a=1,o=0;++o<t&&(a*=256);)n+=this[e+o]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*t)),n};ve.prototype.readIntBE=function(e,t,i){e=e|0,t=t|0,i||pt(e,t,this.length);for(var n=t,a=1,o=this[e+--n];n>0&&(a*=256);)o+=this[e+--n]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*t)),o};ve.prototype.readInt8=function(e,t){return t||pt(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};ve.prototype.readInt16LE=function(e,t){t||pt(e,2,this.length);var i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};ve.prototype.readInt16BE=function(e,t){t||pt(e,2,this.length);var i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};ve.prototype.readInt32LE=function(e,t){return t||pt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};ve.prototype.readInt32BE=function(e,t){return t||pt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};ve.prototype.readFloatLE=function(e,t){return t||pt(e,4,this.length),ta(this,e,!0,23,4)};ve.prototype.readFloatBE=function(e,t){return t||pt(e,4,this.length),ta(this,e,!1,23,4)};ve.prototype.readDoubleLE=function(e,t){return t||pt(e,8,this.length),ta(this,e,!0,52,8)};ve.prototype.readDoubleBE=function(e,t){return t||pt(e,8,this.length),ta(this,e,!1,52,8)};function At(r,e,t,i,n,a){if(!Qt(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<a)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}ve.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t|0,i=i|0,!n){var a=Math.pow(2,8*i)-1;At(this,e,t,i,a,0)}var o=1,s=0;for(this[t]=e&255;++s<i&&(o*=256);)this[t+s]=e/o&255;return t+i};ve.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t|0,i=i|0,!n){var a=Math.pow(2,8*i)-1;At(this,e,t,i,a,0)}var o=i-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+i};ve.prototype.writeUInt8=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,1,255,0),ve.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=e&255,t+1};function ra(r,e,t,i){e<0&&(e=65535+e+1);for(var n=0,a=Math.min(r.length-t,2);n<a;++n)r[t+n]=(e&255<<8*(i?n:1-n))>>>(i?n:1-n)*8}ve.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,2,65535,0),ve.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):ra(this,e,t,!0),t+2};ve.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,2,65535,0),ve.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):ra(this,e,t,!1),t+2};function ia(r,e,t,i){e<0&&(e=4294967295+e+1);for(var n=0,a=Math.min(r.length-t,4);n<a;++n)r[t+n]=e>>>(i?n:3-n)*8&255}ve.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,4,4294967295,0),ve.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255):ia(this,e,t,!0),t+4};ve.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,4,4294967295,0),ve.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):ia(this,e,t,!1),t+4};ve.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t|0,!n){var a=Math.pow(2,8*i-1);At(this,e,t,i,a-1,-a)}var o=0,s=1,l=0;for(this[t]=e&255;++o<i&&(s*=256);)e<0&&l===0&&this[t+o-1]!==0&&(l=1),this[t+o]=(e/s>>0)-l&255;return t+i};ve.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t|0,!n){var a=Math.pow(2,8*i-1);At(this,e,t,i,a-1,-a)}var o=i-1,s=1,l=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&l===0&&this[t+o+1]!==0&&(l=1),this[t+o]=(e/s>>0)-l&255;return t+i};ve.prototype.writeInt8=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,1,127,-128),ve.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=e&255,t+1};ve.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,2,32767,-32768),ve.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):ra(this,e,t,!0),t+2};ve.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,2,32767,-32768),ve.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):ra(this,e,t,!1),t+2};ve.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,4,2147483647,-2147483648),ve.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ia(this,e,t,!0),t+4};ve.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t|0,i||At(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),ve.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):ia(this,e,t,!1),t+4};function Il(r,e,t,i,n,a){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Al(r,e,t,i,n){return n||Il(r,e,t,4),Cl(r,e,t,i,23,4),t+4}ve.prototype.writeFloatLE=function(e,t,i){return Al(this,e,t,!0,i)};ve.prototype.writeFloatBE=function(e,t,i){return Al(this,e,t,!1,i)};function _l(r,e,t,i,n){return n||Il(r,e,t,8),Cl(r,e,t,i,52,8),t+8}ve.prototype.writeDoubleLE=function(e,t,i){return _l(this,e,t,!0,i)};ve.prototype.writeDoubleBE=function(e,t,i){return _l(this,e,t,!1,i)};ve.prototype.copy=function(e,t,i,n){if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var a=n-i,o;if(this===e&&i<t&&t<n)for(o=a-1;o>=0;--o)e[o+t]=this[o+i];else if(a<1e3||!ve.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+a),t);return a};ve.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),e.length===1){var a=e.charCodeAt(0);a<256&&(e=a)}if(n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!ve.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else typeof e=="number"&&(e=e&255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);var o;if(typeof e=="number")for(o=t;o<i;++o)this[o]=e;else{var s=Qt(e)?e:Gn(new ve(e,n).toString()),l=s.length;for(o=0;o<i-t;++o)this[o+t]=s[o%l]}return this};var pf=/[^+\/0-9A-Za-z-_]/g;function mf(r){if(r=yf(r).replace(pf,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function yf(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function wf(r){return r<16?"0"+r.toString(16):r.toString(16)}function Gn(r,e){e=e||1/0;for(var t,i=r.length,n=null,a=[],o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&a.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&a.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&a.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&a.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;a.push(t)}else if(t<2048){if((e-=2)<0)break;a.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;a.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;a.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return a}function Ef(r){for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Tf(r,e){for(var t,i,n,a=[],o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,a.push(n),a.push(i);return a}function Fl(r){return Zh(mf(r))}function na(r,e,t,i){for(var n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function bf(r){return r!==r}function Mt(r){return r!=null&&(!!r._isBuffer||Bl(r)||xf(r))}function Bl(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function xf(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&Bl(r.slice(0,0))}var Sf;function Cr(){}Cr.prototype=Object.create(null);function ke(){ke.init.call(this)}ke.EventEmitter=ke;ke.usingDomains=!1;ke.prototype.domain=void 0;ke.prototype._events=void 0;ke.prototype._maxListeners=void 0;ke.defaultMaxListeners=10;ke.init=function(){this.domain=null,ke.usingDomains&&Sf.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Cr,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ke.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};function kl(r){return r._maxListeners===void 0?ke.defaultMaxListeners:r._maxListeners}ke.prototype.getMaxListeners=function(){return kl(this)};function Cf(r,e,t){if(e)r.call(t);else for(var i=r.length,n=en(r,i),a=0;a<i;++a)n[a].call(t)}function Df(r,e,t,i){if(e)r.call(t,i);else for(var n=r.length,a=en(r,n),o=0;o<n;++o)a[o].call(t,i)}function Rf(r,e,t,i,n){if(e)r.call(t,i,n);else for(var a=r.length,o=en(r,a),s=0;s<a;++s)o[s].call(t,i,n)}function Pf(r,e,t,i,n,a){if(e)r.call(t,i,n,a);else for(var o=r.length,s=en(r,o),l=0;l<o;++l)s[l].call(t,i,n,a)}function Lf(r,e,t,i){if(e)r.apply(t,i);else for(var n=r.length,a=en(r,n),o=0;o<n;++o)a[o].apply(t,i)}ke.prototype.emit=function(e){var t,i,n,a,o,s,l,u=e==="error";if(s=this._events,s)u=u&&s.error==null;else if(!u)return!1;if(l=this.domain,u){if(t=arguments[1],l)t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=l,t.domainThrown=!1,l.emit("error",t);else{if(t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}return!1}if(i=s[e],!i)return!1;var f=typeof i=="function";switch(n=arguments.length,n){case 1:Cf(i,f,this);break;case 2:Df(i,f,this,arguments[1]);break;case 3:Rf(i,f,this,arguments[1],arguments[2]);break;case 4:Pf(i,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(n-1),o=1;o<n;o++)a[o-1]=arguments[o];Lf(i,f,this,a)}return!0};function zl(r,e,t,i){var n,a,o;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(a=r._events,a?(a.newListener&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),o=a[e]):(a=r._events=new Cr,r._eventsCount=0),!o)o=a[e]=t,++r._eventsCount;else if(typeof o=="function"?o=a[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),!o.warned&&(n=kl(r),n&&n>0&&o.length>n)){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=r,s.type=e,s.count=o.length,Of(s)}return r}function Of(r){typeof console.warn=="function"?console.warn(r):console.log(r)}ke.prototype.addListener=function(e,t){return zl(this,e,t,!1)};ke.prototype.on=ke.prototype.addListener;ke.prototype.prependListener=function(e,t){return zl(this,e,t,!0)};function Hl(r,e,t){var i=!1;function n(){r.removeListener(e,n),i||(i=!0,t.apply(r,arguments))}return n.listener=t,n}ke.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,Hl(this,e,t)),this};ke.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Hl(this,e,t)),this};ke.prototype.removeListener=function(e,t){var i,n,a,o,s;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(n=this._events,!n)return this;if(i=n[e],!i)return this;if(i===t||i.listener&&i.listener===t)--this._eventsCount===0?this._events=new Cr:(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(a=-1,o=i.length;o-- >0;)if(i[o]===t||i[o].listener&&i[o].listener===t){s=i[o].listener,a=o;break}if(a<0)return this;if(i.length===1){if(i[0]=void 0,--this._eventsCount===0)return this._events=new Cr,this;delete n[e]}else Mf(i,a);n.removeListener&&this.emit("removeListener",e,s||t)}return this};ke.prototype.removeAllListeners=function(e){var t,i;if(i=this._events,!i)return this;if(!i.removeListener)return arguments.length===0?(this._events=new Cr,this._eventsCount=0):i[e]&&(--this._eventsCount===0?this._events=new Cr:delete i[e]),this;if(arguments.length===0){for(var n=Object.keys(i),a=0,o;a<n.length;++a)o=n[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new Cr,this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this};ke.prototype.listeners=function(e){var t,i,n=this._events;return n?(t=n[e],t?typeof t=="function"?i=[t.listener||t]:i=Nf(t):i=[]):i=[],i};ke.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Ul.call(r,e)};ke.prototype.listenerCount=Ul;function Ul(r){var e=this._events;if(e){var t=e[r];if(typeof t=="function")return 1;if(t)return t.length}return 0}ke.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Mf(r,e){for(var t=e,i=t+1,n=r.length;i<n;t+=1,i+=1)r[t]=r[i];r.pop()}function en(r,e){for(var t=new Array(e);e--;)t[e]=r[e];return t}function Nf(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Gl(){throw new Error("setTimeout has not been defined")}function Vl(){throw new Error("clearTimeout has not been defined")}var wr=Gl,Er=Vl;typeof gi.setTimeout=="function"&&(wr=setTimeout);typeof gi.clearTimeout=="function"&&(Er=clearTimeout);function Wl(r){if(wr===setTimeout)return setTimeout(r,0);if((wr===Gl||!wr)&&setTimeout)return wr=setTimeout,setTimeout(r,0);try{return wr(r,0)}catch{try{return wr.call(null,r,0)}catch{return wr.call(this,r,0)}}}function If(r){if(Er===clearTimeout)return clearTimeout(r);if((Er===Vl||!Er)&&clearTimeout)return Er=clearTimeout,clearTimeout(r);try{return Er(r)}catch{try{return Er.call(null,r)}catch{return Er.call(this,r)}}}var nr=[],hi=!1,Hr,Nn=-1;function Af(){!hi||!Hr||(hi=!1,Hr.length?nr=Hr.concat(nr):Nn=-1,nr.length&&ql())}function ql(){if(!hi){var r=Wl(Af);hi=!0;for(var e=nr.length;e;){for(Hr=nr,nr=[];++Nn<e;)Hr&&Hr[Nn].run();Nn=-1,e=nr.length}Hr=null,hi=!1,If(r)}}function Ft(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];nr.push(new Yl(r,e)),nr.length===1&&!hi&&Wl(ql)}function Yl(r,e){this.fun=r,this.array=e}Yl.prototype.run=function(){this.fun.apply(null,this.array)};var _f="browser",Ff="browser",Bf=!0,kf={},zf=[],Hf="",Uf={},Gf={},Vf={};function Zr(){}var Wf=Zr,qf=Zr,Yf=Zr,Xf=Zr,Zf=Zr,Kf=Zr,Qf=Zr;function jf(r){throw new Error("process.binding is not supported")}function Jf(){return"/"}function $f(r){throw new Error("process.chdir is not supported")}function ec(){return 0}var oi=gi.performance||{},tc=oi.now||oi.mozNow||oi.msNow||oi.oNow||oi.webkitNow||function(){return new Date().getTime()};function rc(r){var e=tc.call(oi)*.001,t=Math.floor(e),i=Math.floor(e%1*1e9);return r&&(t=t-r[0],i=i-r[1],i<0&&(t--,i+=1e9)),[t,i]}var ic=new Date;function nc(){var r=new Date,e=r-ic;return e/1e3}var In={nextTick:Ft,title:_f,browser:Bf,env:kf,argv:zf,version:Hf,versions:Uf,on:Wf,addListener:qf,once:Yf,off:Xf,removeListener:Zf,removeAllListeners:Kf,emit:Qf,binding:jf,cwd:Jf,chdir:$f,umask:ec,hrtime:rc,platform:Ff,release:Gf,config:Vf,uptime:nc},Ka;typeof Object.create=="function"?Ka=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:Ka=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e};var wi=Ka,ac=/%[sdj%]/g;function oc(r){if(!go(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Dr(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,a=String(r).replace(ac,function(s){if(s==="%%")return"%";if(t>=n)return s;switch(s){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch{return"[Circular]"}default:return s}}),o=i[t];t<n;o=i[++t])vo(o)||!tn(o)?a+=" "+o:a+=" "+Dr(o);return a}function Xl(r,e){if(br(gi.process))return function(){return Xl(r,e).apply(this,arguments)};if(In.noDeprecation===!0)return r;var t=!1;function i(){if(!t){if(In.throwDeprecation)throw new Error(e);In.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i}var wn={},Ca;function sc(r){if(br(Ca)&&(Ca=In.env.NODE_DEBUG||""),r=r.toUpperCase(),!wn[r])if(new RegExp("\\b"+r+"\\b","i").test(Ca)){var e=0;wn[r]=function(){var t=oc.apply(null,arguments);console.error("%s %d: %s",r,e,t)}}else wn[r]=function(){};return wn[r]}function Dr(r,e){var t={seen:[],stylize:uc};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),Zl(e)?t.showHidden=e:e&&pc(t,e),br(t.showHidden)&&(t.showHidden=!1),br(t.depth)&&(t.depth=2),br(t.colors)&&(t.colors=!1),br(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=lc),Vn(t,r,t.depth)}Dr.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Dr.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function lc(r,e){var t=Dr.styles[e];return t?"\x1B["+Dr.colors[t][0]+"m"+r+"\x1B["+Dr.colors[t][1]+"m":r}function uc(r,e){return r}function hc(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function Vn(r,e,t){if(r.customInspect&&e&&La(e.inspect)&&e.inspect!==Dr&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return go(i)||(i=Vn(r,i,t)),i}var n=fc(r,e);if(n)return n;var a=Object.keys(e),o=hc(a);if(r.showHidden&&(a=Object.getOwnPropertyNames(e)),Pa(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return Da(e);if(a.length===0){if(La(e)){var s=e.name?": "+e.name:"";return r.stylize("[Function"+s+"]","special")}if(Ra(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Zo(e))return r.stylize(Date.prototype.toString.call(e),"date");if(Pa(e))return Da(e)}var l="",u=!1,h=["{","}"];if(vc(e)&&(u=!0,h=["[","]"]),La(e)){var f=e.name?": "+e.name:"";l=" [Function"+f+"]"}if(Ra(e)&&(l=" "+RegExp.prototype.toString.call(e)),Zo(e)&&(l=" "+Date.prototype.toUTCString.call(e)),Pa(e)&&(l=" "+Da(e)),a.length===0&&(!u||e.length==0))return h[0]+l+h[1];if(t<0)return Ra(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var d;return u?d=cc(r,e,t,o,a):d=a.map(function(c){return Qa(r,e,t,o,c,u)}),r.seen.pop(),dc(d,l,h)}function fc(r,e){if(br(e))return r.stylize("undefined","undefined");if(go(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(gc(e))return r.stylize(""+e,"number");if(Zl(e))return r.stylize(""+e,"boolean");if(vo(e))return r.stylize("null","null")}function Da(r){return"["+Error.prototype.toString.call(r)+"]"}function cc(r,e,t,i,n){for(var a=[],o=0,s=e.length;o<s;++o)Kl(e,String(o))?a.push(Qa(r,e,t,i,String(o),!0)):a.push("");return n.forEach(function(l){l.match(/^\d+$/)||a.push(Qa(r,e,t,i,l,!0))}),a}function Qa(r,e,t,i,n,a){var o,s,l;if(l=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},l.get?l.set?s=r.stylize("[Getter/Setter]","special"):s=r.stylize("[Getter]","special"):l.set&&(s=r.stylize("[Setter]","special")),Kl(i,n)||(o="["+n+"]"),s||(r.seen.indexOf(l.value)<0?(vo(t)?s=Vn(r,l.value,null):s=Vn(r,l.value,t-1),s.indexOf(`
`)>-1&&(a?s=s.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):s=`
`+s.split(`
`).map(function(u){return"   "+u}).join(`
`))):s=r.stylize("[Circular]","special")),br(o)){if(a&&n.match(/^\d+$/))return s;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+s}function dc(r,e,t){var i=r.reduce(function(n,a){return a.indexOf(`
`)>=0,n+a.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function vc(r){return Array.isArray(r)}function Zl(r){return typeof r=="boolean"}function vo(r){return r===null}function gc(r){return typeof r=="number"}function go(r){return typeof r=="string"}function br(r){return r===void 0}function Ra(r){return tn(r)&&po(r)==="[object RegExp]"}function tn(r){return typeof r=="object"&&r!==null}function Zo(r){return tn(r)&&po(r)==="[object Date]"}function Pa(r){return tn(r)&&(po(r)==="[object Error]"||r instanceof Error)}function La(r){return typeof r=="function"}function po(r){return Object.prototype.toString.call(r)}function pc(r,e){if(!e||!tn(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r}function Kl(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Kr(){this.head=null,this.tail=null,this.length=0}Kr.prototype.push=function(r){var e={data:r,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length};Kr.prototype.unshift=function(r){var e={data:r,next:this.head};this.length===0&&(this.tail=e),this.head=e,++this.length};Kr.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}};Kr.prototype.clear=function(){this.head=this.tail=null,this.length=0};Kr.prototype.join=function(r){if(this.length===0)return"";for(var e=this.head,t=""+e.data;e=e.next;)t+=r+e.data;return t};Kr.prototype.concat=function(r){if(this.length===0)return ve.alloc(0);if(this.length===1)return this.head.data;for(var e=ve.allocUnsafe(r>>>0),t=this.head,i=0;t;)t.data.copy(e,i),i+=t.data.length,t=t.next;return e};var mc=ve.isEncoding||function(r){switch(r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function yc(r){if(r&&!mc(r))throw new Error("Unknown encoding: "+r)}function rn(r){switch(this.encoding=(r||"utf8").toLowerCase().replace(/[-_]/,""),yc(r),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ec;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Tc;break;default:this.write=wc;return}this.charBuffer=new ve(6),this.charReceived=0,this.charLength=0}rn.prototype.write=function(r){for(var e="";this.charLength;){var t=r.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:r.length;if(r.copy(this.charBuffer,this.charReceived,0,t),this.charReceived+=t,this.charReceived<this.charLength)return"";r=r.slice(t,r.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=e.charCodeAt(e.length-1);if(n>=55296&&n<=56319){this.charLength+=this.surrogateSize,e="";continue}if(this.charReceived=this.charLength=0,r.length===0)return e;break}this.detectIncompleteChar(r);var i=r.length;this.charLength&&(r.copy(this.charBuffer,0,r.length-this.charReceived,i),i-=this.charReceived),e+=r.toString(this.encoding,0,i);var i=e.length-1,n=e.charCodeAt(i);if(n>=55296&&n<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),r.copy(this.charBuffer,0,0,a),e.substring(0,i)}return e};rn.prototype.detectIncompleteChar=function(r){for(var e=r.length>=3?3:r.length;e>0;e--){var t=r[r.length-e];if(e==1&&t>>5==6){this.charLength=2;break}if(e<=2&&t>>4==14){this.charLength=3;break}if(e<=3&&t>>3==30){this.charLength=4;break}}this.charReceived=e};rn.prototype.end=function(r){var e="";if(r&&r.length&&(e=this.write(r)),this.charReceived){var t=this.charReceived,i=this.charBuffer,n=this.encoding;e+=i.slice(0,t).toString(n)}return e};function wc(r){return r.toString(this.encoding)}function Ec(r){this.charReceived=r.length%2,this.charLength=this.charReceived?2:0}function Tc(r){this.charReceived=r.length%3,this.charLength=this.charReceived?3:0}ot.ReadableState=Ql;var Ke=sc("stream");wi(ot,ke);function bc(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function xc(r,e){return r.listeners(e).length}function Ql(r,e){r=r||{},this.objectMode=!!r.objectMode,e instanceof Gt&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var t=r.highWaterMark,i=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new Kr,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(this.decoder=new rn(r.encoding),this.encoding=r.encoding)}function ot(r){if(!(this instanceof ot))return new ot(r);this._readableState=new Ql(r,this),this.readable=!0,r&&typeof r.read=="function"&&(this._read=r.read),ke.call(this)}ot.prototype.push=function(r,e){var t=this._readableState;return!t.objectMode&&typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=ve.from(r,e),e="")),jl(this,t,r,e,!1)};ot.prototype.unshift=function(r){var e=this._readableState;return jl(this,e,r,"",!0)};ot.prototype.isPaused=function(){return this._readableState.flowing===!1};function jl(r,e,t,i,n){var a=Dc(e,t);if(a)r.emit("error",a);else if(t===null)e.reading=!1,Rc(r,e);else if(e.objectMode||t&&t.length>0)if(e.ended&&!n){var o=new Error("stream.push() after EOF");r.emit("error",o)}else if(e.endEmitted&&n){var s=new Error("stream.unshift() after end event");r.emit("error",s)}else{var l;e.decoder&&!n&&!i&&(t=e.decoder.write(t),l=!e.objectMode&&t.length===0),n||(e.reading=!1),l||(e.flowing&&e.length===0&&!e.sync?(r.emit("data",t),r.read(0)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&aa(r))),Pc(r,e)}else n||(e.reading=!1);return Sc(e)}function Sc(r){return!r.ended&&(r.needReadable||r.length<r.highWaterMark||r.length===0)}ot.prototype.setEncoding=function(r){return this._readableState.decoder=new rn(r),this._readableState.encoding=r,this};var Ko=8388608;function Cc(r){return r>=Ko?r=Ko:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function Qo(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=Cc(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}ot.prototype.read=function(r){Ke("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Ke("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Oa(this):aa(this),null;if(r=Qo(r,e),r===0&&e.ended)return e.length===0&&Oa(this),null;var i=e.needReadable;Ke("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,Ke("length less than watermark",i)),e.ended||e.reading?(i=!1,Ke("reading or ended",i)):i&&(Ke("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=Qo(t,e)));var n;return r>0?n=Jl(r,e):n=null,n===null?(e.needReadable=!0,r=0):e.length-=r,e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&Oa(this)),n!==null&&this.emit("data",n),n};function Dc(r,e){var t=null;return!Mt(e)&&typeof e!="string"&&e!==null&&e!==void 0&&!r.objectMode&&(t=new TypeError("Invalid non-string/buffer chunk")),t}function Rc(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,aa(r)}}function aa(r){var e=r._readableState;e.needReadable=!1,e.emittedReadable||(Ke("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Ft(jo,r):jo(r))}function jo(r){Ke("emit readable"),r.emit("readable"),mo(r)}function Pc(r,e){e.readingMore||(e.readingMore=!0,Ft(Lc,r,e))}function Lc(r,e){for(var t=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Ke("maybeReadMore read 0"),r.read(0),t!==e.length);)t=e.length;e.readingMore=!1}ot.prototype._read=function(r){this.emit("error",new Error("not implemented"))};ot.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,Ke("pipe count=%d opts=%j",i.pipesCount,e);var n=!e||e.end!==!1,a=n?s:h;i.endEmitted?Ft(a):t.once("end",a),r.on("unpipe",o);function o(p){Ke("onunpipe"),p===t&&h()}function s(){Ke("onend"),r.end()}var l=Oc(t);r.on("drain",l);var u=!1;function h(){Ke("cleanup"),r.removeListener("close",v),r.removeListener("finish",g),r.removeListener("drain",l),r.removeListener("error",c),r.removeListener("unpipe",o),t.removeListener("end",s),t.removeListener("end",h),t.removeListener("data",d),u=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&l()}var f=!1;t.on("data",d);function d(p){Ke("ondata"),f=!1;var y=r.write(p);y===!1&&!f&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&$l(i.pipes,r)!==-1)&&!u&&(Ke("false write response, pause",t._readableState.awaitDrain),t._readableState.awaitDrain++,f=!0),t.pause())}function c(p){Ke("onerror",p),m(),r.removeListener("error",c),xc(r,"error")===0&&r.emit("error",p)}bc(r,"error",c);function v(){r.removeListener("finish",g),m()}r.once("close",v);function g(){Ke("onfinish"),r.removeListener("close",v),m()}r.once("finish",g);function m(){Ke("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(Ke("pipe resume"),t.resume()),r};function Oc(r){return function(){var e=r._readableState;Ke("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&r.listeners("data").length&&(e.flowing=!0,mo(r))}}ot.prototype.unpipe=function(r){var e=this._readableState;if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this),this);if(!r){var t=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var n=0;n<i;n++)t[n].emit("unpipe",this);return this}var a=$l(e.pipes,r);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this),this)};ot.prototype.on=function(r,e){var t=ke.prototype.on.call(this,r,e);if(r==="data")this._readableState.flowing!==!1&&this.resume();else if(r==="readable"){var i=this._readableState;!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&aa(this):Ft(Mc,this))}return t};ot.prototype.addListener=ot.prototype.on;function Mc(r){Ke("readable nexttick read 0"),r.read(0)}ot.prototype.resume=function(){var r=this._readableState;return r.flowing||(Ke("resume"),r.flowing=!0,Nc(this,r)),this};function Nc(r,e){e.resumeScheduled||(e.resumeScheduled=!0,Ft(Ic,r,e))}function Ic(r,e){e.reading||(Ke("resume read 0"),r.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,r.emit("resume"),mo(r),e.flowing&&!e.reading&&r.read(0)}ot.prototype.pause=function(){return Ke("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ke("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function mo(r){var e=r._readableState;for(Ke("flow",e.flowing);e.flowing&&r.read()!==null;);}ot.prototype.wrap=function(r){var e=this._readableState,t=!1,i=this;r.on("end",function(){if(Ke("wrapped end"),e.decoder&&!e.ended){var o=e.decoder.end();o&&o.length&&i.push(o)}i.push(null)}),r.on("data",function(o){if(Ke("wrapped data"),e.decoder&&(o=e.decoder.write(o)),!(e.objectMode&&o==null)&&!(!e.objectMode&&(!o||!o.length))){var s=i.push(o);s||(t=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(o){return function(){return r[o].apply(r,arguments)}}(n));var a=["error","close","destroy","pause","resume"];return kc(a,function(o){r.on(o,i.emit.bind(i,o))}),i._read=function(o){Ke("wrapped _read",o),t&&(t=!1,r.resume())},i};ot._fromList=Jl;function Jl(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.head.data:t=e.buffer.concat(e.length),e.buffer.clear()):t=Ac(r,e.buffer,e.decoder),t}function Ac(r,e,t){var i;return r<e.head.data.length?(i=e.head.data.slice(0,r),e.head.data=e.head.data.slice(r)):r===e.head.data.length?i=e.shift():i=t?_c(r,e):Fc(r,e),i}function _c(r,e){var t=e.head,i=1,n=t.data;for(r-=n.length;t=t.next;){var a=t.data,o=r>a.length?a.length:r;if(o===a.length?n+=a:n+=a.slice(0,r),r-=o,r===0){o===a.length?(++i,t.next?e.head=t.next:e.head=e.tail=null):(e.head=t,t.data=a.slice(o));break}++i}return e.length-=i,n}function Fc(r,e){var t=ve.allocUnsafe(r),i=e.head,n=1;for(i.data.copy(t),r-=i.data.length;i=i.next;){var a=i.data,o=r>a.length?a.length:r;if(a.copy(t,t.length-r,0,o),r-=o,r===0){o===a.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=a.slice(o));break}++n}return e.length-=n,t}function Oa(r){var e=r._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Ft(Bc,e,r))}function Bc(r,e){!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"))}function kc(r,e){for(var t=0,i=r.length;t<i;t++)e(r[t],t)}function $l(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}St.WritableState=yo;wi(St,ke);function zc(){}function Hc(r,e,t){this.chunk=r,this.encoding=e,this.callback=t,this.next=null}function yo(r,e){Object.defineProperty(this,"buffer",{get:Xl(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),r=r||{},this.objectMode=!!r.objectMode,e instanceof Gt&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var t=r.highWaterMark,i=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=r.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){Xc(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new iu(this)}yo.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};function St(r){if(!(this instanceof St)&&!(this instanceof Gt))return new St(r);this._writableState=new yo(r,this),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev)),ke.call(this)}St.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Uc(r,e){var t=new Error("write after end");r.emit("error",t),Ft(e,t)}function Gc(r,e,t,i){var n=!0,a=!1;return t===null?a=new TypeError("May not write null values to stream"):!ve.isBuffer(t)&&typeof t!="string"&&t!==void 0&&!e.objectMode&&(a=new TypeError("Invalid non-string/buffer chunk")),a&&(r.emit("error",a),Ft(i,a),n=!1),n}St.prototype.write=function(r,e,t){var i=this._writableState,n=!1;return typeof e=="function"&&(t=e,e=null),ve.isBuffer(r)?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=zc),i.ended?Uc(this,t):Gc(this,i,r,t)&&(i.pendingcb++,n=Wc(this,i,r,e,t)),n};St.prototype.cork=function(){var r=this._writableState;r.corked++};St.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.finished&&!r.bufferProcessing&&r.bufferedRequest&&eu(this,r))};St.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function Vc(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=ve.from(e,t)),e}function Wc(r,e,t,i,n){t=Vc(e,t,i),ve.isBuffer(t)&&(i="buffer");var a=e.objectMode?1:t.length;e.length+=a;var o=e.length<e.highWaterMark;if(o||(e.needDrain=!0),e.writing||e.corked){var s=e.lastBufferedRequest;e.lastBufferedRequest=new Hc(t,i,n),s?s.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else ja(r,e,!1,a,t,i,n);return o}function ja(r,e,t,i,n,a,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,t?r._writev(n,e.onwrite):r._write(n,a,e.onwrite),e.sync=!1}function qc(r,e,t,i,n){--e.pendingcb,t?Ft(n,i):n(i),r._writableState.errorEmitted=!0,r.emit("error",i)}function Yc(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function Xc(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(Yc(t),e)qc(r,t,i,e,n);else{var a=tu(t);!a&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&eu(r,t),i?Ft(Jo,r,t,a,n):Jo(r,t,a,n)}}function Jo(r,e,t,i){t||Zc(r,e),e.pendingcb--,i(),ru(r,e)}function Zc(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function eu(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),a=e.corkedRequestsFree;a.entry=t;for(var o=0;t;)n[o]=t,t=t.next,o+=1;ja(r,e,!0,e.length,n,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new iu(e)}else{for(;t;){var s=t.chunk,l=t.encoding,u=t.callback,h=e.objectMode?1:s.length;if(ja(r,e,!1,h,s,l,u),t=t.next,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=t,e.bufferProcessing=!1}St.prototype._write=function(r,e,t){t(new Error("not implemented"))};St.prototype._writev=null;St.prototype.end=function(r,e,t){var i=this._writableState;typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),!i.ending&&!i.finished&&Kc(this,i,t)};function tu(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function $o(r,e){e.prefinished||(e.prefinished=!0,r.emit("prefinish"))}function ru(r,e){var t=tu(e);return t&&(e.pendingcb===0?($o(r,e),e.finished=!0,r.emit("finish")):$o(r,e)),t}function Kc(r,e,t){e.ending=!0,ru(r,e),t&&(e.finished?Ft(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function iu(r){var e=this;this.next=null,this.entry=null,this.finish=function(t){var i=e.entry;for(e.entry=null;i;){var n=i.callback;r.pendingcb--,n(t),i=i.next}r.corkedRequestsFree?r.corkedRequestsFree.next=e:r.corkedRequestsFree=e}}wi(Gt,ot);var es=Object.keys(St.prototype);for(var Ma=0;Ma<es.length;Ma++){var Na=es[Ma];Gt.prototype[Na]||(Gt.prototype[Na]=St.prototype[Na])}function Gt(r){if(!(this instanceof Gt))return new Gt(r);ot.call(this,r),St.call(this,r),r&&r.readable===!1&&(this.readable=!1),r&&r.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,r&&r.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",Qc)}function Qc(){this.allowHalfOpen||this._writableState.ended||Ft(jc,this)}function jc(r){r.end()}wi(Yt,Gt);function Jc(r){this.afterTransform=function(e,t){return $c(r,e,t)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function $c(r,e,t){var i=r._transformState;i.transforming=!1;var n=i.writecb;if(!n)return r.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,t!=null&&r.push(t),n(e);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Yt(r){if(!(this instanceof Yt))return new Yt(r);Gt.call(this,r),this._transformState=new Jc(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(t){ts(e,t)}):ts(e)})}Yt.prototype.push=function(r,e){return this._transformState.needTransform=!1,Gt.prototype.push.call(this,r,e)};Yt.prototype._transform=function(r,e,t){throw new Error("Not implemented")};Yt.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Yt.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function ts(r,e){if(e)return r.emit("error",e);var t=r._writableState,i=r._transformState;if(t.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}wi(Vi,Yt);function Vi(r){if(!(this instanceof Vi))return new Vi(r);Yt.call(this,r)}Vi.prototype._transform=function(r,e,t){t(null,r)};wi(ar,ke);ar.Readable=ot;ar.Writable=St;ar.Duplex=Gt;ar.Transform=Yt;ar.PassThrough=Vi;ar.Stream=ar;function ar(){ke.call(this)}ar.prototype.pipe=function(r,e){var t=this;function i(h){r.writable&&r.write(h)===!1&&t.pause&&t.pause()}t.on("data",i);function n(){t.readable&&t.resume&&t.resume()}r.on("drain",n),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",o),t.on("close",s));var a=!1;function o(){a||(a=!0,r.end())}function s(){a||(a=!0,typeof r.destroy=="function"&&r.destroy())}function l(h){if(u(),ke.listenerCount(this,"error")===0)throw h}t.on("error",l),r.on("error",l);function u(){t.removeListener("data",i),r.removeListener("drain",n),t.removeListener("end",o),t.removeListener("close",s),t.removeListener("error",l),r.removeListener("error",l),t.removeListener("end",u),t.removeListener("close",u),r.removeListener("close",u)}return t.on("end",u),t.on("close",u),r.on("close",u),r.emit("pipe",t),r};const nu=function(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)};class qe extends Error{constructor(e,t,i,...n){Array.isArray(t)&&(t=t.join(" ")),super(t),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,qe),this.code=e;for(const a of n)for(const o in a){const s=a[o];this[o]=Mt(s)?s.toString(i.encoding):s==null?s:JSON.parse(JSON.stringify(s))}}}const au=function(r){const e=[];for(let t=0,i=r.length;t<i;t++){const n=r[t];if(n==null||n===!1)e[t]={disabled:!0};else if(typeof n=="string")e[t]={name:n};else if(nu(n)){if(typeof n.name!="string")throw new qe("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${t}`,"when column is an object literal"]);e[t]=n}else throw new qe("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(n)} at position ${t}`])}return e};class rs{constructor(e=100){this.size=e,this.length=0,this.buf=ve.allocUnsafe(e)}prepend(e){if(Mt(e)){const t=this.length+e.length;if(t>=this.size&&(this.resize(),t>=this.size))throw Error("INVALID_BUFFER_STATE");const i=this.buf;this.buf=ve.allocUnsafe(this.size),e.copy(this.buf,0),i.copy(this.buf,e.length),this.length+=e.length}else{const t=this.length++;t===this.size&&this.resize();const i=this.clone();this.buf[0]=e,i.copy(this.buf,1,0,t)}}append(e){const t=this.length++;t===this.size&&this.resize(),this.buf[t]=e}clone(){return ve.from(this.buf.slice(0,this.length))}resize(){const e=this.length;this.size=this.size*2;const t=ve.allocUnsafe(this.size);this.buf.copy(t,0,0,e),this.buf=t}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}}const ed=12,td=13,rd=10,id=32,nd=9,ad=function(r){return{bomSkipped:!1,bufBytesStart:0,castField:r.cast_function,commenting:!1,error:void 0,enabled:r.from_line===1,escaping:!1,escapeIsQuote:Mt(r.escape)&&Mt(r.quote)&&ve.compare(r.escape,r.quote)===0,expectedRecordLength:Array.isArray(r.columns)?r.columns.length:void 0,field:new rs(20),firstLineToHeaders:r.cast_first_line_to_header,needMoreDataSize:Math.max(r.comment!==null?r.comment.length:0,...r.delimiter.map(e=>e.length),r.quote!==null?r.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new rs(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:r.record_delimiter.length===0?0:Math.max(...r.record_delimiter.map(e=>e.length)),trimChars:[ve.from(" ",r.encoding)[0],ve.from("	",r.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1,timchars:[ve.from(ve.from([td],"utf8").toString(),r.encoding),ve.from(ve.from([rd],"utf8").toString(),r.encoding),ve.from(ve.from([ed],"utf8").toString(),r.encoding),ve.from(ve.from([id],"utf8").toString(),r.encoding),ve.from(ve.from([nd],"utf8").toString(),r.encoding)]}},od=function(r){return r.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})},is=function(r){const e={};for(const i in r)e[od(i)]=r[i];if(e.encoding===void 0||e.encoding===!0)e.encoding="utf8";else if(e.encoding===null||e.encoding===!1)e.encoding=null;else if(typeof e.encoding!="string"&&e.encoding!==null)throw new qe("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,",`got ${JSON.stringify(e.encoding)}`],e);if(e.bom===void 0||e.bom===null||e.bom===!1)e.bom=!1;else if(e.bom!==!0)throw new qe("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(e.bom)}`],e);if(e.cast_function=null,e.cast===void 0||e.cast===null||e.cast===!1||e.cast==="")e.cast=void 0;else if(typeof e.cast=="function")e.cast_function=e.cast,e.cast=!0;else if(e.cast!==!0)throw new qe("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(e.cast)}`],e);if(e.cast_date===void 0||e.cast_date===null||e.cast_date===!1||e.cast_date==="")e.cast_date=!1;else if(e.cast_date===!0)e.cast_date=function(i){const n=Date.parse(i);return isNaN(n)?i:new Date(n)};else if(typeof e.cast_date!="function")throw new qe("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(e.cast_date)}`],e);if(e.cast_first_line_to_header=null,e.columns===!0)e.cast_first_line_to_header=void 0;else if(typeof e.columns=="function")e.cast_first_line_to_header=e.columns,e.columns=!0;else if(Array.isArray(e.columns))e.columns=au(e.columns);else if(e.columns===void 0||e.columns===null||e.columns===!1)e.columns=!1;else throw new qe("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,",`got ${JSON.stringify(e.columns)}`],e);if(e.group_columns_by_name===void 0||e.group_columns_by_name===null||e.group_columns_by_name===!1)e.group_columns_by_name=!1;else{if(e.group_columns_by_name!==!0)throw new qe("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","expect an boolean,",`got ${JSON.stringify(e.group_columns_by_name)}`],e);if(e.columns===!1)throw new qe("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","the `columns` mode must be activated."],e)}if(e.comment===void 0||e.comment===null||e.comment===!1||e.comment==="")e.comment=null;else if(typeof e.comment=="string"&&(e.comment=ve.from(e.comment,e.encoding)),!Mt(e.comment))throw new qe("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(e.comment)}`],e);const t=JSON.stringify(e.delimiter);if(Array.isArray(e.delimiter)||(e.delimiter=[e.delimiter]),e.delimiter.length===0)throw new qe("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${t}`],e);if(e.delimiter=e.delimiter.map(function(i){if(i==null||i===!1)return ve.from(",",e.encoding);if(typeof i=="string"&&(i=ve.from(i,e.encoding)),!Mt(i)||i.length===0)throw new qe("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${t}`],e);return i}),e.escape===void 0||e.escape===!0?e.escape=ve.from('"',e.encoding):typeof e.escape=="string"?e.escape=ve.from(e.escape,e.encoding):(e.escape===null||e.escape===!1)&&(e.escape=null),e.escape!==null&&!Mt(e.escape))throw new Error(`Invalid Option: escape must be a buffer, a string or a boolean, got ${JSON.stringify(e.escape)}`);if(e.from===void 0||e.from===null)e.from=1;else if(typeof e.from=="string"&&/\d+/.test(e.from)&&(e.from=parseInt(e.from)),Number.isInteger(e.from)){if(e.from<0)throw new Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(r.from)}`)}else throw new Error(`Invalid Option: from must be an integer, got ${JSON.stringify(e.from)}`);if(e.from_line===void 0||e.from_line===null)e.from_line=1;else if(typeof e.from_line=="string"&&/\d+/.test(e.from_line)&&(e.from_line=parseInt(e.from_line)),Number.isInteger(e.from_line)){if(e.from_line<=0)throw new Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(r.from_line)}`)}else throw new Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(r.from_line)}`);if(e.ignore_last_delimiters===void 0||e.ignore_last_delimiters===null)e.ignore_last_delimiters=!1;else if(typeof e.ignore_last_delimiters=="number")e.ignore_last_delimiters=Math.floor(e.ignore_last_delimiters),e.ignore_last_delimiters===0&&(e.ignore_last_delimiters=!1);else if(typeof e.ignore_last_delimiters!="boolean")throw new qe("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,",`got ${JSON.stringify(e.ignore_last_delimiters)}`],e);if(e.ignore_last_delimiters===!0&&e.columns===!1)throw new qe("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],e);if(e.info===void 0||e.info===null||e.info===!1)e.info=!1;else if(e.info!==!0)throw new Error(`Invalid Option: info must be true, got ${JSON.stringify(e.info)}`);if(e.max_record_size===void 0||e.max_record_size===null||e.max_record_size===!1)e.max_record_size=0;else if(!(Number.isInteger(e.max_record_size)&&e.max_record_size>=0))if(typeof e.max_record_size=="string"&&/\d+/.test(e.max_record_size))e.max_record_size=parseInt(e.max_record_size);else throw new Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(e.max_record_size)}`);if(e.objname===void 0||e.objname===null||e.objname===!1)e.objname=void 0;else if(Mt(e.objname)){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty buffer");e.encoding===null||(e.objname=e.objname.toString(e.encoding))}else if(typeof e.objname=="string"){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty string")}else if(typeof e.objname!="number")throw new Error(`Invalid Option: objname must be a string or a buffer, got ${e.objname}`);if(e.objname!==void 0){if(typeof e.objname=="number"){if(e.columns!==!1)throw Error("Invalid Option: objname index cannot be combined with columns or be defined as a field")}else if(e.columns===!1)throw Error("Invalid Option: objname field must be combined with columns or be defined as an index")}if(e.on_record===void 0||e.on_record===null)e.on_record=void 0;else if(typeof e.on_record!="function")throw new qe("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(e.on_record)}`],e);if(e.quote===null||e.quote===!1||e.quote==="")e.quote=null;else if(e.quote===void 0||e.quote===!0?e.quote=ve.from('"',e.encoding):typeof e.quote=="string"&&(e.quote=ve.from(e.quote,e.encoding)),!Mt(e.quote))throw new Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(e.quote)}`);if(e.raw===void 0||e.raw===null||e.raw===!1)e.raw=!1;else if(e.raw!==!0)throw new Error(`Invalid Option: raw must be true, got ${JSON.stringify(e.raw)}`);if(e.record_delimiter===void 0)e.record_delimiter=[];else if(typeof e.record_delimiter=="string"||Mt(e.record_delimiter)){if(e.record_delimiter.length===0)throw new qe("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);e.record_delimiter=[e.record_delimiter]}else if(!Array.isArray(e.record_delimiter))throw new qe("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);if(e.record_delimiter=e.record_delimiter.map(function(i,n){if(typeof i!="string"&&!Mt(i))throw new qe("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer",`at index ${n},`,`got ${JSON.stringify(i)}`],e);if(i.length===0)throw new qe("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer",`at index ${n},`,`got ${JSON.stringify(i)}`],e);return typeof i=="string"&&(i=ve.from(i,e.encoding)),i}),typeof e.relax_column_count!="boolean")if(e.relax_column_count===void 0||e.relax_column_count===null)e.relax_column_count=!1;else throw new Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(e.relax_column_count)}`);if(typeof e.relax_column_count_less!="boolean")if(e.relax_column_count_less===void 0||e.relax_column_count_less===null)e.relax_column_count_less=!1;else throw new Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(e.relax_column_count_less)}`);if(typeof e.relax_column_count_more!="boolean")if(e.relax_column_count_more===void 0||e.relax_column_count_more===null)e.relax_column_count_more=!1;else throw new Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(e.relax_column_count_more)}`);if(typeof e.relax_quotes!="boolean")if(e.relax_quotes===void 0||e.relax_quotes===null)e.relax_quotes=!1;else throw new Error(`Invalid Option: relax_quotes must be a boolean, got ${JSON.stringify(e.relax_quotes)}`);if(typeof e.skip_empty_lines!="boolean")if(e.skip_empty_lines===void 0||e.skip_empty_lines===null)e.skip_empty_lines=!1;else throw new Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(e.skip_empty_lines)}`);if(typeof e.skip_records_with_empty_values!="boolean")if(e.skip_records_with_empty_values===void 0||e.skip_records_with_empty_values===null)e.skip_records_with_empty_values=!1;else throw new Error(`Invalid Option: skip_records_with_empty_values must be a boolean, got ${JSON.stringify(e.skip_records_with_empty_values)}`);if(typeof e.skip_records_with_error!="boolean")if(e.skip_records_with_error===void 0||e.skip_records_with_error===null)e.skip_records_with_error=!1;else throw new Error(`Invalid Option: skip_records_with_error must be a boolean, got ${JSON.stringify(e.skip_records_with_error)}`);if(e.rtrim===void 0||e.rtrim===null||e.rtrim===!1)e.rtrim=!1;else if(e.rtrim!==!0)throw new Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(e.rtrim)}`);if(e.ltrim===void 0||e.ltrim===null||e.ltrim===!1)e.ltrim=!1;else if(e.ltrim!==!0)throw new Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(e.ltrim)}`);if(e.trim===void 0||e.trim===null||e.trim===!1)e.trim=!1;else if(e.trim!==!0)throw new Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(e.trim)}`);if(e.trim===!0&&r.ltrim!==!1?e.ltrim=!0:e.ltrim!==!0&&(e.ltrim=!1),e.trim===!0&&r.rtrim!==!1?e.rtrim=!0:e.rtrim!==!0&&(e.rtrim=!1),e.to===void 0||e.to===null)e.to=-1;else if(typeof e.to=="string"&&/\d+/.test(e.to)&&(e.to=parseInt(e.to)),Number.isInteger(e.to)){if(e.to<=0)throw new Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(r.to)}`)}else throw new Error(`Invalid Option: to must be an integer, got ${JSON.stringify(r.to)}`);if(e.to_line===void 0||e.to_line===null)e.to_line=-1;else if(typeof e.to_line=="string"&&/\d+/.test(e.to_line)&&(e.to_line=parseInt(e.to_line)),Number.isInteger(e.to_line)){if(e.to_line<=0)throw new Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(r.to_line)}`)}else throw new Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(r.to_line)}`);return e},ns=function(r){return r.every(e=>e==null||e.toString&&e.toString().trim()==="")},sd=13,ld=10,En={utf8:ve.from([239,187,191]),utf16le:ve.from([255,254])},ud=function(r={}){const e={bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},t=is(r);return{info:e,original_options:r,options:t,state:ad(t),__needMoreData:function(i,n,a){if(a)return!1;const{encoding:o,escape:s,quote:l}=this.options,{quoting:u,needMoreDataSize:h,recordDelimiterMaxLength:f}=this.state,d=n-i-1,c=Math.max(h,f===0?ve.from(`\r
`,o).length:f,u?(s===null?0:s.length)+l.length:0,u?l.length+f:0);return d<c},parse:function(i,n,a,o){const{bom:s,from_line:l,ltrim:u,max_record_size:h,raw:f,relax_quotes:d,rtrim:c,skip_empty_lines:v,to:g,to_line:m}=this.options;let{comment:p,escape:y,quote:w,record_delimiter:T}=this.options;const{bomSkipped:O,previousBuf:I,rawBuffer:R,escapeIsQuote:L}=this.state;let N;if(I===void 0)if(i===void 0){o();return}else N=i;else I!==void 0&&i===void 0?N=I:N=ve.concat([I,i]);if(O===!1)if(s===!1)this.state.bomSkipped=!0;else if(N.length<3){if(n===!1){this.state.previousBuf=N;return}}else{for(const b in En)if(En[b].compare(N,0,En[b].length)===0){const M=En[b].length;this.state.bufBytesStart+=M,N=N.slice(M),this.options=is({...this.original_options,encoding:b}),{comment:p,escape:y,quote:w}=this.options;break}this.state.bomSkipped=!0}const E=N.length;let C;for(C=0;C<E&&!this.__needMoreData(C,E,n);C++){if(this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1),m!==-1&&this.info.lines>m){this.state.stop=!0,o();return}this.state.quoting===!1&&T.length===0&&this.__autoDiscoverRecordDelimiter(N,C)&&(T=this.options.record_delimiter);const b=N[C];if(f===!0&&R.append(b),(b===sd||b===ld)&&this.state.wasRowDelimiter===!1&&(this.state.wasRowDelimiter=!0),this.state.escaping===!0)this.state.escaping=!1;else{if(y!==null&&this.state.quoting===!0&&this.__isEscape(N,C,b)&&C+y.length<E)if(L){if(this.__isQuote(N,C+y.length)){this.state.escaping=!0,C+=y.length-1;continue}}else{this.state.escaping=!0,C+=y.length-1;continue}if(this.state.commenting===!1&&this.__isQuote(N,C))if(this.state.quoting===!0){const H=N[C+w.length],k=c&&this.__isCharTrimable(N,C+w.length),B=p!==null&&this.__compareBytes(p,N,C+w.length,H),U=this.__isDelimiter(N,C+w.length,H),W=T.length===0?this.__autoDiscoverRecordDelimiter(N,C+w.length):this.__isRecordDelimiter(H,N,C+w.length);if(y!==null&&this.__isEscape(N,C,b)&&this.__isQuote(N,C+y.length))C+=y.length-1;else if(!H||U||W||B||k){this.state.quoting=!1,this.state.wasQuoting=!0,C+=w.length-1;continue}else if(d===!1){const J=this.__error(new qe("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(H)}"`,`at line ${this.info.lines}`,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(J!==void 0)return J}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(w),C+=w.length-1}else if(this.state.field.length!==0){if(d===!1){const H=this.__error(new qe("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found inside a field at line ${this.info.lines}`],this.options,this.__infoField(),{field:this.state.field}));if(H!==void 0)return H}}else{this.state.quoting=!0,C+=w.length-1;continue}if(this.state.quoting===!1){const H=this.__isRecordDelimiter(b,N,C);if(H!==0){if(this.state.commenting&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0)this.info.comment_lines++;else{if(this.state.enabled===!1&&this.info.lines+(this.state.wasRowDelimiter===!0?1:0)>=l){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),C+=H-1;continue}if(v===!0&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0){this.info.empty_lines++,C+=H-1;continue}this.info.bytes=this.state.bufBytesStart+C;const W=this.__onField();if(W!==void 0)return W;this.info.bytes=this.state.bufBytesStart+C+H;const J=this.__onRecord(a);if(J!==void 0)return J;if(g!==-1&&this.info.records>=g){this.state.stop=!0,o();return}}this.state.commenting=!1,C+=H-1;continue}if(this.state.commenting)continue;if((p===null?0:this.__compareBytes(p,N,C,b))!==0){this.state.commenting=!0;continue}const B=this.__isDelimiter(N,C,b);if(B!==0){this.info.bytes=this.state.bufBytesStart+C;const U=this.__onField();if(U!==void 0)return U;C+=B-1;continue}}}if(this.state.commenting===!1&&h!==0&&this.state.record_length+this.state.field.length>h)return this.__error(new qe("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${h}`,`at line ${this.info.lines}`],this.options,this.__infoField()));const M=u===!1||this.state.quoting===!0||this.state.field.length!==0||!this.__isCharTrimable(N,C),D=c===!1||this.state.wasQuoting===!1;if(M===!0&&D===!0)this.state.field.append(b);else{if(c===!0&&!this.__isCharTrimable(N,C))return this.__error(new qe("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.options,this.__infoField()));M===!1&&(C+=this.__isCharTrimable(N,C)-1);continue}}if(n===!0)if(this.state.quoting===!0){const b=this.__error(new qe("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.options,this.__infoField()));if(b!==void 0)return b}else if(this.state.wasQuoting===!0||this.state.record.length!==0||this.state.field.length!==0){this.info.bytes=this.state.bufBytesStart+C;const b=this.__onField();if(b!==void 0)return b;const M=this.__onRecord(a);if(M!==void 0)return M}else this.state.wasRowDelimiter===!0?this.info.empty_lines++:this.state.commenting===!0&&this.info.comment_lines++;else this.state.bufBytesStart+=C,this.state.previousBuf=N.slice(C);this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1)},__onRecord:function(i){const{columns:n,group_columns_by_name:a,encoding:o,info:s,from:l,relax_column_count:u,relax_column_count_less:h,relax_column_count_more:f,raw:d,skip_records_with_empty_values:c}=this.options,{enabled:v,record:g}=this.state;if(v===!1)return this.__resetRecord();const m=g.length;if(n===!0){if(c===!0&&ns(g)){this.__resetRecord();return}return this.__firstLineToColumns(g)}if(n===!1&&this.info.records===0&&(this.state.expectedRecordLength=m),m!==this.state.expectedRecordLength){const p=n===!1?new qe("CSV_RECORD_INCONSISTENT_FIELDS_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${m} on line ${this.info.lines}`],this.options,this.__infoField(),{record:g}):new qe("CSV_RECORD_INCONSISTENT_COLUMNS",["Invalid Record Length:",`columns length is ${n.length},`,`got ${m} on line ${this.info.lines}`],this.options,this.__infoField(),{record:g});if(u===!0||h===!0&&m<this.state.expectedRecordLength||f===!0&&m>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=p;else{const y=this.__error(p);if(y)return y}}if(c===!0&&ns(g)){this.__resetRecord();return}if(this.state.recordHasError===!0){this.__resetRecord(),this.state.recordHasError=!1;return}if(this.info.records++,l===1||this.info.records>=l){const{objname:p}=this.options;if(n!==!1){const y={};for(let w=0,T=g.length;w<T;w++)n[w]===void 0||n[w].disabled||(a===!0&&y[n[w].name]!==void 0?Array.isArray(y[n[w].name])?y[n[w].name]=y[n[w].name].concat(g[w]):y[n[w].name]=[y[n[w].name],g[w]]:y[n[w].name]=g[w]);if(d===!0||s===!0){const w=Object.assign({record:y},d===!0?{raw:this.state.rawBuffer.toString(o)}:{},s===!0?{info:this.__infoRecord()}:{}),T=this.__push(p===void 0?w:[y[p],w],i);if(T)return T}else{const w=this.__push(p===void 0?y:[y[p],y],i);if(w)return w}}else if(d===!0||s===!0){const y=Object.assign({record:g},d===!0?{raw:this.state.rawBuffer.toString(o)}:{},s===!0?{info:this.__infoRecord()}:{}),w=this.__push(p===void 0?y:[g[p],y],i);if(w)return w}else{const y=this.__push(p===void 0?g:[g[p],g],i);if(y)return y}}this.__resetRecord()},__firstLineToColumns:function(i){const{firstLineToHeaders:n}=this.state;try{const a=n===void 0?i:n.call(null,i);if(!Array.isArray(a))return this.__error(new qe("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(a)}`],this.options,this.__infoField(),{headers:a}));const o=au(a);this.state.expectedRecordLength=o.length,this.options.columns=o,this.__resetRecord();return}catch(a){return a}},__resetRecord:function(){this.options.raw===!0&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0},__onField:function(){const{cast:i,encoding:n,rtrim:a,max_record_size:o}=this.options,{enabled:s,wasQuoting:l}=this.state;if(s===!1)return this.__resetField();let u=this.state.field.toString(n);if(a===!0&&l===!1&&(u=u.trimRight()),i===!0){const[h,f]=this.__cast(u);if(h!==void 0)return h;u=f}this.state.record.push(u),o!==0&&typeof u=="string"&&(this.state.record_length+=u.length),this.__resetField()},__resetField:function(){this.state.field.reset(),this.state.wasQuoting=!1},__push:function(i,n){const{on_record:a}=this.options;if(a!==void 0){const o=this.__infoRecord();try{i=a.call(null,i,o)}catch(s){return s}if(i==null)return}n(i)},__cast:function(i){const{columns:n,relax_column_count:a}=this.options;if(Array.isArray(n)===!0&&a&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(this.state.castField!==null)try{const s=this.__infoField();return[void 0,this.state.castField.call(null,i,s)]}catch(s){return[s]}if(this.__isFloat(i))return[void 0,parseFloat(i)];if(this.options.cast_date!==!1){const s=this.__infoField();return[void 0,this.options.cast_date.call(null,i,s)]}return[void 0,i]},__isCharTrimable:function(i,n){return((o,s)=>{const{timchars:l}=this.state;e:for(let u=0;u<l.length;u++){const h=l[u];for(let f=0;f<h.length;f++)if(h[f]!==o[s+f])continue e;return h.length}return 0})(i,n)},__isFloat:function(i){return i-parseFloat(i)+1>=0},__compareBytes:function(i,n,a,o){if(i[0]!==o)return 0;const s=i.length;for(let l=1;l<s;l++)if(i[l]!==n[a+l])return 0;return s},__isDelimiter:function(i,n,a){const{delimiter:o,ignore_last_delimiters:s}=this.options;if(s===!0&&this.state.record.length===this.options.columns.length-1)return 0;if(s!==!1&&typeof s=="number"&&this.state.record.length===s-1)return 0;e:for(let l=0;l<o.length;l++){const u=o[l];if(u[0]===a){for(let h=1;h<u.length;h++)if(u[h]!==i[n+h])continue e;return u.length}}return 0},__isRecordDelimiter:function(i,n,a){const{record_delimiter:o}=this.options,s=o.length;e:for(let l=0;l<s;l++){const u=o[l],h=u.length;if(u[0]===i){for(let f=1;f<h;f++)if(u[f]!==n[a+f])continue e;return u.length}}return 0},__isEscape:function(i,n,a){const{escape:o}=this.options;if(o===null)return!1;const s=o.length;if(o[0]===a){for(let l=0;l<s;l++)if(o[l]!==i[n+l])return!1;return!0}return!1},__isQuote:function(i,n){const{quote:a}=this.options;if(a===null)return!1;const o=a.length;for(let s=0;s<o;s++)if(a[s]!==i[n+s])return!1;return!0},__autoDiscoverRecordDelimiter:function(i,n){const{encoding:a}=this.options,o=[ve.from(`\r
`,a),ve.from(`
`,a),ve.from("\r",a)];e:for(let s=0;s<o.length;s++){const l=o[s].length;for(let u=0;u<l;u++)if(o[s][u]!==i[n+u])continue e;return this.options.record_delimiter.push(o[s]),this.state.recordDelimiterMaxLength=o[s].length,o[s].length}return 0},__error:function(i){const{encoding:n,raw:a,skip_records_with_error:o}=this.options,s=typeof i=="string"?new Error(i):i;if(o){this.state.recordHasError=!0,this.options.on_skip!==void 0&&this.options.on_skip(s,a?this.state.rawBuffer.toString(n):void 0);return}else return s},__infoDataSet:function(){return{...this.info,columns:this.options.columns}},__infoRecord:function(){const{columns:i,raw:n,encoding:a}=this.options;return{...this.__infoDataSet(),error:this.state.error,header:i===!0,index:this.state.record.length,raw:n?this.state.rawBuffer.toString(a):void 0}},__infoField:function(){const{columns:i}=this.options,n=Array.isArray(i);return{...this.__infoRecord(),column:n===!0?i.length>this.state.record.length?i[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}};class hd extends Yt{constructor(e={}){super({readableObjectMode:!0,...e,encoding:null}),this.api=ud(e),this.api.options.on_skip=(t,i)=>{this.emit("skip",t,i)},this.state=this.api.state,this.options=this.api.options,this.info=this.api.info}_transform(e,t,i){if(this.state.stop===!0)return;const n=this.api.parse(e,!1,a=>{this.push.call(this,a)},()=>{this.push.call(this,null)});n!==void 0&&(this.state.stop=!0),i(n)}_flush(e){if(this.state.stop===!0)return;const t=this.api.parse(void 0,!0,i=>{this.push.call(this,i)},()=>{this.push.call(this,null)});e(t)}}const fd=function(){let r,e,t;for(const n in arguments){const a=arguments[n],o=typeof a;if(r===void 0&&(typeof a=="string"||Mt(a)))r=a;else if(e===void 0&&nu(a))e=a;else if(t===void 0&&o==="function")t=a;else throw new qe("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(a)} at index ${n}`],e||{})}const i=new hd(e);if(t){const n=e===void 0||e.objname===void 0?[]:{};i.on("readable",function(){let a;for(;(a=this.read())!==null;)e===void 0||e.objname===void 0?n.push(a):n[a[0]]=a[1]}),i.on("error",function(a){t(a,void 0,i.api.__infoDataSet())}),i.on("end",function(){t(void 0,n,i.api.__infoDataSet())})}if(r!==void 0){const n=function(){i.write(r),i.end()};typeof setImmediate=="function"?setImmediate(n):setTimeout(n,0)}return i};var xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cd(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var nn=cd,dd=typeof xr=="object"&&xr&&xr.Object===Object&&xr,vd=dd,gd=vd,pd=typeof self=="object"&&self&&self.Object===Object&&self,md=gd||pd||Function("return this")(),oa=md,yd=oa,wd=function(){return yd.Date.now()},Ed=wd,Td=/\s/;function bd(r){for(var e=r.length;e--&&Td.test(r.charAt(e)););return e}var xd=bd,Sd=xd,Cd=/^\s+/;function Dd(r){return r&&r.slice(0,Sd(r)+1).replace(Cd,"")}var Rd=Dd,Pd=oa,Ld=Pd.Symbol,wo=Ld,as=wo,ou=Object.prototype,Od=ou.hasOwnProperty,Md=ou.toString,Mi=as?as.toStringTag:void 0;function Nd(r){var e=Od.call(r,Mi),t=r[Mi];try{r[Mi]=void 0;var i=!0}catch{}var n=Md.call(r);return i&&(e?r[Mi]=t:delete r[Mi]),n}var Id=Nd,Ad=Object.prototype,_d=Ad.toString;function Fd(r){return _d.call(r)}var Bd=Fd,os=wo,kd=Id,zd=Bd,Hd="[object Null]",Ud="[object Undefined]",ss=os?os.toStringTag:void 0;function Gd(r){return r==null?r===void 0?Ud:Hd:ss&&ss in Object(r)?kd(r):zd(r)}var su=Gd;function Vd(r){return r!=null&&typeof r=="object"}var Wd=Vd,qd=su,Yd=Wd,Xd="[object Symbol]";function Zd(r){return typeof r=="symbol"||Yd(r)&&qd(r)==Xd}var an=Zd,Kd=Rd,ls=nn,Qd=an,us=0/0,jd=/^[-+]0x[0-9a-f]+$/i,Jd=/^0b[01]+$/i,$d=/^0o[0-7]+$/i,ev=parseInt;function tv(r){if(typeof r=="number")return r;if(Qd(r))return us;if(ls(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=ls(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Kd(r);var t=Jd.test(r);return t||$d.test(r)?ev(r.slice(2),t?2:8):jd.test(r)?us:+r}var rv=tv,iv=nn,Ia=Ed,hs=rv,nv="Expected a function",av=Math.max,ov=Math.min;function sv(r,e,t){var i,n,a,o,s,l,u=0,h=!1,f=!1,d=!0;if(typeof r!="function")throw new TypeError(nv);e=hs(e)||0,iv(t)&&(h=!!t.leading,f="maxWait"in t,a=f?av(hs(t.maxWait)||0,e):a,d="trailing"in t?!!t.trailing:d);function c(I){var R=i,L=n;return i=n=void 0,u=I,o=r.apply(L,R),o}function v(I){return u=I,s=setTimeout(p,e),h?c(I):o}function g(I){var R=I-l,L=I-u,N=e-R;return f?ov(N,a-L):N}function m(I){var R=I-l,L=I-u;return l===void 0||R>=e||R<0||f&&L>=a}function p(){var I=Ia();if(m(I))return y(I);s=setTimeout(p,g(I))}function y(I){return s=void 0,d&&i?c(I):(i=n=void 0,o)}function w(){s!==void 0&&clearTimeout(s),u=0,i=l=n=s=void 0}function T(){return s===void 0?o:y(Ia())}function O(){var I=Ia(),R=m(I);if(i=arguments,n=this,l=I,R){if(s===void 0)return v(l);if(f)return clearTimeout(s),s=setTimeout(p,e),c(l)}return s===void 0&&(s=setTimeout(p,e)),o}return O.cancel=w,O.flush=T,O}var lv=sv,lu={exports:{}},uu={exports:{}};(function(r,e){(function(){var t,i,n,a,o,s,l,u,h,f,d,c,v,g,m;n=Math.floor,f=Math.min,i=function(p,y){return p<y?-1:p>y?1:0},h=function(p,y,w,T,O){var I;if(w==null&&(w=0),O==null&&(O=i),w<0)throw new Error("lo must be non-negative");for(T==null&&(T=p.length);w<T;)I=n((w+T)/2),O(y,p[I])<0?T=I:w=I+1;return[].splice.apply(p,[w,w-w].concat(y)),y},s=function(p,y,w){return w==null&&(w=i),p.push(y),g(p,0,p.length-1,w)},o=function(p,y){var w,T;return y==null&&(y=i),w=p.pop(),p.length?(T=p[0],p[0]=w,m(p,0,y)):T=w,T},u=function(p,y,w){var T;return w==null&&(w=i),T=p[0],p[0]=y,m(p,0,w),T},l=function(p,y,w){var T;return w==null&&(w=i),p.length&&w(p[0],y)<0&&(T=[p[0],y],y=T[0],p[0]=T[1],m(p,0,w)),y},a=function(p,y){var w,T,O,I,R,L;for(y==null&&(y=i),I=function(){L=[];for(var N=0,E=n(p.length/2);0<=E?N<E:N>E;0<=E?N++:N--)L.push(N);return L}.apply(this).reverse(),R=[],T=0,O=I.length;T<O;T++)w=I[T],R.push(m(p,w,y));return R},v=function(p,y,w){var T;if(w==null&&(w=i),T=p.indexOf(y),T!==-1)return g(p,0,T,w),m(p,T,w)},d=function(p,y,w){var T,O,I,R,L;if(w==null&&(w=i),O=p.slice(0,y),!O.length)return O;for(a(O,w),L=p.slice(y),I=0,R=L.length;I<R;I++)T=L[I],l(O,T,w);return O.sort(w).reverse()},c=function(p,y,w){var T,O,I,R,L,N,E,C,b;if(w==null&&(w=i),y*10<=p.length){if(I=p.slice(0,y).sort(w),!I.length)return I;for(O=I[I.length-1],E=p.slice(y),R=0,N=E.length;R<N;R++)T=E[R],w(T,O)<0&&(h(I,T,0,null,w),I.pop(),O=I[I.length-1]);return I}for(a(p,w),b=[],L=0,C=f(y,p.length);0<=C?L<C:L>C;0<=C?++L:--L)b.push(o(p,w));return b},g=function(p,y,w,T){var O,I,R;for(T==null&&(T=i),O=p[w];w>y;){if(R=w-1>>1,I=p[R],T(O,I)<0){p[w]=I,w=R;continue}break}return p[w]=O},m=function(p,y,w){var T,O,I,R,L;for(w==null&&(w=i),O=p.length,L=y,I=p[y],T=2*y+1;T<O;)R=T+1,R<O&&!(w(p[T],p[R])<0)&&(T=R),p[y]=p[T],y=T,T=2*y+1;return p[y]=I,g(p,L,y,w)},t=function(){p.push=s,p.pop=o,p.replace=u,p.pushpop=l,p.heapify=a,p.updateItem=v,p.nlargest=d,p.nsmallest=c;function p(y){this.cmp=y!=null?y:i,this.nodes=[]}return p.prototype.push=function(y){return s(this.nodes,y,this.cmp)},p.prototype.pop=function(){return o(this.nodes,this.cmp)},p.prototype.peek=function(){return this.nodes[0]},p.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},p.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},p.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},p.prototype.heapify=function(){return a(this.nodes,this.cmp)},p.prototype.updateItem=function(y){return v(this.nodes,y,this.cmp)},p.prototype.clear=function(){return this.nodes=[]},p.prototype.empty=function(){return this.nodes.length===0},p.prototype.size=function(){return this.nodes.length},p.prototype.clone=function(){var y;return y=new p,y.nodes=this.nodes.slice(0),y},p.prototype.toArray=function(){return this.nodes.slice(0)},p.prototype.insert=p.prototype.push,p.prototype.top=p.prototype.peek,p.prototype.front=p.prototype.peek,p.prototype.has=p.prototype.contains,p.prototype.copy=p.prototype.clone,p}(),function(p,y){return r.exports=y()}(this,function(){return t})}).call(xr)})(uu);(function(r){r.exports=uu.exports})(lu);var uv=Array.isArray,sa=uv,hv=sa,fv=an,cv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dv=/^\w*$/;function vv(r,e){if(hv(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||fv(r)?!0:dv.test(r)||!cv.test(r)||e!=null&&r in Object(e)}var gv=vv,pv=su,mv=nn,yv="[object AsyncFunction]",wv="[object Function]",Ev="[object GeneratorFunction]",Tv="[object Proxy]";function bv(r){if(!mv(r))return!1;var e=pv(r);return e==wv||e==Ev||e==yv||e==Tv}var xv=bv,Sv=oa,Cv=Sv["__core-js_shared__"],Dv=Cv,Aa=Dv,fs=function(){var r=/[^.]+$/.exec(Aa&&Aa.keys&&Aa.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Rv(r){return!!fs&&fs in r}var Pv=Rv,Lv=Function.prototype,Ov=Lv.toString;function Mv(r){if(r!=null){try{return Ov.call(r)}catch{}try{return r+""}catch{}}return""}var Nv=Mv,Iv=xv,Av=Pv,_v=nn,Fv=Nv,Bv=/[\\^$.*+?()[\]{}|]/g,kv=/^\[object .+?Constructor\]$/,zv=Function.prototype,Hv=Object.prototype,Uv=zv.toString,Gv=Hv.hasOwnProperty,Vv=RegExp("^"+Uv.call(Gv).replace(Bv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wv(r){if(!_v(r)||Av(r))return!1;var e=Iv(r)?Vv:kv;return e.test(Fv(r))}var qv=Wv;function Yv(r,e){return r==null?void 0:r[e]}var Xv=Yv,Zv=qv,Kv=Xv;function Qv(r,e){var t=Kv(r,e);return Zv(t)?t:void 0}var Eo=Qv,jv=Eo,Jv=jv(Object,"create"),la=Jv,cs=la;function $v(){this.__data__=cs?cs(null):{},this.size=0}var eg=$v;function tg(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var rg=tg,ig=la,ng="__lodash_hash_undefined__",ag=Object.prototype,og=ag.hasOwnProperty;function sg(r){var e=this.__data__;if(ig){var t=e[r];return t===ng?void 0:t}return og.call(e,r)?e[r]:void 0}var lg=sg,ug=la,hg=Object.prototype,fg=hg.hasOwnProperty;function cg(r){var e=this.__data__;return ug?e[r]!==void 0:fg.call(e,r)}var dg=cg,vg=la,gg="__lodash_hash_undefined__";function pg(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=vg&&e===void 0?gg:e,this}var mg=pg,yg=eg,wg=rg,Eg=lg,Tg=dg,bg=mg;function Ei(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}Ei.prototype.clear=yg;Ei.prototype.delete=wg;Ei.prototype.get=Eg;Ei.prototype.has=Tg;Ei.prototype.set=bg;var xg=Ei;function Sg(){this.__data__=[],this.size=0}var Cg=Sg;function Dg(r,e){return r===e||r!==r&&e!==e}var hu=Dg,Rg=hu;function Pg(r,e){for(var t=r.length;t--;)if(Rg(r[t][0],e))return t;return-1}var ua=Pg,Lg=ua,Og=Array.prototype,Mg=Og.splice;function Ng(r){var e=this.__data__,t=Lg(e,r);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():Mg.call(e,t,1),--this.size,!0}var Ig=Ng,Ag=ua;function _g(r){var e=this.__data__,t=Ag(e,r);return t<0?void 0:e[t][1]}var Fg=_g,Bg=ua;function kg(r){return Bg(this.__data__,r)>-1}var zg=kg,Hg=ua;function Ug(r,e){var t=this.__data__,i=Hg(t,r);return i<0?(++this.size,t.push([r,e])):t[i][1]=e,this}var Gg=Ug,Vg=Cg,Wg=Ig,qg=Fg,Yg=zg,Xg=Gg;function Ti(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}Ti.prototype.clear=Vg;Ti.prototype.delete=Wg;Ti.prototype.get=qg;Ti.prototype.has=Yg;Ti.prototype.set=Xg;var Zg=Ti,Kg=Eo,Qg=oa,jg=Kg(Qg,"Map"),Jg=jg,ds=xg,$g=Zg,ep=Jg;function tp(){this.size=0,this.__data__={hash:new ds,map:new(ep||$g),string:new ds}}var rp=tp;function ip(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var np=ip,ap=np;function op(r,e){var t=r.__data__;return ap(e)?t[typeof e=="string"?"string":"hash"]:t.map}var ha=op,sp=ha;function lp(r){var e=sp(this,r).delete(r);return this.size-=e?1:0,e}var up=lp,hp=ha;function fp(r){return hp(this,r).get(r)}var cp=fp,dp=ha;function vp(r){return dp(this,r).has(r)}var gp=vp,pp=ha;function mp(r,e){var t=pp(this,r),i=t.size;return t.set(r,e),this.size+=t.size==i?0:1,this}var yp=mp,wp=rp,Ep=up,Tp=cp,bp=gp,xp=yp;function bi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}bi.prototype.clear=wp;bi.prototype.delete=Ep;bi.prototype.get=Tp;bi.prototype.has=bp;bi.prototype.set=xp;var Sp=bi,fu=Sp,Cp="Expected a function";function To(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(Cp);var t=function(){var i=arguments,n=e?e.apply(this,i):i[0],a=t.cache;if(a.has(n))return a.get(n);var o=r.apply(this,i);return t.cache=a.set(n,o)||a,o};return t.cache=new(To.Cache||fu),t}To.Cache=fu;var Dp=To,Rp=Dp,Pp=500;function Lp(r){var e=Rp(r,function(i){return t.size===Pp&&t.clear(),i}),t=e.cache;return e}var Op=Lp,Mp=Op,Np=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ip=/\\(\\)?/g,Ap=Mp(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(Np,function(t,i,n,a){e.push(n?a.replace(Ip,"$1"):i||t)}),e}),cu=Ap;function _p(r,e){for(var t=-1,i=r==null?0:r.length,n=Array(i);++t<i;)n[t]=e(r[t],t,r);return n}var du=_p,vs=wo,Fp=du,Bp=sa,kp=an,zp=1/0,gs=vs?vs.prototype:void 0,ps=gs?gs.toString:void 0;function vu(r){if(typeof r=="string")return r;if(Bp(r))return Fp(r,vu)+"";if(kp(r))return ps?ps.call(r):"";var e=r+"";return e=="0"&&1/r==-zp?"-0":e}var Hp=vu,Up=Hp;function Gp(r){return r==null?"":Up(r)}var gu=Gp,Vp=sa,Wp=gv,qp=cu,Yp=gu;function Xp(r,e){return Vp(r)?r:Wp(r,e)?[r]:qp(Yp(r))}var pu=Xp,Zp=an,Kp=1/0;function Qp(r){if(typeof r=="string"||Zp(r))return r;var e=r+"";return e=="0"&&1/r==-Kp?"-0":e}var bo=Qp,jp=pu,Jp=bo;function $p(r,e){e=jp(e,r);for(var t=0,i=e.length;r!=null&&t<i;)r=r[Jp(e[t++])];return t&&t==i?r:void 0}var em=$p,tm=em;function rm(r,e,t){var i=r==null?void 0:tm(r,e);return i===void 0?t:i}var im=rm,nm=Eo,am=function(){try{var r=nm(Object,"defineProperty");return r({},"",{}),r}catch{}}(),om=am,ms=om;function sm(r,e,t){e=="__proto__"&&ms?ms(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var lm=sm,um=lm,hm=hu,fm=Object.prototype,cm=fm.hasOwnProperty;function dm(r,e,t){var i=r[e];(!(cm.call(r,e)&&hm(i,t))||t===void 0&&!(e in r))&&um(r,e,t)}var vm=dm,gm=9007199254740991,pm=/^(?:0|[1-9]\d*)$/;function mm(r,e){var t=typeof r;return e=e==null?gm:e,!!e&&(t=="number"||t!="symbol"&&pm.test(r))&&r>-1&&r%1==0&&r<e}var ym=mm,wm=vm,Em=pu,Tm=ym,ys=nn,bm=bo;function xm(r,e,t,i){if(!ys(r))return r;e=Em(e,r);for(var n=-1,a=e.length,o=a-1,s=r;s!=null&&++n<a;){var l=bm(e[n]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return r;if(n!=o){var h=s[l];u=i?i(h,l,s):void 0,u===void 0&&(u=ys(h)?h:Tm(e[n+1])?[]:{})}wm(s,l,u),s=s[l]}return r}var Sm=xm,Cm=Sm;function Dm(r,e,t){return r==null?r:Cm(r,e,t)}var Rm=Dm;function Pm(r,e){var t=-1,i=r.length;for(e||(e=Array(i));++t<i;)e[t]=r[t];return e}var Lm=Pm,Om=du,Mm=Lm,Nm=sa,Im=an,Am=cu,_m=bo,Fm=gu;function Bm(r){return Nm(r)?Om(r,_m):Im(r)?[r]:Mm(Am(Fm(r)))}var km=Bm,zm=lv,Hm=lu.exports,Um=im,Gm=Rm,Vm=km;function on(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var fa=on(zm),sn=on(Hm),Wm=on(Um),qm=on(Gm),Ym=on(Vm);function dt(r){return dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dt(r)}function xo(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ws(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function So(r,e,t){return e&&ws(r.prototype,e),t&&ws(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function mu(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function rr(r,e){return Xm(r)||Zm(r,e)||Km(r,e)||Qm()}function Xm(r){if(Array.isArray(r))return r}function Zm(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i=[],n=!0,a=!1,o,s;try{for(t=t.call(r);!(n=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));n=!0);}catch(l){a=!0,s=l}finally{try{!n&&t.return!=null&&t.return()}finally{if(a)throw s}}return i}}function Km(r,e){if(!!r){if(typeof r=="string")return Es(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Es(r,e)}}function Es(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function Qm(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rt=typeof window>"u"?null:window,Ts=rt?rt.navigator:null;rt&&rt.document;var jm=dt(""),yu=dt({}),Jm=dt(function(){}),$m=typeof HTMLElement>"u"?"undefined":dt(HTMLElement),ln=function(e){return e&&e.instanceString&&nt(e.instanceString)?e.instanceString():null},Ne=function(e){return e!=null&&dt(e)==jm},nt=function(e){return e!=null&&dt(e)===Jm},je=function(e){return!_t(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Ue=function(e){return e!=null&&dt(e)===yu&&!je(e)&&e.constructor===Object},ey=function(e){return e!=null&&dt(e)===yu},Se=function(e){return e!=null&&dt(e)===dt(1)&&!isNaN(e)},ty=function(e){return Se(e)&&Math.floor(e)===e},Wn=function(e){if($m!=="undefined")return e!=null&&e instanceof HTMLElement},_t=function(e){return un(e)||wu(e)},un=function(e){return ln(e)==="collection"&&e._private.single},wu=function(e){return ln(e)==="collection"&&!e._private.single},Co=function(e){return ln(e)==="core"},Eu=function(e){return ln(e)==="stylesheet"},ry=function(e){return ln(e)==="event"},Lr=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},iy=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},ny=function(e){return Ue(e)&&Se(e.x1)&&Se(e.x2)&&Se(e.y1)&&Se(e.y2)},ay=function(e){return ey(e)&&nt(e.then)},oy=function(){return Ts&&Ts.userAgent.match(/msie|trident|edge/i)},Wi=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);return a.join("$")});var i=function n(){var a=this,o=arguments,s,l=t.apply(a,o),u=n.cache;return(s=u[l])||(s=u[l]=e.apply(a,o)),s};return i.cache={},i},Do=Wi(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),ca=Wi(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),Tu=Wi(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),bs=function(e){return Lr(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},ct="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",sy="rgb[a]?\\(("+ct+"[%]?)\\s*,\\s*("+ct+"[%]?)\\s*,\\s*("+ct+"[%]?)(?:\\s*,\\s*("+ct+"))?\\)",ly="rgb[a]?\\((?:"+ct+"[%]?)\\s*,\\s*(?:"+ct+"[%]?)\\s*,\\s*(?:"+ct+"[%]?)(?:\\s*,\\s*(?:"+ct+"))?\\)",uy="hsl[a]?\\(("+ct+")\\s*,\\s*("+ct+"[%])\\s*,\\s*("+ct+"[%])(?:\\s*,\\s*("+ct+"))?\\)",hy="hsl[a]?\\((?:"+ct+")\\s*,\\s*(?:"+ct+"[%])\\s*,\\s*(?:"+ct+"[%])(?:\\s*,\\s*(?:"+ct+"))?\\)",fy="\\#[0-9a-fA-F]{3}",cy="\\#[0-9a-fA-F]{6}",bu=function(e,t){return e<t?-1:e>t?1:0},dy=function(e,t){return-1*bu(e,t)},_e=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var i=e[t];if(i!=null)for(var n=Object.keys(i),a=0;a<n.length;a++){var o=n[a];r[o]=i[o]}}return r},vy=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,i,n,a,o=16;return t?(i=parseInt(e[1]+e[1],o),n=parseInt(e[2]+e[2],o),a=parseInt(e[3]+e[3],o)):(i=parseInt(e[1]+e[2],o),n=parseInt(e[3]+e[4],o),a=parseInt(e[5]+e[6],o)),[i,n,a]}},gy=function(e){var t,i,n,a,o,s,l,u;function h(v,g,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?v+(g-v)*6*m:m<1/2?g:m<2/3?v+(g-v)*(2/3-m)*6:v}var f=new RegExp("^"+uy+"$").exec(e);if(f){if(i=parseInt(f[1]),i<0?i=(360- -1*i%360)%360:i>360&&(i=i%360),i/=360,n=parseFloat(f[2]),n<0||n>100||(n=n/100,a=parseFloat(f[3]),a<0||a>100)||(a=a/100,o=f[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(n===0)s=l=u=Math.round(a*255);else{var d=a<.5?a*(1+n):a+n-a*n,c=2*a-d;s=Math.round(255*h(c,d,i+1/3)),l=Math.round(255*h(c,d,i)),u=Math.round(255*h(c,d,i-1/3))}t=[s,l,u,o]}return t},py=function(e){var t,i=new RegExp("^"+sy+"$").exec(e);if(i){t=[];for(var n=[],a=1;a<=3;a++){var o=i[a];if(o[o.length-1]==="%"&&(n[a]=!0),o=parseFloat(o),n[a]&&(o=o/100*255),o<0||o>255)return;t.push(Math.floor(o))}var s=n[1]||n[2]||n[3],l=n[1]&&n[2]&&n[3];if(s&&!l)return;var u=i[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;t.push(u)}}return t},my=function(e){return wy[e.toLowerCase()]},yy=function(e){return(je(e)?e:null)||my(e)||vy(e)||py(e)||gy(e)},wy={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},xu=function(e){for(var t=e.map,i=e.keys,n=i.length,a=0;a<n;a++){var o=i[a];if(Ue(o))throw Error("Tried to set map with object key");a<i.length-1?(t[o]==null&&(t[o]={}),t=t[o]):t[o]=e.value}},Su=function(e){for(var t=e.map,i=e.keys,n=i.length,a=0;a<n;a++){var o=i[a];if(Ue(o))throw Error("Tried to get map with object key");if(t=t[o],t==null)return t}return t},_a=rt?rt.performance:null,Cu=_a&&_a.now?function(){return _a.now()}:function(){return Date.now()},Ey=function(){if(rt){if(rt.requestAnimationFrame)return function(r){rt.requestAnimationFrame(r)};if(rt.mozRequestAnimationFrame)return function(r){rt.mozRequestAnimationFrame(r)};if(rt.webkitRequestAnimationFrame)return function(r){rt.webkitRequestAnimationFrame(r)};if(rt.msRequestAnimationFrame)return function(r){rt.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(Cu())},1e3/60)}}(),qn=function(e){return Ey(e)},or=Cu,si=9261,Du=65599,Fi=5381,Ru=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:si,i=t,n;n=e.next(),!n.done;)i=i*Du+n.value|0;return i},qi=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:si;return t*Du+e|0},Yi=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fi;return(t<<5)+t+e|0},Ty=function(e,t){return e*2097152+t},mr=function(e){return e[0]*2097152+e[1]},Tn=function(e,t){return[qi(e[0],t[0]),Yi(e[1],t[1])]},by=function(e,t){var i={value:0,done:!1},n=0,a=e.length,o={next:function(){return n<a?i.value=e[n++]:i.done=!0,i}};return Ru(o,t)},Gr=function(e,t){var i={value:0,done:!1},n=0,a=e.length,o={next:function(){return n<a?i.value=e.charCodeAt(n++):i.done=!0,i}};return Ru(o,t)},Pu=function(){return xy(arguments)},xy=function(e){for(var t,i=0;i<e.length;i++){var n=e[i];i===0?t=Gr(n):t=Gr(n,t)}return t},xs=!0,Sy=console.warn!=null,Cy=console.trace!=null,Ro=Number.MAX_SAFE_INTEGER||9007199254740991,Lu=function(){return!0},Yn=function(){return!1},Ss=function(){return 0},Po=function(){},at=function(e){throw new Error(e)},Ou=function(e){if(e!==void 0)xs=!!e;else return xs},Xe=function(e){!Ou()||(Sy?console.warn(e):(console.log(e),Cy&&console.trace()))},Dy=function(e){return _e({},e)},Zt=function(e){return e==null?e:je(e)?e.slice():Ue(e)?Dy(e):e},Ry=function(e){return e.slice()},Mu=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},Py={},Nu=function(){return Py},Et=function(e){var t=Object.keys(e);return function(i){for(var n={},a=0;a<t.length;a++){var o=t[a],s=i==null?void 0:i[o];n[o]=s===void 0?e[o]:s}return n}},Or=function(e,t,i){for(var n=e.length-1;n>=0&&!(e[n]===t&&(e.splice(n,1),i));n--);},Lo=function(e){e.splice(0,e.length)},Ly=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.push(n)}},Wt=function(e,t,i){return i&&(t=Tu(i,t)),e[t]},Tr=function(e,t,i,n){i&&(t=Tu(i,t)),e[t]=n},Oy=function(){function r(){xo(this,r),this._obj={}}return So(r,[{key:"set",value:function(t,i){return this._obj[t]=i,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}]),r}(),Kt=typeof Map<"u"?Map:Oy,My="undefined",Ny=function(){function r(e){if(xo(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var i=0;i<t.length;i++)this.add(t[i])}}return So(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var i=this._obj;i[t]!==1&&(i[t]=1,this.size++)}},{key:"delete",value:function(t){var i=this._obj;i[t]===1&&(i[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(i){return t.has(i)})}},{key:"forEach",value:function(t,i){return this.toArray().forEach(t,i)}}]),r}(),xi=(typeof Set>"u"?"undefined":dt(Set))!==My?Set:Ny,da=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!Co(e)){at("An element must have a core reference and parameters set");return}var n=t.group;if(n==null&&(t.data&&t.data.source!=null&&t.data.target!=null?n="edges":n="nodes"),n!=="nodes"&&n!=="edges"){at("An element must be of type `nodes` or `edges`; you specified `"+n+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:n,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?n==="edges":!!t.pannable,active:!1,classes:new xi,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var o=t.renderedPosition,s=e.pan(),l=e.zoom();a.position={x:(o.x-s.x)/l,y:(o.y-s.y)/l}}var u=[];je(t.classes)?u=t.classes:Ne(t.classes)&&(u=t.classes.split(/\s+/));for(var h=0,f=u.length;h<f;h++){var d=u[h];!d||d===""||a.classes.add(d)}this.createEmitter();var c=t.style||t.css;c&&(Xe("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(c)),(i===void 0||i)&&this.restore()},Cs=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(i,n,a){var o;Ue(i)&&!_t(i)&&(o=i,i=o.roots||o.root,n=o.visit,a=o.directed),a=arguments.length===2&&!nt(n)?n:a,n=nt(n)?n:function(){};for(var s=this._private.cy,l=i=Ne(i)?this.filter(i):i,u=[],h=[],f={},d={},c={},v=0,g,m=this.byGroup(),p=m.nodes,y=m.edges,w=0;w<l.length;w++){var T=l[w],O=T.id();T.isNode()&&(u.unshift(T),e.bfs&&(c[O]=!0,h.push(T)),d[O]=0)}for(var I=function(){var M=e.bfs?u.shift():u.pop(),D=M.id();if(e.dfs){if(c[D])return"continue";c[D]=!0,h.push(M)}var H=d[D],k=f[D],B=k!=null?k.source():null,U=k!=null?k.target():null,W=k==null?void 0:M.same(B)?U[0]:B[0],J=void 0;if(J=n(M,k,W,v++,H),J===!0)return g=M,"break";if(J===!1)return"break";for(var G=M.connectedEdges().filter(function($){return(!a||$.source().same(M))&&y.has($)}),X=0;X<G.length;X++){var ie=G[X],ee=ie.connectedNodes().filter(function($){return!$.same(M)&&p.has($)}),q=ee.id();ee.length!==0&&!c[q]&&(ee=ee[0],u.push(ee),e.bfs&&(c[q]=!0,h.push(ee)),f[q]=ie,d[q]=d[D]+1)}};u.length!==0;){var R=I();if(R!=="continue"&&R==="break")break}for(var L=s.collection(),N=0;N<h.length;N++){var E=h[N],C=f[E.id()];C!=null&&L.push(C),L.push(E)}return{path:s.collection(L),found:s.collection(g)}}},Xi={breadthFirstSearch:Cs({bfs:!0}),depthFirstSearch:Cs({dfs:!0})};Xi.bfs=Xi.breadthFirstSearch;Xi.dfs=Xi.depthFirstSearch;var Iy=Et({root:null,weight:function(e){return 1},directed:!1}),Ay={dijkstra:function(e){if(!Ue(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var i=Iy(e),n=i.root,a=i.weight,o=i.directed,s=this,l=a,u=Ne(n)?this.filter(n)[0]:n[0],h={},f={},d={},c=this.byGroup(),v=c.nodes,g=c.edges;g.unmergeBy(function(H){return H.isLoop()});for(var m=function(k){return h[k.id()]},p=function(k,B){h[k.id()]=B,y.updateItem(k)},y=new sn.default(function(H,k){return m(H)-m(k)}),w=0;w<v.length;w++){var T=v[w];h[T.id()]=T.same(u)?0:1/0,y.push(T)}for(var O=function(k,B){for(var U=(o?k.edgesTo(B):k.edgesWith(B)).intersect(g),W=1/0,J,G=0;G<U.length;G++){var X=U[G],ie=l(X);(ie<W||!J)&&(W=ie,J=X)}return{edge:J,dist:W}};y.size()>0;){var I=y.pop(),R=m(I),L=I.id();if(d[L]=R,R!==1/0)for(var N=I.neighborhood().intersect(v),E=0;E<N.length;E++){var C=N[E],b=C.id(),M=O(I,C),D=R+M.dist;D<m(C)&&(p(C,D),f[b]={node:I,edge:M.edge})}}return{distanceTo:function(k){var B=Ne(k)?v.filter(k)[0]:k[0];return d[B.id()]},pathTo:function(k){var B=Ne(k)?v.filter(k)[0]:k[0],U=[],W=B,J=W.id();if(B.length>0)for(U.unshift(B);f[J];){var G=f[J];U.unshift(G.edge),U.unshift(G.node),W=G.node,J=W.id()}return s.spawn(U)}}}},_y={kruskal:function(e){e=e||function(w){return 1};for(var t=this.byGroup(),i=t.nodes,n=t.edges,a=i.length,o=new Array(a),s=i,l=function(T){for(var O=0;O<o.length;O++){var I=o[O];if(I.has(T))return O}},u=0;u<a;u++)o[u]=this.spawn(i[u]);for(var h=n.sort(function(w,T){return e(w)-e(T)}),f=0;f<h.length;f++){var d=h[f],c=d.source()[0],v=d.target()[0],g=l(c),m=l(v),p=o[g],y=o[m];g!==m&&(s.merge(d),p.merge(y),o.splice(m,1))}return s}},Fy=Et({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),By={aStar:function(e){var t=this.cy(),i=Fy(e),n=i.root,a=i.goal,o=i.heuristic,s=i.directed,l=i.weight;n=t.collection(n)[0],a=t.collection(a)[0];var u=n.id(),h=a.id(),f={},d={},c={},v=new sn.default(function(J,G){return d[J.id()]-d[G.id()]}),g=new xi,m={},p={},y=function(G,X){v.push(G),g.add(X)},w,T,O=function(){w=v.pop(),T=w.id(),g.delete(T)},I=function(G){return g.has(G)};y(n,u),f[u]=0,d[u]=o(n);for(var R=0;v.size()>0;){if(O(),R++,T===h){for(var L=[],N=a,E=h,C=p[E];L.unshift(N),C!=null&&L.unshift(C),N=m[E],N!=null;)E=N.id(),C=p[E];return{found:!0,distance:f[T],path:this.spawn(L),steps:R}}c[T]=!0;for(var b=w._private.edges,M=0;M<b.length;M++){var D=b[M];if(!!this.hasElementWithId(D.id())&&!(s&&D.data("source")!==T)){var H=D.source(),k=D.target(),B=H.id()!==T?H:k,U=B.id();if(!!this.hasElementWithId(U)&&!c[U]){var W=f[T]+l(D);if(!I(U)){f[U]=W,d[U]=W+o(B),y(B,U),m[U]=w,p[U]=D;continue}W<f[U]&&(f[U]=W,d[U]=W+o(B),m[U]=w,p[U]=D)}}}}return{found:!1,distance:void 0,path:void 0,steps:R}}},ky=Et({weight:function(e){return 1},directed:!1}),zy={floydWarshall:function(e){for(var t=this.cy(),i=ky(e),n=i.weight,a=i.directed,o=n,s=this.byGroup(),l=s.nodes,u=s.edges,h=l.length,f=h*h,d=function(ie){return l.indexOf(ie)},c=function(ie){return l[ie]},v=new Array(f),g=0;g<f;g++){var m=g%h,p=(g-m)/h;p===m?v[g]=0:v[g]=1/0}for(var y=new Array(f),w=new Array(f),T=0;T<u.length;T++){var O=u[T],I=O.source()[0],R=O.target()[0];if(I!==R){var L=d(I),N=d(R),E=L*h+N,C=o(O);if(v[E]>C&&(v[E]=C,y[E]=N,w[E]=O),!a){var b=N*h+L;!a&&v[b]>C&&(v[b]=C,y[b]=L,w[b]=O)}}}for(var M=0;M<h;M++)for(var D=0;D<h;D++)for(var H=D*h+M,k=0;k<h;k++){var B=D*h+k,U=M*h+k;v[H]+v[U]<v[B]&&(v[B]=v[H]+v[U],y[B]=y[H])}var W=function(ie){return(Ne(ie)?t.filter(ie):ie)[0]},J=function(ie){return d(W(ie))},G={distance:function(ie,ee){var q=J(ie),$=J(ee);return v[q*h+$]},path:function(ie,ee){var q=J(ie),$=J(ee),V=c(q);if(q===$)return V.collection();if(y[q*h+$]==null)return t.collection();var re=t.collection(),ae=q,de;for(re.merge(V);q!==$;)ae=q,q=y[q*h+$],de=w[ae*h+q],re.merge(de),re.merge(c(q));return re}};return G}},Hy=Et({weight:function(e){return 1},directed:!1,root:null}),Uy={bellmanFord:function(e){var t=this,i=Hy(e),n=i.weight,a=i.directed,o=i.root,s=n,l=this,u=this.cy(),h=this.byGroup(),f=h.edges,d=h.nodes,c=d.length,v=new Kt,g=!1,m=[];o=u.collection(o)[0],f.unmergeBy(function(j){return j.isLoop()});for(var p=f.length,y=function(te){var K=v.get(te.id());return K||(K={},v.set(te.id(),K)),K},w=function(te){return(Ne(te)?u.$(te):te)[0]},T=function(te){return y(w(te)).dist},O=function(te){for(var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,le=w(te),fe=[],me=le;;){if(me==null)return t.spawn();var se=y(me),F=se.edge,Q=se.pred;if(fe.unshift(me[0]),me.same(K)&&fe.length>0)break;F!=null&&fe.unshift(F),me=Q}return l.spawn(fe)},I=0;I<c;I++){var R=d[I],L=y(R);R.same(o)?L.dist=0:L.dist=1/0,L.pred=null,L.edge=null}for(var N=!1,E=function(te,K,le,fe,me,se){var F=fe.dist+se;F<me.dist&&!le.same(fe.edge)&&(me.dist=F,me.pred=te,me.edge=le,N=!0)},C=1;C<c;C++){N=!1;for(var b=0;b<p;b++){var M=f[b],D=M.source(),H=M.target(),k=s(M),B=y(D),U=y(H);E(D,H,M,B,U,k),a||E(H,D,M,U,B,k)}if(!N)break}if(N)for(var W=[],J=0;J<p;J++){var G=f[J],X=G.source(),ie=G.target(),ee=s(G),q=y(X).dist,$=y(ie).dist;if(q+ee<$||!a&&$+ee<q)if(g||(Xe("Graph contains a negative weight cycle for Bellman-Ford"),g=!0),e.findNegativeWeightCycles!==!1){var V=[];q+ee<$&&V.push(X),!a&&$+ee<q&&V.push(ie);for(var re=V.length,ae=0;ae<re;ae++){var de=V[ae],ye=[de];ye.push(y(de).edge);for(var Te=y(de).pred;ye.indexOf(Te)===-1;)ye.push(Te),ye.push(y(Te).edge),Te=y(Te).pred;ye=ye.slice(ye.indexOf(Te));for(var Oe=ye[0].id(),ce=0,x=2;x<ye.length;x+=2)ye[x].id()<Oe&&(Oe=ye[x].id(),ce=x);ye=ye.slice(ce).concat(ye.slice(0,ce)),ye.push(ye[0]);var z=ye.map(function(j){return j.id()}).join(",");W.indexOf(z)===-1&&(m.push(l.spawn(ye)),W.push(z))}}else break}return{distanceTo:T,pathTo:O,hasNegativeWeightCycle:g,negativeWeightCycles:m}}},Gy=Math.sqrt(2),Vy=function(e,t,i){i.length===0&&at("Karger-Stein must be run on a connected (sub)graph");for(var n=i[e],a=n[1],o=n[2],s=t[a],l=t[o],u=i,h=u.length-1;h>=0;h--){var f=u[h],d=f[1],c=f[2];(t[d]===s&&t[c]===l||t[d]===l&&t[c]===s)&&u.splice(h,1)}for(var v=0;v<u.length;v++){var g=u[v];g[1]===l?(u[v]=g.slice(),u[v][1]=s):g[2]===l&&(u[v]=g.slice(),u[v][2]=s)}for(var m=0;m<t.length;m++)t[m]===l&&(t[m]=s);return u},Fa=function(e,t,i,n){for(;i>n;){var a=Math.floor(Math.random()*t.length);t=Vy(a,e,t),i--}return t},Wy={kargerStein:function(){var e=this,t=this.byGroup(),i=t.nodes,n=t.edges;n.unmergeBy(function(U){return U.isLoop()});var a=i.length,o=n.length,s=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/Gy);if(a<2){at("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],h=0;h<o;h++){var f=n[h];u.push([h,i.indexOf(f.source()),i.indexOf(f.target())])}for(var d=1/0,c=[],v=new Array(a),g=new Array(a),m=new Array(a),p=function(W,J){for(var G=0;G<a;G++)J[G]=W[G]},y=0;y<=s;y++){for(var w=0;w<a;w++)g[w]=w;var T=Fa(g,u.slice(),a,l),O=T.slice();p(g,m);var I=Fa(g,T,l,2),R=Fa(m,O,l,2);I.length<=R.length&&I.length<d?(d=I.length,c=I,p(g,v)):R.length<=I.length&&R.length<d&&(d=R.length,c=R,p(m,v))}for(var L=this.spawn(c.map(function(U){return n[U[0]]})),N=this.spawn(),E=this.spawn(),C=v[0],b=0;b<v.length;b++){var M=v[b],D=i[b];M===C?N.merge(D):E.merge(D)}var H=function(W){var J=e.spawn();return W.forEach(function(G){J.merge(G),G.connectedEdges().forEach(function(X){e.contains(X)&&!L.contains(X)&&J.merge(X)})}),J},k=[H(N),H(E)],B={cut:L,components:k,partition1:N,partition2:E};return B}},qy=function(e){return{x:e.x,y:e.y}},va=function(e,t,i){return{x:e.x*t+i.x,y:e.y*t+i.y}},Iu=function(e,t,i){return{x:(e.x-i.x)/t,y:(e.y-i.y)/t}},li=function(e){return{x:e[0],y:e[1]}},Yy=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,n=1/0,a=t;a<i;a++){var o=e[a];isFinite(o)&&(n=Math.min(o,n))}return n},Xy=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,n=-1/0,a=t;a<i;a++){var o=e[a];isFinite(o)&&(n=Math.max(o,n))}return n},Zy=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,n=0,a=0,o=t;o<i;o++){var s=e[o];isFinite(s)&&(n+=s,a++)}return n/a},Ky=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;n?e=e.slice(t,i):(i<e.length&&e.splice(i,e.length-i),t>0&&e.splice(0,t));for(var s=0,l=e.length-1;l>=0;l--){var u=e[l];o?isFinite(u)||(e[l]=-1/0,s++):e.splice(l,1)}a&&e.sort(function(d,c){return d-c});var h=e.length,f=Math.floor(h/2);return h%2!==0?e[f+1+s]:(e[f-1+s]+e[f+s])/2},Qy=function(e){return Math.PI*e/180},bn=function(e,t){return Math.atan2(t,e)-Math.PI/2},Oo=Math.log2||function(r){return Math.log(r)/Math.log(2)},Au=function(e){return e>0?1:e<0?-1:0},Vr=function(e,t){return Math.sqrt(Br(e,t))},Br=function(e,t){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},jy=function(e){for(var t=e.length,i=0,n=0;n<t;n++)i+=e[n];for(var a=0;a<t;a++)e[a]=e[a]/i;return e},gt=function(e,t,i,n){return(1-n)*(1-n)*e+2*(1-n)*n*t+n*n*i},fi=function(e,t,i,n){return{x:gt(e.x,t.x,i.x,n),y:gt(e.y,t.y,i.y,n)}},Jy=function(e,t,i,n){var a={x:t.x-e.x,y:t.y-e.y},o=Vr(e,t),s={x:a.x/o,y:a.y/o};return i=i==null?0:i,n=n!=null?n:i*o,{x:e.x+s.x*n,y:e.y+s.y*n}},Zi=function(e,t,i){return Math.max(e,Math.min(i,t))},It=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},$y=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},e0=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},t0=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},r0=function(e,t,i){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,i),e.y2=Math.max(e.y2,i),e.h=e.y2-e.y1},An=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Ba=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],i,n,a,o;if(t.length===1)i=n=a=o=t[0];else if(t.length===2)i=a=t[0],o=n=t[1];else if(t.length===4){var s=rr(t,4);i=s[0],n=s[1],a=s[2],o=s[3]}return e.x1-=o,e.x2+=n,e.y1-=i,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Ds=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},Mo=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},pi=function(e,t,i){return e.x1<=t&&t<=e.x2&&e.y1<=i&&i<=e.y2},i0=function(e,t){return pi(e,t.x,t.y)},_u=function(e,t){return pi(e,t.x1,t.y1)&&pi(e,t.x2,t.y2)},Fu=function(e,t,i,n,a,o,s){var l=hn(a,o),u=a/2,h=o/2,f;{var d=i-u+l-s,c=n-h-s,v=i+u-l+s,g=c;if(f=Sr(e,t,i,n,d,c,v,g,!1),f.length>0)return f}{var m=i+u+s,p=n-h+l-s,y=m,w=n+h-l+s;if(f=Sr(e,t,i,n,m,p,y,w,!1),f.length>0)return f}{var T=i-u+l-s,O=n+h+s,I=i+u-l+s,R=O;if(f=Sr(e,t,i,n,T,O,I,R,!1),f.length>0)return f}{var L=i-u-s,N=n-h+l-s,E=L,C=n+h-l+s;if(f=Sr(e,t,i,n,L,N,E,C,!1),f.length>0)return f}var b;{var M=i-u+l,D=n-h+l;if(b=Bi(e,t,i,n,M,D,l+s),b.length>0&&b[0]<=M&&b[1]<=D)return[b[0],b[1]]}{var H=i+u-l,k=n-h+l;if(b=Bi(e,t,i,n,H,k,l+s),b.length>0&&b[0]>=H&&b[1]<=k)return[b[0],b[1]]}{var B=i+u-l,U=n+h-l;if(b=Bi(e,t,i,n,B,U,l+s),b.length>0&&b[0]>=B&&b[1]>=U)return[b[0],b[1]]}{var W=i-u+l,J=n+h-l;if(b=Bi(e,t,i,n,W,J,l+s),b.length>0&&b[0]<=W&&b[1]>=J)return[b[0],b[1]]}return[]},n0=function(e,t,i,n,a,o,s){var l=s,u=Math.min(i,a),h=Math.max(i,a),f=Math.min(n,o),d=Math.max(n,o);return u-l<=e&&e<=h+l&&f-l<=t&&t<=d+l},a0=function(e,t,i,n,a,o,s,l,u){var h={x1:Math.min(i,s,a)-u,x2:Math.max(i,s,a)+u,y1:Math.min(n,l,o)-u,y2:Math.max(n,l,o)+u};return!(e<h.x1||e>h.x2||t<h.y1||t>h.y2)},o0=function(e,t,i,n){i-=n;var a=t*t-4*e*i;if(a<0)return[];var o=Math.sqrt(a),s=2*e,l=(-t+o)/s,u=(-t-o)/s;return[l,u]},s0=function(e,t,i,n,a){var o=1e-5;e===0&&(e=o),t/=e,i/=e,n/=e;var s,l,u,h,f,d,c,v;if(l=(3*i-t*t)/9,u=-(27*n)+t*(9*i-2*(t*t)),u/=54,s=l*l*l+u*u,a[1]=0,c=t/3,s>0){f=u+Math.sqrt(s),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),d=u-Math.sqrt(s),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),a[0]=-c+f+d,c+=(f+d)/2,a[4]=a[2]=-c,c=Math.sqrt(3)*(-d+f)/2,a[3]=c,a[5]=-c;return}if(a[5]=a[3]=0,s===0){v=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-c+2*v,a[4]=a[2]=-(v+c);return}l=-l,h=l*l*l,h=Math.acos(u/Math.sqrt(h)),v=2*Math.sqrt(l),a[0]=-c+v*Math.cos(h/3),a[2]=-c+v*Math.cos((h+2*Math.PI)/3),a[4]=-c+v*Math.cos((h+4*Math.PI)/3)},l0=function(e,t,i,n,a,o,s,l){var u=1*i*i-4*i*a+2*i*s+4*a*a-4*a*s+s*s+n*n-4*n*o+2*n*l+4*o*o-4*o*l+l*l,h=1*9*i*a-3*i*i-3*i*s-6*a*a+3*a*s+9*n*o-3*n*n-3*n*l-6*o*o+3*o*l,f=1*3*i*i-6*i*a+i*s-i*e+2*a*a+2*a*e-s*e+3*n*n-6*n*o+n*l-n*t+2*o*o+2*o*t-l*t,d=1*i*a-i*i+i*e-a*e+n*o-n*n+n*t-o*t,c=[];s0(u,h,f,d,c);for(var v=1e-7,g=[],m=0;m<6;m+=2)Math.abs(c[m+1])<v&&c[m]>=0&&c[m]<=1&&g.push(c[m]);g.push(1),g.push(0);for(var p=-1,y,w,T,O=0;O<g.length;O++)y=Math.pow(1-g[O],2)*i+2*(1-g[O])*g[O]*a+g[O]*g[O]*s,w=Math.pow(1-g[O],2)*n+2*(1-g[O])*g[O]*o+g[O]*g[O]*l,T=Math.pow(y-e,2)+Math.pow(w-t,2),p>=0?T<p&&(p=T):p=T;return p},u0=function(e,t,i,n,a,o){var s=[e-i,t-n],l=[a-i,o-n],u=l[0]*l[0]+l[1]*l[1],h=s[0]*s[0]+s[1]*s[1],f=s[0]*l[0]+s[1]*l[1],d=f*f/u;return f<0?h:d>u?(e-a)*(e-a)+(t-o)*(t-o):h-d},Nt=function(e,t,i){for(var n,a,o,s,l,u=0,h=0;h<i.length/2;h++)if(n=i[h*2],a=i[h*2+1],h+1<i.length/2?(o=i[(h+1)*2],s=i[(h+1)*2+1]):(o=i[(h+1-i.length/2)*2],s=i[(h+1-i.length/2)*2+1]),!(n==e&&o==e))if(n>=e&&e>=o||n<=e&&e<=o)l=(e-n)/(o-n)*(s-a)+a,l>t&&u++;else continue;return u%2!==0},sr=function(e,t,i,n,a,o,s,l,u){var h=new Array(i.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var d=Math.cos(-f),c=Math.sin(-f),v=0;v<h.length/2;v++)h[v*2]=o/2*(i[v*2]*d-i[v*2+1]*c),h[v*2+1]=s/2*(i[v*2+1]*d+i[v*2]*c),h[v*2]+=n,h[v*2+1]+=a;var g;if(u>0){var m=ku(h,-u);g=Bu(m)}else g=h;return Nt(e,t,g)},h0=function(e,t,i,n,a,o,s){for(var l=new Array(i.length),u=o/2,h=s/2,f=No(o,s),d=f*f,c=0;c<i.length/4;c++){var v=void 0,g=void 0;c===0?v=i.length-2:v=c*4-2,g=c*4+2;var m=n+u*i[c*4],p=a+h*i[c*4+1],y=-i[v]*i[g]-i[v+1]*i[g+1],w=f/Math.tan(Math.acos(y)/2),T=m-w*i[v],O=p-w*i[v+1],I=m+w*i[g],R=p+w*i[g+1];l[c*4]=T,l[c*4+1]=O,l[c*4+2]=I,l[c*4+3]=R;var L=i[v+1],N=-i[v],E=L*i[g]+N*i[g+1];E<0&&(L*=-1,N*=-1);var C=T+L*f,b=O+N*f,M=Math.pow(C-e,2)+Math.pow(b-t,2);if(M<=d)return!0}return Nt(e,t,l)},Bu=function(e){for(var t=new Array(e.length/2),i,n,a,o,s,l,u,h,f=0;f<e.length/4;f++){i=e[f*4],n=e[f*4+1],a=e[f*4+2],o=e[f*4+3],f<e.length/4-1?(s=e[(f+1)*4],l=e[(f+1)*4+1],u=e[(f+1)*4+2],h=e[(f+1)*4+3]):(s=e[0],l=e[1],u=e[2],h=e[3]);var d=Sr(i,n,a,o,s,l,u,h,!0);t[f*2]=d[0],t[f*2+1]=d[1]}return t},ku=function(e,t){for(var i=new Array(e.length*2),n,a,o,s,l=0;l<e.length/2;l++){n=e[l*2],a=e[l*2+1],l<e.length/2-1?(o=e[(l+1)*2],s=e[(l+1)*2+1]):(o=e[0],s=e[1]);var u=s-a,h=-(o-n),f=Math.sqrt(u*u+h*h),d=u/f,c=h/f;i[l*4]=n+d*t,i[l*4+1]=a+c*t,i[l*4+2]=o+d*t,i[l*4+3]=s+c*t}return i},f0=function(e,t,i,n,a,o){var s=i-e,l=n-t;s/=a,l/=o;var u=Math.sqrt(s*s+l*l),h=u-1;if(h<0)return[];var f=h/u;return[(i-e)*f+e,(n-t)*f+t]},Ur=function(e,t,i,n,a,o,s){return e-=a,t-=o,e/=i/2+s,t/=n/2+s,e*e+t*t<=1},Bi=function(e,t,i,n,a,o,s){var l=[i-e,n-t],u=[e-a,t-o],h=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),d=u[0]*u[0]+u[1]*u[1]-s*s,c=f*f-4*h*d;if(c<0)return[];var v=(-f+Math.sqrt(c))/(2*h),g=(-f-Math.sqrt(c))/(2*h),m=Math.min(v,g),p=Math.max(v,g),y=[];if(m>=0&&m<=1&&y.push(m),p>=0&&p<=1&&y.push(p),y.length===0)return[];var w=y[0]*l[0]+e,T=y[0]*l[1]+t;if(y.length>1){if(y[0]==y[1])return[w,T];var O=y[1]*l[0]+e,I=y[1]*l[1]+t;return[w,T,O,I]}else return[w,T]},ka=function(e,t,i){return t<=e&&e<=i||i<=e&&e<=t?e:e<=t&&t<=i||i<=t&&t<=e?t:i},Sr=function(e,t,i,n,a,o,s,l,u){var h=e-a,f=i-e,d=s-a,c=t-o,v=n-t,g=l-o,m=d*c-g*h,p=f*c-v*h,y=g*f-d*v;if(y!==0){var w=m/y,T=p/y,O=.001,I=0-O,R=1+O;return I<=w&&w<=R&&I<=T&&T<=R?[e+w*f,t+w*v]:u?[e+w*f,t+w*v]:[]}else return m===0||p===0?ka(e,i,s)===s?[s,l]:ka(e,i,a)===a?[a,o]:ka(a,s,i)===i?[i,n]:[]:[]},Ki=function(e,t,i,n,a,o,s,l){var u=[],h,f=new Array(i.length),d=!0;o==null&&(d=!1);var c;if(d){for(var v=0;v<f.length/2;v++)f[v*2]=i[v*2]*o+n,f[v*2+1]=i[v*2+1]*s+a;if(l>0){var g=ku(f,-l);c=Bu(g)}else c=f}else c=i;for(var m,p,y,w,T=0;T<c.length/2;T++)m=c[T*2],p=c[T*2+1],T<c.length/2-1?(y=c[(T+1)*2],w=c[(T+1)*2+1]):(y=c[0],w=c[1]),h=Sr(e,t,n,a,m,p,y,w),h.length!==0&&u.push(h[0],h[1]);return u},c0=function(e,t,i,n,a,o,s,l){for(var u=[],h,f=new Array(i.length),d=o/2,c=s/2,v=No(o,s),g=0;g<i.length/4;g++){var m=void 0,p=void 0;g===0?m=i.length-2:m=g*4-2,p=g*4+2;var y=n+d*i[g*4],w=a+c*i[g*4+1],T=-i[m]*i[p]-i[m+1]*i[p+1],O=v/Math.tan(Math.acos(T)/2),I=y-O*i[m],R=w-O*i[m+1],L=y+O*i[p],N=w+O*i[p+1];g===0?(f[i.length-2]=I,f[i.length-1]=R):(f[g*4-2]=I,f[g*4-1]=R),f[g*4]=L,f[g*4+1]=N;var E=i[m+1],C=-i[m],b=E*i[p]+C*i[p+1];b<0&&(E*=-1,C*=-1);var M=I+E*v,D=R+C*v;h=Bi(e,t,n,a,M,D,v),h.length!==0&&u.push(h[0],h[1])}for(var H=0;H<f.length/4;H++)h=Sr(e,t,n,a,f[H*4],f[H*4+1],f[H*4+2],f[H*4+3],!1),h.length!==0&&u.push(h[0],h[1]);if(u.length>2){for(var k=[u[0],u[1]],B=Math.pow(k[0]-e,2)+Math.pow(k[1]-t,2),U=1;U<u.length/2;U++){var W=Math.pow(u[U*2]-e,2)+Math.pow(u[U*2+1]-t,2);W<=B&&(k[0]=u[U*2],k[1]=u[U*2+1],B=W)}return k}return u},xn=function(e,t,i){var n=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(n[0]*n[0]+n[1]*n[1]),o=(a-i)/a;return o<0&&(o=1e-5),[t[0]+o*n[0],t[1]+o*n[1]]},Pt=function(e,t){var i=Ja(e,t);return i=zu(i),i},zu=function(e){for(var t,i,n=e.length/2,a=1/0,o=1/0,s=-1/0,l=-1/0,u=0;u<n;u++)t=e[2*u],i=e[2*u+1],a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,i),l=Math.max(l,i);for(var h=2/(s-a),f=2/(l-o),d=0;d<n;d++)t=e[2*d]=e[2*d]*h,i=e[2*d+1]=e[2*d+1]*f,a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,i),l=Math.max(l,i);if(o<-1)for(var c=0;c<n;c++)i=e[2*c+1]=e[2*c+1]+(-1-o);return e},Ja=function(e,t){var i=1/e*2*Math.PI,n=e%2===0?Math.PI/2+i/2:Math.PI/2;n+=t;for(var a=new Array(e*2),o,s=0;s<e;s++)o=s*i+n,a[2*s]=Math.cos(o),a[2*s+1]=Math.sin(-o);return a},hn=function(e,t){return Math.min(e/4,t/4,8)},No=function(e,t){return Math.min(e/10,t/10,8)},Hu=function(){return 8},d0=function(e,t,i){return[e-2*t+i,2*(t-e),e]},$a=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},v0=Et({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),g0={pageRank:function(e){for(var t=v0(e),i=t.dampingFactor,n=t.precision,a=t.iterations,o=t.weight,s=this._private.cy,l=this.byGroup(),u=l.nodes,h=l.edges,f=u.length,d=f*f,c=h.length,v=new Array(d),g=new Array(f),m=(1-i)/f,p=0;p<f;p++){for(var y=0;y<f;y++){var w=p*f+y;v[w]=0}g[p]=0}for(var T=0;T<c;T++){var O=h[T],I=O.data("source"),R=O.data("target");if(I!==R){var L=u.indexOfId(I),N=u.indexOfId(R),E=o(O),C=N*f+L;v[C]+=E,g[L]+=E}}for(var b=1/f+m,M=0;M<f;M++)if(g[M]===0)for(var D=0;D<f;D++){var H=D*f+M;v[H]=b}else for(var k=0;k<f;k++){var B=k*f+M;v[B]=v[B]/g[M]+m}for(var U=new Array(f),W=new Array(f),J,G=0;G<f;G++)U[G]=1;for(var X=0;X<a;X++){for(var ie=0;ie<f;ie++)W[ie]=0;for(var ee=0;ee<f;ee++)for(var q=0;q<f;q++){var $=ee*f+q;W[ee]+=v[$]*U[q]}jy(W),J=U,U=W,W=J;for(var V=0,re=0;re<f;re++){var ae=J[re]-U[re];V+=ae*ae}if(V<n)break}var de={rank:function(Te){return Te=s.collection(Te)[0],U[u.indexOf(Te)]}};return de}},Rs=Et({root:null,weight:function(e){return 1},directed:!1,alpha:0}),ci={degreeCentralityNormalized:function(e){e=Rs(e);var t=this.cy(),i=this.nodes(),n=i.length;if(e.directed){for(var h={},f={},d=0,c=0,v=0;v<n;v++){var g=i[v],m=g.id();e.root=g;var p=this.degreeCentrality(e);d<p.indegree&&(d=p.indegree),c<p.outdegree&&(c=p.outdegree),h[m]=p.indegree,f[m]=p.outdegree}return{indegree:function(w){return d==0?0:(Ne(w)&&(w=t.filter(w)),h[w.id()]/d)},outdegree:function(w){return c===0?0:(Ne(w)&&(w=t.filter(w)),f[w.id()]/c)}}}else{for(var a={},o=0,s=0;s<n;s++){var l=i[s];e.root=l;var u=this.degreeCentrality(e);o<u.degree&&(o=u.degree),a[l.id()]=u.degree}return{degree:function(w){return o===0?0:(Ne(w)&&(w=t.filter(w)),a[w.id()]/o)}}}},degreeCentrality:function(e){e=Rs(e);var t=this.cy(),i=this,n=e,a=n.root,o=n.weight,s=n.directed,l=n.alpha;if(a=t.collection(a)[0],s){for(var c=a.connectedEdges(),v=c.filter(function(I){return I.target().same(a)&&i.has(I)}),g=c.filter(function(I){return I.source().same(a)&&i.has(I)}),m=v.length,p=g.length,y=0,w=0,T=0;T<v.length;T++)y+=o(v[T]);for(var O=0;O<g.length;O++)w+=o(g[O]);return{indegree:Math.pow(m,1-l)*Math.pow(y,l),outdegree:Math.pow(p,1-l)*Math.pow(w,l)}}else{for(var u=a.connectedEdges().intersection(i),h=u.length,f=0,d=0;d<u.length;d++)f+=o(u[d]);return{degree:Math.pow(h,1-l)*Math.pow(f,l)}}}};ci.dc=ci.degreeCentrality;ci.dcn=ci.degreeCentralityNormalised=ci.degreeCentralityNormalized;var Ps=Et({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),di={closenessCentralityNormalized:function(e){for(var t=Ps(e),i=t.harmonic,n=t.weight,a=t.directed,o=this.cy(),s={},l=0,u=this.nodes(),h=this.floydWarshall({weight:n,directed:a}),f=0;f<u.length;f++){for(var d=0,c=u[f],v=0;v<u.length;v++)if(f!==v){var g=h.distance(c,u[v]);i?d+=1/g:d+=g}i||(d=1/d),l<d&&(l=d),s[c.id()]=d}return{closeness:function(p){return l==0?0:(Ne(p)?p=o.filter(p)[0].id():p=p.id(),s[p]/l)}}},closenessCentrality:function(e){var t=Ps(e),i=t.root,n=t.weight,a=t.directed,o=t.harmonic;i=this.filter(i)[0];for(var s=this.dijkstra({root:i,weight:n,directed:a}),l=0,u=this.nodes(),h=0;h<u.length;h++){var f=u[h];if(!f.same(i)){var d=s.distanceTo(f);o?l+=1/d:l+=d}}return o?l:1/l}};di.cc=di.closenessCentrality;di.ccn=di.closenessCentralityNormalised=di.closenessCentralityNormalized;var p0=Et({weight:null,directed:!1}),eo={betweennessCentrality:function(e){for(var t=p0(e),i=t.directed,n=t.weight,a=n!=null,o=this.cy(),s=this.nodes(),l={},u={},h=0,f={set:function(w,T){u[w]=T,T>h&&(h=T)},get:function(w){return u[w]}},d=0;d<s.length;d++){var c=s[d],v=c.id();i?l[v]=c.outgoers().nodes():l[v]=c.openNeighborhood().nodes(),f.set(v,0)}for(var g=function(w){for(var T=s[w].id(),O=[],I={},R={},L={},N=new sn.default(function(q,$){return L[q]-L[$]}),E=0;E<s.length;E++){var C=s[E].id();I[C]=[],R[C]=0,L[C]=1/0}for(R[T]=1,L[T]=0,N.push(T);!N.empty();){var b=N.pop();if(O.push(b),a)for(var M=0;M<l[b].length;M++){var D=l[b][M],H=o.getElementById(b),k=void 0;H.edgesTo(D).length>0?k=H.edgesTo(D)[0]:k=D.edgesTo(H)[0];var B=n(k);D=D.id(),L[D]>L[b]+B&&(L[D]=L[b]+B,N.nodes.indexOf(D)<0?N.push(D):N.updateItem(D),R[D]=0,I[D]=[]),L[D]==L[b]+B&&(R[D]=R[D]+R[b],I[D].push(b))}else for(var U=0;U<l[b].length;U++){var W=l[b][U].id();L[W]==1/0&&(N.push(W),L[W]=L[b]+1),L[W]==L[b]+1&&(R[W]=R[W]+R[b],I[W].push(b))}}for(var J={},G=0;G<s.length;G++)J[s[G].id()]=0;for(;O.length>0;){for(var X=O.pop(),ie=0;ie<I[X].length;ie++){var ee=I[X][ie];J[ee]=J[ee]+R[ee]/R[X]*(1+J[X])}X!=s[w].id()&&f.set(X,f.get(X)+J[X])}},m=0;m<s.length;m++)g(m);var p={betweenness:function(w){var T=o.collection(w).id();return f.get(T)},betweennessNormalized:function(w){if(h==0)return 0;var T=o.collection(w).id();return f.get(T)/h}};return p.betweennessNormalised=p.betweennessNormalized,p}};eo.bc=eo.betweennessCentrality;var m0=Et({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),y0=function(e){return m0(e)},w0=function(e,t){for(var i=0,n=0;n<t.length;n++)i+=t[n](e);return i},E0=function(e,t,i){for(var n=0;n<t;n++)e[n*t+n]=i},Uu=function(e,t){for(var i,n=0;n<t;n++){i=0;for(var a=0;a<t;a++)i+=e[a*t+n];for(var o=0;o<t;o++)e[o*t+n]=e[o*t+n]/i}},T0=function(e,t,i){for(var n=new Array(i*i),a=0;a<i;a++){for(var o=0;o<i;o++)n[a*i+o]=0;for(var s=0;s<i;s++)for(var l=0;l<i;l++)n[a*i+l]+=e[a*i+s]*t[s*i+l]}return n},b0=function(e,t,i){for(var n=e.slice(0),a=1;a<i;a++)e=T0(e,n,t);return e},x0=function(e,t,i){for(var n=new Array(t*t),a=0;a<t*t;a++)n[a]=Math.pow(e[a],i);return Uu(n,t),n},S0=function(e,t,i,n){for(var a=0;a<i;a++){var o=Math.round(e[a]*Math.pow(10,n))/Math.pow(10,n),s=Math.round(t[a]*Math.pow(10,n))/Math.pow(10,n);if(o!==s)return!1}return!0},C0=function(e,t,i,n){for(var a=[],o=0;o<t;o++){for(var s=[],l=0;l<t;l++)Math.round(e[o*t+l]*1e3)/1e3>0&&s.push(i[l]);s.length!==0&&a.push(n.collection(s))}return a},D0=function(e,t){for(var i=0;i<e.length;i++)if(!t[i]||e[i].id()!==t[i].id())return!1;return!0},R0=function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e.length;i++)t!=i&&D0(e[t],e[i])&&e.splice(i,1);return e},Ls=function(e){for(var t=this.nodes(),i=this.edges(),n=this.cy(),a=y0(e),o={},s=0;s<t.length;s++)o[t[s].id()]=s;for(var l=t.length,u=l*l,h=new Array(u),f,d=0;d<u;d++)h[d]=0;for(var c=0;c<i.length;c++){var v=i[c],g=o[v.source().id()],m=o[v.target().id()],p=w0(v,a.attributes);h[g*l+m]+=p,h[m*l+g]+=p}E0(h,l,a.multFactor),Uu(h,l);for(var y=!0,w=0;y&&w<a.maxIterations;)y=!1,f=b0(h,l,a.expandFactor),h=x0(f,l,a.inflateFactor),S0(h,f,u,4)||(y=!0),w++;var T=C0(h,l,t,n);return T=R0(T),T},P0={markovClustering:Ls,mcl:Ls},L0=function(e){return e},Gu=function(e,t){return Math.abs(t-e)},Os=function(e,t,i){return e+Gu(t,i)},Ms=function(e,t,i){return e+Math.pow(i-t,2)},O0=function(e){return Math.sqrt(e)},M0=function(e,t,i){return Math.max(e,Gu(t,i))},Ni=function(e,t,i,n,a){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:L0,s=n,l,u,h=0;h<e;h++)l=t(h),u=i(h),s=a(s,l,u);return o(s)},mi={euclidean:function(e,t,i){return e>=2?Ni(e,t,i,0,Ms,O0):Ni(e,t,i,0,Os)},squaredEuclidean:function(e,t,i){return Ni(e,t,i,0,Ms)},manhattan:function(e,t,i){return Ni(e,t,i,0,Os)},max:function(e,t,i){return Ni(e,t,i,-1/0,M0)}};mi["squared-euclidean"]=mi.squaredEuclidean;mi.squaredeuclidean=mi.squaredEuclidean;function ga(r,e,t,i,n,a){var o;return nt(r)?o=r:o=mi[r]||mi.euclidean,e===0&&nt(r)?o(n,a):o(e,t,i,n,a)}var N0=Et({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Io=function(e){return N0(e)},Xn=function(e,t,i,n,a){var o=a!=="kMedoids",s=o?function(f){return i[f]}:function(f){return n[f](i)},l=function(d){return n[d](t)},u=i,h=t;return ga(e,n.length,s,l,u,h)},za=function(e,t,i){for(var n=i.length,a=new Array(n),o=new Array(n),s=new Array(t),l=null,u=0;u<n;u++)a[u]=e.min(i[u]).value,o[u]=e.max(i[u]).value;for(var h=0;h<t;h++){l=[];for(var f=0;f<n;f++)l[f]=Math.random()*(o[f]-a[f])+a[f];s[h]=l}return s},Vu=function(e,t,i,n,a){for(var o=1/0,s=0,l=0;l<t.length;l++){var u=Xn(i,e,t[l],n,a);u<o&&(o=u,s=l)}return s},Wu=function(e,t,i){for(var n=[],a=null,o=0;o<t.length;o++)a=t[o],i[a.id()]===e&&n.push(a);return n},I0=function(e,t,i){return Math.abs(t-e)<=i},A0=function(e,t,i){for(var n=0;n<e.length;n++)for(var a=0;a<e[n].length;a++){var o=Math.abs(e[n][a]-t[n][a]);if(o>i)return!1}return!0},_0=function(e,t,i){for(var n=0;n<i;n++)if(e===t[n])return!0;return!1},Ns=function(e,t){var i=new Array(t);if(e.length<50)for(var n=0;n<t;n++){for(var a=e[Math.floor(Math.random()*e.length)];_0(a,i,n);)a=e[Math.floor(Math.random()*e.length)];i[n]=a}else for(var o=0;o<t;o++)i[o]=e[Math.floor(Math.random()*e.length)];return i},Is=function(e,t,i){for(var n=0,a=0;a<t.length;a++)n+=Xn("manhattan",t[a],e,i,"kMedoids");return n},F0=function(e){var t=this.cy(),i=this.nodes(),n=null,a=Io(e),o=new Array(a.k),s={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=za(i,a.k,a.attributes)):dt(a.testCentroids)==="object"?l=a.testCentroids:l=za(i,a.k,a.attributes):l=za(i,a.k,a.attributes);for(var u=!0,h=0;u&&h<a.maxIterations;){for(var f=0;f<i.length;f++)n=i[f],s[n.id()]=Vu(n,l,a.distance,a.attributes,"kMeans");u=!1;for(var d=0;d<a.k;d++){var c=Wu(d,i,s);if(c.length!==0){for(var v=a.attributes.length,g=l[d],m=new Array(v),p=new Array(v),y=0;y<v;y++){p[y]=0;for(var w=0;w<c.length;w++)n=c[w],p[y]+=a.attributes[y](n);m[y]=p[y]/c.length,I0(m[y],g[y],a.sensitivityThreshold)||(u=!0)}l[d]=m,o[d]=t.collection(c)}}h++}return o},B0=function(e){var t=this.cy(),i=this.nodes(),n=null,a=Io(e),o=new Array(a.k),s,l={},u,h=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(dt(a.testCentroids)==="object"?s=a.testCentroids:s=Ns(i,a.k)):s=Ns(i,a.k);for(var f=!0,d=0;f&&d<a.maxIterations;){for(var c=0;c<i.length;c++)n=i[c],l[n.id()]=Vu(n,s,a.distance,a.attributes,"kMedoids");f=!1;for(var v=0;v<s.length;v++){var g=Wu(v,i,l);if(g.length!==0){h[v]=Is(s[v],g,a.attributes);for(var m=0;m<g.length;m++)u=Is(g[m],g,a.attributes),u<h[v]&&(h[v]=u,s[v]=g[m],f=!0);o[v]=t.collection(g)}}d++}return o},k0=function(e,t,i,n,a){for(var o,s,l=0;l<t.length;l++)for(var u=0;u<e.length;u++)n[l][u]=Math.pow(i[l][u],a.m);for(var h=0;h<e.length;h++)for(var f=0;f<a.attributes.length;f++){o=0,s=0;for(var d=0;d<t.length;d++)o+=n[d][h]*a.attributes[f](t[d]),s+=n[d][h];e[h][f]=o/s}},z0=function(e,t,i,n,a){for(var o=0;o<e.length;o++)t[o]=e[o].slice();for(var s,l,u,h=2/(a.m-1),f=0;f<i.length;f++)for(var d=0;d<n.length;d++){s=0;for(var c=0;c<i.length;c++)l=Xn(a.distance,n[d],i[f],a.attributes,"cmeans"),u=Xn(a.distance,n[d],i[c],a.attributes,"cmeans"),s+=Math.pow(l/u,h);e[d][f]=1/s}},H0=function(e,t,i,n){for(var a=new Array(i.k),o=0;o<a.length;o++)a[o]=[];for(var s,l,u=0;u<t.length;u++){s=-1/0,l=-1;for(var h=0;h<t[0].length;h++)t[u][h]>s&&(s=t[u][h],l=h);a[l].push(e[u])}for(var f=0;f<a.length;f++)a[f]=n.collection(a[f]);return a},As=function(e){var t=this.cy(),i=this.nodes(),n=Io(e),a,o,s,l,u;l=new Array(i.length);for(var h=0;h<i.length;h++)l[h]=new Array(n.k);s=new Array(i.length);for(var f=0;f<i.length;f++)s[f]=new Array(n.k);for(var d=0;d<i.length;d++){for(var c=0,v=0;v<n.k;v++)s[d][v]=Math.random(),c+=s[d][v];for(var g=0;g<n.k;g++)s[d][g]=s[d][g]/c}o=new Array(n.k);for(var m=0;m<n.k;m++)o[m]=new Array(n.attributes.length);u=new Array(i.length);for(var p=0;p<i.length;p++)u[p]=new Array(n.k);for(var y=!0,w=0;y&&w<n.maxIterations;)y=!1,k0(o,i,s,u,n),z0(s,l,o,i,n),A0(s,l,n.sensitivityThreshold)||(y=!0),w++;return a=H0(i,s,n,t),{clusters:a,degreeOfMembership:s}},U0={kMeans:F0,kMedoids:B0,fuzzyCMeans:As,fcm:As},G0=Et({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),V0={single:"min",complete:"max"},W0=function(e){var t=G0(e),i=V0[t.linkage];return i!=null&&(t.linkage=i),t},_s=function(e,t,i,n,a){for(var o=0,s=1/0,l,u=a.attributes,h=function(N,E){return ga(a.distance,u.length,function(C){return u[C](N)},function(C){return u[C](E)},N,E)},f=0;f<e.length;f++){var d=e[f].key,c=i[d][n[d]];c<s&&(o=d,s=c)}if(a.mode==="threshold"&&s>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=t[o],g=t[n[o]],m;a.mode==="dendrogram"?m={left:v,right:g,key:v.key}:m={value:v.value.concat(g.value),key:v.key},e[v.index]=m,e.splice(g.index,1),t[v.key]=m;for(var p=0;p<e.length;p++){var y=e[p];v.key===y.key?l=1/0:a.linkage==="min"?(l=i[v.key][y.key],i[v.key][y.key]>i[g.key][y.key]&&(l=i[g.key][y.key])):a.linkage==="max"?(l=i[v.key][y.key],i[v.key][y.key]<i[g.key][y.key]&&(l=i[g.key][y.key])):a.linkage==="mean"?l=(i[v.key][y.key]*v.size+i[g.key][y.key]*g.size)/(v.size+g.size):a.mode==="dendrogram"?l=h(y.value,v.value):l=h(y.value[0],v.value[0]),i[v.key][y.key]=i[y.key][v.key]=l}for(var w=0;w<e.length;w++){var T=e[w].key;if(n[T]===v.key||n[T]===g.key){for(var O=T,I=0;I<e.length;I++){var R=e[I].key;i[T][R]<i[T][O]&&(O=R)}n[T]=O}e[w].index=w}return v.key=g.key=v.index=g.index=null,!0},Sn=function r(e,t,i){!e||(e.value?t.push(e.value):(e.left&&r(e.left,t),e.right&&r(e.right,t)))},q0=function r(e,t){if(!e)return"";if(e.left&&e.right){var i=r(e.left,t),n=r(e.right,t),a=t.add({group:"nodes",data:{id:i+","+n}});return t.add({group:"edges",data:{source:i,target:a.id()}}),t.add({group:"edges",data:{source:n,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},Y0=function r(e,t,i){if(!e)return[];var n=[],a=[],o=[];return t===0?(e.left&&Sn(e.left,n),e.right&&Sn(e.right,a),o=n.concat(a),[i.collection(o)]):t===1?e.value?[i.collection(e.value)]:(e.left&&Sn(e.left,n),e.right&&Sn(e.right,a),[i.collection(n),i.collection(a)]):e.value?[i.collection(e.value)]:(e.left&&(n=r(e.left,t-1,i)),e.right&&(a=r(e.right,t-1,i)),n.concat(a))},Fs=function(e){for(var t=this.cy(),i=this.nodes(),n=W0(e),a=n.attributes,o=function(w,T){return ga(n.distance,a.length,function(O){return a[O](w)},function(O){return a[O](T)},w,T)},s=[],l=[],u=[],h=[],f=0;f<i.length;f++){var d={value:n.mode==="dendrogram"?i[f]:[i[f]],key:f,index:f};s[f]=d,h[f]=d,l[f]=[],u[f]=0}for(var c=0;c<s.length;c++)for(var v=0;v<=c;v++){var g=void 0;n.mode==="dendrogram"?g=c===v?1/0:o(s[c].value,s[v].value):g=c===v?1/0:o(s[c].value[0],s[v].value[0]),l[c][v]=g,l[v][c]=g,g<l[c][u[c]]&&(u[c]=v)}for(var m=_s(s,h,l,u,n);m;)m=_s(s,h,l,u,n);var p;return n.mode==="dendrogram"?(p=Y0(s[0],n.dendrogramDepth,t),n.addDendrogram&&q0(s[0],t)):(p=new Array(s.length),s.forEach(function(y,w){y.key=y.index=null,p[w]=t.collection(y.value)})),p},X0={hierarchicalClustering:Fs,hca:Fs},Z0=Et({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),K0=function(e){var t=e.damping,i=e.preference;.5<=t&&t<1||at("Damping must range on [0.5, 1).  Got: ".concat(t));var n=["median","mean","min","max"];return n.some(function(a){return a===i})||Se(i)||at("Preference must be one of [".concat(n.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(i)),Z0(e)},Q0=function(e,t,i,n){var a=function(s,l){return n[l](s)};return-ga(e,n.length,function(o){return a(t,o)},function(o){return a(i,o)},t,i)},j0=function(e,t){var i=null;return t==="median"?i=Ky(e):t==="mean"?i=Zy(e):t==="min"?i=Yy(e):t==="max"?i=Xy(e):i=t,i},J0=function(e,t,i){for(var n=[],a=0;a<e;a++)t[a*e+a]+i[a*e+a]>0&&n.push(a);return n},Bs=function(e,t,i){for(var n=[],a=0;a<e;a++){for(var o=-1,s=-1/0,l=0;l<i.length;l++){var u=i[l];t[a*e+u]>s&&(o=u,s=t[a*e+u])}o>0&&n.push(o)}for(var h=0;h<i.length;h++)n[i[h]]=i[h];return n},$0=function(e,t,i){for(var n=Bs(e,t,i),a=0;a<i.length;a++){for(var o=[],s=0;s<n.length;s++)n[s]===i[a]&&o.push(s);for(var l=-1,u=-1/0,h=0;h<o.length;h++){for(var f=0,d=0;d<o.length;d++)f+=t[o[d]*e+o[h]];f>u&&(l=h,u=f)}i[a]=o[l]}return n=Bs(e,t,i),n},ks=function(e){for(var t=this.cy(),i=this.nodes(),n=K0(e),a={},o=0;o<i.length;o++)a[i[o].id()]=o;var s,l,u,h,f,d;s=i.length,l=s*s,u=new Array(l);for(var c=0;c<l;c++)u[c]=-1/0;for(var v=0;v<s;v++)for(var g=0;g<s;g++)v!==g&&(u[v*s+g]=Q0(n.distance,i[v],i[g],n.attributes));h=j0(u,n.preference);for(var m=0;m<s;m++)u[m*s+m]=h;f=new Array(l);for(var p=0;p<l;p++)f[p]=0;d=new Array(l);for(var y=0;y<l;y++)d[y]=0;for(var w=new Array(s),T=new Array(s),O=new Array(s),I=0;I<s;I++)w[I]=0,T[I]=0,O[I]=0;for(var R=new Array(s*n.minIterations),L=0;L<R.length;L++)R[L]=0;var N;for(N=0;N<n.maxIterations;N++){for(var E=0;E<s;E++){for(var C=-1/0,b=-1/0,M=-1,D=0,H=0;H<s;H++)w[H]=f[E*s+H],D=d[E*s+H]+u[E*s+H],D>=C?(b=C,C=D,M=H):D>b&&(b=D);for(var k=0;k<s;k++)f[E*s+k]=(1-n.damping)*(u[E*s+k]-C)+n.damping*w[k];f[E*s+M]=(1-n.damping)*(u[E*s+M]-b)+n.damping*w[M]}for(var B=0;B<s;B++){for(var U=0,W=0;W<s;W++)w[W]=d[W*s+B],T[W]=Math.max(0,f[W*s+B]),U+=T[W];U-=T[B],T[B]=f[B*s+B],U+=T[B];for(var J=0;J<s;J++)d[J*s+B]=(1-n.damping)*Math.min(0,U-T[J])+n.damping*w[J];d[B*s+B]=(1-n.damping)*(U-T[B])+n.damping*w[B]}for(var G=0,X=0;X<s;X++){var ie=d[X*s+X]+f[X*s+X]>0?1:0;R[N%n.minIterations*s+X]=ie,G+=ie}if(G>0&&(N>=n.minIterations-1||N==n.maxIterations-1)){for(var ee=0,q=0;q<s;q++){O[q]=0;for(var $=0;$<n.minIterations;$++)O[q]+=R[$*s+q];(O[q]===0||O[q]===n.minIterations)&&ee++}if(ee===s)break}}for(var V=J0(s,f,d),re=$0(s,u,V),ae={},de=0;de<V.length;de++)ae[V[de]]=[];for(var ye=0;ye<i.length;ye++){var Te=a[i[ye].id()],Oe=re[Te];Oe!=null&&ae[Oe].push(i[ye])}for(var ce=new Array(V.length),x=0;x<V.length;x++)ce[x]=t.collection(ae[V[x]]);return ce},ew={affinityPropagation:ks,ap:ks},tw=Et({root:void 0,directed:!1}),rw={hierholzer:function(e){if(!Ue(e)){var t=arguments;e={root:t[0],directed:t[1]}}var i=tw(e),n=i.root,a=i.directed,o=this,s=!1,l,u,h;n&&(h=Ne(n)?this.filter(n)[0].id():n[0].id());var f={},d={};a?o.forEach(function(y){var w=y.id();if(y.isNode()){var T=y.indegree(!0),O=y.outdegree(!0),I=T-O,R=O-T;I==1?l?s=!0:l=w:R==1?u?s=!0:u=w:(R>1||I>1)&&(s=!0),f[w]=[],y.outgoers().forEach(function(L){L.isEdge()&&f[w].push(L.id())})}else d[w]=[void 0,y.target().id()]}):o.forEach(function(y){var w=y.id();if(y.isNode()){var T=y.degree(!0);T%2&&(l?u?s=!0:u=w:l=w),f[w]=[],y.connectedEdges().forEach(function(O){return f[w].push(O.id())})}else d[w]=[y.source().id(),y.target().id()]});var c={found:!1,trail:void 0};if(s)return c;if(u&&l)if(a){if(h&&u!=h)return c;h=u}else{if(h&&u!=h&&l!=h)return c;h||(h=u)}else h||(h=o[0].id());var v=function(w){for(var T=w,O=[w],I,R,L;f[T].length;)I=f[T].shift(),R=d[I][0],L=d[I][1],T!=L?(f[L]=f[L].filter(function(N){return N!=I}),T=L):!a&&T!=R&&(f[R]=f[R].filter(function(N){return N!=I}),T=R),O.unshift(I),O.unshift(T);return O},g=[],m=[];for(m=v(h);m.length!=1;)f[m[0]].length==0?(g.unshift(o.getElementById(m.shift())),g.unshift(o.getElementById(m.shift()))):m=v(m.shift()).concat(m);g.unshift(o.getElementById(m.shift()));for(var p in f)if(f[p].length)return c;return c.found=!0,c.trail=this.spawn(g,!0),c}},Cn=function(){var e=this,t={},i=0,n=0,a=[],o=[],s={},l=function(d,c){for(var v=o.length-1,g=[],m=e.spawn();o[v].x!=d||o[v].y!=c;)g.push(o.pop().edge),v--;g.push(o.pop().edge),g.forEach(function(p){var y=p.connectedNodes().intersection(e);m.merge(p),y.forEach(function(w){var T=w.id(),O=w.connectedEdges().intersection(e);m.merge(w),t[T].cutVertex?m.merge(O.filter(function(I){return I.isLoop()})):m.merge(O)})}),a.push(m)},u=function f(d,c,v){d===v&&(n+=1),t[c]={id:i,low:i++,cutVertex:!1};var g=e.getElementById(c).connectedEdges().intersection(e);if(g.size()===0)a.push(e.spawn(e.getElementById(c)));else{var m,p,y,w;g.forEach(function(T){m=T.source().id(),p=T.target().id(),y=m===c?p:m,y!==v&&(w=T.id(),s[w]||(s[w]=!0,o.push({x:c,y,edge:T})),y in t?t[c].low=Math.min(t[c].low,t[y].id):(f(d,y,c),t[c].low=Math.min(t[c].low,t[y].low),t[c].id<=t[y].low&&(t[c].cutVertex=!0,l(c,y))))})}};e.forEach(function(f){if(f.isNode()){var d=f.id();d in t||(n=0,u(d,d),t[d].cutVertex=n>1)}});var h=Object.keys(t).filter(function(f){return t[f].cutVertex}).map(function(f){return e.getElementById(f)});return{cut:e.spawn(h),components:a}},iw={hopcroftTarjanBiconnected:Cn,htbc:Cn,htb:Cn,hopcroftTarjanBiconnectedComponents:Cn},Dn=function(){var e=this,t={},i=0,n=[],a=[],o=e.spawn(e),s=function l(u){a.push(u),t[u]={index:i,low:i++,explored:!1};var h=e.getElementById(u).connectedEdges().intersection(e);if(h.forEach(function(g){var m=g.target().id();m!==u&&(m in t||l(m),t[m].explored||(t[u].low=Math.min(t[u].low,t[m].low)))}),t[u].index===t[u].low){for(var f=e.spawn();;){var d=a.pop();if(f.merge(e.getElementById(d)),t[d].low=t[u].index,t[d].explored=!0,d===u)break}var c=f.edgesWith(f),v=f.merge(c);n.push(v),o=o.difference(v)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in t||s(u)}}),{cut:o,components:n}},nw={tarjanStronglyConnected:Dn,tsc:Dn,tscc:Dn,tarjanStronglyConnectedComponents:Dn},qu={};[Xi,Ay,_y,By,zy,Uy,Wy,g0,ci,di,eo,P0,U0,X0,ew,rw,iw,nw].forEach(function(r){_e(qu,r)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var Yu=0,Xu=1,Zu=2,lr=function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.7",this.state=Yu,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};lr.prototype={fulfill:function(e){return zs(this,Xu,"fulfillValue",e)},reject:function(e){return zs(this,Zu,"rejectReason",e)},then:function(e,t){var i=this,n=new lr;return i.onFulfilled.push(Us(e,n,"fulfill")),i.onRejected.push(Us(t,n,"reject")),Ku(i),n.proxy}};var zs=function(e,t,i,n){return e.state===Yu&&(e.state=t,e[i]=n,Ku(e)),e},Ku=function(e){e.state===Xu?Hs(e,"onFulfilled",e.fulfillValue):e.state===Zu&&Hs(e,"onRejected",e.rejectReason)},Hs=function(e,t,i){if(e[t].length!==0){var n=e[t];e[t]=[];var a=function(){for(var s=0;s<n.length;s++)n[s](i)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},Us=function(e,t,i){return function(n){if(typeof e!="function")t[i].call(t,n);else{var a;try{a=e(n)}catch(o){t.reject(o);return}aw(t,a)}}},aw=function r(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var i;if(dt(t)==="object"&&t!==null||typeof t=="function")try{i=t.then}catch(a){e.reject(a);return}if(typeof i=="function"){var n=!1;try{i.call(t,function(a){n||(n=!0,a===t?e.reject(new TypeError("circular thenable chain")):r(e,a))},function(a){n||(n=!0,e.reject(a))})}catch(a){n||e.reject(a)}return}e.fulfill(t)};lr.all=function(r){return new lr(function(e,t){for(var i=new Array(r.length),n=0,a=function(l,u){i[l]=u,n++,n===r.length&&e(i)},o=0;o<r.length;o++)(function(s){var l=r[s],u=l!=null&&l.then!=null;if(u)l.then(function(f){a(s,f)},function(f){t(f)});else{var h=l;a(s,h)}})(o)})};lr.resolve=function(r){return new lr(function(e,t){e(r)})};lr.reject=function(r){return new lr(function(e,t){t(r)})};var Si=typeof Promise<"u"?Promise:lr,to=function(e,t,i){var n=Co(e),a=!n,o=this._private=_e({duration:1e3},t,i);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&nt(o.complete)&&o.completes.push(o.complete),a){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(n){var l=e.pan();o.startPan={x:l.x,y:l.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},Wr=to.prototype;_e(Wr,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,i=e.target._private.animation;e.queue?t=i.queue:t=i.current,t.push(this),_t(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,i=t.playing;return e===void 0?t.progress:(i&&this.pause(),t.progress=e,t.started=!1,i&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var i=function(u,h){var f=e[u];f!=null&&(e[u]=e[h],e[h]=f)};if(i("zoom","startZoom"),i("pan","startPan"),i("position","startPosition"),e.style)for(var n=0;n<e.style.length;n++){var a=e.style[n],o=a.name,s=e.startStyle[o];e.startStyle[o]=a,e.style[n]=s}return t&&this.play(),this},promise:function(e){var t=this._private,i;switch(e){case"frame":i=t.frames;break;default:case"complete":case"completed":i=t.completes}return new Si(function(n,a){i.push(function(){n()})})}});Wr.complete=Wr.completed;Wr.run=Wr.play;Wr.running=Wr.playing;var ow={animated:function(){return function(){var t=this,i=t.length!==void 0,n=i?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return!1;var o=n[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,i=t.length!==void 0,n=i?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var o=0;o<n.length;o++){var s=n[o];s._private.animation.queue=[]}return this}},delay:function(){return function(t,i){var n=this._private.cy||this;return n.styleEnabled()?this.animate({delay:t,duration:t,complete:i}):this}},delayAnimation:function(){return function(t,i){var n=this._private.cy||this;return n.styleEnabled()?this.animation({delay:t,duration:t,complete:i}):this}},animation:function(){return function(t,i){var n=this,a=n.length!==void 0,o=a?n:[n],s=this._private.cy||this,l=!a,u=!l;if(!s.styleEnabled())return this;var h=s.style();t=_e({},t,i);var f=Object.keys(t).length===0;if(f)return new to(o[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(u&&(t.style=h.getPropsList(t.style||t.css),t.css=void 0),u&&t.renderedPosition!=null){var d=t.renderedPosition,c=s.pan(),v=s.zoom();t.position=Iu(d,v,c)}if(l&&t.panBy!=null){var g=t.panBy,m=s.pan();t.pan={x:m.x+g.x,y:m.y+g.y}}var p=t.center||t.centre;if(l&&p!=null){var y=s.getCenterPan(p.eles,t.zoom);y!=null&&(t.pan=y)}if(l&&t.fit!=null){var w=t.fit,T=s.getFitViewport(w.eles||w.boundingBox,w.padding);T!=null&&(t.pan=T.pan,t.zoom=T.zoom)}if(l&&Ue(t.zoom)){var O=s.getZoomedViewport(t.zoom);O!=null?(O.zoomed&&(t.zoom=O.zoom),O.panned&&(t.pan=O.pan)):t.zoom=null}return new to(o[0],t)}},animate:function(){return function(t,i){var n=this,a=n.length!==void 0,o=a?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;i&&(t=_e({},t,i));for(var l=0;l<o.length;l++){var u=o[l],h=u.animated()&&(t.queue===void 0||t.queue),f=u.animation(t,h?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(t,i){var n=this,a=n.length!==void 0,o=a?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var l=0;l<o.length;l++){for(var u=o[l],h=u._private,f=h.animation.current,d=0;d<f.length;d++){var c=f[d],v=c._private;i&&(v.duration=0)}t&&(h.animation.queue=[]),i||(h.animation.current=[])}return s.notify("draw"),this}}},sw={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(n){},beforeSet:function(n,a){},onSet:function(n){},canSet:function(n){return!0}};return e=_e({},t,e),function(n,a){var o=e,s=this,l=s.length!==void 0,u=l?s:[s],h=l?s[0]:s;if(Ne(n)){var f=n.indexOf(".")!==-1,d=f&&Ym.default(n);if(o.allowGetting&&a===void 0){var c;return h&&(o.beforeGet(h),d&&h._private[o.field][n]===void 0?c=Wm.default(h._private[o.field],d):c=h._private[o.field][n]),c}else if(o.allowSetting&&a!==void 0){var v=!o.immutableKeys[n];if(v){var g=mu({},n,a);o.beforeSet(s,g);for(var m=0,p=u.length;m<p;m++){var y=u[m];o.canSet(y)&&(d&&h._private[o.field][n]===void 0?qm.default(y._private[o.field],d,a):y._private[o.field][n]=a)}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&Ue(n)){var w=n,T,O,I=Object.keys(w);o.beforeSet(s,w);for(var R=0;R<I.length;R++){T=I[R],O=w[T];var L=!o.immutableKeys[T];if(L)for(var N=0;N<u.length;N++){var E=u[N];o.canSet(E)&&(E._private[o.field][T]=O)}}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&nt(n)){var C=n;s.on(o.bindingEvent,C)}else if(o.allowGetting&&n===void 0){var b;return h&&(o.beforeGet(h),b=h._private[o.field]),b}return s}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=_e({},t,e),function(n){var a=e,o=this,s=o.length!==void 0,l=s?o:[o];if(Ne(n)){for(var u=n.split(/\s+/),h=u.length,f=0;f<h;f++){var d=u[f];if(!Lr(d)){var c=!a.immutableKeys[d];if(c)for(var v=0,g=l.length;v<g;v++)l[v]._private[a.field][d]=void 0}}a.triggerEvent&&o[a.triggerFnName](a.event)}else if(n===void 0){for(var m=0,p=l.length;m<p;m++)for(var y=l[m]._private[a.field],w=Object.keys(y),T=0;T<w.length;T++){var O=w[T],I=!a.immutableKeys[O];I&&(y[O]=void 0)}a.triggerEvent&&o[a.triggerFnName](a.event)}return o}}},lw={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(i,n){var a=this,o=Array.prototype.slice.call(arguments,0);return new Si(function(s,l){var u=function(c){a.off.apply(a,f),s(c)},h=o.concat([u]),f=h.concat([]);a.on.apply(a,h)})}}},Ye={};[ow,sw,lw].forEach(function(r){_e(Ye,r)});var uw={animate:Ye.animate(),animation:Ye.animation(),animated:Ye.animated(),clearQueue:Ye.clearQueue(),delay:Ye.delay(),delayAnimation:Ye.delayAnimation(),stop:Ye.stop()},_n={classes:function(e){var t=this;if(e===void 0){var i=[];return t[0]._private.classes.forEach(function(v){return i.push(v)}),i}else je(e)||(e=(e||"").match(/\S+/g)||[]);for(var n=[],a=new xi(e),o=0;o<t.length;o++){for(var s=t[o],l=s._private,u=l.classes,h=!1,f=0;f<e.length;f++){var d=e[f],c=u.has(d);if(!c){h=!0;break}}h||(h=u.size!==e.length),h&&(l.classes=a,n.push(s))}return n.length>0&&this.spawn(n).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){je(e)||(e=e.match(/\S+/g)||[]);for(var i=this,n=t===void 0,a=[],o=0,s=i.length;o<s;o++)for(var l=i[o],u=l._private.classes,h=!1,f=0;f<e.length;f++){var d=e[f],c=u.has(d),v=!1;t||n&&!c?(u.add(d),v=!0):(!t||n&&c)&&(u.delete(d),v=!0),!h&&v&&(a.push(l),h=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),i},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var i=this;if(t==null)t=250;else if(t===0)return i;return i.addClass(e),setTimeout(function(){i.removeClass(e)},t),i}};_n.className=_n.classNames=_n.classes;var He={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:ct,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};He.variable="(?:[\\w-.]|(?:\\\\"+He.metaChar+"))+";He.className="(?:[\\w-]|(?:\\\\"+He.metaChar+"))+";He.value=He.string+"|"+He.number;He.id=He.variable;(function(){var r,e,t;for(r=He.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],He.comparatorOp+="|@"+e;for(r=He.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(He.comparatorOp+="|\\!"+e)})();var Qe=function(){return{checks:[]}},Le={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},ro=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return dy(r.selector,e.selector)}),hw=function(){for(var r={},e,t=0;t<ro.length;t++)e=ro[t],r[e.selector]=e.matches;return r}(),fw=function(e,t){return hw[e](t)},cw="("+ro.map(function(r){return r.selector}).join("|")+")",ti=function(e){return e.replace(new RegExp("\\\\("+He.metaChar+")","g"),function(t,i){return i})},yr=function(e,t,i){e[e.length-1]=i},io=[{name:"group",query:!0,regex:"("+He.group+")",populate:function(e,t,i){var n=rr(i,1),a=n[0];t.checks.push({type:Le.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:cw,populate:function(e,t,i){var n=rr(i,1),a=n[0];t.checks.push({type:Le.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+He.id+")",populate:function(e,t,i){var n=rr(i,1),a=n[0];t.checks.push({type:Le.ID,value:ti(a)})}},{name:"className",query:!0,regex:"\\.("+He.className+")",populate:function(e,t,i){var n=rr(i,1),a=n[0];t.checks.push({type:Le.CLASS,value:ti(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+He.variable+")\\s*\\]",populate:function(e,t,i){var n=rr(i,1),a=n[0];t.checks.push({type:Le.DATA_EXIST,field:ti(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+He.variable+")\\s*("+He.comparatorOp+")\\s*("+He.value+")\\s*\\]",populate:function(e,t,i){var n=rr(i,3),a=n[0],o=n[1],s=n[2],l=new RegExp("^"+He.string+"$").exec(s)!=null;l?s=s.substring(1,s.length-1):s=parseFloat(s),t.checks.push({type:Le.DATA_COMPARE,field:ti(a),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+He.boolOp+")\\s*("+He.variable+")\\s*\\]",populate:function(e,t,i){var n=rr(i,2),a=n[0],o=n[1];t.checks.push({type:Le.DATA_BOOL,field:ti(o),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+He.meta+")\\s*("+He.comparatorOp+")\\s*("+He.number+")\\s*\\]\\]",populate:function(e,t,i){var n=rr(i,3),a=n[0],o=n[1],s=n[2];t.checks.push({type:Le.META_COMPARE,field:ti(a),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:He.separator,populate:function(e,t){var i=e.currentSubject,n=e.edgeCount,a=e.compoundCount,o=e[e.length-1];i!=null&&(o.subject=i,e.currentSubject=null),o.edgeCount=n,o.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var s=e[e.length++]=Qe();return s}},{name:"directedEdge",separator:!0,regex:He.directedEdge,populate:function(e,t){if(e.currentSubject==null){var i=Qe(),n=t,a=Qe();return i.checks.push({type:Le.DIRECTED_EDGE,source:n,target:a}),yr(e,t,i),e.edgeCount++,a}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Le.NODE_SOURCE,source:s,target:l}),yr(e,t,o),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:He.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var i=Qe(),n=t,a=Qe();return i.checks.push({type:Le.UNDIRECTED_EDGE,nodes:[n,a]}),yr(e,t,i),e.edgeCount++,a}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Le.NODE_NEIGHBOR,node:s,neighbor:l}),yr(e,t,o),l}}},{name:"child",separator:!0,regex:He.child,populate:function(e,t){if(e.currentSubject==null){var i=Qe(),n=Qe(),a=e[e.length-1];return i.checks.push({type:Le.CHILD,parent:a,child:n}),yr(e,t,i),e.compoundCount++,n}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),h=Qe(),f=Qe();return o.checks.push({type:Le.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Le.TRUE}],f.checks.push({type:Le.TRUE}),l.checks.push({type:Le.PARENT,parent:f,child:h}),yr(e,s,o),e.currentSubject=u,e.compoundCount++,h}else{var d=Qe(),c=Qe(),v=[{type:Le.PARENT,parent:d,child:c}];return d.checks=t.checks,t.checks=v,e.compoundCount++,c}}},{name:"descendant",separator:!0,regex:He.descendant,populate:function(e,t){if(e.currentSubject==null){var i=Qe(),n=Qe(),a=e[e.length-1];return i.checks.push({type:Le.DESCENDANT,ancestor:a,descendant:n}),yr(e,t,i),e.compoundCount++,n}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),h=Qe(),f=Qe();return o.checks.push({type:Le.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Le.TRUE}],f.checks.push({type:Le.TRUE}),l.checks.push({type:Le.ANCESTOR,ancestor:f,descendant:h}),yr(e,s,o),e.currentSubject=u,e.compoundCount++,h}else{var d=Qe(),c=Qe(),v=[{type:Le.ANCESTOR,ancestor:d,descendant:c}];return d.checks=t.checks,t.checks=v,e.compoundCount++,c}}},{name:"subject",modifier:!0,regex:He.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return Xe("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var i=e[e.length-1],n=i.checks[0],a=n==null?null:n.type;a===Le.DIRECTED_EDGE?n.type=Le.NODE_TARGET:a===Le.UNDIRECTED_EDGE&&(n.type=Le.NODE_NEIGHBOR,n.node=n.nodes[1],n.neighbor=n.nodes[0],n.nodes=null)}}];io.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var dw=function(e){for(var t,i,n,a=0;a<io.length;a++){var o=io[a],s=o.name,l=e.match(o.regexObj);if(l!=null){i=l,t=o,n=s;var u=l[0];e=e.substring(u.length);break}}return{expr:t,match:i,name:n,remaining:e}},vw=function(e){var t=e.match(/^\s+/);if(t){var i=t[0];e=e.substring(i.length)}return e},gw=function(e){var t=this,i=t.inputText=e,n=t[0]=Qe();for(t.length=1,i=vw(i);;){var a=dw(i);if(a.expr==null)return Xe("The selector `"+e+"`is invalid"),!1;var o=a.match.slice(1),s=a.expr.populate(t,n,o);if(s===!1)return!1;if(s!=null&&(n=s),i=a.remaining,i.match(/^\s*$/))break}var l=t[t.length-1];t.currentSubject!=null&&(l.subject=t.currentSubject),l.edgeCount=t.edgeCount,l.compoundCount=t.compoundCount;for(var u=0;u<t.length;u++){var h=t[u];if(h.compoundCount>0&&h.edgeCount>0)return Xe("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(h.edgeCount>1)return Xe("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;h.edgeCount===1&&Xe("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},pw=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(h){return h==null?"":h},t=function(h){return Ne(h)?'"'+h+'"':e(h)},i=function(h){return" "+h+" "},n=function(h,f){var d=h.type,c=h.value;switch(d){case Le.GROUP:{var v=e(c);return v.substring(0,v.length-1)}case Le.DATA_COMPARE:{var g=h.field,m=h.operator;return"["+g+i(e(m))+t(c)+"]"}case Le.DATA_BOOL:{var p=h.operator,y=h.field;return"["+e(p)+y+"]"}case Le.DATA_EXIST:{var w=h.field;return"["+w+"]"}case Le.META_COMPARE:{var T=h.operator,O=h.field;return"[["+O+i(e(T))+t(c)+"]]"}case Le.STATE:return c;case Le.ID:return"#"+c;case Le.CLASS:return"."+c;case Le.PARENT:case Le.CHILD:return a(h.parent,f)+i(">")+a(h.child,f);case Le.ANCESTOR:case Le.DESCENDANT:return a(h.ancestor,f)+" "+a(h.descendant,f);case Le.COMPOUND_SPLIT:{var I=a(h.left,f),R=a(h.subject,f),L=a(h.right,f);return I+(I.length>0?" ":"")+R+L}case Le.TRUE:return""}},a=function(h,f){return h.checks.reduce(function(d,c,v){return d+(f===h&&v===0?"$":"")+n(c,f)},"")},o="",s=0;s<this.length;s++){var l=this[s];o+=a(l,l.subject),this.length>1&&s<this.length-1&&(o+=", ")}return this.toStringCache=o,o},mw={parse:gw,toString:pw},Qu=function(e,t,i){var n,a=Ne(e),o=Se(e),s=Ne(i),l,u,h=!1,f=!1,d=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),f=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),h=!0),(a||s||h)&&(l=!a&&!o?"":""+e,u=""+i),h&&(e=l=l.toLowerCase(),i=u=u.toLowerCase()),t){case"*=":n=l.indexOf(u)>=0;break;case"$=":n=l.indexOf(u,l.length-u.length)>=0;break;case"^=":n=l.indexOf(u)===0;break;case"=":n=e===i;break;case">":d=!0,n=e>i;break;case">=":d=!0,n=e>=i;break;case"<":d=!0,n=e<i;break;case"<=":d=!0,n=e<=i;break;default:n=!1;break}return f&&(e!=null||!d)&&(n=!n),n},yw=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},ww=function(e){return e!==void 0},Ao=function(e,t){return e.data(t)},Ew=function(e,t){return e[t]()},st=[],tt=function(e,t){return e.checks.every(function(i){return st[i.type](i,t)})};st[Le.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};st[Le.STATE]=function(r,e){var t=r.value;return fw(t,e)};st[Le.ID]=function(r,e){var t=r.value;return e.id()===t};st[Le.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};st[Le.META_COMPARE]=function(r,e){var t=r.field,i=r.operator,n=r.value;return Qu(Ew(e,t),i,n)};st[Le.DATA_COMPARE]=function(r,e){var t=r.field,i=r.operator,n=r.value;return Qu(Ao(e,t),i,n)};st[Le.DATA_BOOL]=function(r,e){var t=r.field,i=r.operator;return yw(Ao(e,t),i)};st[Le.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,ww(Ao(e,t))};st[Le.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],i=r.nodes[1],n=e.source(),a=e.target();return tt(t,n)&&tt(i,a)||tt(i,n)&&tt(t,a)};st[Le.NODE_NEIGHBOR]=function(r,e){return tt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&tt(r.neighbor,t)})};st[Le.DIRECTED_EDGE]=function(r,e){return tt(r.source,e.source())&&tt(r.target,e.target())};st[Le.NODE_SOURCE]=function(r,e){return tt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&tt(r.target,t)})};st[Le.NODE_TARGET]=function(r,e){return tt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&tt(r.source,t)})};st[Le.CHILD]=function(r,e){return tt(r.child,e)&&tt(r.parent,e.parent())};st[Le.PARENT]=function(r,e){return tt(r.parent,e)&&e.children().some(function(t){return tt(r.child,t)})};st[Le.DESCENDANT]=function(r,e){return tt(r.descendant,e)&&e.ancestors().some(function(t){return tt(r.ancestor,t)})};st[Le.ANCESTOR]=function(r,e){return tt(r.ancestor,e)&&e.descendants().some(function(t){return tt(r.descendant,t)})};st[Le.COMPOUND_SPLIT]=function(r,e){return tt(r.subject,e)&&tt(r.left,e)&&tt(r.right,e)};st[Le.TRUE]=function(){return!0};st[Le.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};st[Le.FILTER]=function(r,e){var t=r.value;return t(e)};var Tw=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===Le.ID)return e.getElementById(t[0].checks[0].value).collection();var i=function(a){for(var o=0;o<t.length;o++){var s=t[o];if(tt(s,a))return!0}return!1};return t.text()==null&&(i=function(){return!0}),e.filter(i)},bw=function(e){for(var t=this,i=0;i<t.length;i++){var n=t[i];if(tt(n,e))return!0}return!1},xw={matches:bw,filter:Tw},Mr=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Ne(e)&&e.match(/^\s*$/)||(_t(e)?this.addQuery({checks:[{type:Le.COLLECTION,value:e.collection()}]}):nt(e)?this.addQuery({checks:[{type:Le.FILTER,value:e}]}):Ne(e)?this.parse(e)||(this.invalid=!0):at("A selector must be created from a string; found "))},Nr=Mr.prototype;[mw,xw].forEach(function(r){return _e(Nr,r)});Nr.text=function(){return this.inputText};Nr.size=function(){return this.length};Nr.eq=function(r){return this[r]};Nr.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};Nr.addQuery=function(r){this[this.length++]=r};Nr.selector=Nr.toString;var Rr={allAre:function(e){var t=new Mr(e);return this.every(function(i){return t.matches(i)})},is:function(e){var t=new Mr(e);return this.some(function(i){return t.matches(i)})},some:function(e,t){for(var i=0;i<this.length;i++){var n=t?e.apply(t,[this[i],i,this]):e(this[i],i,this);if(n)return!0}return!1},every:function(e,t){for(var i=0;i<this.length;i++){var n=t?e.apply(t,[this[i],i,this]):e(this[i],i,this);if(!n)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,i=e.length;return t!==i?!1:t===1?this[0]===e[0]:this.every(function(n){return e.hasElementWithId(n.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(i){return t.hasElementWithId(i.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(i){return t.hasElementWithId(i.id())})}};Rr.allAreNeighbours=Rr.allAreNeighbors;Rr.has=Rr.contains;Rr.equal=Rr.equals=Rr.same;var Ut=function(e,t){return function(n,a,o,s){var l=n,u=this,h;if(l==null?h="":_t(l)&&l.length===1&&(h=l.id()),u.length===1&&h){var f=u[0]._private,d=f.traversalCache=f.traversalCache||{},c=d[t]=d[t]||[],v=Gr(h),g=c[v];return g||(c[v]=e.call(u,n,a,o,s))}else return e.call(u,n,a,o,s)}},yi={parent:function(e){var t=[];if(this.length===1){var i=this[0]._private.parent;if(i)return i}for(var n=0;n<this.length;n++){var a=this[n],o=a._private.parent;o&&t.push(o)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],i=this.parent();i.nonempty();){for(var n=0;n<i.length;n++){var a=i[n];t.push(a)}i=i.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,i=0;i<this.length;i++){var n=this[i],a=n.parents();t=t||a,t=t.intersect(a)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:Ut(function(r){for(var e=[],t=0;t<this.length;t++)for(var i=this[t],n=i._private.children,a=0;a<n.length;a++)e.push(n[a]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function i(n){for(var a=0;a<n.length;a++){var o=n[a];t.push(o),o.children().nonempty()&&i(o.children())}}return i(this.children()),this.spawn(t,!0).filter(e)}};function _o(r,e,t,i){for(var n=[],a=new xi,o=r.cy(),s=o.hasCompoundNodes(),l=0;l<r.length;l++){var u=r[l];t?n.push(u):s&&i(n,a,u)}for(;n.length>0;){var h=n.shift();e(h),a.add(h.id()),s&&i(n,a,h)}return r}function ju(r,e,t){if(t.isParent())for(var i=t._private.children,n=0;n<i.length;n++){var a=i[n];e.has(a.id())||r.push(a)}}yi.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return _o(this,r,e,ju)};function Ju(r,e,t){if(t.isChild()){var i=t._private.parent;e.has(i.id())||r.push(i)}}yi.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return _o(this,r,e,Ju)};function Sw(r,e,t){Ju(r,e,t),ju(r,e,t)}yi.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return _o(this,r,e,Sw)};yi.ancestors=yi.parents;var Qi,$u;Qi=$u={data:Ye.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Ye.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Ye.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ye.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Ye.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Ye.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Qi.attr=Qi.data;Qi.removeAttr=Qi.removeData;var Cw=$u,pa={};function Ha(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var i=0,n=t[0],a=n._private.edges,o=0;o<a.length;o++){var s=a[o];!e&&s.isLoop()||(i+=r(n,s))}return i}else return}}_e(pa,{degree:Ha(function(r,e){return e.source().same(e.target())?2:1}),indegree:Ha(function(r,e){return e.target().same(r)?1:0}),outdegree:Ha(function(r,e){return e.source().same(r)?1:0})});function ri(r,e){return function(t){for(var i,n=this.nodes(),a=0;a<n.length;a++){var o=n[a],s=o[r](t);s!==void 0&&(i===void 0||e(s,i))&&(i=s)}return i}}_e(pa,{minDegree:ri("degree",function(r,e){return r<e}),maxDegree:ri("degree",function(r,e){return r>e}),minIndegree:ri("indegree",function(r,e){return r<e}),maxIndegree:ri("indegree",function(r,e){return r>e}),minOutdegree:ri("outdegree",function(r,e){return r<e}),maxOutdegree:ri("outdegree",function(r,e){return r>e})});_e(pa,{totalDegree:function(e){for(var t=0,i=this.nodes(),n=0;n<i.length;n++)t+=i[n].degree(e);return t}});var qt,eh,th=function(e,t,i){for(var n=0;n<e.length;n++){var a=e[n];if(!a.locked()){var o=a._private.position,s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};a.isParent()&&!(s.x===0&&s.y===0)&&a.children().shift(s,i),a.dirtyBoundingBoxCache()}}},Gs={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){th(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};qt=eh={position:Ye.data(Gs),silentPosition:Ye.data(_e({},Gs,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){th(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(Ue(e))t?this.silentPosition(e):this.position(e);else if(nt(e)){var i=e,n=this.cy();n.startBatch();for(var a=0;a<this.length;a++){var o=this[a],s=void 0;(s=i(o,a))&&(t?o.silentPosition(s):o.position(s))}n.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,i){var n;if(Ue(e)?(n={x:Se(e.x)?e.x:0,y:Se(e.y)?e.y:0},i=t):Ne(e)&&Se(t)&&(n={x:0,y:0},n[e]=t),n!=null){var a=this.cy();a.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(a.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var l=s.position(),u={x:l.x+n.x,y:l.y+n.y};i?s.silentPosition(u):s.position(u)}}a.endBatch()}return this},silentShift:function(e,t){return Ue(e)?this.shift(e,!0):Ne(e)&&Se(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var i=this[0],n=this.cy(),a=n.zoom(),o=n.pan(),s=Ue(e)?e:void 0,l=s!==void 0||t!==void 0&&Ne(e);if(i&&i.isNode())if(l)for(var u=0;u<this.length;u++){var h=this[u];t!==void 0?h.position(e,(t-o[e])/a):s!==void 0&&h.position(Iu(s,a,o))}else{var f=i.position();return s=va(f,a,o),e===void 0?s:s[e]}else if(!l)return;return this},relativePosition:function(e,t){var i=this[0],n=this.cy(),a=Ue(e)?e:void 0,o=a!==void 0||t!==void 0&&Ne(e),s=n.hasCompoundNodes();if(i&&i.isNode())if(o)for(var l=0;l<this.length;l++){var u=this[l],h=s?u.parent():null,f=h&&h.length>0,d=f;f&&(h=h[0]);var c=d?h.position():{x:0,y:0};t!==void 0?u.position(e,t+c[e]):a!==void 0&&u.position({x:a.x+c.x,y:a.y+c.y})}else{var v=i.position(),g=s?i.parent():null,m=g&&g.length>0,p=m;m&&(g=g[0]);var y=p?g.position():{x:0,y:0};return a={x:v.x-y.x,y:v.y-y.y},e===void 0?a:a[e]}else if(!o)return;return this}};qt.modelPosition=qt.point=qt.position;qt.modelPositions=qt.points=qt.positions;qt.renderedPoint=qt.renderedPosition;qt.relativePoint=qt.relativePosition;var Dw=eh,vi,Ar;vi=Ar={};Ar.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),i=t.zoom(),n=t.pan(),a=e.x1*i+n.x,o=e.x2*i+n.x,s=e.y1*i+n.y,l=e.y2*i+n.y;return{x1:a,x2:o,y1:s,y2:l,w:o-a,h:l-s}};Ar.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var i=t._private;i.compoundBoundsClean=!1,i.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};Ar.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(o){if(!o.isParent())return;var s=o._private,l=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",h={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),d=s.position;(f.w===0||f.h===0)&&(f={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},f.x1=d.x-f.w/2,f.x2=d.x+f.w/2,f.y1=d.y-f.h/2,f.y2=d.y+f.h/2);function c(N,E,C){var b=0,M=0,D=E+C;return N>0&&D>0&&(b=E/D*N,M=C/D*N),{biasDiff:b,biasComplementDiff:M}}function v(N,E,C,b){if(C.units==="%")switch(b){case"width":return N>0?C.pfValue*N:0;case"height":return E>0?C.pfValue*E:0;case"average":return N>0&&E>0?C.pfValue*(N+E)/2:0;case"min":return N>0&&E>0?N>E?C.pfValue*E:C.pfValue*N:0;case"max":return N>0&&E>0?N>E?C.pfValue*N:C.pfValue*E:0;default:return 0}else return C.units==="px"?C.pfValue:0}var g=h.width.left.value;h.width.left.units==="px"&&h.width.val>0&&(g=g*100/h.width.val);var m=h.width.right.value;h.width.right.units==="px"&&h.width.val>0&&(m=m*100/h.width.val);var p=h.height.top.value;h.height.top.units==="px"&&h.height.val>0&&(p=p*100/h.height.val);var y=h.height.bottom.value;h.height.bottom.units==="px"&&h.height.val>0&&(y=y*100/h.height.val);var w=c(h.width.val-f.w,g,m),T=w.biasDiff,O=w.biasComplementDiff,I=c(h.height.val-f.h,p,y),R=I.biasDiff,L=I.biasComplementDiff;s.autoPadding=v(f.w,f.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(f.w,h.width.val),d.x=(-T+f.x1+f.x2+O)/2,s.autoHeight=Math.max(f.h,h.height.val),d.y=(-R+f.y1+f.y2+L)/2}for(var i=0;i<this.length;i++){var n=this[i],a=n._private;(!a.compoundBoundsClean||r)&&(t(n),e.batching()||(a.compoundBoundsClean=!0))}return this};var Ht=function(e){return e===1/0||e===-1/0?0:e},Vt=function(e,t,i,n,a){n-t===0||a-i===0||t==null||i==null||n==null||a==null||(e.x1=t<e.x1?t:e.x1,e.x2=n>e.x2?n:e.x2,e.y1=i<e.y1?i:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},kr=function(e,t){return t==null?e:Vt(e,t.x1,t.y1,t.x2,t.y2)},Ii=function(e,t,i){return Wt(e,t,i)},Rn=function(e,t,i){if(!t.cy().headless()){var n=t._private,a=n.rstyle,o=a.arrowWidth/2,s=t.pstyle(i+"-arrow-shape").value,l,u;if(s!=="none"){i==="source"?(l=a.srcX,u=a.srcY):i==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var h=n.arrowBounds=n.arrowBounds||{},f=h[i]=h[i]||{};f.x1=l-o,f.y1=u-o,f.x2=l+o,f.y2=u+o,f.w=f.x2-f.x1,f.h=f.y2-f.y1,An(f,1),Vt(e,f.x1,f.y1,f.x2,f.y2)}}},Ua=function(e,t,i){if(!t.cy().headless()){var n;i?n=i+"-":n="";var a=t._private,o=a.rstyle,s=t.pstyle(n+"label").strValue;if(s){var l=t.pstyle("text-halign"),u=t.pstyle("text-valign"),h=Ii(o,"labelWidth",i),f=Ii(o,"labelHeight",i),d=Ii(o,"labelX",i),c=Ii(o,"labelY",i),v=t.pstyle(n+"text-margin-x").pfValue,g=t.pstyle(n+"text-margin-y").pfValue,m=t.isEdge(),p=t.pstyle(n+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,w=t.pstyle("text-border-width").pfValue,T=w/2,O=t.pstyle("text-background-padding").pfValue,I=2,R=f,L=h,N=L/2,E=R/2,C,b,M,D;if(m)C=d-N,b=d+N,M=c-E,D=c+E;else{switch(l.value){case"left":C=d-L,b=d;break;case"center":C=d-N,b=d+N;break;case"right":C=d,b=d+L;break}switch(u.value){case"top":M=c-R,D=c;break;case"center":M=c-E,D=c+E;break;case"bottom":M=c,D=c+R;break}}C+=v-Math.max(y,T)-O-I,b+=v+Math.max(y,T)+O+I,M+=g-Math.max(y,T)-O-I,D+=g+Math.max(y,T)+O+I;var H=i||"main",k=a.labelBounds,B=k[H]=k[H]||{};B.x1=C,B.y1=M,B.x2=b,B.y2=D,B.w=b-C,B.h=D-M;var U=m&&p.strValue==="autorotate",W=p.pfValue!=null&&p.pfValue!==0;if(U||W){var J=U?Ii(a.rstyle,"labelAngle",i):p.pfValue,G=Math.cos(J),X=Math.sin(J),ie=(C+b)/2,ee=(M+D)/2;if(!m){switch(l.value){case"left":ie=b;break;case"right":ie=C;break}switch(u.value){case"top":ee=D;break;case"bottom":ee=M;break}}var q=function(Oe,ce){return Oe=Oe-ie,ce=ce-ee,{x:Oe*G-ce*X+ie,y:Oe*X+ce*G+ee}},$=q(C,M),V=q(C,D),re=q(b,M),ae=q(b,D);C=Math.min($.x,V.x,re.x,ae.x),b=Math.max($.x,V.x,re.x,ae.x),M=Math.min($.y,V.y,re.y,ae.y),D=Math.max($.y,V.y,re.y,ae.y)}var de=H+"Rot",ye=k[de]=k[de]||{};ye.x1=C,ye.y1=M,ye.x2=b,ye.y2=D,ye.w=b-C,ye.h=D-M,Vt(e,C,M,b,D),Vt(a.labelBounds.all,C,M,b,D)}return e}},Rw=function(e,t){var i=e._private.cy,n=i.styleEnabled(),a=i.headless(),o=It(),s=e._private,l=e.isNode(),u=e.isEdge(),h,f,d,c,v,g,m=s.rstyle,p=l&&n?e.pstyle("bounds-expansion").pfValue:[0],y=function(z){return z.pstyle("display").value!=="none"},w=!n||y(e)&&(!u||y(e.source())&&y(e.target()));if(w){var T=0,O=0;n&&t.includeOverlays&&(T=e.pstyle("overlay-opacity").value,T!==0&&(O=e.pstyle("overlay-padding").value));var I=0,R=0;n&&t.includeUnderlays&&(I=e.pstyle("underlay-opacity").value,I!==0&&(R=e.pstyle("underlay-padding").value));var L=Math.max(O,R),N=0,E=0;if(n&&(N=e.pstyle("width").pfValue,E=N/2),l&&t.includeNodes){var C=e.position();v=C.x,g=C.y;var b=e.outerWidth(),M=b/2,D=e.outerHeight(),H=D/2;h=v-M,f=v+M,d=g-H,c=g+H,Vt(o,h,d,f,c)}else if(u&&t.includeEdges)if(n&&!a){var k=e.pstyle("curve-style").strValue;if(h=Math.min(m.srcX,m.midX,m.tgtX),f=Math.max(m.srcX,m.midX,m.tgtX),d=Math.min(m.srcY,m.midY,m.tgtY),c=Math.max(m.srcY,m.midY,m.tgtY),h-=E,f+=E,d-=E,c+=E,Vt(o,h,d,f,c),k==="haystack"){var B=m.haystackPts;if(B&&B.length===2){if(h=B[0].x,d=B[0].y,f=B[1].x,c=B[1].y,h>f){var U=h;h=f,f=U}if(d>c){var W=d;d=c,c=W}Vt(o,h-E,d-E,f+E,c+E)}}else if(k==="bezier"||k==="unbundled-bezier"||k==="segments"||k==="taxi"){var J;switch(k){case"bezier":case"unbundled-bezier":J=m.bezierPts;break;case"segments":case"taxi":J=m.linePts;break}if(J!=null)for(var G=0;G<J.length;G++){var X=J[G];h=X.x-E,f=X.x+E,d=X.y-E,c=X.y+E,Vt(o,h,d,f,c)}}}else{var ie=e.source(),ee=ie.position(),q=e.target(),$=q.position();if(h=ee.x,f=$.x,d=ee.y,c=$.y,h>f){var V=h;h=f,f=V}if(d>c){var re=d;d=c,c=re}h-=E,f+=E,d-=E,c+=E,Vt(o,h,d,f,c)}if(n&&t.includeEdges&&u&&(Rn(o,e,"mid-source"),Rn(o,e,"mid-target"),Rn(o,e,"source"),Rn(o,e,"target")),n){var ae=e.pstyle("ghost").value==="yes";if(ae){var de=e.pstyle("ghost-offset-x").pfValue,ye=e.pstyle("ghost-offset-y").pfValue;Vt(o,o.x1+de,o.y1+ye,o.x2+de,o.y2+ye)}}var Te=s.bodyBounds=s.bodyBounds||{};Ds(Te,o),Ba(Te,p),An(Te,1),n&&(h=o.x1,f=o.x2,d=o.y1,c=o.y2,Vt(o,h-L,d-L,f+L,c+L));var Oe=s.overlayBounds=s.overlayBounds||{};Ds(Oe,o),Ba(Oe,p),An(Oe,1);var ce=s.labelBounds=s.labelBounds||{};ce.all!=null?e0(ce.all):ce.all=It(),n&&t.includeLabels&&(t.includeMainLabels&&Ua(o,e,null),u&&(t.includeSourceLabels&&Ua(o,e,"source"),t.includeTargetLabels&&Ua(o,e,"target")))}return o.x1=Ht(o.x1),o.y1=Ht(o.y1),o.x2=Ht(o.x2),o.y2=Ht(o.y2),o.w=Ht(o.x2-o.x1),o.h=Ht(o.y2-o.y1),o.w>0&&o.h>0&&w&&(Ba(o,p),An(o,1)),o},rh=function(e){var t=0,i=function(o){return(o?1:0)<<t++},n=0;return n+=i(e.incudeNodes),n+=i(e.includeEdges),n+=i(e.includeLabels),n+=i(e.includeMainLabels),n+=i(e.includeSourceLabels),n+=i(e.includeTargetLabels),n+=i(e.includeOverlays),n},ih=function(e){if(e.isEdge()){var t=e.source().position(),i=e.target().position(),n=function(o){return Math.round(o)};return by([n(t.x),n(t.y),n(i.x),n(i.y)])}else return 0},Vs=function(e,t){var i=e._private,n,a=e.isEdge(),o=t==null?Ws:rh(t),s=o===Ws,l=ih(e),u=i.bbCachePosKey===l,h=t.useCache&&u,f=function(g){return g._private.bbCache==null||g._private.styleDirty},d=!h||f(e)||a&&f(e.source())||f(e.target());if(d?(u||e.recalculateRenderedStyle(h),n=Rw(e,ji),i.bbCache=n,i.bbCachePosKey=l):n=i.bbCache,!s){var c=e.isNode();n=It(),(t.includeNodes&&c||t.includeEdges&&!c)&&(t.includeOverlays?kr(n,i.overlayBounds):kr(n,i.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?kr(n,i.labelBounds.all):(t.includeMainLabels&&kr(n,i.labelBounds.mainRot),t.includeSourceLabels&&kr(n,i.labelBounds.sourceRot),t.includeTargetLabels&&kr(n,i.labelBounds.targetRot))),n.w=n.x2-n.x1,n.h=n.y2-n.y1}return n},ji={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,useCache:!0},Ws=rh(ji),qs=Et(ji);Ar.boundingBox=function(r){var e;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(r===void 0||r.useCache===void 0||r.useCache===!0))r===void 0?r=ji:r=qs(r),e=Vs(this[0],r);else{e=It(),r=r||ji;var t=qs(r),i=this,n=i.cy(),a=n.styleEnabled();if(a)for(var o=0;o<i.length;o++){var s=i[o],l=s._private,u=ih(s),h=l.bbCachePosKey===u,f=t.useCache&&h&&!l.styleDirty;s.recalculateRenderedStyle(f)}this.updateCompoundBounds(!r.useCache);for(var d=0;d<i.length;d++){var c=i[d];kr(e,Vs(c,t))}}return e.x1=Ht(e.x1),e.y1=Ht(e.y1),e.x2=Ht(e.x2),e.y2=Ht(e.y2),e.w=Ht(e.x2-e.x1),e.h=Ht(e.y2-e.y1),e};Ar.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Ar.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),i=t.hasCompoundNodes(),n=t.collection();if(i&&(n=e.filter(function(u){return u.isParent()}),e=e.not(n)),Ue(r)){var a=r;r=function(){return a}}var o=function(h,f){return h._private.bbAtOldPos=r(h,f)},s=function(h){return h._private.bbAtOldPos};t.startBatch(),e.forEach(o).silentPositions(r),i&&(n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),n.updateCompoundBounds(!0));var l=$y(this.boundingBox({useCache:!1}));return e.silentPositions(s),i&&(n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),n.updateCompoundBounds(!0)),t.endBatch(),l};vi.boundingbox=vi.bb=vi.boundingBox;vi.renderedBoundingbox=vi.renderedBoundingBox;var Pw=Ar,ki,fn;ki=fn={};var nh=function(e){e.uppercaseName=bs(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=bs(e.outerName),ki[e.name]=function(){var i=this[0],n=i._private,a=n.cy,o=a._private.styleEnabled;if(i)if(o){if(i.isParent())return i.updateCompoundBounds(),n[e.autoName]||0;var s=i.pstyle(e.name);switch(s.strValue){case"label":return i.recalculateRenderedStyle(),n.rstyle[e.labelName]||0;default:return s.pfValue}}else return 1},ki["outer"+e.uppercaseName]=function(){var i=this[0],n=i._private,a=n.cy,o=a._private.styleEnabled;if(i)if(o){var s=i[e.name](),l=i.pstyle("border-width").pfValue,u=2*i.padding();return s+l+u}else return 1},ki["rendered"+e.uppercaseName]=function(){var i=this[0];if(i){var n=i[e.name]();return n*this.cy().zoom()}},ki["rendered"+e.uppercaseOuterName]=function(){var i=this[0];if(i){var n=i[e.outerName]();return n*this.cy().zoom()}}};nh({name:"width"});nh({name:"height"});fn.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};fn.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};fn.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var Lw=fn,Ow=function(e,t){if(e.isEdge())return t(e)},Mw=function(e,t){if(e.isEdge()){var i=e.cy();return va(t(e),i.zoom(),i.pan())}},Nw=function(e,t){if(e.isEdge()){var i=e.cy(),n=i.pan(),a=i.zoom();return t(e).map(function(o){return va(o,a,n)})}},Iw=function(e){return e.renderer().getControlPoints(e)},Aw=function(e){return e.renderer().getSegmentPoints(e)},_w=function(e){return e.renderer().getSourceEndpoint(e)},Fw=function(e){return e.renderer().getTargetEndpoint(e)},Bw=function(e){return e.renderer().getEdgeMidpoint(e)},Ys={controlPoints:{get:Iw,mult:!0},segmentPoints:{get:Aw,mult:!0},sourceEndpoint:{get:_w},targetEndpoint:{get:Fw},midpoint:{get:Bw}},kw=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},zw=Object.keys(Ys).reduce(function(r,e){var t=Ys[e],i=kw(e);return r[e]=function(){return Ow(this,t.get)},t.mult?r[i]=function(){return Nw(this,t.get)}:r[i]=function(){return Mw(this,t.get)},r},{}),Hw=_e({},Dw,Pw,Lw,zw);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var ah=function(e,t){this.recycle(e,t)};function Ai(){return!1}function Pn(){return!0}ah.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ai,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Pn:Ai):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var i=this.position,n=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:i.x*n+a.x,y:i.y*n+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Pn;var e=this.originalEvent;!e||e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Pn;var e=this.originalEvent;!e||e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Pn,this.stopPropagation()},isDefaultPrevented:Ai,isPropagationStopped:Ai,isImmediatePropagationStopped:Ai};var oh=/^([^.]+)(\.(?:[^.]+))?$/,Uw=".*",sh={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Xs=Object.keys(sh),Gw={};function ma(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gw,e=arguments.length>1?arguments[1]:void 0,t=0;t<Xs.length;t++){var i=Xs[t];this[i]=r[i]||sh[i]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Ir=ma.prototype,lh=function(e,t,i,n,a,o,s){nt(n)&&(a=n,n=null),s&&(o==null?o=s:o=_e({},o,s));for(var l=je(i)?i:i.split(/\s+/),u=0;u<l.length;u++){var h=l[u];if(!Lr(h)){var f=h.match(oh);if(f){var d=f[1],c=f[2]?f[2]:null,v=t(e,h,d,c,n,a,o);if(v===!1)break}}}},Zs=function(e,t){return e.addEventFields(e.context,t),new ah(t.type,t)},Vw=function(e,t,i){if(ry(i)){t(e,i);return}else if(Ue(i)){t(e,Zs(e,i));return}for(var n=je(i)?i:i.split(/\s+/),a=0;a<n.length;a++){var o=n[a];if(!Lr(o)){var s=o.match(oh);if(s){var l=s[1],u=s[2]?s[2]:null,h=Zs(e,{type:l,namespace:u,target:e.context});t(e,h)}}}};Ir.on=Ir.addListener=function(r,e,t,i,n){return lh(this,function(a,o,s,l,u,h,f){nt(h)&&a.listeners.push({event:o,callback:h,type:s,namespace:l,qualifier:u,conf:f})},r,e,t,i,n),this};Ir.one=function(r,e,t,i){return this.on(r,e,t,i,{one:!0})};Ir.removeListener=Ir.off=function(r,e,t,i){var n=this;this.emitting!==0&&(this.listeners=Ry(this.listeners));for(var a=this.listeners,o=function(u){var h=a[u];lh(n,function(f,d,c,v,g,m){if((h.type===c||r==="*")&&(!v&&h.namespace!==".*"||h.namespace===v)&&(!g||f.qualifierCompare(h.qualifier,g))&&(!m||h.callback===m))return a.splice(u,1),!1},r,e,t,i)},s=a.length-1;s>=0;s--)o(s);return this};Ir.removeAllListeners=function(){return this.removeListener("*")};Ir.emit=Ir.trigger=function(r,e,t){var i=this.listeners,n=i.length;return this.emitting++,je(e)||(e=[e]),Vw(this,function(a,o){t!=null&&(i=[{event:o.event,type:o.type,namespace:o.namespace,callback:t}],n=i.length);for(var s=function(h){var f=i[h];if(f.type===o.type&&(!f.namespace||f.namespace===o.namespace||f.namespace===Uw)&&a.eventMatches(a.context,f,o)){var d=[o];e!=null&&Ly(d,e),a.beforeEmit(a.context,f,o),f.conf&&f.conf.one&&(a.listeners=a.listeners.filter(function(g){return g!==f}));var c=a.callbackContext(a.context,f,o),v=f.callback.apply(c,d);a.afterEmit(a.context,f,o),v===!1&&(o.stopPropagation(),o.preventDefault())}},l=0;l<n;l++)s(l);a.bubble(a.context)&&!o.isPropagationStopped()&&a.parent(a.context).emit(o,e)},r),this.emitting--,this};var Ww={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,i){var n=t.qualifier;return n!=null?e!==i.target&&un(i.target)&&n.matches(i.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,i){return t.qualifier!=null?i.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Ln=function(e){return Ne(e)?new Mr(e):e},uh={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],i=t._private;i.emitter||(i.emitter=new ma(Ww,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,i){for(var n=Ln(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,n,i)}return this},removeListener:function(e,t,i){for(var n=Ln(t),a=0;a<this.length;a++){var o=this[a];o.emitter().removeListener(e,n,i)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,i){for(var n=Ln(t),a=0;a<this.length;a++){var o=this[a];o.emitter().one(e,n,i)}return this},once:function(e,t,i){for(var n=Ln(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,n,i,{once:!0,onceCollection:this})}},emit:function(e,t){for(var i=0;i<this.length;i++){var n=this[i];n.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};Ye.eventAliasesOn(uh);var hh={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),i=0;i<this.length;i++){var n=this[i];n.isNode()?e.push(n):t.push(n)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(Ne(e)||_t(e))return new Mr(e).filter(this);if(nt(e)){for(var i=this.spawn(),n=this,a=0;a<n.length;a++){var o=n[a],s=t?e.apply(t,[o,a,n]):e(o,a,n);s&&i.push(o)}return i}return this.spawn()},not:function(e){if(e){Ne(e)&&(e=this.filter(e));for(var t=this.spawn(),i=0;i<this.length;i++){var n=this[i],a=e.has(n);a||t.push(n)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Ne(e)){var t=e;return this.filter(t)}for(var i=this.spawn(),n=this,a=e,o=this.length<e.length,s=o?n:a,l=o?a:n,u=0;u<s.length;u++){var h=s[u];l.has(h)&&i.push(h)}return i},xor:function(e){var t=this._private.cy;Ne(e)&&(e=t.$(e));var i=this.spawn(),n=this,a=e,o=function(l,u){for(var h=0;h<l.length;h++){var f=l[h],d=f._private.data.id,c=u.hasElementWithId(d);c||i.push(f)}};return o(n,a),o(a,n),i},diff:function(e){var t=this._private.cy;Ne(e)&&(e=t.$(e));var i=this.spawn(),n=this.spawn(),a=this.spawn(),o=this,s=e,l=function(h,f,d){for(var c=0;c<h.length;c++){var v=h[c],g=v._private.data.id,m=f.hasElementWithId(g);m?a.merge(v):d.push(v)}};return l(o,s,i),l(s,o,n),{left:i,right:n,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(Ne(e)){var i=e;e=t.mutableElements().filter(i)}for(var n=this.spawnSelf(),a=0;a<e.length;a++){var o=e[a],s=!this.has(o);s&&n.push(o)}return n},merge:function(e){var t=this._private,i=t.cy;if(!e)return this;if(e&&Ne(e)){var n=e;e=i.mutableElements().filter(n)}for(var a=t.map,o=0;o<e.length;o++){var s=e[o],l=s._private.data.id,u=!a.has(l);if(u){var h=this.length++;this[h]=s,a.set(l,{ele:s,index:h})}}return this},unmergeAt:function(e){var t=this[e],i=t.id(),n=this._private,a=n.map;this[e]=void 0,a.delete(i);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1,l=this[s],u=l._private.data.id;this[s]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,i=e._private.data.id,n=t.map,a=n.get(i);if(!a)return this;var o=a.index;return this.unmergeAt(o),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&Ne(e)){var i=e;e=t.mutableElements().filter(i)}for(var n=0;n<e.length;n++)this.unmergeOne(e[n]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var i=this[t];e(i)&&this.unmergeAt(t)}return this},map:function(e,t){for(var i=[],n=this,a=0;a<n.length;a++){var o=n[a],s=t?e.apply(t,[o,a,n]):e(o,a,n);i.push(s)}return i},reduce:function(e,t){for(var i=t,n=this,a=0;a<n.length;a++)i=e(i,n[a],a,n);return i},max:function(e,t){for(var i=-1/0,n,a=this,o=0;o<a.length;o++){var s=a[o],l=t?e.apply(t,[s,o,a]):e(s,o,a);l>i&&(i=l,n=s)}return{value:i,ele:n}},min:function(e,t){for(var i=1/0,n,a=this,o=0;o<a.length;o++){var s=a[o],l=t?e.apply(t,[s,o,a]):e(s,o,a);l<i&&(i=l,n=s)}return{value:i,ele:n}}},Ve=hh;Ve.u=Ve["|"]=Ve["+"]=Ve.union=Ve.or=Ve.add;Ve["\\"]=Ve["!"]=Ve["-"]=Ve.difference=Ve.relativeComplement=Ve.subtract=Ve.not;Ve.n=Ve["&"]=Ve["."]=Ve.and=Ve.intersection=Ve.intersect;Ve["^"]=Ve["(+)"]=Ve["(-)"]=Ve.symmetricDifference=Ve.symdiff=Ve.xor;Ve.fnFilter=Ve.filterFn=Ve.stdFilter=Ve.filter;Ve.complement=Ve.abscomp=Ve.absoluteComplement;var qw={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},fh=function(e,t){var i=e.cy(),n=i.hasCompoundNodes();function a(h){var f=h.pstyle("z-compound-depth");return f.value==="auto"?n?h.zDepth():0:f.value==="bottom"?-1:f.value==="top"?Ro:0}var o=a(e)-a(t);if(o!==0)return o;function s(h){var f=h.pstyle("z-index-compare");return f.value==="auto"&&h.isNode()?1:0}var l=s(e)-s(t);if(l!==0)return l;var u=e.pstyle("z-index").value-t.pstyle("z-index").value;return u!==0?u:e.poolIndex()-t.poolIndex()},Zn={forEach:function(e,t){if(nt(e))for(var i=this.length,n=0;n<i;n++){var a=this[n],o=t?e.apply(t,[a,n,this]):e(a,n,this);if(o===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var i=[],n=this.length;t==null&&(t=n),e==null&&(e=0),e<0&&(e=n+e),t<0&&(t=n+t);for(var a=e;a>=0&&a<t&&a<n;a++)i.push(this[a]);return this.spawn(i)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!nt(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(fh)},zDepth:function(){var e=this[0];if(!!e){var t=e._private,i=t.group;if(i==="nodes"){var n=t.data.parent?e.parents().size():0;return e.isParent()?n:Ro-1}else{var a=t.source,o=t.target,s=a.zDepth(),l=o.zDepth();return Math.max(s,l,0)}}}};Zn.each=Zn.forEach;var Yw=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":dt(Symbol))!=e&&dt(Symbol.iterator)!=e;t&&(Zn[Symbol.iterator]=function(){var i=this,n={value:void 0,done:!1},a=0,o=this.length;return mu({next:function(){return a<o?n.value=i[a++]:(n.value=void 0,n.done=!0),n}},Symbol.iterator,function(){return this})})};Yw();var Xw=Et({nodeDimensionsIncludeLabels:!1}),Fn={layoutDimensions:function(e){e=Xw(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var i=this.boundingBox();t={w:i.w,h:i.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,i){var n=this.nodes().filter(function(O){return!O.isParent()}),a=this.cy(),o=t.eles,s=function(I){return I.id()},l=Wi(i,s);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(I,R,L){var N={x:R.x1+R.w/2,y:R.y1+R.h/2},E={x:(L.x-N.x)*I,y:(L.y-N.y)*I};return{x:N.x+E.x,y:N.y+E.y}},h=t.spacingFactor&&t.spacingFactor!==1,f=function(){if(!h)return null;for(var I=It(),R=0;R<n.length;R++){var L=n[R],N=l(L,R);r0(I,N.x,N.y)}return I},d=f(),c=Wi(function(O,I){var R=l(O,I);if(h){var L=Math.abs(t.spacingFactor);R=u(L,d,R)}return t.transform!=null&&(R=t.transform(O,R)),R},s);if(t.animate){for(var v=0;v<n.length;v++){var g=n[v],m=c(g,v),p=t.animateFilter==null||t.animateFilter(g,v);if(p){var y=g.animation({position:m,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else g.position(m)}if(t.fit){var w=a.animation({fit:{boundingBox:o.boundingBoxAt(c),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(w)}else if(t.zoom!==void 0&&t.pan!==void 0){var T=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(T)}e.animations.forEach(function(O){return O.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Si.all(e.animations.map(function(O){return O.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else n.positions(c),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(_e({},e,{eles:this}))}};Fn.createLayout=Fn.makeLayout=Fn.layout;function ch(r,e,t){var i=t._private,n=i.styleCache=i.styleCache||[],a;return(a=n[r])!=null||(a=n[r]=e(t)),a}function ya(r,e){return r=Gr(r),function(i){return ch(r,e,i)}}function wa(r,e){r=Gr(r);var t=function(n){return e.call(n)};return function(){var n=this[0];if(n)return ch(r,t,n)}}var yt={recalculateRenderedStyle:function(e){var t=this.cy(),i=t.renderer(),n=t.styleEnabled();return i&&n&&i.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var i;i=this.spawnSelf().merge(this.descendants()).merge(this.parents()),i.merge(i.connectedEdges()),i.forEach(t)}else this.forEach(function(n){t(n),n.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var i=t._private.batchStyleEles;return i.merge(this),this}var n=t.hasCompoundNodes(),a=this;e=!!(e||e===void 0),n&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=a;return e?o.emitAndNotify("style"):o.emit("style"),a.forEach(function(s){return s._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(!!e.styleEnabled())for(var t=0;t<this.length;t++){var i=this[t];i._private.styleDirty&&(i._private.styleDirty=!1,e.style().apply(i))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this[0],n=i.cy();if(!!n.styleEnabled()&&i){this.cleanStyle();var a=i._private.style[e];return a!=null?a:t?n.style().getDefaultProperty(e):null}},numericStyle:function(e){var t=this[0];if(!!t.cy().styleEnabled()&&t){var i=t.pstyle(e);return i.pfValue!==void 0?i.pfValue:i.value}},numericStyleUnits:function(e){var t=this[0];if(!!t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var i=this[0];if(i)return t.style().getRenderedStyle(i,e)},style:function(e,t){var i=this.cy();if(!i.styleEnabled())return this;var n=!1,a=i.style();if(Ue(e)){var o=e;a.applyBypass(this,o,n),this.emitAndNotify("style")}else if(Ne(e))if(t===void 0){var s=this[0];return s?a.getStylePropertyValue(s,e):void 0}else a.applyBypass(this,e,t,n),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var i=!1,n=t.style(),a=this;if(e===void 0)for(var o=0;o<a.length;o++){var s=a[o];n.removeAllBypasses(s,i)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];n.removeBypasses(u,e,i)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),i=this[0];if(i){var n=i._private,a=i.pstyle("opacity").value;if(!t)return a;var o=n.data.parent?i.parents():null;if(o)for(var s=0;s<o.length;s++){var l=o[s],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],i=t.cy().hasCompoundNodes();if(t)return i?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function Ga(r,e){var t=r._private,i=t.data.parent?r.parents():null;if(i)for(var n=0;n<i.length;n++){var a=i[n];if(!e(a))return!1}return!0}function Fo(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,i=r.parentOk||r.ok;return function(){var n=this.cy();if(!n.styleEnabled())return!0;var a=this[0],o=n.hasCompoundNodes();if(a){var s=a._private;if(!e(a))return!1;if(a.isNode())return!o||Ga(a,i);var l=s.source,u=s.target;return t(l)&&(!o||Ga(l,t))&&(l===u||t(u)&&(!o||Ga(u,t)))}}}var Ci=ya("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});yt.takesUpSpace=wa("takesUpSpace",Fo({ok:Ci}));var Zw=ya("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&Ci(r)}),Kw=ya("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&Ci(r)});yt.interactive=wa("interactive",Fo({ok:Zw,parentOk:Kw,edgeOkViaNode:Ci}));yt.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var Qw=ya("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&Ci(r)}),jw=Ci;yt.visible=wa("visible",Fo({ok:Qw,edgeOkViaNode:jw}));yt.hidden=function(){var r=this[0];if(r)return!r.visible()};yt.isBundledBezier=wa("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});yt.bypass=yt.css=yt.style;yt.renderedCss=yt.renderedStyle;yt.removeBypass=yt.removeCss=yt.removeStyle;yt.pstyle=yt.parsedStyle;var Pr={};function Ks(r){return function(){var e=arguments,t=[];if(e.length===2){var i=e[0],n=e[1];this.on(r.event,i,n)}else if(e.length===1&&nt(e[0])){var a=e[0];this.on(r.event,a)}else if(e.length===0||e.length===1&&je(e[0])){for(var o=e.length===1?e[0]:null,s=0;s<this.length;s++){var l=this[s],u=!r.ableField||l._private[r.ableField],h=l._private[r.field]!=r.value;if(r.overrideAble){var f=r.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[r.field]=r.value,h&&t.push(l))}var d=this.spawn(t);d.updateStyle(),d.emit(r.event),o&&d.emit(o)}return this}}function Di(r){Pr[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},Pr[r.on]=Ks({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),Pr[r.off]=Ks({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Di({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Di({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Di({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Di({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Pr.deselect=Pr.unselect;Pr.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Di({field:"active",on:"activate",off:"unactivate"});Di({field:"pannable",on:"panify",off:"unpanify"});Pr.inactive=function(){var r=this[0];if(r)return!r._private.active};var Ct={},Qs=function(e){return function(i){for(var n=this,a=[],o=0;o<n.length;o++){var s=n[o];if(!!s.isNode()){for(var l=!1,u=s.connectedEdges(),h=0;h<u.length;h++){var f=u[h],d=f.source(),c=f.target();if(e.noIncomingEdges&&c===s&&d!==s||e.noOutgoingEdges&&d===s&&c!==s){l=!0;break}}l||a.push(s)}}return this.spawn(a,!0).filter(i)}},js=function(e){return function(t){for(var i=this,n=[],a=0;a<i.length;a++){var o=i[a];if(!!o.isNode())for(var s=o.connectedEdges(),l=0;l<s.length;l++){var u=s[l],h=u.source(),f=u.target();e.outgoing&&h===o?(n.push(u),n.push(f)):e.incoming&&f===o&&(n.push(u),n.push(h))}}return this.spawn(n,!0).filter(t)}},Js=function(e){return function(t){for(var i=this,n=[],a={};;){var o=e.outgoing?i.outgoers():i.incomers();if(o.length===0)break;for(var s=!1,l=0;l<o.length;l++){var u=o[l],h=u.id();a[h]||(a[h]=!0,n.push(u),s=!0)}if(!s)break;i=o}return this.spawn(n,!0).filter(t)}};Ct.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};_e(Ct,{roots:Qs({noIncomingEdges:!0}),leaves:Qs({noOutgoingEdges:!0}),outgoers:Ut(js({outgoing:!0}),"outgoers"),successors:Js({outgoing:!0}),incomers:Ut(js({incoming:!0}),"incomers"),predecessors:Js({incoming:!0})});_e(Ct,{neighborhood:Ut(function(r){for(var e=[],t=this.nodes(),i=0;i<t.length;i++)for(var n=t[i],a=n.connectedEdges(),o=0;o<a.length;o++){var s=a[o],l=s.source(),u=s.target(),h=n===l?u:l;h.length>0&&e.push(h[0]),e.push(s[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Ct.neighbourhood=Ct.neighborhood;Ct.closedNeighbourhood=Ct.closedNeighborhood;Ct.openNeighbourhood=Ct.openNeighborhood;_e(Ct,{source:Ut(function(e){var t=this[0],i;return t&&(i=t._private.source||t.cy().collection()),i&&e?i.filter(e):i},"source"),target:Ut(function(e){var t=this[0],i;return t&&(i=t._private.target||t.cy().collection()),i&&e?i.filter(e):i},"target"),sources:$s({attr:"source"}),targets:$s({attr:"target"})});function $s(r){return function(t){for(var i=[],n=0;n<this.length;n++){var a=this[n],o=a._private[r.attr];o&&i.push(o)}return this.spawn(i,!0).filter(t)}}_e(Ct,{edgesWith:Ut(el(),"edgesWith"),edgesTo:Ut(el({thisIsSrc:!0}),"edgesTo")});function el(r){return function(t){var i=[],n=this._private.cy,a=r||{};Ne(t)&&(t=n.$(t));for(var o=0;o<t.length;o++)for(var s=t[o]._private.edges,l=0;l<s.length;l++){var u=s[l],h=u._private.data,f=this.hasElementWithId(h.source)&&t.hasElementWithId(h.target),d=t.hasElementWithId(h.source)&&this.hasElementWithId(h.target),c=f||d;!c||(a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!f||a.thisIsTgt&&!d)||i.push(u)}return this.spawn(i,!0)}}_e(Ct,{connectedEdges:Ut(function(r){for(var e=[],t=this,i=0;i<t.length;i++){var n=t[i];if(!!n.isNode())for(var a=n._private.edges,o=0;o<a.length;o++){var s=a[o];e.push(s)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:Ut(function(r){for(var e=[],t=this,i=0;i<t.length;i++){var n=t[i];!n.isEdge()||(e.push(n.source()[0]),e.push(n.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:Ut(tl(),"parallelEdges"),codirectedEdges:Ut(tl({codirected:!0}),"codirectedEdges")});function tl(r){var e={codirected:!1};return r=_e({},e,r),function(i){for(var n=[],a=this.edges(),o=r,s=0;s<a.length;s++)for(var l=a[s],u=l._private,h=u.source,f=h._private.data.id,d=u.data.target,c=h._private.edges,v=0;v<c.length;v++){var g=c[v],m=g._private.data,p=m.target,y=m.source,w=p===d&&y===f,T=f===p&&d===y;(o.codirected&&w||!o.codirected&&(w||T))&&n.push(g)}return this.spawn(n,!0).filter(i)}}_e(Ct,{components:function(e){var t=this,i=t.cy(),n=i.collection(),a=e==null?t.nodes():e.nodes(),o=[];e!=null&&a.empty()&&(a=e.sources());var s=function(h,f){n.merge(h),a.unmerge(h),f.merge(h)};if(a.empty())return t.spawn();var l=function(){var h=i.collection();o.push(h);var f=a[0];s(f,h),t.bfs({directed:!1,roots:f,visit:function(c){return s(c,h)}}),h.forEach(function(d){d.connectedEdges().forEach(function(c){t.has(c)&&h.has(c.source())&&h.has(c.target())&&h.merge(c)})})};do l();while(a.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Ct.componentsOf=Ct.components;var wt=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){at("A collection must have a reference to the core");return}var a=new Kt,o=!1;if(!t)t=[];else if(t.length>0&&Ue(t[0])&&!un(t[0])){o=!0;for(var s=[],l=new xi,u=0,h=t.length;u<h;u++){var f=t[u];f.data==null&&(f.data={});var d=f.data;if(d.id==null)d.id=Mu();else if(e.hasElementWithId(d.id)||l.has(d.id))continue;var c=new da(e,f,!1);s.push(c),l.add(d.id)}t=s}this.length=0;for(var v=0,g=t.length;v<g;v++){var m=t[v][0];if(m!=null){var p=m._private.data.id;(!i||!a.has(p))&&(i&&a.set(p,{index:this.length,ele:m}),this[this.length]=m,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var w=this.lazyMap=new Kt,T=this.eles,O=0;O<T.length;O++){var I=T[O];w.set(I.id(),{index:O,ele:I})}}},i&&(this._private.map=a),o&&!n&&this.restore()},$e=da.prototype=wt.prototype=Object.create(Array.prototype);$e.instanceString=function(){return"collection"};$e.spawn=function(r,e){return new wt(this.cy(),r,e)};$e.spawnSelf=function(){return this.spawn(this)};$e.cy=function(){return this._private.cy};$e.renderer=function(){return this._private.cy.renderer()};$e.element=function(){return this[0]};$e.collection=function(){return wu(this)?this:new wt(this._private.cy,[this])};$e.unique=function(){return new wt(this._private.cy,this,!0)};$e.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};$e.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new wt(e)};$e.$id=$e.getElementById;$e.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};$e.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};$e.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};$e.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var i=e._private;if(Ue(r)){if(t.startBatch(),r.data){e.data(r.data);var n=i.data;if(e.isEdge()){var a=!1,o={},s=r.data.source,l=r.data.target;s!=null&&s!=n.source&&(o.source=""+s,a=!0),l!=null&&l!=n.target&&(o.target=""+l,a=!0),a&&(e=e.move(o))}else{var u="parent"in r.data,h=r.data.parent;u&&(h!=null||n.parent!=null)&&h!=n.parent&&(h===void 0&&(h=null),h!=null&&(h=""+h),e=e.move({parent:h}))}}r.position&&e.position(r.position);var f=function(g,m,p){var y=r[g];y!=null&&y!==i[g]&&(y?e[m]():e[p]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var d={data:Zt(i.data),position:Zt(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};d.classes="";var c=0;return i.classes.forEach(function(v){return d.classes+=c++===0?v:" "+v}),d}}};$e.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],i=t.json();r.push(i)}return r};$e.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var i=this[t],n=i.json(),a=new da(r,n,!1);e.push(a)}return new wt(r,e)};$e.copy=$e.clone;$e.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,i=t.cy(),n=i._private,a=[],o=[],s,l=0,u=t.length;l<u;l++){var h=t[l];e&&!h.removed()||(h.isNode()?a.push(h):o.push(h))}s=a.concat(o);var f,d=function(){s.splice(f,1),f--};for(f=0;f<s.length;f++){var c=s[f],v=c._private,g=v.data;if(c.clearTraversalCache(),!(!e&&!v.removed)){if(g.id===void 0)g.id=Mu();else if(Se(g.id))g.id=""+g.id;else if(Lr(g.id)||!Ne(g.id)){at("Can not create element with invalid string ID `"+g.id+"`"),d();continue}else if(i.hasElementWithId(g.id)){at("Can not create second element with ID `"+g.id+"`"),d();continue}}var m=g.id;if(c.isNode()){var p=v.position;p.x==null&&(p.x=0),p.y==null&&(p.y=0)}if(c.isEdge()){for(var y=c,w=["source","target"],T=w.length,O=!1,I=0;I<T;I++){var R=w[I],L=g[R];Se(L)&&(L=g[R]=""+g[R]),L==null||L===""?(at("Can not create edge `"+m+"` with unspecified "+R),O=!0):i.hasElementWithId(L)||(at("Can not create edge `"+m+"` with nonexistant "+R+" `"+L+"`"),O=!0)}if(O){d();continue}var N=i.getElementById(g.source),E=i.getElementById(g.target);N.same(E)?N._private.edges.push(y):(N._private.edges.push(y),E._private.edges.push(y)),y._private.source=N,y._private.target=E}v.map=new Kt,v.map.set(m,{ele:c,index:0}),v.removed=!1,e&&i.addToPool(c)}for(var C=0;C<a.length;C++){var b=a[C],M=b._private.data;Se(M.parent)&&(M.parent=""+M.parent);var D=M.parent,H=D!=null;if(H||b._private.parent){var k=b._private.parent?i.collection().merge(b._private.parent):i.getElementById(D);if(k.empty())M.parent=void 0;else if(k[0].removed())Xe("Node added with missing parent, reference to parent removed"),M.parent=void 0,b._private.parent=null;else{for(var B=!1,U=k;!U.empty();){if(b.same(U)){B=!0,M.parent=void 0;break}U=U.parent()}B||(k[0]._private.children.push(b),b._private.parent=k[0],n.hasCompoundNodes=!0)}}}if(s.length>0){for(var W=s.length===t.length?t:new wt(i,s),J=0;J<W.length;J++){var G=W[J];G.isNode()||(G.parallelEdges().clearTraversalCache(),G.source().clearTraversalCache(),G.target().clearTraversalCache())}var X;n.hasCompoundNodes?X=i.collection().merge(W).merge(W.connectedNodes()).merge(W.parent()):X=W,X.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?W.emitAndNotify("add"):e&&W.emit("add")}return t};$e.removed=function(){var r=this[0];return r&&r._private.removed};$e.inside=function(){var r=this[0];return r&&!r._private.removed};$e.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,i=[],n={},a=t._private.cy;function o(D){for(var H=D._private.edges,k=0;k<H.length;k++)l(H[k])}function s(D){for(var H=D._private.children,k=0;k<H.length;k++)l(H[k])}function l(D){var H=n[D.id()];e&&D.removed()||H||(n[D.id()]=!0,D.isNode()?(i.push(D),o(D),s(D)):i.unshift(D))}for(var u=0,h=t.length;u<h;u++){var f=t[u];l(f)}function d(D,H){var k=D._private.edges;Or(k,H),D.clearTraversalCache()}function c(D){D.clearTraversalCache()}var v=[];v.ids={};function g(D,H){H=H[0],D=D[0];var k=D._private.children,B=D.id();Or(k,H),H._private.parent=null,v.ids[B]||(v.ids[B]=!0,v.push(D))}t.dirtyCompoundBoundsCache(),e&&a.removeFromPool(i);for(var m=0;m<i.length;m++){var p=i[m];if(p.isEdge()){var y=p.source()[0],w=p.target()[0];d(y,p),d(w,p);for(var T=p.parallelEdges(),O=0;O<T.length;O++){var I=T[O];c(I),I.isBundledBezier()&&I.dirtyBoundingBoxCache()}}else{var R=p.parent();R.length!==0&&g(R,p)}e&&(p._private.removed=!0)}var L=a._private.elements;a._private.hasCompoundNodes=!1;for(var N=0;N<L.length;N++){var E=L[N];if(E.isParent()){a._private.hasCompoundNodes=!0;break}}var C=new wt(this.cy(),i);C.size()>0&&(r?C.emitAndNotify("remove"):e&&C.emit("remove"));for(var b=0;b<v.length;b++){var M=v[b];(!e||!M.removed())&&M.updateStyle()}return C};$e.move=function(r){var e=this._private.cy,t=this,i=!1,n=!1,a=function(v){return v==null?v:""+v};if(r.source!==void 0||r.target!==void 0){var o=a(r.source),s=a(r.target),l=o!=null&&e.hasElementWithId(o),u=s!=null&&e.hasElementWithId(s);(l||u)&&(e.batch(function(){t.remove(i,n),t.emitAndNotify("moveout");for(var c=0;c<t.length;c++){var v=t[c],g=v._private.data;v.isEdge()&&(l&&(g.source=o),u&&(g.target=s))}t.restore(i,n)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var h=a(r.parent),f=h===null||e.hasElementWithId(h);if(f){var d=h===null?void 0:h;e.batch(function(){var c=t.remove(i,n);c.emitAndNotify("moveout");for(var v=0;v<t.length;v++){var g=t[v],m=g._private.data;g.isNode()&&(m.parent=d)}c.restore(i,n)}),t.emitAndNotify("move")}}return this};[qu,uw,_n,Rr,yi,Cw,pa,Hw,uh,hh,qw,Zn,Fn,yt,Pr,Ct].forEach(function(r){_e($e,r)});var Jw={add:function(e){var t,i=this;if(_t(e)){var n=e;if(n._private.cy===i)t=n.restore();else{for(var a=[],o=0;o<n.length;o++){var s=n[o];a.push(s.json())}t=new wt(i,a)}}else if(je(e)){var l=e;t=new wt(i,l)}else if(Ue(e)&&(je(e.nodes)||je(e.edges))){for(var u=e,h=[],f=["nodes","edges"],d=0,c=f.length;d<c;d++){var v=f[d],g=u[v];if(je(g))for(var m=0,p=g.length;m<p;m++){var y=_e({group:v},g[m]);h.push(y)}}t=new wt(i,h)}else{var w=e;t=new da(i,w).collection()}return t},remove:function(e){if(!_t(e)){if(Ne(e)){var t=e;e=this.$(t)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function $w(r,e,t,i){var n=4,a=.001,o=1e-7,s=10,l=11,u=1/(l-1),h=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var d=h?new Float32Array(l):new Array(l);function c(E,C){return 1-3*C+3*E}function v(E,C){return 3*C-6*E}function g(E){return 3*E}function m(E,C,b){return((c(C,b)*E+v(C,b))*E+g(C))*E}function p(E,C,b){return 3*c(C,b)*E*E+2*v(C,b)*E+g(C)}function y(E,C){for(var b=0;b<n;++b){var M=p(C,r,t);if(M===0)return C;var D=m(C,r,t)-E;C-=D/M}return C}function w(){for(var E=0;E<l;++E)d[E]=m(E*u,r,t)}function T(E,C,b){var M,D,H=0;do D=C+(b-C)/2,M=m(D,r,t)-E,M>0?b=D:C=D;while(Math.abs(M)>o&&++H<s);return D}function O(E){for(var C=0,b=1,M=l-1;b!==M&&d[b]<=E;++b)C+=u;--b;var D=(E-d[b])/(d[b+1]-d[b]),H=C+D*u,k=p(H,r,t);return k>=a?y(E,H):k===0?H:T(E,C,C+u)}var I=!1;function R(){I=!0,(r!==e||t!==i)&&w()}var L=function(C){return I||R(),r===e&&t===i?C:C===0?0:C===1?1:m(O(C),e,i)};L.getControlPoints=function(){return[{x:r,y:e},{x:t,y:i}]};var N="generateBezier("+[r,e,t,i]+")";return L.toString=function(){return N},L}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var eE=function(){function r(i){return-i.tension*i.x-i.friction*i.v}function e(i,n,a){var o={x:i.x+a.dx*n,v:i.v+a.dv*n,tension:i.tension,friction:i.friction};return{dx:o.v,dv:r(o)}}function t(i,n){var a={dx:i.v,dv:r(i)},o=e(i,n*.5,a),s=e(i,n*.5,o),l=e(i,n,s),u=1/6*(a.dx+2*(o.dx+s.dx)+l.dx),h=1/6*(a.dv+2*(o.dv+s.dv)+l.dv);return i.x=i.x+u*n,i.v=i.v+h*n,i}return function i(n,a,o){var s={x:-1,v:0,tension:null,friction:null},l=[0],u=0,h=1/1e4,f=16/1e3,d,c,v;for(n=parseFloat(n)||500,a=parseFloat(a)||20,o=o||null,s.tension=n,s.friction=a,d=o!==null,d?(u=i(n,a),c=u/o*f):c=f;v=t(v||s,c),l.push(1+v.x),u+=16,Math.abs(v.x)>h&&Math.abs(v.v)>h;);return d?function(g){return l[g*(l.length-1)|0]}:u}}(),Je=function(e,t,i,n){var a=$w(e,t,i,n);return function(o,s,l){return o+(s-o)*a(l)}},Bn={linear:function(e,t,i){return e+(t-e)*i},ease:Je(.25,.1,.25,1),"ease-in":Je(.42,0,1,1),"ease-out":Je(0,0,.58,1),"ease-in-out":Je(.42,0,.58,1),"ease-in-sine":Je(.47,0,.745,.715),"ease-out-sine":Je(.39,.575,.565,1),"ease-in-out-sine":Je(.445,.05,.55,.95),"ease-in-quad":Je(.55,.085,.68,.53),"ease-out-quad":Je(.25,.46,.45,.94),"ease-in-out-quad":Je(.455,.03,.515,.955),"ease-in-cubic":Je(.55,.055,.675,.19),"ease-out-cubic":Je(.215,.61,.355,1),"ease-in-out-cubic":Je(.645,.045,.355,1),"ease-in-quart":Je(.895,.03,.685,.22),"ease-out-quart":Je(.165,.84,.44,1),"ease-in-out-quart":Je(.77,0,.175,1),"ease-in-quint":Je(.755,.05,.855,.06),"ease-out-quint":Je(.23,1,.32,1),"ease-in-out-quint":Je(.86,0,.07,1),"ease-in-expo":Je(.95,.05,.795,.035),"ease-out-expo":Je(.19,1,.22,1),"ease-in-out-expo":Je(1,0,0,1),"ease-in-circ":Je(.6,.04,.98,.335),"ease-out-circ":Je(.075,.82,.165,1),"ease-in-out-circ":Je(.785,.135,.15,.86),spring:function(e,t,i){if(i===0)return Bn.linear;var n=eE(e,t,i);return function(a,o,s){return a+(o-a)*n(s)}},"cubic-bezier":Je};function rl(r,e,t,i,n){if(i===1||e===t)return t;var a=n(e,t,i);return r==null||((r.roundValue||r.color)&&(a=Math.round(a)),r.min!==void 0&&(a=Math.max(a,r.min)),r.max!==void 0&&(a=Math.min(a,r.max))),a}function il(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function ii(r,e,t,i,n){var a=n!=null?n.type:null;t<0?t=0:t>1&&(t=1);var o=il(r,n),s=il(e,n);if(Se(o)&&Se(s))return rl(a,o,s,t,i);if(je(o)&&je(s)){for(var l=[],u=0;u<s.length;u++){var h=o[u],f=s[u];if(h!=null&&f!=null){var d=rl(a,h,f,t,i);l.push(d)}else l.push(f)}return l}}function tE(r,e,t,i){var n=!i,a=r._private,o=e._private,s=o.easing,l=o.startTime,u=i?r:r.cy(),h=u.style();if(!o.easingImpl)if(s==null)o.easingImpl=Bn.linear;else{var f;if(Ne(s)){var d=h.parse("transition-timing-function",s);f=d.value}else f=s;var c,v;Ne(f)?(c=f,v=[]):(c=f[1],v=f.slice(2).map(function(W){return+W})),v.length>0?(c==="spring"&&v.push(o.duration),o.easingImpl=Bn[c].apply(null,v)):o.easingImpl=Bn[c]}var g=o.easingImpl,m;if(o.duration===0?m=1:m=(t-l)/o.duration,o.applying&&(m=o.progress),m<0?m=0:m>1&&(m=1),o.delay==null){var p=o.startPosition,y=o.position;if(y&&n&&!r.locked()){var w={};_i(p.x,y.x)&&(w.x=ii(p.x,y.x,m,g)),_i(p.y,y.y)&&(w.y=ii(p.y,y.y,m,g)),r.position(w)}var T=o.startPan,O=o.pan,I=a.pan,R=O!=null&&i;R&&(_i(T.x,O.x)&&(I.x=ii(T.x,O.x,m,g)),_i(T.y,O.y)&&(I.y=ii(T.y,O.y,m,g)),r.emit("pan"));var L=o.startZoom,N=o.zoom,E=N!=null&&i;E&&(_i(L,N)&&(a.zoom=Zi(a.minZoom,ii(L,N,m,g),a.maxZoom)),r.emit("zoom")),(R||E)&&r.emit("viewport");var C=o.style;if(C&&C.length>0&&n){for(var b=0;b<C.length;b++){var M=C[b],D=M.name,H=M,k=o.startStyle[D],B=h.properties[k.name],U=ii(k,H,m,g,B);h.overrideBypass(r,D,U)}r.emit("style")}}return o.progress=m,m}function _i(r,e){return r==null||e==null?!1:Se(r)&&Se(e)?!0:!!(r&&e)}function rE(r,e,t,i){var n=e._private;n.started=!0,n.startTime=t-n.progress*n.duration}function nl(r,e){var t=e._private.aniEles,i=[];function n(h,f){var d=h._private,c=d.animation.current,v=d.animation.queue,g=!1;if(c.length===0){var m=v.shift();m&&c.push(m)}for(var p=function(I){for(var R=I.length-1;R>=0;R--){var L=I[R];L()}I.splice(0,I.length)},y=c.length-1;y>=0;y--){var w=c[y],T=w._private;if(T.stopped){c.splice(y,1),T.hooked=!1,T.playing=!1,T.started=!1,p(T.frames);continue}!T.playing&&!T.applying||(T.playing&&T.applying&&(T.applying=!1),T.started||rE(h,w,r),tE(h,w,r,f),T.applying&&(T.applying=!1),p(T.frames),T.step!=null&&T.step(r),w.completed()&&(c.splice(y,1),T.hooked=!1,T.playing=!1,T.started=!1,p(T.completes)),g=!0)}return!f&&c.length===0&&v.length===0&&i.push(h),g}for(var a=!1,o=0;o<t.length;o++){var s=t[o],l=n(s);a=a||l}var u=n(e,!0);(a||u)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(i),e.emit("step")}var iE={animate:Ye.animate(),animation:Ye.animation(),animated:Ye.animated(),clearQueue:Ye.clearQueue(),delay:Ye.delay(),delayAnimation:Ye.delayAnimation(),stop:Ye.stop(),addToAnimationPool:function(e){var t=this;!t.styleEnabled()||t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){!e._private.animationsRunning||qn(function(a){nl(a,e),t()})}var i=e.renderer();i&&i.beforeRender?i.beforeRender(function(a,o){nl(o,e)},i.beforeRenderPriorities.animations):t()}},nE={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,i){var n=t.qualifier;return n!=null?e!==i.target&&un(i.target)&&n.matches(i.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,i){return t.qualifier!=null?i.target:e}},On=function(e){return Ne(e)?new Mr(e):e},dh={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new ma(nE,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,i){return this.emitter().on(e,On(t),i),this},removeListener:function(e,t,i){return this.emitter().removeListener(e,On(t),i),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,i){return this.emitter().one(e,On(t),i),this},once:function(e,t,i){return this.emitter().one(e,On(t),i),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Ye.eventAliasesOn(dh);var no={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};no.jpeg=no.jpg;var kn={layout:function(e){var t=this;if(e==null){at("Layout options must be specified to make a layout");return}if(e.name==null){at("A `name` must be specified to make a layout");return}var i=e.name,n=t.extension("layout",i);if(n==null){at("No such layout `"+i+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Ne(e.eles)?a=t.$(e.eles):a=e.eles!=null?e.eles:t.$();var o=new n(_e({},e,{cy:t,eles:a}));return o}};kn.createLayout=kn.makeLayout=kn.layout;var aE={notify:function(e,t){var i=this._private;if(this.batching()){i.batchNotifications=i.batchNotifications||{};var n=i.batchNotifications[e]=i.batchNotifications[e]||this.collection();t!=null&&n.merge(t);return}if(!!i.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(i){var n=e.batchNotifications[i];n.empty()?t.notify(i):t.notify(i,n)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var i=Object.keys(e),n=0;n<i.length;n++){var a=i[n],o=e[a],s=t.getElementById(a);s.data(o)}})}},oE=Et({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),ao={renderTo:function(e,t,i,n){var a=this._private.renderer;return a.renderTo(e,t,i,n),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,i=t.extension("renderer",e.name);if(i==null){at("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Xe("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var n=oE(e);n.cy=t,t._private.renderer=new i(n),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(i){var n=i._private;n.rscratch={},n.rstyle={},n.animation.current=[],n.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};ao.invalidateDimensions=ao.resize;var zn={collection:function(e,t){return Ne(e)?this.$(e):_t(e)?e.collection():je(e)?(t||(t={}),new wt(this,e,t.unique,t.removed)):new wt(this)},nodes:function(e){var t=this.$(function(i){return i.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(i){return i.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};zn.elements=zn.filter=zn.$;var Rt={},Ui="t",sE="f";Rt.apply=function(r){for(var e=this,t=e._private,i=t.cy,n=i.collection(),a=0;a<r.length;a++){var o=r[a],s=e.getContextMeta(o);if(!s.empty){var l=e.getContextStyle(s),u=e.applyContextStyle(s,l,o);o._private.appliedInitStyle?e.updateTransitions(o,u.diffProps):o._private.appliedInitStyle=!0;var h=e.updateStyleHints(o);h&&n.push(o)}}return n};Rt.getPropertiesDiff=function(r,e){var t=this,i=t._private.propDiffs=t._private.propDiffs||{},n=r+"-"+e,a=i[n];if(a)return a;for(var o=[],s={},l=0;l<t.length;l++){var u=t[l],h=r[l]===Ui,f=e[l]===Ui,d=h!==f,c=u.mappedProperties.length>0;if(d||f&&c){var v=void 0;d&&c||d?v=u.properties:c&&(v=u.mappedProperties);for(var g=0;g<v.length;g++){for(var m=v[g],p=m.name,y=!1,w=l+1;w<t.length;w++){var T=t[w],O=e[w]===Ui;if(!!O&&(y=T.properties[m.name]!=null,y))break}!s[p]&&!y&&(s[p]=!0,o.push(p))}}}return i[n]=o,o};Rt.getContextMeta=function(r){for(var e=this,t="",i,n=r._private.styleCxtKey||"",a=0;a<e.length;a++){var o=e[a],s=o.selector&&o.selector.matches(r);s?t+=Ui:t+=sE}return i=e.getPropertiesDiff(n,t),r._private.styleCxtKey=t,{key:t,diffPropNames:i,empty:i.length===0}};Rt.getContextStyle=function(r){var e=r.key,t=this,i=this._private.contextStyles=this._private.contextStyles||{};if(i[e])return i[e];for(var n={_private:{key:e}},a=0;a<t.length;a++){var o=t[a],s=e[a]===Ui;if(!!s)for(var l=0;l<o.properties.length;l++){var u=o.properties[l];n[u.name]=u}}return i[e]=n,n};Rt.applyContextStyle=function(r,e,t){for(var i=this,n=r.diffPropNames,a={},o=i.types,s=0;s<n.length;s++){var l=n[s],u=e[l],h=t.pstyle(l);if(!u)if(h)h.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(h!==u){if(u.mapped===o.fn&&h!=null&&h.mapping!=null&&h.mapping.value===u.value){var f=h.mapping,d=f.fnValue=u.value(t);if(d===f.prevFnValue)continue}var c=a[l]={prev:h};i.applyParsedProperty(t,u),c.next=t.pstyle(l),c.next&&c.next.bypass&&(c.next=c.next.bypassed)}}return{diffProps:a}};Rt.updateStyleHints=function(r){var e=r._private,t=this,i=t.propertyGroupNames,n=t.propertyGroupKeys,a=function(de,ye,Te){return t.getPropertiesHash(de,ye,Te)},o=e.styleKey;if(r.removed())return!1;var s=e.group==="nodes",l=r._private.style;i=Object.keys(l);for(var u=0;u<n.length;u++){var h=n[u];e.styleKeys[h]=[si,Fi]}for(var f=function(de,ye){return e.styleKeys[ye][0]=qi(de,e.styleKeys[ye][0])},d=function(de,ye){return e.styleKeys[ye][1]=Yi(de,e.styleKeys[ye][1])},c=function(de,ye){f(de,ye),d(de,ye)},v=function(de,ye){for(var Te=0;Te<de.length;Te++){var Oe=de.charCodeAt(Te);f(Oe,ye),d(Oe,ye)}},g=2e9,m=function(de){return-128<de&&de<128&&Math.floor(de)!==de?g-(de*1024|0):de},p=0;p<i.length;p++){var y=i[p],w=l[y];if(w!=null){var T=this.properties[y],O=T.type,I=T.groupKey,R=void 0;T.hashOverride!=null?R=T.hashOverride(r,w):w.pfValue!=null&&(R=w.pfValue);var L=T.enums==null?w.value:null,N=R!=null,E=L!=null,C=N||E,b=w.units;if(O.number&&C&&!O.multiple){var M=N?R:L;c(m(M),I),!N&&b!=null&&v(b,I)}else v(w.strValue,I)}}for(var D=[si,Fi],H=0;H<n.length;H++){var k=n[H],B=e.styleKeys[k];D[0]=qi(B[0],D[0]),D[1]=Yi(B[1],D[1])}e.styleKey=Ty(D[0],D[1]);var U=e.styleKeys;e.labelDimsKey=mr(U.labelDimensions);var W=a(r,["label"],U.labelDimensions);if(e.labelKey=mr(W),e.labelStyleKey=mr(Tn(U.commonLabel,W)),!s){var J=a(r,["source-label"],U.labelDimensions);e.sourceLabelKey=mr(J),e.sourceLabelStyleKey=mr(Tn(U.commonLabel,J));var G=a(r,["target-label"],U.labelDimensions);e.targetLabelKey=mr(G),e.targetLabelStyleKey=mr(Tn(U.commonLabel,G))}if(s){var X=e.styleKeys,ie=X.nodeBody,ee=X.nodeBorder,q=X.backgroundImage,$=X.compound,V=X.pie,re=[ie,ee,q,$,V].filter(function(ae){return ae!=null}).reduce(Tn,[si,Fi]);e.nodeKey=mr(re),e.hasPie=V!=null&&V[0]!==si&&V[1]!==Fi}return o!==e.styleKey};Rt.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null};Rt.applyParsedProperty=function(r,e){var t=this,i=e,n=r._private.style,a,o=t.types,s=t.properties[i.name].type,l=i.bypass,u=n[i.name],h=u&&u.bypass,f=r._private,d="mapping",c=function(ie){return ie==null?null:ie.pfValue!=null?ie.pfValue:ie.value},v=function(){var ie=c(u),ee=c(i);t.checkTriggers(r,i.name,ie,ee)};if(i&&i.name.substr(0,3)==="pie"&&Xe("The pie style properties are deprecated.  Create charts using background images instead."),e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(i=e=this.parse(e.name,"bezier",l)),i.delete)return n[i.name]=void 0,v(),!0;if(i.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,v(),!0):!1:(v(),!0);if(i.deleteBypass)return u?u.bypass?(n[i.name]=u.bypassed,v(),!0):!1:(v(),!0);var g=function(){Xe("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+i.name+"` with data field `"+i.field+"`); try a `["+i.field+"]` selector to limit scope to elements with `"+i.field+"` defined")};switch(i.mapped){case o.mapData:{for(var m=i.field.split("."),p=f.data,y=0;y<m.length&&p;y++){var w=m[y];p=p[w]}if(p==null)return g(),!1;var T;if(Se(p)){var O=i.fieldMax-i.fieldMin;O===0?T=0:T=(p-i.fieldMin)/O}else return Xe("Do not use continuous mappers without specifying numeric data (i.e. `"+i.field+": "+p+"` for `"+r.id()+"` is non-numeric)"),!1;if(T<0?T=0:T>1&&(T=1),s.color){var I=i.valueMin[0],R=i.valueMax[0],L=i.valueMin[1],N=i.valueMax[1],E=i.valueMin[2],C=i.valueMax[2],b=i.valueMin[3]==null?1:i.valueMin[3],M=i.valueMax[3]==null?1:i.valueMax[3],D=[Math.round(I+(R-I)*T),Math.round(L+(N-L)*T),Math.round(E+(C-E)*T),Math.round(b+(M-b)*T)];a={bypass:i.bypass,name:i.name,value:D,strValue:"rgb("+D[0]+", "+D[1]+", "+D[2]+")"}}else if(s.number){var H=i.valueMin+(i.valueMax-i.valueMin)*T;a=this.parse(i.name,H,i.bypass,d)}else return!1;if(!a)return g(),!1;a.mapping=i,i=a;break}case o.data:{for(var k=i.field.split("."),B=f.data,U=0;U<k.length&&B;U++){var W=k[U];B=B[W]}if(B!=null&&(a=this.parse(i.name,B,i.bypass,d)),!a)return g(),!1;a.mapping=i,i=a;break}case o.fn:{var J=i.value,G=i.fnValue!=null?i.fnValue:J(r);if(i.prevFnValue=G,G==null)return Xe("Custom function mappers may not return null (i.e. `"+i.name+"` for ele `"+r.id()+"` is null)"),!1;if(a=this.parse(i.name,G,i.bypass,d),!a)return Xe("Custom function mappers may not return invalid values for the property type (i.e. `"+i.name+"` for ele `"+r.id()+"` is invalid)"),!1;a.mapping=Zt(i),i=a;break}case void 0:break;default:return!1}return l?(h?i.bypassed=u.bypassed:i.bypassed=u,n[i.name]=i):h?u.bypassed=i:n[i.name]=i,v(),!0};Rt.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var i=r[t];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),!e)i._private.style={};else for(var n=i._private.style,a=Object.keys(n),o=0;o<a.length;o++){var s=a[o],l=n[s];l!=null&&(l.bypass?l.bypassed=null:n[s]=null)}}};Rt.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};Rt.updateTransitions=function(r,e){var t=this,i=r._private,n=r.pstyle("transition-property").value,a=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(n.length>0&&a>0){for(var s={},l=!1,u=0;u<n.length;u++){var h=n[u],f=r.pstyle(h),d=e[h];if(!!d){var c=d.prev,v=c,g=d.next!=null?d.next:f,m=!1,p=void 0,y=1e-6;!v||(Se(v.pfValue)&&Se(g.pfValue)?(m=g.pfValue-v.pfValue,p=v.pfValue+y*m):Se(v.value)&&Se(g.value)?(m=g.value-v.value,p=v.value+y*m):je(v.value)&&je(g.value)&&(m=v.value[0]!==g.value[0]||v.value[1]!==g.value[1]||v.value[2]!==g.value[2],p=v.strValue),m&&(s[h]=g.strValue,this.applyBypass(r,h,p),l=!0))}}if(!l)return;i.transitioning=!0,new Si(function(w){o>0?r.delayAnimation(o).play().promise().then(w):w()}).then(function(){return r.animation({style:s,duration:a,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,n),r.emitAndNotify("style"),i.transitioning=!1})}else i.transitioning&&(this.removeBypasses(r,n),r.emitAndNotify("style"),i.transitioning=!1)};Rt.checkTrigger=function(r,e,t,i,n,a){var o=this.properties[e],s=n(o);s!=null&&s(t,i)&&a(o)};Rt.checkZOrderTrigger=function(r,e,t,i){var n=this;this.checkTrigger(r,e,t,i,function(a){return a.triggersZOrder},function(){n._private.cy.notify("zorder",r)})};Rt.checkBoundsTrigger=function(r,e,t,i){this.checkTrigger(r,e,t,i,function(n){return n.triggersBounds},function(n){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),n.triggersBoundsOfParallelBeziers&&(e==="curve-style"&&(t==="bezier"||i==="bezier")||e==="display"&&(t==="none"||i==="none"))&&r.parallelEdges().forEach(function(a){a.isBundledBezier()&&a.dirtyBoundingBoxCache()})})};Rt.checkTriggers=function(r,e,t,i){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,i),this.checkBoundsTrigger(r,e,t,i)};var cn={};cn.applyBypass=function(r,e,t,i){var n=this,a=[],o=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var s=0;s<n.properties.length;s++){var l=n.properties[s],u=l.name,h=this.parse(u,t,!0);h&&a.push(h)}}else if(Ne(e)){var f=this.parse(e,t,!0);f&&a.push(f)}else if(Ue(e)){var d=e;i=t;for(var c=Object.keys(d),v=0;v<c.length;v++){var g=c[v],m=d[g];if(m===void 0&&(m=d[ca(g)]),m!==void 0){var p=this.parse(g,m,!0);p&&a.push(p)}}}else return!1;if(a.length===0)return!1;for(var y=!1,w=0;w<r.length;w++){for(var T=r[w],O={},I=void 0,R=0;R<a.length;R++){var L=a[R];if(i){var N=T.pstyle(L.name);I=O[L.name]={prev:N}}y=this.applyParsedProperty(T,Zt(L))||y,i&&(I.next=T.pstyle(L.name))}y&&this.updateStyleHints(T),i&&this.updateTransitions(T,O,o)}return y};cn.overrideBypass=function(r,e,t){e=Do(e);for(var i=0;i<r.length;i++){var n=r[i],a=n._private.style[e],o=this.properties[e].type,s=o.color,l=o.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(n,e,t):(a.value=t,a.pfValue!=null&&(a.pfValue=t),s?a.strValue="rgb("+t.join(",")+")":l?a.strValue=t.join(" "):a.strValue=""+t,this.updateStyleHints(n)),this.checkTriggers(n,e,u,t)}};cn.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};cn.removeBypasses=function(r,e,t){for(var i=!0,n=0;n<r.length;n++){for(var a=r[n],o={},s=0;s<e.length;s++){var l=e[s],u=this.properties[l],h=a.pstyle(u.name);if(!(!h||!h.bypass)){var f="",d=this.parse(l,f,!0),c=o[u.name]={prev:h};this.applyParsedProperty(a,d),c.next=a.pstyle(u.name)}}this.updateStyleHints(a),t&&this.updateTransitions(a,o,i)}};var Bo={};Bo.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};Bo.containerCss=function(r){var e=this._private.cy,t=e.container();if(rt&&t&&rt.getComputedStyle)return rt.getComputedStyle(t).getPropertyValue(r)};var jt={};jt.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};jt.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var i={},n=0;n<t.properties.length;n++){var a=t.properties[n],o=t.getStylePropertyValue(r,a.name,e);o!=null&&(i[a.name]=o,i[ca(a.name)]=o)}return i}};jt.getIndexedStyle=function(r,e,t,i){var n=r.pstyle(e)[t][i];return n!=null?n:r.cy().style().getDefaultProperty(e)[t][0]};jt.getStylePropertyValue=function(r,e,t){var i=this;if(r=r[0],r){var n=i.properties[e];n.alias&&(n=n.pointsTo);var a=n.type,o=r.pstyle(n.name);if(o){var s=o.value,l=o.units,u=o.strValue;if(t&&a.number&&s!=null&&Se(s)){var h=r.cy().zoom(),f=function(m){return m*h},d=function(m,p){return f(m)+p},c=je(s),v=c?l.every(function(g){return g!=null}):l!=null;return v?c?s.map(function(g,m){return d(g,l[m])}).join(" "):d(s,l):c?s.map(function(g){return Ne(g)?g:""+f(g)}).join(" "):""+f(s)}else if(u!=null)return u}return null}};jt.getAnimationStartStyle=function(r,e){for(var t={},i=0;i<e.length;i++){var n=e[i],a=n.name,o=r.pstyle(a);o!==void 0&&(Ue(o)?o=this.parse(a,o.strValue):o=this.parse(a,o)),o&&(t[a]=o)}return t};jt.getPropsList=function(r){var e=this,t=[],i=r,n=e.properties;if(i)for(var a=Object.keys(i),o=0;o<a.length;o++){var s=a[o],l=i[s],u=n[s]||n[Do(s)],h=this.parse(u.name,l);h&&t.push(h)}return t};jt.getNonDefaultPropertiesHash=function(r,e,t){var i=t.slice(),n,a,o,s,l,u;for(l=0;l<e.length;l++)if(n=e[l],a=r.pstyle(n,!1),a!=null)if(a.pfValue!=null)i[0]=qi(s,i[0]),i[1]=Yi(s,i[1]);else for(o=a.strValue,u=0;u<o.length;u++)s=o.charCodeAt(u),i[0]=qi(s,i[0]),i[1]=Yi(s,i[1]);return i};jt.getPropertiesHash=jt.getNonDefaultPropertiesHash;var Ea={};Ea.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var i=r[t],n=i.selector,a=i.style||i.css,o=Object.keys(a);e.selector(n);for(var s=0;s<o.length;s++){var l=o[s],u=a[l];e.css(l,u)}}return e};Ea.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};Ea.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],i=t.selector,n=t.properties,a={},o=0;o<n.length;o++){var s=n[o];a[s.name]=s.strValue}r.push({selector:i?i.toString():"core",style:a})}return r};var ko={};ko.appendFromString=function(r){var e=this,t=this,i=""+r,n,a,o;i=i.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){i.length>n.length?i=i.substr(n.length):i=""}function l(){a.length>o.length?a=a.substr(o.length):a=""}for(;;){var u=i.match(/^\s*$/);if(u)break;var h=i.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!h){Xe("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+i);break}n=h[0];var f=h[1];if(f!=="core"){var d=new Mr(f);if(d.invalid){Xe("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),s();continue}}var c=h[2],v=!1;a=c;for(var g=[];;){var m=a.match(/^\s*$/);if(m)break;var p=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!p){Xe("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+c),v=!0;break}o=p[0];var y=p[1],w=p[2],T=e.properties[y];if(!T){Xe("Skipping property: Invalid property name in: "+o),l();continue}var O=t.parse(y,w);if(!O){Xe("Skipping property: Invalid property definition in: "+o),l();continue}g.push({name:y,val:w}),l()}if(v){s();break}t.selector(f);for(var I=0;I<g.length;I++){var R=g[I];t.css(R.name,R.val)}s()}return t};ko.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var mt={};(function(){var r=ct,e=ly,t=hy,i=fy,n=cy,a=function(re){return"^"+re+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(re){var ae=r+"|\\w+|"+e+"|"+t+"|"+i+"|"+n;return"^"+re+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+ae+")\\s*\\,\\s*("+ae+")\\)$"},s=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];mt.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:s,singleRegexMatchValue:!0},urls:{regexes:s,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(re,ae){switch(re.length){case 2:return ae[0]!=="deg"&&ae[0]!=="rad"&&ae[1]!=="deg"&&ae[1]!=="rad";case 1:return Ne(re[0])||ae[0]==="deg"||ae[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(re){var ae=re.length;return ae===1||ae===2||ae===4}}};var l={zeroNonZero:function(re,ae){return(re==null||ae==null)&&re!==ae||re==0&&ae!=0?!0:re!=0&&ae==0},any:function(re,ae){return re!=ae},emptyNonEmpty:function(re,ae){var de=Lr(re),ye=Lr(ae);return de&&!ye||!de&&ye}},u=mt.types,h=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],d=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],c=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],v=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification}],g=[{name:"events",type:u.bool},{name:"text-events",type:u.bool}],m=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.nonNegativeInt,triggersZOrder:l.any}],p=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any}],w=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],T=function(re,ae){return ae.value==="label"?-re.poolIndex():ae.pfValue},O=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:T},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:T},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],I=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle}],R=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],L=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],N=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],E=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],C=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],b=[];mt.pieBackgroundN=16,b.push({name:"pie-size",type:u.sizeMaybePercent});for(var M=1;M<=mt.pieBackgroundN;M++)b.push({name:"pie-"+M+"-background-color",type:u.color}),b.push({name:"pie-"+M+"-background-size",type:u.percent}),b.push({name:"pie-"+M+"-background-opacity",type:u.zeroOneNumber});var D=[],H=mt.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill}].forEach(function(V){H.forEach(function(re){var ae=re+"-"+V.name,de=V.type,ye=V.triggersBounds;D.push({name:ae,type:de,triggersBounds:ye})})},{});var k=mt.properties=[].concat(g,w,m,p,y,E,v,c,h,f,d,O,I,R,b,L,N,D,C),B=mt.propertyGroups={behavior:g,transition:w,visibility:m,overlay:p,underlay:y,ghost:E,commonLabel:v,labelDimensions:c,mainLabel:h,sourceLabel:f,targetLabel:d,nodeBody:O,nodeBorder:I,backgroundImage:R,pie:b,compound:L,edgeLine:N,edgeArrow:D,core:C},U=mt.propertyGroupNames={},W=mt.propertyGroupKeys=Object.keys(B);W.forEach(function(V){U[V]=B[V].map(function(re){return re.name}),B[V].forEach(function(re){return re.groupKey=V})});var J=mt.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];mt.propertyNames=k.map(function(V){return V.name});for(var G=0;G<k.length;G++){var X=k[G];k[X.name]=X}for(var ie=0;ie<J.length;ie++){var ee=J[ie],q=k[ee.pointsTo],$={name:ee.name,alias:!0,pointsTo:q};k.push($),k[ee.name]=$}})();mt.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};mt.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=_e({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var h=1;h<=mt.pieBackgroundN;h++){var f=u.name.replace("{{i}}",h),d=u.value;l[f]=d}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce(function(l,u){return mt.arrowPrefixes.forEach(function(h){var f=h+"-"+u.name,d=u.value;l[f]=d}),l},{})),t={},i=0;i<this.properties.length;i++){var n=this.properties[i];if(!n.pointsTo){var a=n.name,o=e[a],s=this.parse(a,o);t[a]=s}}return r.defaultProperties=t,r.defaultProperties};mt.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Ta={};Ta.parse=function(r,e,t,i){var n=this;if(nt(e))return n.parseImplWarn(r,e,t,i);var a=i==="mapping"||i===!0||i===!1||i==null?"dontcare":i,o=t?"t":"f",s=""+e,l=Pu(r,s,o,a),u=n.propCache=n.propCache||[],h;return(h=u[l])||(h=u[l]=n.parseImplWarn(r,e,t,i)),(t||i==="mapping")&&(h=Zt(h),h&&(h.value=Zt(h.value))),h};Ta.parseImplWarn=function(r,e,t,i){var n=this.parseImpl(r,e,t,i);return!n&&e!=null&&Xe("The style property `".concat(r,": ").concat(e,"` is invalid")),n&&(n.name==="width"||n.name==="height")&&e==="label"&&Xe("The style value of `label` is deprecated for `"+n.name+"`"),n};Ta.parseImpl=function(r,e,t,i){var n=this;r=Do(r);var a=n.properties[r],o=e,s=n.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,r=a.name);var l=Ne(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(nt(e))return{name:r,value:e,strValue:"fn",mapped:s.fn,bypass:t};var h,f;if(!(!l||i||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(h=new RegExp(s.data.regex).exec(e))){if(t)return!1;var d=s.data;return{name:r,value:h,strValue:""+e,mapped:d,field:h[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(f=new RegExp(s.mapData.regex).exec(e))){if(t||u.multiple)return!1;var c=s.mapData;if(!(u.color||u.number))return!1;var v=this.parse(r,f[4]);if(!v||v.mapped)return!1;var g=this.parse(r,f[5]);if(!g||g.mapped)return!1;if(v.pfValue===g.pfValue||v.strValue===g.strValue)return Xe("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+v.strValue+"`"),this.parse(r,v.strValue);if(u.color){var m=v.value,p=g.value,y=m[0]===p[0]&&m[1]===p[1]&&m[2]===p[2]&&(m[3]===p[3]||(m[3]==null||m[3]===1)&&(p[3]==null||p[3]===1));if(y)return!1}return{name:r,value:f,strValue:""+e,mapped:c,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:v.value,valueMax:g.value,bypass:t}}}if(u.multiple&&i!=="multiple"){var w;if(l?w=e.split(/\s+/):je(e)?w=e:w=[e],u.evenMultiple&&w.length%2!==0)return null;for(var T=[],O=[],I=[],R="",L=!1,N=0;N<w.length;N++){var E=n.parse(r,w[N],t,"multiple");L=L||Ne(E.value),T.push(E.value),I.push(E.pfValue!=null?E.pfValue:E.value),O.push(E.units),R+=(N>0?" ":"")+E.strValue}return u.validate&&!u.validate(T,O)?null:u.singleEnum&&L?T.length===1&&Ne(T[0])?{name:r,value:T[0],strValue:T[0],bypass:t}:null:{name:r,value:T,pfValue:I,strValue:R,bypass:t,units:O}}var C=function(){for(var ae=0;ae<u.enums.length;ae++){var de=u.enums[ae];if(de===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(u.number){var b,M="px";if(u.units&&(b=u.units),u.implicitUnits&&(M=u.implicitUnits),!u.unitless)if(l){var D="px|em"+(u.allowPercent?"|\\%":"");b&&(D=b);var H=e.match("^("+ct+")("+D+")?$");H&&(e=H[1],b=H[2]||M)}else(!b||u.implicitUnits)&&(b=M);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=o,C();if(u.integer&&!ty(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var k={name:r,value:e,strValue:""+e+(b||""),units:b,bypass:t};return u.unitless||b!=="px"&&b!=="em"?k.pfValue=e:k.pfValue=b==="px"||!b?e:this.getEmSizeInPixels()*e,(b==="ms"||b==="s")&&(k.pfValue=b==="ms"?e:1e3*e),(b==="deg"||b==="rad")&&(k.pfValue=b==="rad"?e:Qy(e)),b==="%"&&(k.pfValue=e/100),k}else if(u.propList){var B=[],U=""+e;if(U!=="none"){for(var W=U.split(/\s*,\s*|\s+/),J=0;J<W.length;J++){var G=W[J].trim();n.properties[G]?B.push(G):Xe("`"+G+"` is not a valid property name")}if(B.length===0)return null}return{name:r,value:B,strValue:B.length===0?"none":B.join(" "),bypass:t}}else if(u.color){var X=yy(e);return X?{name:r,value:X,pfValue:X,strValue:"rgb("+X[0]+","+X[1]+","+X[2]+")",bypass:t}:null}else if(u.regex||u.regexes){if(u.enums){var ie=C();if(ie)return ie}for(var ee=u.regexes?u.regexes:[u.regex],q=0;q<ee.length;q++){var $=new RegExp(ee[q]),V=$.exec(e);if(V)return{name:r,value:u.singleRegexMatchValue?V[1]:V,strValue:""+e,bypass:t}}return null}else return u.string?{name:r,value:""+e,strValue:""+e,bypass:t}:u.enums?C():null};var xt=function r(e){if(!(this instanceof r))return new r(e);if(!Co(e)){at("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Dt=xt.prototype;Dt.instanceString=function(){return"style"};Dt.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),i=0;i<this.length;i++)this[i]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(n){var a=n[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Dt.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Dt.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};Dt.selector=function(r){var e=r==="core"?null:new Mr(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};Dt.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],i=0;i<r.properties.length;i++){var n=r.properties[i],a=t[n.name];a===void 0&&(a=t[ca(n.name)]),a!==void 0&&this.cssRule(n.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Dt.style=Dt.css;Dt.cssRule=function(r,e){var t=this.parse(r,e);if(t){var i=this.length-1;this[i].properties.push(t),this[i].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.mapped&&this[i].mappedProperties.push(t);var n=!this[i].selector;n&&(this._private.coreStyle[t.name]=t)}return this};Dt.append=function(r){return Eu(r)?r.appendToStyle(this):je(r)?this.appendFromJson(r):Ne(r)&&this.appendFromString(r),this};xt.fromJson=function(r,e){var t=new xt(r);return t.fromJson(e),t};xt.fromString=function(r,e){return new xt(r).fromString(e)};[Rt,cn,Bo,jt,Ea,ko,mt,Ta].forEach(function(r){_e(Dt,r)});xt.types=Dt.types;xt.properties=Dt.properties;xt.propertyGroups=Dt.propertyGroups;xt.propertyGroupNames=Dt.propertyGroupNames;xt.propertyGroupKeys=Dt.propertyGroupKeys;var lE={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return Eu(e)?t.style=e.generateStyle(this):je(e)?t.style=xt.fromJson(this,e):Ne(e)?t.style=xt.fromString(this,e):t.style=xt(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},uE="single",qr={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=uE),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,i,n,a,o,s;switch(e.length){case 0:return t;case 1:if(Ne(e[0]))return i=e[0],t[i];if(Ue(e[0])){if(!this._private.panningEnabled)return this;a=e[0],o=a.x,s=a.y,Se(o)&&(t.x=o),Se(s)&&(t.y=s),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;i=e[0],n=e[1],(i==="x"||i==="y")&&Se(n)&&(t[i]=n),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var i=arguments,n=this._private.pan,a,o,s,l,u;if(!this._private.panningEnabled)return this;switch(i.length){case 1:Ue(e)&&(s=i[0],l=s.x,u=s.y,Se(l)&&(n.x+=l),Se(u)&&(n.y+=u),this.emit("pan viewport"));break;case 2:a=e,o=t,(a==="x"||a==="y")&&Se(o)&&(n[a]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},fit:function(e,t){var i=this.getFitViewport(e,t);if(i){var n=this._private;n.zoom=i.zoom,n.pan=i.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(Se(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var i;if(Ne(e)){var n=e;e=this.$(n)}else if(ny(e)){var a=e;i={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},i.w=i.x2-i.x1,i.h=i.y2-i.y1}else _t(e)||(e=this.mutableElements());if(!(_t(e)&&e.empty())){i=i||e.boundingBox();var o=this.width(),s=this.height(),l;if(t=Se(t)?t:0,!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(i.w)&&!isNaN(i.h)&&i.w>0&&i.h>0){l=Math.min((o-2*t)/i.w,(s-2*t)/i.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(o-l*(i.x1+i.x2))/2,y:(s-l*(i.y1+i.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,t){var i=this._private;if(t==null){var n=e;e=n.min,t=n.max}return Se(e)&&Se(t)&&e<=t?(i.minZoom=e,i.maxZoom=t):Se(e)&&t===void 0&&e<=i.maxZoom?i.minZoom=e:Se(t)&&e===void 0&&t>=i.minZoom&&(i.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,i=t.pan,n=t.zoom,a,o,s=!1;if(t.zoomingEnabled||(s=!0),Se(e)?o=e:Ue(e)&&(o=e.level,e.position!=null?a=va(e.position,n,i):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!t.panningEnabled&&(s=!0)),o=o>t.maxZoom?t.maxZoom:o,o=o<t.minZoom?t.minZoom:o,s||!Se(o)||o===n||a!=null&&(!Se(a.x)||!Se(a.y)))return null;if(a!=null){var l=i,u=n,h=o,f={x:-h/u*(a.x-l.x)+a.x,y:-h/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:h,pan:f}}else return{zoomed:!0,panned:!1,zoom:o,pan:i}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),i=this._private;return t==null||!t.zoomed?this:(i.zoom=t.zoom,t.panned&&(i.pan.x=t.pan.x,i.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,i=!0,n=!0,a=[],o=!1,s=!1;if(!e)return this;if(Se(e.zoom)||(i=!1),Ue(e.pan)||(n=!1),!i&&!n)return this;if(i){var l=e.zoom;l<t.minZoom||l>t.maxZoom||!t.zoomingEnabled?o=!0:(t.zoom=l,a.push("zoom"))}if(n&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var u=e.pan;Se(u.x)&&(t.pan.x=u.x,s=!1),Se(u.y)&&(t.pan.y=u.y,s=!1),s||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(!!this._private.panningEnabled){if(Ne(e)){var i=e;e=this.mutableElements().filter(i)}else _t(e)||(e=this.mutableElements());if(e.length!==0){var n=e.boundingBox(),a=this.width(),o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(a-t*(n.x1+n.x2))/2,y:(o-t*(n.y1+n.y2))/2};return s}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container;return e.sizeCache=e.sizeCache||(t?function(){var i=rt.getComputedStyle(t),n=function(o){return parseFloat(i.getPropertyValue(o))};return{width:t.clientWidth-n("padding-left")-n("padding-right"),height:t.clientHeight-n("padding-top")-n("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,i=this.renderedExtent(),n={x1:(i.x1-e.x)/t,x2:(i.x2-e.x)/t,y1:(i.y1-e.y)/t,y2:(i.y2-e.y)/t};return n.w=n.x2-n.x1,n.h=n.y2-n.y1,n},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};qr.centre=qr.center;qr.autolockNodes=qr.autolock;qr.autoungrabifyNodes=qr.autoungrabify;var Ji={data:Ye.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Ye.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Ye.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ye.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Ji.attr=Ji.data;Ji.removeAttr=Ji.removeData;var $i=function(e){var t=this;e=_e({},e);var i=e.container;i&&!Wn(i)&&Wn(i[0])&&(i=i[0]);var n=i?i._cyreg:null;n=n||{},n&&n.cy&&(n.cy.destroy(),n={});var a=n.readies=n.readies||[];i&&(i._cyreg=n),n.cy=t;var o=rt!==void 0&&i!==void 0&&!e.headless,s=e;s.layout=_e({name:o?"grid":"null"},s.layout),s.renderer=_e({name:o?"canvas":"null"},s.renderer);var l=function(v,g,m){return g!==void 0?g:m!==void 0?m:v},u=this._private={container:i,ready:!1,options:s,elements:new wt(this),listeners:[],aniEles:new wt(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,s.zoomingEnabled),userZoomingEnabled:l(!0,s.userZoomingEnabled),panningEnabled:l(!0,s.panningEnabled),userPanningEnabled:l(!0,s.userPanningEnabled),boxSelectionEnabled:l(!0,s.boxSelectionEnabled),autolock:l(!1,s.autolock,s.autolockNodes),autoungrabify:l(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:l(!1,s.autounselectify),styleEnabled:s.styleEnabled===void 0?o:s.styleEnabled,zoom:Se(s.zoom)?s.zoom:1,pan:{x:Ue(s.pan)&&Se(s.pan.x)?s.pan.x:0,y:Ue(s.pan)&&Se(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,s.multiClickDebounceTime)};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});var h=function(v,g){var m=v.some(ay);if(m)return Si.all(v).then(g);g(v)};u.styleEnabled&&t.setStyle([]);var f=_e({},s,s.renderer);t.initRenderer(f);var d=function(v,g,m){t.notifications(!1);var p=t.mutableElements();p.length>0&&p.remove(),v!=null&&(Ue(v)||je(v))&&t.add(v),t.one("layoutready",function(w){t.notifications(!0),t.emit(w),t.one("load",g),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",m),t.emit("done")});var y=_e({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};h([s.style,s.elements],function(c){var v=c[0],g=c[1];u.styleEnabled&&t.style().append(v),d(g,function(){t.startAnimationLoop(),u.ready=!0,nt(s.ready)&&t.on("ready",s.ready);for(var m=0;m<a.length;m++){var p=a[m];t.on("ready",p)}n&&(n.readies=[]),t.emit("ready")},s.done)})},Kn=$i.prototype;_e(Kn,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},mount:function(e){if(e!=null){var t=this,i=t._private,n=i.options;return!Wn(e)&&Wn(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),i.container=e,i.styleEnabled=!0,t.invalidateSize(),t.initRenderer(_e({},n,n.renderer,{name:n.renderer.name==="null"?"canvas":n.renderer.name})),t.startAnimationLoop(),t.style(n.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Zt(this._private.options)},json:function(e){var t=this,i=t._private,n=t.mutableElements(),a=function(T){return t.getElementById(T.id())};if(Ue(e)){if(t.startBatch(),e.elements){var o={},s=function(T,O){for(var I=[],R=[],L=0;L<T.length;L++){var N=T[L];if(!N.data.id){Xe("cy.json() cannot handle elements without an ID attribute");continue}var E=""+N.data.id,C=t.getElementById(E);o[E]=!0,C.length!==0?R.push({ele:C,json:N}):(O&&(N.group=O),I.push(N))}t.add(I);for(var b=0;b<R.length;b++){var M=R[b],D=M.ele,H=M.json;D.json(H)}};if(je(e.elements))s(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var h=l[u],f=e.elements[h];je(f)&&s(f,h)}var d=t.collection();n.filter(function(w){return!o[w.id()]}).forEach(function(w){w.isParent()?d.merge(w):w.remove()}),d.forEach(function(w){return w.children().move({parent:null})}),d.forEach(function(w){return a(w).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==i.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==i.pan.x||e.pan.y!==i.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var c=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<c.length;v++){var g=c[v];e[g]!=null&&t[g](e[g])}return t.endBatch(),this}else{var m=!!e,p={};m?p.elements=this.elements().map(function(w){return w.json()}):(p.elements={},n.forEach(function(w){var T=w.group();p.elements[T]||(p.elements[T]=[]),p.elements[T].push(w.json())})),this._private.styleEnabled&&(p.style=t.style().json()),p.data=Zt(t.data());var y=i.options;return p.zoomingEnabled=i.zoomingEnabled,p.userZoomingEnabled=i.userZoomingEnabled,p.zoom=i.zoom,p.minZoom=i.minZoom,p.maxZoom=i.maxZoom,p.panningEnabled=i.panningEnabled,p.userPanningEnabled=i.userPanningEnabled,p.pan=Zt(i.pan),p.boxSelectionEnabled=i.boxSelectionEnabled,p.renderer=Zt(y.renderer),p.hideEdgesOnViewport=y.hideEdgesOnViewport,p.textureOnViewport=y.textureOnViewport,p.wheelSensitivity=y.wheelSensitivity,p.motionBlur=y.motionBlur,p.multiClickDebounceTime=y.multiClickDebounceTime,p}}});Kn.$id=Kn.getElementById;[Jw,iE,dh,no,kn,aE,ao,zn,lE,qr,Ji].forEach(function(r){_e(Kn,r)});var hE={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},ni=function(e){return e.scratch("breadthfirst")},al=function(e,t){return e.scratch("breadthfirst",t)};function vh(r){this.options=_e({},hE,r)}vh.prototype.run=function(){var r=this.options,e=r,t=r.cy,i=e.eles,n=i.nodes().filter(function(ce){return!ce.isParent()}),a=i,o=e.directed,s=e.maximal||e.maximalAdjustments>0,l=It(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),u;if(_t(e.roots))u=e.roots;else if(je(e.roots)){for(var h=[],f=0;f<e.roots.length;f++){var d=e.roots[f],c=t.getElementById(d);h.push(c)}u=t.collection(h)}else if(Ne(e.roots))u=t.$(e.roots);else if(o)u=n.roots();else{var v=i.components();u=t.collection();for(var g=function(x){var z=v[x],j=z.maxDegree(!1),te=z.filter(function(K){return K.degree(!1)===j});u=u.add(te)},m=0;m<v.length;m++)g(m)}var p=[],y={},w=function(x,z){p[z]==null&&(p[z]=[]);var j=p[z].length;p[z].push(x),al(x,{index:j,depth:z})},T=function(x,z){var j=ni(x),te=j.depth,K=j.index;p[te][K]=null,w(x,z)};a.bfs({roots:u,directed:e.directed,visit:function(x,z,j,te,K){var le=x[0],fe=le.id();w(le,K),y[fe]=!0}});for(var O=[],I=0;I<n.length;I++){var R=n[I];y[R.id()]||O.push(R)}var L=function(x){for(var z=p[x],j=0;j<z.length;j++){var te=z[j];if(te==null){z.splice(j,1),j--;continue}al(te,{depth:x,index:j})}},N=function(){for(var x=0;x<p.length;x++)L(x)},E=function(x,z){for(var j=ni(x),te=x.incomers().filter(function(F){return F.isNode()&&i.has(F)}),K=-1,le=x.id(),fe=0;fe<te.length;fe++){var me=te[fe],se=ni(me);K=Math.max(K,se.depth)}return j.depth<=K?z[le]?null:(T(x,K+1),z[le]=!0,!0):!1};if(o&&s){var C=[],b={},M=function(x){return C.push(x)},D=function(){return C.shift()};for(n.forEach(function(ce){return C.push(ce)});C.length>0;){var H=D(),k=E(H,b);if(k)H.outgoers().filter(function(ce){return ce.isNode()&&i.has(ce)}).forEach(M);else if(k===null){Xe("Detected double maximal shift for node `"+H.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}N();var B=0;if(e.avoidOverlap)for(var U=0;U<n.length;U++){var W=n[U],J=W.layoutDimensions(e),G=J.w,X=J.h;B=Math.max(B,G,X)}var ie={},ee=function(x){if(ie[x.id()])return ie[x.id()];for(var z=ni(x).depth,j=x.neighborhood(),te=0,K=0,le=0;le<j.length;le++){var fe=j[le];if(!(fe.isEdge()||fe.isParent()||!n.has(fe))){var me=ni(fe);if(me!=null){var se=me.index,F=me.depth;if(!(se==null||F==null)){var Q=p[F].length;F<z&&(te+=se/Q,K++)}}}}return K=Math.max(1,K),te=te/K,K===0&&(te=0),ie[x.id()]=te,te},q=function(x,z){var j=ee(x),te=ee(z),K=j-te;return K===0?bu(x.id(),z.id()):K};e.depthSort!==void 0&&(q=e.depthSort);for(var $=0;$<p.length;$++)p[$].sort(q),L($);for(var V=[],re=0;re<O.length;re++)V.push(O[re]);p.unshift(V),N();for(var ae=0,de=0;de<p.length;de++)ae=Math.max(p[de].length,ae);var ye={x:l.x1+l.w/2,y:l.x1+l.h/2},Te=p.reduce(function(ce,x){return Math.max(ce,x.length)},0),Oe=function(x){var z=ni(x),j=z.depth,te=z.index,K=p[j].length,le=Math.max(l.w/((e.grid?Te:K)+1),B),fe=Math.max(l.h/(p.length+1),B),me=Math.min(l.w/2/p.length,l.h/2/p.length);if(me=Math.max(me,B),e.circle){var F=me*j+me-(p.length>0&&p[0].length<=3?me/2:0),Q=2*Math.PI/p[j].length*te;return j===0&&p[0].length===1&&(F=1),{x:ye.x+F*Math.cos(Q),y:ye.y+F*Math.sin(Q)}}else{var se={x:ye.x+(te+1-(K+1)/2)*le,y:(j+1)*fe};return se}};return i.nodes().layoutPositions(this,e,Oe),this};var fE={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function gh(r){this.options=_e({},fE,r)}gh.prototype.run=function(){var r=this.options,e=r,t=r.cy,i=e.eles,n=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=i.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var o=It(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),h,f=0,d=0;d<a.length;d++){var c=a[d],v=c.layoutDimensions(e),g=v.w,m=v.h;f=Math.max(f,g,m)}if(Se(e.radius)?h=e.radius:a.length<=1?h=0:h=Math.min(o.h,o.w)/2-f,a.length>1&&e.avoidOverlap){f*=1.75;var p=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),w=Math.sqrt(f*f/(p*p+y*y));h=Math.max(w,h)}var T=function(I,R){var L=e.startAngle+R*u*(n?1:-1),N=h*Math.cos(L),E=h*Math.sin(L),C={x:s.x+N,y:s.y+E};return C};return i.nodes().layoutPositions(this,e,T),this};var cE={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function ph(r){this.options=_e({},cE,r)}ph.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,i=r.cy,n=e.eles,a=n.nodes().not(":parent"),o=It(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=[],u=0,h=0;h<a.length;h++){var f=a[h],d=void 0;d=e.concentric(f),l.push({value:d,node:f}),f._private.scratch.concentric=d}a.updateStyle();for(var c=0;c<a.length;c++){var v=a[c],g=v.layoutDimensions(e);u=Math.max(u,g.w,g.h)}l.sort(function(ce,x){return x.value-ce.value});for(var m=e.levelWidth(a),p=[[]],y=p[0],w=0;w<l.length;w++){var T=l[w];if(y.length>0){var O=Math.abs(y[0].value-T.value);O>=m&&(y=[],p.push(y))}y.push(T)}var I=u+e.minNodeSpacing;if(!e.avoidOverlap){var R=p.length>0&&p[0].length>1,L=Math.min(o.w,o.h)/2-I,N=L/(p.length+R?1:0);I=Math.min(I,N)}for(var E=0,C=0;C<p.length;C++){var b=p[C],M=e.sweep===void 0?2*Math.PI-2*Math.PI/b.length:e.sweep,D=b.dTheta=M/Math.max(1,b.length-1);if(b.length>1&&e.avoidOverlap){var H=Math.cos(D)-Math.cos(0),k=Math.sin(D)-Math.sin(0),B=Math.sqrt(I*I/(H*H+k*k));E=Math.max(B,E)}b.r=E,E+=I}if(e.equidistant){for(var U=0,W=0,J=0;J<p.length;J++){var G=p[J],X=G.r-W;U=Math.max(U,X)}W=0;for(var ie=0;ie<p.length;ie++){var ee=p[ie];ie===0&&(W=ee.r),ee.r=W,W+=U}}for(var q={},$=0;$<p.length;$++)for(var V=p[$],re=V.dTheta,ae=V.r,de=0;de<V.length;de++){var ye=V[de],Te=e.startAngle+(t?1:-1)*re*de,Oe={x:s.x+ae*Math.cos(Te),y:s.y+ae*Math.sin(Te)};q[ye.node.id()]=Oe}return n.nodes().layoutPositions(this,e,function(ce){var x=ce.id();return q[x]}),this};var Va,dE={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function ba(r){this.options=_e({},dE,r),this.options.layout=this}ba.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Va=!0:Va=!1;var i=vE(e,t,r);Va&&mE(i),r.randomize&&yE(i);var n=or(),a=function(){wE(i,e,r),r.fit===!0&&e.fit(r.padding)},o=function(d){return!(t.stopped||d>=r.numIter||(EE(i,r),i.temperature=i.temperature*r.coolingFactor,i.temperature<r.minTemp))},s=function(){if(r.animate===!0||r.animate===!1)a(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var d=r.eles.nodes(),c=mh(i,r,d);d.layoutPositions(t,r,c)}},l=0,u=!0;if(r.animate===!0){var h=function f(){for(var d=0;u&&d<r.refresh;)u=o(l),l++,d++;if(!u)sl(i,r),s();else{var c=or();c-n>=r.animationThreshold&&a(),qn(f)}};h()}else{for(;u;)u=o(l),l++;sl(i,r),s()}return this};ba.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};ba.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var vE=function(e,t,i){for(var n=i.eles.edges(),a=i.eles.nodes(),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:n.size(),temperature:i.initialTemp,clientWidth:e.width(),clientHeight:e.width(),boundingBox:It(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()})},s=i.eles.components(),l={},u=0;u<s.length;u++)for(var h=s[u],f=0;f<h.length;f++){var d=h[f];l[d.id()]=u}for(var u=0;u<o.nodeSize;u++){var c=a[u],v=c.layoutDimensions(i),g={};g.isLocked=c.locked(),g.id=c.data("id"),g.parentId=c.data("parent"),g.cmptId=l[c.id()],g.children=[],g.positionX=c.position("x"),g.positionY=c.position("y"),g.offsetX=0,g.offsetY=0,g.height=v.w,g.width=v.h,g.maxX=g.positionX+g.width/2,g.minX=g.positionX-g.width/2,g.maxY=g.positionY+g.height/2,g.minY=g.positionY-g.height/2,g.padLeft=parseFloat(c.style("padding")),g.padRight=parseFloat(c.style("padding")),g.padTop=parseFloat(c.style("padding")),g.padBottom=parseFloat(c.style("padding")),g.nodeRepulsion=nt(i.nodeRepulsion)?i.nodeRepulsion(c):i.nodeRepulsion,o.layoutNodes.push(g),o.idToIndex[g.id]=u}for(var m=[],p=0,y=-1,w=[],u=0;u<o.nodeSize;u++){var c=o.layoutNodes[u],T=c.parentId;T!=null?o.layoutNodes[o.idToIndex[T]].children.push(c.id):(m[++y]=c.id,w.push(c.id))}for(o.graphSet.push(w);p<=y;){var O=m[p++],I=o.idToIndex[O],d=o.layoutNodes[I],R=d.children;if(R.length>0){o.graphSet.push(R);for(var u=0;u<R.length;u++)m[++y]=R[u]}}for(var u=0;u<o.graphSet.length;u++)for(var L=o.graphSet[u],f=0;f<L.length;f++){var N=o.idToIndex[L[f]];o.indexToGraph[N]=u}for(var u=0;u<o.edgeSize;u++){var E=n[u],C={};C.id=E.data("id"),C.sourceId=E.data("source"),C.targetId=E.data("target");var b=nt(i.idealEdgeLength)?i.idealEdgeLength(E):i.idealEdgeLength,M=nt(i.edgeElasticity)?i.edgeElasticity(E):i.edgeElasticity,D=o.idToIndex[C.sourceId],H=o.idToIndex[C.targetId],k=o.indexToGraph[D],B=o.indexToGraph[H];if(k!=B){for(var U=gE(C.sourceId,C.targetId,o),W=o.graphSet[U],J=0,g=o.layoutNodes[D];W.indexOf(g.id)===-1;)g=o.layoutNodes[o.idToIndex[g.parentId]],J++;for(g=o.layoutNodes[H];W.indexOf(g.id)===-1;)g=o.layoutNodes[o.idToIndex[g.parentId]],J++;b*=J*i.nestingFactor}C.idealLength=b,C.elasticity=M,o.layoutEdges.push(C)}return o},gE=function(e,t,i){var n=pE(e,t,0,i);return 2>n.count?0:n.graph},pE=function r(e,t,i,n){var a=n.graphSet[i];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:i};for(var o=0,s=0;s<a.length;s++){var l=a[s],u=n.idToIndex[l],h=n.layoutNodes[u].children;if(h.length!==0){var f=n.indexToGraph[n.idToIndex[h[0]]],d=r(e,t,f,n);if(d.count!==0)if(d.count===1){if(o++,o===2)break}else return d}}return{count:o,graph:i}},mE,yE=function(e,t){for(var i=e.clientWidth,n=e.clientHeight,a=0;a<e.nodeSize;a++){var o=e.layoutNodes[a];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*i,o.positionY=Math.random()*n)}},mh=function(e,t,i){var n=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(i.forEach(function(o){var s=e.layoutNodes[e.idToIndex[o.data("id")]];a.x1=Math.min(a.x1,s.positionX),a.x2=Math.max(a.x2,s.positionX),a.y1=Math.min(a.y1,s.positionY),a.y2=Math.max(a.y2,s.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(o,s){var l=e.layoutNodes[e.idToIndex[o.data("id")]];if(t.boundingBox){var u=(l.positionX-a.x1)/a.w,h=(l.positionY-a.y1)/a.h;return{x:n.x1+u*n.w,y:n.y1+h*n.h}}else return{x:l.positionX,y:l.positionY}}},wE=function(e,t,i){var n=i.layout,a=i.eles.nodes(),o=mh(e,i,a);a.positions(o),e.ready!==!0&&(e.ready=!0,n.one("layoutready",i.ready),n.emit({type:"layoutready",layout:this}))},EE=function(e,t,i){TE(e,t),SE(e),CE(e,t),DE(e),RE(e)},TE=function(e,t){for(var i=0;i<e.graphSet.length;i++)for(var n=e.graphSet[i],a=n.length,o=0;o<a;o++)for(var s=e.layoutNodes[e.idToIndex[n[o]]],l=o+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[n[l]]];bE(s,u,e,t)}},ol=function(e){return-e+2*e*Math.random()},bE=function(e,t,i,n){var a=e.cmptId,o=t.cmptId;if(!(a!==o&&!i.isCompound)){var s=t.positionX-e.positionX,l=t.positionY-e.positionY,u=1;s===0&&l===0&&(s=ol(u),l=ol(u));var h=xE(e,t,s,l);if(h>0)var f=n.nodeOverlap*h,d=Math.sqrt(s*s+l*l),c=f*s/d,v=f*l/d;else var g=Qn(e,s,l),m=Qn(t,-1*s,-1*l),p=m.x-g.x,y=m.y-g.y,w=p*p+y*y,d=Math.sqrt(w),f=(e.nodeRepulsion+t.nodeRepulsion)/w,c=f*p/d,v=f*y/d;e.isLocked||(e.offsetX-=c,e.offsetY-=v),t.isLocked||(t.offsetX+=c,t.offsetY+=v)}},xE=function(e,t,i,n){if(i>0)var a=e.maxX-t.minX;else var a=t.maxX-e.minX;if(n>0)var o=e.maxY-t.minY;else var o=t.maxY-e.minY;return a>=0&&o>=0?Math.sqrt(a*a+o*o):0},Qn=function(e,t,i){var n=e.positionX,a=e.positionY,o=e.height||1,s=e.width||1,l=i/t,u=o/s,h={};return t===0&&0<i||t===0&&0>i?(h.x=n,h.y=a+o/2,h):0<t&&-1*u<=l&&l<=u?(h.x=n+s/2,h.y=a+s*i/2/t,h):0>t&&-1*u<=l&&l<=u?(h.x=n-s/2,h.y=a-s*i/2/t,h):0<i&&(l<=-1*u||l>=u)?(h.x=n+o*t/2/i,h.y=a+o/2,h):(0>i&&(l<=-1*u||l>=u)&&(h.x=n-o*t/2/i,h.y=a-o/2),h)},SE=function(e,t){for(var i=0;i<e.edgeSize;i++){var n=e.layoutEdges[i],a=e.idToIndex[n.sourceId],o=e.layoutNodes[a],s=e.idToIndex[n.targetId],l=e.layoutNodes[s],u=l.positionX-o.positionX,h=l.positionY-o.positionY;if(!(u===0&&h===0)){var f=Qn(o,u,h),d=Qn(l,-1*u,-1*h),c=d.x-f.x,v=d.y-f.y,g=Math.sqrt(c*c+v*v),m=Math.pow(n.idealLength-g,2)/n.elasticity;if(g!==0)var p=m*c/g,y=m*v/g;else var p=0,y=0;o.isLocked||(o.offsetX+=p,o.offsetY+=y),l.isLocked||(l.offsetX-=p,l.offsetY-=y)}}},CE=function(e,t){if(t.gravity!==0)for(var i=1,n=0;n<e.graphSet.length;n++){var a=e.graphSet[n],o=a.length;if(n===0)var s=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],h=e.layoutNodes[e.idToIndex[u.parentId]],s=h.positionX,l=h.positionY;for(var f=0;f<o;f++){var d=e.layoutNodes[e.idToIndex[a[f]]];if(!d.isLocked){var c=s-d.positionX,v=l-d.positionY,g=Math.sqrt(c*c+v*v);if(g>i){var m=t.gravity*c/g,p=t.gravity*v/g;d.offsetX+=m,d.offsetY+=p}}}}},DE=function(e,t){var i=[],n=0,a=-1;for(i.push.apply(i,e.graphSet[0]),a+=e.graphSet[0].length;n<=a;){var o=i[n++],s=e.idToIndex[o],l=e.layoutNodes[s],u=l.children;if(0<u.length&&!l.isLocked){for(var h=l.offsetX,f=l.offsetY,d=0;d<u.length;d++){var c=e.layoutNodes[e.idToIndex[u[d]]];c.offsetX+=h,c.offsetY+=f,i[++a]=u[d]}l.offsetX=0,l.offsetY=0}}},RE=function(e,t){for(var i=0;i<e.nodeSize;i++){var n=e.layoutNodes[i];0<n.children.length&&(n.maxX=void 0,n.minX=void 0,n.maxY=void 0,n.minY=void 0)}for(var i=0;i<e.nodeSize;i++){var n=e.layoutNodes[i];if(!(0<n.children.length||n.isLocked)){var a=PE(n.offsetX,n.offsetY,e.temperature);n.positionX+=a.x,n.positionY+=a.y,n.offsetX=0,n.offsetY=0,n.minX=n.positionX-n.width,n.maxX=n.positionX+n.width,n.minY=n.positionY-n.height,n.maxY=n.positionY+n.height,LE(n,e)}}for(var i=0;i<e.nodeSize;i++){var n=e.layoutNodes[i];0<n.children.length&&!n.isLocked&&(n.positionX=(n.maxX+n.minX)/2,n.positionY=(n.maxY+n.minY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY)}},PE=function(e,t,i){var n=Math.sqrt(e*e+t*t);if(n>i)var a={x:i*e/n,y:i*t/n};else var a={x:e,y:t};return a},LE=function r(e,t){var i=e.parentId;if(i!=null){var n=t.layoutNodes[t.idToIndex[i]],a=!1;if((n.maxX==null||e.maxX+n.padRight>n.maxX)&&(n.maxX=e.maxX+n.padRight,a=!0),(n.minX==null||e.minX-n.padLeft<n.minX)&&(n.minX=e.minX-n.padLeft,a=!0),(n.maxY==null||e.maxY+n.padBottom>n.maxY)&&(n.maxY=e.maxY+n.padBottom,a=!0),(n.minY==null||e.minY-n.padTop<n.minY)&&(n.minY=e.minY-n.padTop,a=!0),a)return r(n,t)}},sl=function(e,t){for(var i=e.layoutNodes,n=[],a=0;a<i.length;a++){var o=i[a],s=o.cmptId,l=n[s]=n[s]||[];l.push(o)}for(var u=0,a=0;a<n.length;a++){var h=n[a];if(!!h){h.x1=1/0,h.x2=-1/0,h.y1=1/0,h.y2=-1/0;for(var f=0;f<h.length;f++){var d=h[f];h.x1=Math.min(h.x1,d.positionX-d.width/2),h.x2=Math.max(h.x2,d.positionX+d.width/2),h.y1=Math.min(h.y1,d.positionY-d.height/2),h.y2=Math.max(h.y2,d.positionY+d.height/2)}h.w=h.x2-h.x1,h.h=h.y2-h.y1,u+=h.w*h.h}}n.sort(function(y,w){return w.w*w.h-y.w*y.h});for(var c=0,v=0,g=0,m=0,p=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<n.length;a++){var h=n[a];if(!!h){for(var f=0;f<h.length;f++){var d=h[f];d.isLocked||(d.positionX+=c-h.x1,d.positionY+=v-h.y1)}c+=h.w+t.componentSpacing,g+=h.w+t.componentSpacing,m=Math.max(m,h.h),g>p&&(v+=m+t.componentSpacing,c=0,g=0,m=0)}}},OE={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function yh(r){this.options=_e({},OE,r)}yh.prototype.run=function(){var r=this.options,e=r,t=r.cy,i=e.eles,n=i.nodes().not(":parent");e.sort&&(n=n.sort(e.sort));var a=It(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(a.h===0||a.w===0)i.nodes().layoutPositions(this,e,function(ie){return{x:a.x1,y:a.y1}});else{var o=n.size(),s=Math.sqrt(o*a.h/a.w),l=Math.round(s),u=Math.round(a.w/a.h*s),h=function(ee){if(ee==null)return Math.min(l,u);var q=Math.min(l,u);q==l?l=ee:u=ee},f=function(ee){if(ee==null)return Math.max(l,u);var q=Math.max(l,u);q==l?l=ee:u=ee},d=e.rows,c=e.cols!=null?e.cols:e.columns;if(d!=null&&c!=null)l=d,u=c;else if(d!=null&&c==null)l=d,u=Math.ceil(o/l);else if(d==null&&c!=null)u=c,l=Math.ceil(o/u);else if(u*l>o){var v=h(),g=f();(v-1)*g>=o?h(v-1):(g-1)*v>=o&&f(g-1)}else for(;u*l<o;){var m=h(),p=f();(p+1)*m>=o?f(p+1):h(m+1)}var y=a.w/u,w=a.h/l;if(e.condense&&(y=0,w=0),e.avoidOverlap)for(var T=0;T<n.length;T++){var O=n[T],I=O._private.position;(I.x==null||I.y==null)&&(I.x=0,I.y=0);var R=O.layoutDimensions(e),L=e.avoidOverlapPadding,N=R.w+L,E=R.h+L;y=Math.max(y,N),w=Math.max(w,E)}for(var C={},b=function(ee,q){return!!C["c-"+ee+"-"+q]},M=function(ee,q){C["c-"+ee+"-"+q]=!0},D=0,H=0,k=function(){H++,H>=u&&(H=0,D++)},B={},U=0;U<n.length;U++){var W=n[U],J=e.position(W);if(J&&(J.row!==void 0||J.col!==void 0)){var G={row:J.row,col:J.col};if(G.col===void 0)for(G.col=0;b(G.row,G.col);)G.col++;else if(G.row===void 0)for(G.row=0;b(G.row,G.col);)G.row++;B[W.id()]=G,M(G.row,G.col)}}var X=function(ee,q){var $,V;if(ee.locked()||ee.isParent())return!1;var re=B[ee.id()];if(re)$=re.col*y+y/2+a.x1,V=re.row*w+w/2+a.y1;else{for(;b(D,H);)k();$=H*y+y/2+a.x1,V=D*w+w/2+a.y1,M(D,H),k()}return{x:$,y:V}};n.layoutPositions(this,e,X)}return this};var ME={ready:function(){},stop:function(){}};function zo(r){this.options=_e({},ME,r)}zo.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};zo.prototype.stop=function(){return this};var NE={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function wh(r){this.options=_e({},NE,r)}wh.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),i=nt(r.positions);function n(a){if(r.positions==null)return qy(a.position());if(i)return r.positions(a);var o=r.positions[a._private.data.id];return o==null?null:o}return t.layoutPositions(this,r,function(a,o){var s=n(a);return a.locked()||s==null?!1:s}),this};var IE={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Eh(r){this.options=_e({},IE,r)}Eh.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,i=It(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),n=function(o,s){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}};return t.nodes().layoutPositions(this,r,n),this};var AE=[{name:"breadthfirst",impl:vh},{name:"circle",impl:gh},{name:"concentric",impl:ph},{name:"cose",impl:ba},{name:"grid",impl:yh},{name:"null",impl:zo},{name:"preset",impl:wh},{name:"random",impl:Eh}];function Th(r){this.options=r,this.notifications=0}var ll=function(){},ul=function(){throw new Error("A headless instance can not render images")};Th.prototype={recalculateRenderedStyle:ll,notify:function(){this.notifications++},init:ll,isHeadless:function(){return!0},png:ul,jpg:ul};var Ho={};Ho.arrowShapeWidth=.3;Ho.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(u,h,f,d,c,v,g){var m=c.x-f/2-g,p=c.x+f/2+g,y=c.y-f/2-g,w=c.y+f/2+g,T=m<=u&&u<=p&&y<=h&&h<=w;return T},i=function(u,h,f,d,c){var v=u*Math.cos(d)-h*Math.sin(d),g=u*Math.sin(d)+h*Math.cos(d),m=v*f,p=g*f,y=m+c.x,w=p+c.y;return{x:y,y:w}},n=function(u,h,f,d){for(var c=[],v=0;v<u.length;v+=2){var g=u[v],m=u[v+1];c.push(i(g,m,h,f,d))}return c},a=function(u){for(var h=[],f=0;f<u.length;f++){var d=u[f];h.push(d.x,d.y)}return h},o=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},s=function(u,h){Ne(h)&&(h=r[h]),r[u]=_e({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(d,c,v,g,m,p){var y=a(n(this.points,v+2*p,g,m)),w=Nt(d,c,y);return w},roughCollide:t,draw:function(d,c,v,g){var m=n(this.points,c,v,g);e.arrowShapeImpl("polygon")(d,m)},spacing:function(d){return 0},gap:o},h)};s("none",{collide:Yn,roughCollide:Yn,draw:Po,spacing:Ss,gap:Ss}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(u,h,f,d,c){var v=n(this.points,h,f,d),g=this.controlPoint,m=i(g[0],g[1],h,f,d);e.arrowShapeImpl(this.name)(u,v,m)},gap:function(u){return o(u)*.8}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,h,f,d,c,v,g){var m=a(n(this.points,f+2*g,d,c)),p=a(n(this.pointsTee,f+2*g,d,c)),y=Nt(u,h,m)||Nt(u,h,p);return y},draw:function(u,h,f,d,c){var v=n(this.points,h,f,d),g=n(this.pointsTee,h,f,d);e.arrowShapeImpl(this.name)(u,v,g)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,h,f,d,c,v,g){var m=c,p=Math.pow(m.x-u,2)+Math.pow(m.y-h,2)<=Math.pow((f+2*g)*this.radius,2),y=a(n(this.points,f+2*g,d,c));return Nt(u,h,y)||p},draw:function(u,h,f,d,c){var v=n(this.pointsTr,h,f,d);e.arrowShapeImpl(this.name)(u,v,d.x,d.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,h){var f=this.baseCrossLinePts.slice(),d=h/u,c=3,v=5;return f[c]=f[c]-d,f[v]=f[v]-d,f},collide:function(u,h,f,d,c,v,g){var m=a(n(this.points,f+2*g,d,c)),p=a(n(this.crossLinePts(f,v),f+2*g,d,c)),y=Nt(u,h,m)||Nt(u,h,p);return y},draw:function(u,h,f,d,c){var v=n(this.points,h,f,d),g=n(this.crossLinePts(h,c),h,f,d);e.arrowShapeImpl(this.name)(u,v,g)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return o(u)*.525}}),s("circle",{radius:.15,collide:function(u,h,f,d,c,v,g){var m=c,p=Math.pow(m.x-u,2)+Math.pow(m.y-h,2)<=Math.pow((f+2*g)*this.radius,2);return p},draw:function(u,h,f,d,c){e.arrowShapeImpl(this.name)(u,d.x,d.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Qr={};Qr.projectIntoViewport=function(r,e){var t=this.cy,i=this.findContainerClientCoords(),n=i[0],a=i[1],o=i[4],s=t.pan(),l=t.zoom(),u=((r-n)/o-s.x)/l,h=((e-a)/o-s.y)/l;return[u,h]};Qr.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=rt.getComputedStyle(r),i=function(p){return parseFloat(t.getPropertyValue(p))},n={left:i("padding-left"),right:i("padding-right"),top:i("padding-top"),bottom:i("padding-bottom")},a={left:i("border-left-width"),right:i("border-right-width"),top:i("border-top-width"),bottom:i("border-bottom-width")},o=r.clientWidth,s=r.clientHeight,l=n.left+n.right,u=n.top+n.bottom,h=a.left+a.right,f=e.width/(o+h),d=o-l,c=s-u,v=e.left+n.left+a.left,g=e.top+n.top+a.top;return this.containerBB=[v,g,d,c,f]};Qr.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Qr.findNearestElement=function(r,e,t,i){return this.findNearestElements(r,e,t,i)[0]};Qr.findNearestElements=function(r,e,t,i){var n=this,a=this,o=a.getCachedZSortedEles(),s=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),h=(i?24:8)/l,f=(i?8:2)/l,d=(i?8:2)/l,c=1/0,v,g;t&&(o=o.interactive);function m(R,L){if(R.isNode()){if(g)return;g=R,s.push(R)}if(R.isEdge()&&(L==null||L<c))if(v){if(v.pstyle("z-compound-depth").value===R.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===R.pstyle("z-compound-depth").value){for(var N=0;N<s.length;N++)if(s[N].isEdge()){s[N]=R,v=R,c=L!=null?L:c;break}}}else s.push(R),v=R,c=L!=null?L:c}function p(R){var L=R.outerWidth()+2*f,N=R.outerHeight()+2*f,E=L/2,C=N/2,b=R.position();if(b.x-E<=r&&r<=b.x+E&&b.y-C<=e&&e<=b.y+C){var M=a.nodeShapes[n.getNodeShape(R)];if(M.checkPoint(r,e,0,L,N,b.x,b.y))return m(R,0),!0}}function y(R){var L=R._private,N=L.rscratch,E=R.pstyle("width").pfValue,C=R.pstyle("arrow-scale").value,b=E/2+h,M=b*b,D=b*2,U=L.source,W=L.target,H;if(N.edgeType==="segments"||N.edgeType==="straight"||N.edgeType==="haystack"){for(var k=N.allpts,B=0;B+3<k.length;B+=2)if(n0(r,e,k[B],k[B+1],k[B+2],k[B+3],D)&&M>(H=u0(r,e,k[B],k[B+1],k[B+2],k[B+3])))return m(R,H),!0}else if(N.edgeType==="bezier"||N.edgeType==="multibezier"||N.edgeType==="self"||N.edgeType==="compound"){for(var k=N.allpts,B=0;B+5<N.allpts.length;B+=4)if(a0(r,e,k[B],k[B+1],k[B+2],k[B+3],k[B+4],k[B+5],D)&&M>(H=l0(r,e,k[B],k[B+1],k[B+2],k[B+3],k[B+4],k[B+5])))return m(R,H),!0}for(var U=U||L.source,W=W||L.target,J=n.getArrowWidth(E,C),G=[{name:"source",x:N.arrowStartX,y:N.arrowStartY,angle:N.srcArrowAngle},{name:"target",x:N.arrowEndX,y:N.arrowEndY,angle:N.tgtArrowAngle},{name:"mid-source",x:N.midX,y:N.midY,angle:N.midsrcArrowAngle},{name:"mid-target",x:N.midX,y:N.midY,angle:N.midtgtArrowAngle}],B=0;B<G.length;B++){var X=G[B],ie=a.arrowShapes[R.pstyle(X.name+"-arrow-shape").value],ee=R.pstyle("width").pfValue;if(ie.roughCollide(r,e,J,X.angle,{x:X.x,y:X.y},ee,h)&&ie.collide(r,e,J,X.angle,{x:X.x,y:X.y},ee,h))return m(R),!0}u&&s.length>0&&(p(U),p(W))}function w(R,L,N){return Wt(R,L,N)}function T(R,L){var N=R._private,E=d,C;L?C=L+"-":C="",R.boundingBox();var b=N.labelBounds[L||"main"],M=R.pstyle(C+"label").value,D=R.pstyle("text-events").strValue==="yes";if(!(!D||!M)){var H=w(N.rscratch,"labelX",L),k=w(N.rscratch,"labelY",L),B=w(N.rscratch,"labelAngle",L),U=R.pstyle(C+"text-margin-x").pfValue,W=R.pstyle(C+"text-margin-y").pfValue,J=b.x1-E-U,G=b.x2+E-U,X=b.y1-E-W,ie=b.y2+E-W;if(B){var ee=Math.cos(B),q=Math.sin(B),$=function(Oe,ce){return Oe=Oe-H,ce=ce-k,{x:Oe*ee-ce*q+H,y:Oe*q+ce*ee+k}},V=$(J,X),re=$(J,ie),ae=$(G,X),de=$(G,ie),ye=[V.x+U,V.y+W,ae.x+U,ae.y+W,de.x+U,de.y+W,re.x+U,re.y+W];if(Nt(r,e,ye))return m(R),!0}else if(pi(b,r,e))return m(R),!0}}for(var O=o.length-1;O>=0;O--){var I=o[O];I.isNode()?p(I)||T(I):y(I)||T(I)||T(I,"source")||T(I,"target")}return s};Qr.getAllInBox=function(r,e,t,i){var n=this.getCachedZSortedEles().interactive,a=[],o=Math.min(r,t),s=Math.max(r,t),l=Math.min(e,i),u=Math.max(e,i);r=o,t=s,e=l,i=u;for(var h=It({x1:r,y1:e,x2:t,y2:i}),f=0;f<n.length;f++){var d=n[f];if(d.isNode()){var c=d,v=c.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Mo(h,v)&&!_u(v,h)&&a.push(c)}else{var g=d,m=g._private,p=m.rscratch;if(p.startX!=null&&p.startY!=null&&!pi(h,p.startX,p.startY)||p.endX!=null&&p.endY!=null&&!pi(h,p.endX,p.endY))continue;if(p.edgeType==="bezier"||p.edgeType==="multibezier"||p.edgeType==="self"||p.edgeType==="compound"||p.edgeType==="segments"||p.edgeType==="haystack"){for(var y=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts,w=!0,T=0;T<y.length;T++)if(!i0(h,y[T])){w=!1;break}w&&a.push(g)}else(p.edgeType==="haystack"||p.edgeType==="straight")&&a.push(g)}}return a};var jn={};jn.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",i=e.edgeType==="bezier",n=e.edgeType==="multibezier",a=e.edgeType==="segments",o=e.edgeType==="compound",s=e.edgeType==="self",l,u,h,f,d,c,p,y;if(t?(h=e.haystackPts[0],f=e.haystackPts[1],d=e.haystackPts[2],c=e.haystackPts[3]):(h=e.arrowStartX,f=e.arrowStartY,d=e.arrowEndX,c=e.arrowEndY),p=e.midX,y=e.midY,a)l=h-e.segpts[0],u=f-e.segpts[1];else if(n||o||s||i){var v=e.allpts,g=gt(v[0],v[2],v[4],.1),m=gt(v[1],v[3],v[5],.1);l=h-g,u=f-m}else l=h-p,u=f-y;e.srcArrowAngle=bn(l,u);var p=e.midX,y=e.midY;if(t&&(p=(h+d)/2,y=(f+c)/2),l=d-h,u=c-f,a){var v=e.allpts;if(v.length/2%2===0){var w=v.length/2,T=w-2;l=v[w]-v[T],u=v[w+1]-v[T+1]}else{var w=v.length/2-1,T=w-2,O=w+2;l=v[w]-v[T],u=v[w+1]-v[T+1]}}else if(n||o||s){var v=e.allpts,I=e.ctrlpts,R,L,N,E;if(I.length/2%2===0){var C=v.length/2-1,b=C+2,M=b+2;R=gt(v[C],v[b],v[M],0),L=gt(v[C+1],v[b+1],v[M+1],0),N=gt(v[C],v[b],v[M],1e-4),E=gt(v[C+1],v[b+1],v[M+1],1e-4)}else{var b=v.length/2-1,C=b-2,M=b+2;R=gt(v[C],v[b],v[M],.4999),L=gt(v[C+1],v[b+1],v[M+1],.4999),N=gt(v[C],v[b],v[M],.5),E=gt(v[C+1],v[b+1],v[M+1],.5)}l=N-R,u=E-L}if(e.midtgtArrowAngle=bn(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var v=e.allpts;if(v.length/2%2!==0){var w=v.length/2-1,O=w+2;l=-(v[O]-v[w]),u=-(v[O+1]-v[w+1])}}if(e.midsrcArrowAngle=bn(l,u),a)l=d-e.segpts[e.segpts.length-2],u=c-e.segpts[e.segpts.length-1];else if(n||o||s||i){var v=e.allpts,D=v.length,g=gt(v[D-6],v[D-4],v[D-2],.9),m=gt(v[D-5],v[D-3],v[D-1],.9);l=d-g,u=c-m}else l=d-p,u=c-y;e.tgtArrowAngle=bn(l,u)};jn.getArrowWidth=jn.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},i=t[r+", "+e];return i||(i=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=i,i)};var Lt={};Lt.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],i=t._private,n=i.rscratch;if(!n.haystack){var a=Math.random()*2*Math.PI;n.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,n.target={x:Math.cos(a),y:Math.sin(a)}}var o=i.source,s=i.target,l=o.position(),u=s.position(),h=o.width(),f=s.width(),d=o.height(),c=s.height(),v=t.pstyle("haystack-radius").value,g=v/2;n.haystackPts=n.allpts=[n.source.x*h*g+l.x,n.source.y*d*g+l.y,n.target.x*f*g+u.x,n.target.y*c*g+u.y],n.midX=(n.allpts[0]+n.allpts[2])/2,n.midY=(n.allpts[1]+n.allpts[3])/2,n.edgeType="haystack",n.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};Lt.findSegmentsPoints=function(r,e){var t=r._private.rscratch,i=e.posPts,n=e.intersectionPts,a=e.vectorNormInverse,o=r.pstyle("edge-distances").value,s=r.pstyle("segment-weights"),l=r.pstyle("segment-distances"),u=Math.min(s.pfValue.length,l.pfValue.length);t.edgeType="segments",t.segpts=[];for(var h=0;h<u;h++){var f=s.pfValue[h],d=l.pfValue[h],c=1-f,v=f,g=o==="node-position"?i:n,m={x:g.x1*c+g.x2*v,y:g.y1*c+g.y2*v};t.segpts.push(m.x+a.x*d,m.y+a.y*d)}};Lt.findLoopPoints=function(r,e,t,i){var n=r._private.rscratch,a=e.dirCounts,o=e.srcPos,s=r.pstyle("control-point-distances"),l=s?s.pfValue[0]:void 0,u=r.pstyle("loop-direction").pfValue,h=r.pstyle("loop-sweep").pfValue,f=r.pstyle("control-point-step-size").pfValue;n.edgeType="self";var d=t,c=f;i&&(d=0,c=l);var v=u-Math.PI/2,g=v-h/2,m=v+h/2,p=String(u+"_"+h);d=a[p]===void 0?a[p]=0:++a[p],n.ctrlpts=[o.x+Math.cos(g)*1.4*c*(d/3+1),o.y+Math.sin(g)*1.4*c*(d/3+1),o.x+Math.cos(m)*1.4*c*(d/3+1),o.y+Math.sin(m)*1.4*c*(d/3+1)]};Lt.findCompoundLoopPoints=function(r,e,t,i){var n=r._private.rscratch;n.edgeType="compound";var a=e.srcPos,o=e.tgtPos,s=e.srcW,l=e.srcH,u=e.tgtW,h=e.tgtH,f=r.pstyle("control-point-step-size").pfValue,d=r.pstyle("control-point-distances"),c=d?d.pfValue[0]:void 0,v=t,g=f;i&&(v=0,g=c);var m=50,p={x:a.x-s/2,y:a.y-l/2},y={x:o.x-u/2,y:o.y-h/2},w={x:Math.min(p.x,y.x),y:Math.min(p.y,y.y)},T=.5,O=Math.max(T,Math.log(s*.01)),I=Math.max(T,Math.log(u*.01));n.ctrlpts=[w.x,w.y-(1+Math.pow(m,1.12)/100)*g*(v/3+1)*O,w.x-(1+Math.pow(m,1.12)/100)*g*(v/3+1)*I,w.y]};Lt.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};Lt.findBezierPoints=function(r,e,t,i,n){var a=r._private.rscratch,o=e.vectorNormInverse,s=e.posPts,l=e.intersectionPts,u=r.pstyle("edge-distances").value,h=r.pstyle("control-point-step-size").pfValue,f=r.pstyle("control-point-distances"),d=r.pstyle("control-point-weights"),c=f&&d?Math.min(f.value.length,d.value.length):1,v=f?f.pfValue[0]:void 0,g=d.value[0],m=i;a.edgeType=m?"multibezier":"bezier",a.ctrlpts=[];for(var p=0;p<c;p++){var y=(.5-e.eles.length/2+t)*h*(n?-1:1),w=void 0,T=Au(y);m&&(v=f?f.pfValue[p]:h,g=d.value[p]),i?w=v:w=v!==void 0?T*v:void 0;var O=w!==void 0?w:y,I=1-g,R=g,L=u==="node-position"?s:l,N={x:L.x1*I+L.x2*R,y:L.y1*I+L.y2*R};a.ctrlpts.push(N.x+o.x*O,N.y+o.y*O)}};Lt.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var i="vertical",n="horizontal",a="leftward",o="rightward",s="downward",l="upward",u="auto",h=e.posPts,f=e.srcW,d=e.srcH,c=e.tgtW,v=e.tgtH,g=r.pstyle("edge-distances").value,m=g!=="node-position",p=r.pstyle("taxi-direction").value,y=p,w=r.pstyle("taxi-turn"),T=w.units==="%",O=w.pfValue,I=O<0,R=r.pstyle("taxi-turn-min-distance").pfValue,L=m?(f+c)/2:0,N=m?(d+v)/2:0,E=h.x2-h.x1,C=h.y2-h.y1,b=function(A,_){return A>0?Math.max(A-_,0):Math.min(A+_,0)},M=b(E,L),D=b(C,N),H=!1;y===u?p=Math.abs(M)>Math.abs(D)?n:i:y===l||y===s?(p=i,H=!0):(y===a||y===o)&&(p=n,H=!0);var k=p===i,B=k?D:M,U=k?C:E,W=Au(U),J=!1;!(H&&(T||I))&&(y===s&&U<0||y===l&&U>0||y===a&&U>0||y===o&&U<0)&&(W*=-1,B=W*Math.abs(B),J=!0);var G;if(T){var X=O<0?1+O:O;G=X*B}else{var ie=O<0?B:0;G=ie+O*W}var ee=function(A){return Math.abs(A)<R||Math.abs(A)>=Math.abs(B)},q=ee(G),$=ee(Math.abs(B)-Math.abs(G)),V=q||$;if(V&&!J)if(k){var re=Math.abs(U)<=d/2,ae=Math.abs(E)<=c/2;if(re){var de=(h.x1+h.x2)/2,ye=h.y1,Te=h.y2;t.segpts=[de,ye,de,Te]}else if(ae){var Oe=(h.y1+h.y2)/2,ce=h.x1,x=h.x2;t.segpts=[ce,Oe,x,Oe]}else t.segpts=[h.x1,h.y2]}else{var z=Math.abs(U)<=f/2,j=Math.abs(C)<=v/2;if(z){var te=(h.y1+h.y2)/2,K=h.x1,le=h.x2;t.segpts=[K,te,le,te]}else if(j){var fe=(h.x1+h.x2)/2,me=h.y1,se=h.y2;t.segpts=[fe,me,fe,se]}else t.segpts=[h.x2,h.y1]}else if(k){var F=h.y1+G+(m?d/2*W:0),Q=h.x1,ue=h.x2;t.segpts=[Q,F,ue,F]}else{var oe=h.x1+G+(m?f/2*W:0),Z=h.y1,P=h.y2;t.segpts=[oe,Z,oe,P]}};Lt.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var i=e.srcPos,n=e.tgtPos,a=e.srcW,o=e.srcH,s=e.tgtW,l=e.tgtH,u=e.srcShape,h=e.tgtShape,f=!Se(t.startX)||!Se(t.startY),d=!Se(t.arrowStartX)||!Se(t.arrowStartY),c=!Se(t.endX)||!Se(t.endY),v=!Se(t.arrowEndX)||!Se(t.arrowEndY),g=3,m=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,p=g*m,y=Vr({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),w=y<p,T=Vr({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),O=T<p,I=!1;if(f||d||w){I=!0;var R={x:t.ctrlpts[0]-i.x,y:t.ctrlpts[1]-i.y},L=Math.sqrt(R.x*R.x+R.y*R.y),N={x:R.x/L,y:R.y/L},E=Math.max(a,o),C={x:t.ctrlpts[0]+N.x*2*E,y:t.ctrlpts[1]+N.y*2*E},b=u.intersectLine(i.x,i.y,a,o,C.x,C.y,0);w?(t.ctrlpts[0]=t.ctrlpts[0]+N.x*(p-y),t.ctrlpts[1]=t.ctrlpts[1]+N.y*(p-y)):(t.ctrlpts[0]=b[0]+N.x*p,t.ctrlpts[1]=b[1]+N.y*p)}if(c||v||O){I=!0;var M={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},D=Math.sqrt(M.x*M.x+M.y*M.y),H={x:M.x/D,y:M.y/D},k=Math.max(a,o),B={x:t.ctrlpts[0]+H.x*2*k,y:t.ctrlpts[1]+H.y*2*k},U=h.intersectLine(n.x,n.y,s,l,B.x,B.y,0);O?(t.ctrlpts[0]=t.ctrlpts[0]+H.x*(p-T),t.ctrlpts[1]=t.ctrlpts[1]+H.y*(p-T)):(t.ctrlpts[0]=U[0]+H.x*p,t.ctrlpts[1]=U[1]+H.y*p)}I&&this.findEndpoints(r)}};Lt.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var i,n;e.ctrlpts.length/2%2===0?(i=e.allpts.length/2-1,e.midX=e.allpts[i],e.midY=e.allpts[i+1]):(i=e.allpts.length/2-3,n=.5,e.midX=gt(e.allpts[i],e.allpts[i+2],e.allpts[i+4],n),e.midY=gt(e.allpts[i+1],e.allpts[i+3],e.allpts[i+5],n))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments")if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.segpts.length%4===0){var a=e.segpts.length/2,o=a-2;e.midX=(e.segpts[o]+e.segpts[a])/2,e.midY=(e.segpts[o+1]+e.segpts[a+1])/2}else{var s=e.segpts.length/2-1;e.midX=e.segpts[s],e.midY=e.segpts[s+1]}};Lt.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Se(e.startX)&&Se(e.startY)&&Se(e.endX)&&Se(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Xe("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};Lt.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,i=t.cy,n=i.hasCompoundNodes(),a={map:new Kt,get:function(R){var L=this.map.get(R[0]);return L!=null?L.get(R[1]):null},set:function(R,L){var N=this.map.get(R[0]);N==null&&(N=new Kt,this.map.set(R[0],N)),N.set(R[1],L)}},o=[],s=[],l=0;l<r.length;l++){var u=r[l],h=u._private,f=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(f==="haystack"){s.push(u);continue}var d=f==="unbundled-bezier"||f==="segments"||f==="straight"||f==="straight-triangle"||f==="taxi",c=f==="unbundled-bezier"||f==="bezier",v=h.source,g=h.target,m=v.poolIndex(),p=g.poolIndex(),y=[m,p].sort(),w=a.get(y);w==null&&(w={eles:[]},a.set(y,w),o.push(y)),w.eles.push(u),d&&(w.hasUnbundled=!0),c&&(w.hasBezier=!0)}}for(var T=function(R){var L=o[R],N=a.get(L),E=void 0;if(!N.hasUnbundled){var C=N.eles[0].parallelEdges().filter(function(se){return se.isBundledBezier()});Lo(N.eles),C.forEach(function(se){return N.eles.push(se)}),N.eles.sort(function(se,F){return se.poolIndex()-F.poolIndex()})}var b=N.eles[0],M=b.source(),D=b.target();if(M.poolIndex()>D.poolIndex()){var H=M;M=D,D=H}var k=N.srcPos=M.position(),B=N.tgtPos=D.position(),U=N.srcW=M.outerWidth(),W=N.srcH=M.outerHeight(),J=N.tgtW=D.outerWidth(),G=N.tgtH=D.outerHeight(),X=N.srcShape=t.nodeShapes[e.getNodeShape(M)],ie=N.tgtShape=t.nodeShapes[e.getNodeShape(D)];N.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var ee=0;ee<N.eles.length;ee++){var q=N.eles[ee],$=q[0]._private.rscratch,V=q.pstyle("curve-style").value,re=V==="unbundled-bezier"||V==="segments"||V==="taxi",ae=!M.same(q.source());if(!N.calculatedIntersection&&M!==D&&(N.hasBezier||N.hasUnbundled)){N.calculatedIntersection=!0;var de=X.intersectLine(k.x,k.y,U,W,B.x,B.y,0),ye=N.srcIntn=de,Te=ie.intersectLine(B.x,B.y,J,G,k.x,k.y,0),Oe=N.tgtIntn=Te,ce=N.intersectionPts={x1:de[0],x2:Te[0],y1:de[1],y2:Te[1]},x=N.posPts={x1:k.x,x2:B.x,y1:k.y,y2:B.y},z=Te[1]-de[1],j=Te[0]-de[0],te=Math.sqrt(j*j+z*z),K=N.vector={x:j,y:z},le=N.vectorNorm={x:K.x/te,y:K.y/te},fe={x:-le.y,y:le.x};N.nodesOverlap=!Se(te)||ie.checkPoint(de[0],de[1],0,J,G,B.x,B.y)||X.checkPoint(Te[0],Te[1],0,U,W,k.x,k.y),N.vectorNormInverse=fe,E={nodesOverlap:N.nodesOverlap,dirCounts:N.dirCounts,calculatedIntersection:!0,hasBezier:N.hasBezier,hasUnbundled:N.hasUnbundled,eles:N.eles,srcPos:B,tgtPos:k,srcW:J,srcH:G,tgtW:U,tgtH:W,srcIntn:Oe,tgtIntn:ye,srcShape:ie,tgtShape:X,posPts:{x1:x.x2,y1:x.y2,x2:x.x1,y2:x.y1},intersectionPts:{x1:ce.x2,y1:ce.y2,x2:ce.x1,y2:ce.y1},vector:{x:-K.x,y:-K.y},vectorNorm:{x:-le.x,y:-le.y},vectorNormInverse:{x:-fe.x,y:-fe.y}}}var me=ae?E:N;$.nodesOverlap=me.nodesOverlap,$.srcIntn=me.srcIntn,$.tgtIntn=me.tgtIntn,n&&(M.isParent()||M.isChild()||D.isParent()||D.isChild())&&(M.parents().anySame(D)||D.parents().anySame(M)||M.same(D)&&M.isParent())?e.findCompoundLoopPoints(q,me,ee,re):M===D?e.findLoopPoints(q,me,ee,re):V==="segments"?e.findSegmentsPoints(q,me):V==="taxi"?e.findTaxiPoints(q,me):V==="straight"||!re&&N.eles.length%2===1&&ee===Math.floor(N.eles.length/2)?e.findStraightEdgePoints(q):e.findBezierPoints(q,me,ee,re,ae),e.findEndpoints(q),e.tryToCorrectInvalidPoints(q,me),e.checkForInvalidEdgeWarning(q),e.storeAllpts(q),e.storeEdgeProjections(q),e.calculateArrowAngles(q),e.recalculateEdgeLabelProjections(q),e.calculateLabelAngles(q)}},O=0;O<o.length;O++)T(O);this.findHaystackPoints(s)}};function bh(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var i=r[t],n=r[t+1];e.push({x:i,y:n})}return e}}Lt.getSegmentPoints=function(r){var e=r[0]._private.rscratch,t=e.edgeType;if(t==="segments")return this.recalculateRenderedStyle(r),bh(e.segpts)};Lt.getControlPoints=function(r){var e=r[0]._private.rscratch,t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return this.recalculateRenderedStyle(r),bh(e.ctrlpts)};Lt.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var dn={};dn.manualEndptToPx=function(r,e){var t=this,i=r.position(),n=r.outerWidth(),a=r.outerHeight();if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*n),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=i.x,o[1]+=i.y,o}else{var s=e.pfValue[0];s=-Math.PI/2+s;var l=2*Math.max(n,a),u=[i.x+Math.cos(s)*l,i.y+Math.sin(s)*l];return t.nodeShapes[this.getNodeShape(r)].intersectLine(i.x,i.y,n,a,u[0],u[1],0)}};dn.findEndpoints=function(r){var e=this,t,i=r.source()[0],n=r.target()[0],a=i.position(),o=n.position(),s=r.pstyle("target-arrow-shape").value,l=r.pstyle("source-arrow-shape").value,u=r.pstyle("target-distance-from-node").pfValue,h=r.pstyle("source-distance-from-node").pfValue,f=r.pstyle("curve-style").value,d=r._private.rscratch,c=d.edgeType,v=f==="taxi",g=c==="self"||c==="compound",m=c==="bezier"||c==="multibezier"||g,p=c!=="bezier",y=c==="straight"||c==="segments",w=c==="segments",T=m||p||y,O=g||v,I=r.pstyle("source-endpoint"),R=O?"outside-to-node":I.value,L=r.pstyle("target-endpoint"),N=O?"outside-to-node":L.value;d.srcManEndpt=I,d.tgtManEndpt=L;var E,C,b,M;if(m){var D=[d.ctrlpts[0],d.ctrlpts[1]],H=p?[d.ctrlpts[d.ctrlpts.length-2],d.ctrlpts[d.ctrlpts.length-1]]:D;E=H,C=D}else if(y){var k=w?d.segpts.slice(0,2):[o.x,o.y],B=w?d.segpts.slice(d.segpts.length-2):[a.x,a.y];E=B,C=k}if(N==="inside-to-node")t=[o.x,o.y];else if(L.units)t=this.manualEndptToPx(n,L);else if(N==="outside-to-line")t=d.tgtIntn;else if(N==="outside-to-node"||N==="outside-to-node-or-label"?b=E:(N==="outside-to-line"||N==="outside-to-line-or-label")&&(b=[a.x,a.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(o.x,o.y,n.outerWidth(),n.outerHeight(),b[0],b[1],0),N==="outside-to-node-or-label"||N==="outside-to-line-or-label"){var U=n._private.rscratch,W=U.labelWidth,J=U.labelHeight,G=U.labelX,X=U.labelY,ie=W/2,ee=J/2,q=n.pstyle("text-valign").value;q==="top"?X-=ee:q==="bottom"&&(X+=ee);var $=n.pstyle("text-halign").value;$==="left"?G-=ie:$==="right"&&(G+=ie);var V=Ki(b[0],b[1],[G-ie,X-ee,G+ie,X-ee,G+ie,X+ee,G-ie,X+ee],o.x,o.y);if(V.length>0){var re=a,ae=Br(re,li(t)),de=Br(re,li(V)),ye=ae;if(de<ae&&(t=V,ye=de),V.length>2){var Te=Br(re,{x:V[2],y:V[3]});Te<ye&&(t=[V[2],V[3]])}}}var Oe=xn(t,E,e.arrowShapes[s].spacing(r)+u),ce=xn(t,E,e.arrowShapes[s].gap(r)+u);if(d.endX=ce[0],d.endY=ce[1],d.arrowEndX=Oe[0],d.arrowEndY=Oe[1],R==="inside-to-node")t=[a.x,a.y];else if(I.units)t=this.manualEndptToPx(i,I);else if(R==="outside-to-line")t=d.srcIntn;else if(R==="outside-to-node"||R==="outside-to-node-or-label"?M=C:(R==="outside-to-line"||R==="outside-to-line-or-label")&&(M=[o.x,o.y]),t=e.nodeShapes[this.getNodeShape(i)].intersectLine(a.x,a.y,i.outerWidth(),i.outerHeight(),M[0],M[1],0),R==="outside-to-node-or-label"||R==="outside-to-line-or-label"){var x=i._private.rscratch,z=x.labelWidth,j=x.labelHeight,te=x.labelX,K=x.labelY,le=z/2,fe=j/2,me=i.pstyle("text-valign").value;me==="top"?K-=fe:me==="bottom"&&(K+=fe);var se=i.pstyle("text-halign").value;se==="left"?te-=le:se==="right"&&(te+=le);var F=Ki(M[0],M[1],[te-le,K-fe,te+le,K-fe,te+le,K+fe,te-le,K+fe],a.x,a.y);if(F.length>0){var Q=o,ue=Br(Q,li(t)),oe=Br(Q,li(F)),Z=ue;if(oe<ue&&(t=[F[0],F[1]],Z=oe),F.length>2){var P=Br(Q,{x:F[2],y:F[3]});P<Z&&(t=[F[2],F[3]])}}}var S=xn(t,C,e.arrowShapes[l].spacing(r)+h),A=xn(t,C,e.arrowShapes[l].gap(r)+h);d.startX=A[0],d.startY=A[1],d.arrowStartX=S[0],d.arrowStartY=S[1],T&&(!Se(d.startX)||!Se(d.startY)||!Se(d.endX)||!Se(d.endY)?d.badLine=!0:d.badLine=!1)};dn.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};dn.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var Uo={};function _E(r,e,t){for(var i=function(u,h,f,d){return gt(u,h,f,d)},n=e._private,a=n.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var s=r.bezierProjPcts[o];a.push({x:i(t[0],t[2],t[4],s),y:i(t[1],t[3],t[5],s)})}}Uo.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,i=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,i==="multibezier"||i==="bezier"||i==="self"||i==="compound"){e.rstyle.bezierPts=[];for(var n=0;n+5<t.allpts.length;n+=4)_E(this,r,t.allpts.slice(n,n+6))}else if(i==="segments")for(var a=e.rstyle.linePts=[],n=0;n+1<t.allpts.length;n+=2)a.push({x:t.allpts[n],y:t.allpts[n+1]});else if(i==="haystack"){var o=t.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};Uo.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var Jt={};Jt.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!Lr(e)){var t,i,n=r._private,a=r.width(),o=r.height(),s=r.padding(),l=r.position(),u=r.pstyle("text-halign").strValue,h=r.pstyle("text-valign").strValue,f=n.rscratch,d=n.rstyle;switch(u){case"left":t=l.x-a/2-s;break;case"right":t=l.x+a/2+s;break;default:t=l.x}switch(h){case"top":i=l.y-o/2-s;break;case"bottom":i=l.y+o/2+s;break;default:i=l.y}f.labelX=t,f.labelY=i,d.labelX=t,d.labelY=i,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var xh=function(e,t){var i=Math.atan(t/e);return e===0&&i<0&&(i=i*-1),i},Sh=function(e,t){var i=t.x-e.x,n=t.y-e.y;return xh(i,n)},FE=function(e,t,i,n){var a=Zi(0,n-.001,1),o=Zi(0,n+.001,1),s=fi(e,t,i,a),l=fi(e,t,i,o);return Sh(s,l)};Jt.recalculateEdgeLabelProjections=function(r){var e,t=r._private,i=t.rscratch,n=this,a={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(!!(a.mid||a.source||a.target)){e={x:i.midX,y:i.midY};var o=function(f,d,c){Tr(t.rscratch,f,d,c),Tr(t.rstyle,f,d,c)};o("labelX",null,e.x),o("labelY",null,e.y);var s=xh(i.midDispX,i.midDispY);o("labelAutoAngle",null,s);var l=function h(){if(h.cache)return h.cache;for(var f=[],d=0;d+5<i.allpts.length;d+=4){var c={x:i.allpts[d],y:i.allpts[d+1]},v={x:i.allpts[d+2],y:i.allpts[d+3]},g={x:i.allpts[d+4],y:i.allpts[d+5]};f.push({p0:c,p1:v,p2:g,startDist:0,length:0,segments:[]})}var m=t.rstyle.bezierPts,p=n.bezierProjPcts.length;function y(R,L,N,E,C){var b=Vr(L,N),M=R.segments[R.segments.length-1],D={p0:L,p1:N,t0:E,t1:C,startDist:M?M.startDist+M.length:0,length:b};R.segments.push(D),R.length+=b}for(var w=0;w<f.length;w++){var T=f[w],O=f[w-1];O&&(T.startDist=O.startDist+O.length),y(T,T.p0,m[w*p],0,n.bezierProjPcts[0]);for(var I=0;I<p-1;I++)y(T,m[w*p+I],m[w*p+I+1],n.bezierProjPcts[I],n.bezierProjPcts[I+1]);y(T,m[w*p+p-1],T.p2,n.bezierProjPcts[p-1],1)}return h.cache=f},u=function(f){var d,c=f==="source";if(!!a[f]){var v=r.pstyle(f+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var g=l(),m,p=0,y=0,w=0;w<g.length;w++){for(var T=g[c?w:g.length-1-w],O=0;O<T.segments.length;O++){var I=T.segments[c?O:T.segments.length-1-O],R=w===g.length-1&&O===T.segments.length-1;if(p=y,y+=I.length,y>=v||R){m={cp:T,segment:I};break}}if(m)break}var L=m.cp,N=m.segment,E=(v-p)/N.length,C=N.t1-N.t0,b=c?N.t0+C*E:N.t1-C*E;b=Zi(0,b,1),e=fi(L.p0,L.p1,L.p2,b),d=FE(L.p0,L.p1,L.p2,b);break}case"straight":case"segments":case"haystack":{for(var M=0,D,H,k,B,U=i.allpts.length,W=0;W+3<U&&(c?(k={x:i.allpts[W],y:i.allpts[W+1]},B={x:i.allpts[W+2],y:i.allpts[W+3]}):(k={x:i.allpts[U-2-W],y:i.allpts[U-1-W]},B={x:i.allpts[U-4-W],y:i.allpts[U-3-W]}),D=Vr(k,B),H=M,M+=D,!(M>=v));W+=2);var J=v-H,G=J/D;G=Zi(0,G,1),e=Jy(k,B,G),d=Sh(k,B);break}}o("labelX",f,e.x),o("labelY",f,e.y),o("labelAutoAngle",f,d)}};u("source"),u("target"),this.applyLabelDimensions(r)}};Jt.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};Jt.applyPrefixedLabelDimensions=function(r,e){var t=r._private,i=this.getLabelText(r,e),n=this.calculateLabelDimensions(r,i),a=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,s=Wt(t.rscratch,"labelWrapCachedLines",e)||[],l=o!=="wrap"?1:Math.max(s.length,1),u=n.height/l,h=u*a,f=n.width,d=n.height+(l-1)*(a-1)*u;Tr(t.rstyle,"labelWidth",e,f),Tr(t.rscratch,"labelWidth",e,f),Tr(t.rstyle,"labelHeight",e,d),Tr(t.rscratch,"labelHeight",e,d),Tr(t.rscratch,"labelLineHeight",e,h)};Jt.getLabelText=function(r,e){var t=r._private,i=e?e+"-":"",n=r.pstyle(i+"label").strValue,a=r.pstyle("text-transform").value,o=function(J,G){return G?(Tr(t.rscratch,J,e,G),G):Wt(t.rscratch,J,e)};if(!n)return"";a=="none"||(a=="uppercase"?n=n.toUpperCase():a=="lowercase"&&(n=n.toLowerCase()));var s=r.pstyle("text-wrap").value;if(s==="wrap"){var l=o("labelKey");if(l!=null&&o("labelWrapKey")===l)return o("labelWrapCachedText");for(var u="\u200B",h=n.split(`
`),f=r.pstyle("text-max-width").pfValue,d=r.pstyle("text-overflow-wrap").value,c=d==="anywhere",v=[],g=/[\s\u200b]+/,m=c?"":" ",p=0;p<h.length;p++){var y=h[p],w=this.calculateLabelDimensions(r,y),T=w.width;if(c){var O=y.split("").join(u);y=O}if(T>f){for(var I=y.split(g),R="",L=0;L<I.length;L++){var N=I[L],E=R.length===0?N:R+m+N,C=this.calculateLabelDimensions(r,E),b=C.width;b<=f?R+=N+m:(R&&v.push(R),R=N+m)}R.match(/^[\s\u200b]+$/)||v.push(R)}else v.push(y)}o("labelWrapCachedLines",v),n=o("labelWrapCachedText",v.join(`
`)),o("labelWrapKey",l)}else if(s==="ellipsis"){var M=r.pstyle("text-max-width").pfValue,D="",H="\u2026",k=!1;if(this.calculateLabelDimensions(r,n).width<M)return n;for(var B=0;B<n.length;B++){var U=this.calculateLabelDimensions(r,D+n[B]+H).width;if(U>M)break;D+=n[B],B===n.length-1&&(k=!0)}return k||(D+=H),D}return n};Jt.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Jt.calculateLabelDimensions=function(r,e){var t=this,i=Gr(e,r._private.labelDimsKey),n=t.labelDimCache||(t.labelDimCache=[]),a=n[i];if(a!=null)return a;var o=0,s=r.pstyle("font-style").strValue,l=r.pstyle("font-size").pfValue,u=r.pstyle("font-family").strValue,h=r.pstyle("font-weight").strValue,f=this.labelCalcCanvas,d=this.labelCalcCanvasContext;if(!f){f=this.labelCalcCanvas=document.createElement("canvas"),d=this.labelCalcCanvasContext=f.getContext("2d");var c=f.style;c.position="absolute",c.left="-9999px",c.top="-9999px",c.zIndex="-1",c.visibility="hidden",c.pointerEvents="none"}d.font="".concat(s," ").concat(h," ").concat(l,"px ").concat(u);for(var v=0,g=0,m=e.split(`
`),p=0;p<m.length;p++){var y=m[p],w=d.measureText(y),T=Math.ceil(w.width),O=l;v=Math.max(T,v),g+=O}return v+=o,g+=o,n[i]={width:v,height:g}};Jt.calculateLabelAngle=function(r,e){var t=r._private,i=t.rscratch,n=r.isEdge(),a=e?e+"-":"",o=r.pstyle(a+"text-rotation"),s=o.strValue;return s==="none"?0:n&&s==="autorotate"?i.labelAutoAngle:s==="autorotate"?0:o.pfValue};Jt.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),i=r._private,n=i.rscratch;n.labelAngle=e.calculateLabelAngle(r),t&&(n.sourceLabelAngle=e.calculateLabelAngle(r,"source"),n.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var Ch={},hl=28,fl=!1;Ch.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<hl||r.height()<hl))return fl||(Xe("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),fl=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var i=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(i).name}return t};var xa={};xa.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,i=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),s)for(var l=0;l<o.length;l++){var u=o[l],h=u._private,f=h.rstyle;f.clean=!1,f.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(o){var s=o.target;i(s)}).on("style.* background.*",function(o){var s=o.target;i(s,!1)});var n=function(o){if(o){var s=t.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],h=u._private.rstyle;u.isNode()&&!h.cleanConnected&&(i(u.connectedEdges()),h.cleanConnected=!0)}if(s)for(var f=0;f<s.length;f++){var d=s[f];d(o,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){n(!0)},t.beforeRender(n,t.beforeRenderPriorities.eleCalcs)};xa.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};xa.recalculateRenderedStyle=function(r,e){var t=function(T){return T._private.rstyle.cleanConnected},i=[],n=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<r.length;a++){var o=r[a],s=o._private,l=s.rstyle;o.isEdge()&&(!t(o.source())||!t(o.target()))&&(l.clean=!1),!(e&&l.clean||o.removed())&&o.pstyle("display").value!=="none"&&(s.group==="nodes"?n.push(o):i.push(o),l.clean=!0)}for(var u=0;u<n.length;u++){var h=n[u],f=h._private,d=f.rstyle,c=h.position();this.recalculateNodeLabelProjection(h),d.nodeX=c.x,d.nodeY=c.y,d.nodeW=h.pstyle("width").pfValue,d.nodeH=h.pstyle("height").pfValue}this.recalculateEdgeProjections(i);for(var v=0;v<i.length;v++){var g=i[v],m=g._private,p=m.rstyle,y=m.rscratch;p.srcX=y.arrowStartX,p.srcY=y.arrowStartY,p.tgtX=y.arrowEndX,p.tgtY=y.arrowEndY,p.midX=y.midX,p.midY=y.midY,p.labelAngle=y.labelAngle,p.sourceLabelAngle=y.sourceLabelAngle,p.targetLabelAngle=y.targetLabelAngle}}};var Sa={};Sa.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(!!r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var i=r[t],n=i._private.rscratch;i.grabbed()&&!i.isParent()?e.push(i):n.inDragLayer?r.drag.push(i):r.nondrag.push(i)}for(var t=0;t<e.length;t++){var i=e[t];r.drag.push(i)}}};Sa.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Sa.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(fh),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var Dh={};[Qr,jn,Lt,dn,Uo,Jt,Ch,xa,Sa].forEach(function(r){_e(Dh,r)});var Rh={};Rh.getCachedImage=function(r,e,t){var i=this,n=i.imageCache=i.imageCache||{},a=n[r];if(a)return a.image.complete||a.image.addEventListener("load",t),a.image;a=n[r]=n[r]||{};var o=a.image=new Image;o.addEventListener("load",t),o.addEventListener("error",function(){o.error=!0});var s="data:",l=r.substring(0,s.length).toLowerCase()===s;return l||(o.crossOrigin=e),o.src=r,o};var Ri={};Ri.registerBinding=function(r,e,t,i){var n=Array.prototype.slice.apply(arguments,[1]),a=this.binder(r);return a.on.apply(a,n)};Ri.binder=function(r){var e=this,t=r===window||r===document||r===document.body||iy(r);if(e.supportsPassiveEvents==null){var i=!1;try{var n=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});window.addEventListener("test",null,n)}catch{}e.supportsPassiveEvents=i}var a=function(s,l,u){var h=Array.prototype.slice.call(arguments);return t&&e.supportsPassiveEvents&&(h[2]={capture:u!=null?u:!1,passive:!1,once:!1}),e.bindings.push({target:r,args:h}),(r.addEventListener||r.on).apply(r,h),this};return{on:a,addEventListener:a,addListener:a,bind:a}};Ri.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};Ri.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};Ri.load=function(){var r=this,e=function(F){return F.selected()},t=function(F,Q,ue,oe){F==null&&(F=r.cy);for(var Z=0;Z<Q.length;Z++){var P=Q[Z];F.emit({originalEvent:ue,type:P,position:oe})}},i=function(F){return F.shiftKey||F.metaKey||F.ctrlKey},n=function(F,Q){var ue=!0;if(r.cy.hasCompoundNodes()&&F&&F.pannable())for(var oe=0;Q&&oe<Q.length;oe++){var F=Q[oe];if(F.isNode()&&F.isParent()&&!F.pannable()){ue=!1;break}}else ue=!0;return ue},a=function(F){F[0]._private.grabbed=!0},o=function(F){F[0]._private.grabbed=!1},s=function(F){F[0]._private.rscratch.inDragLayer=!0},l=function(F){F[0]._private.rscratch.inDragLayer=!1},u=function(F){F[0]._private.rscratch.isGrabTarget=!0},h=function(F){F[0]._private.rscratch.isGrabTarget=!1},f=function(F,Q){var ue=Q.addToList,oe=ue.has(F);!oe&&F.grabbable()&&!F.locked()&&(ue.merge(F),a(F))},d=function(F,Q){if(!!F.cy().hasCompoundNodes()&&!(Q.inDragLayer==null&&Q.addToList==null)){var ue=F.descendants();Q.inDragLayer&&(ue.forEach(s),ue.connectedEdges().forEach(s)),Q.addToList&&f(ue,Q)}},c=function(F,Q){Q=Q||{};var ue=F.cy().hasCompoundNodes();Q.inDragLayer&&(F.forEach(s),F.neighborhood().stdFilter(function(oe){return!ue||oe.isEdge()}).forEach(s)),Q.addToList&&F.forEach(function(oe){f(oe,Q)}),d(F,Q),m(F,{inDragLayer:Q.inDragLayer}),r.updateCachedGrabbedEles()},v=c,g=function(F){!F||(r.getCachedZSortedEles().forEach(function(Q){o(Q),l(Q),h(Q)}),r.updateCachedGrabbedEles())},m=function(F,Q){if(!(Q.inDragLayer==null&&Q.addToList==null)&&!!F.cy().hasCompoundNodes()){var ue=F.ancestors().orphans();if(!ue.same(F)){var oe=ue.descendants().spawnSelf().merge(ue).unmerge(F).unmerge(F.descendants()),Z=oe.connectedEdges();Q.inDragLayer&&(Z.forEach(s),oe.forEach(s)),Q.addToList&&oe.forEach(function(P){f(P,Q)})}}},p=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},y=typeof MutationObserver<"u",w=typeof ResizeObserver<"u";y?(r.removeObserver=new MutationObserver(function(se){for(var F=0;F<se.length;F++){var Q=se[F],ue=Q.removedNodes;if(ue)for(var oe=0;oe<ue.length;oe++){var Z=ue[oe];if(Z===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(se){r.destroy()});var T=fa.default(function(){r.cy.resize()},100);y&&(r.styleObserver=new MutationObserver(T),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(window,"resize",T),w&&(r.resizeObserver=new ResizeObserver(T),r.resizeObserver.observe(r.container));var O=function(F,Q){for(;F!=null;)Q(F),F=F.parentNode},I=function(){r.invalidateContainerClientCoordsCache()};O(r.container,function(se){r.registerBinding(se,"transitionend",I),r.registerBinding(se,"animationend",I),r.registerBinding(se,"scroll",I)}),r.registerBinding(r.container,"contextmenu",function(se){se.preventDefault()});var R=function(){return r.selection[4]!==0},L=function(F){for(var Q=r.findContainerClientCoords(),ue=Q[0],oe=Q[1],Z=Q[2],P=Q[3],S=F.touches?F.touches:[F],A=!1,_=0;_<S.length;_++){var Y=S[_];if(ue<=Y.clientX&&Y.clientX<=ue+Z&&oe<=Y.clientY&&Y.clientY<=oe+P){A=!0;break}}if(!A)return!1;for(var ne=r.container,pe=F.target,he=pe.parentNode,ge=!1;he;){if(he===ne){ge=!0;break}he=he.parentNode}return!!ge};r.registerBinding(r.container,"mousedown",function(F){if(!!L(F)){F.preventDefault(),p(),r.hoverData.capture=!0,r.hoverData.which=F.which;var Q=r.cy,ue=[F.clientX,F.clientY],oe=r.projectIntoViewport(ue[0],ue[1]),Z=r.selection,P=r.findNearestElements(oe[0],oe[1],!0,!1),S=P[0],A=r.dragData.possibleDragElements;r.hoverData.mdownPos=oe,r.hoverData.mdownGPos=ue;var _=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var we=r.hoverData.down;we?we.emit({originalEvent:F,type:"taphold",position:{x:oe[0],y:oe[1]}}):Q.emit({originalEvent:F,type:"taphold",position:{x:oe[0],y:oe[1]}})}},r.tapholdDuration)};if(F.which==3){r.hoverData.cxtStarted=!0;var Y={originalEvent:F,type:"cxttapstart",position:{x:oe[0],y:oe[1]}};S?(S.activate(),S.emit(Y),r.hoverData.down=S):Q.emit(Y),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(F.which==1){S&&S.activate();{if(S!=null&&r.nodeIsGrabbable(S)){var ne=function(we){return{originalEvent:F,type:we,position:{x:oe[0],y:oe[1]}}},pe=function(we){we.emit(ne("grab"))};if(u(S),!S.selected())A=r.dragData.possibleDragElements=Q.collection(),v(S,{addToList:A}),S.emit(ne("grabon")).emit(ne("grab"));else{A=r.dragData.possibleDragElements=Q.collection();var he=Q.$(function(ge){return ge.isNode()&&ge.selected()&&r.nodeIsGrabbable(ge)});c(he,{addToList:A}),S.emit(ne("grabon")),he.forEach(pe)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=S,r.hoverData.downs=P,r.hoverData.downTime=new Date().getTime()}t(S,["mousedown","tapstart","vmousedown"],F,{x:oe[0],y:oe[1]}),S==null?(Z[4]=1,r.data.bgActivePosistion={x:oe[0],y:oe[1]},r.redrawHint("select",!0),r.redraw()):S.pannable()&&(Z[4]=1),_()}Z[0]=Z[2]=oe[0],Z[1]=Z[3]=oe[1]}},!1),r.registerBinding(window,"mousemove",function(F){var Q=r.hoverData.capture;if(!(!Q&&!L(F))){var ue=!1,oe=r.cy,Z=oe.zoom(),P=[F.clientX,F.clientY],S=r.projectIntoViewport(P[0],P[1]),A=r.hoverData.mdownPos,_=r.hoverData.mdownGPos,Y=r.selection,ne=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(ne=r.findNearestElement(S[0],S[1],!0,!1));var pe=r.hoverData.last,he=r.hoverData.down,ge=[S[0]-Y[2],S[1]-Y[3]],we=r.dragData.possibleDragElements,Ee;if(_){var Pe=P[0]-_[0],Ce=Pe*Pe,be=P[1]-_[1],xe=be*be,Me=Ce+xe;r.hoverData.isOverThresholdDrag=Ee=Me>=r.desktopTapThreshold2}var Re=i(F);Ee&&(r.hoverData.tapholdCancelled=!0);var De=function(){var ht=r.hoverData.dragDelta=r.hoverData.dragDelta||[];ht.length===0?(ht.push(ge[0]),ht.push(ge[1])):(ht[0]+=ge[0],ht[1]+=ge[1])};ue=!0,t(ne,["mousemove","vmousemove","tapdrag"],F,{x:S[0],y:S[1]});var ze=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||oe.emit({originalEvent:F,type:"boxstart",position:{x:S[0],y:S[1]}}),Y[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(Ee){var Be={originalEvent:F,type:"cxtdrag",position:{x:S[0],y:S[1]}};he?he.emit(Be):oe.emit(Be),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||ne!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:F,type:"cxtdragout",position:{x:S[0],y:S[1]}}),r.hoverData.cxtOver=ne,ne&&ne.emit({originalEvent:F,type:"cxtdragover",position:{x:S[0],y:S[1]}}))}}else if(r.hoverData.dragging){if(ue=!0,oe.panningEnabled()&&oe.userPanningEnabled()){var et;if(r.hoverData.justStartedPan){var lt=r.hoverData.mdownPos;et={x:(S[0]-lt[0])*Z,y:(S[1]-lt[1])*Z},r.hoverData.justStartedPan=!1}else et={x:ge[0]*Z,y:ge[1]*Z};oe.panBy(et),oe.emit("dragpan"),r.hoverData.dragged=!0}S=r.projectIntoViewport(F.clientX,F.clientY)}else if(Y[4]==1&&(he==null||he.pannable())){if(Ee){if(!r.hoverData.dragging&&oe.boxSelectionEnabled()&&(Re||!oe.panningEnabled()||!oe.userPanningEnabled()))ze();else if(!r.hoverData.selecting&&oe.panningEnabled()&&oe.userPanningEnabled()){var ut=n(he,r.hoverData.downs);ut&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,Y[4]=0,r.data.bgActivePosistion=li(A),r.redrawHint("select",!0),r.redraw())}he&&he.pannable()&&he.active()&&he.unactivate()}}else{if(he&&he.pannable()&&he.active()&&he.unactivate(),(!he||!he.grabbed())&&ne!=pe&&(pe&&t(pe,["mouseout","tapdragout"],F,{x:S[0],y:S[1]}),ne&&t(ne,["mouseover","tapdragover"],F,{x:S[0],y:S[1]}),r.hoverData.last=ne),he)if(Ee){if(oe.boxSelectionEnabled()&&Re)he&&he.grabbed()&&(g(we),he.emit("freeon"),we.emit("free"),r.dragData.didDrag&&(he.emit("dragfreeon"),we.emit("dragfree"))),ze();else if(he&&he.grabbed()&&r.nodeIsDraggable(he)){var Fe=!r.dragData.didDrag;Fe&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||c(we,{inDragLayer:!0});var Ie={x:0,y:0};if(Se(ge[0])&&Se(ge[1])&&(Ie.x+=ge[0],Ie.y+=ge[1],Fe)){var Ze=r.hoverData.dragDelta;Ze&&Se(Ze[0])&&Se(Ze[1])&&(Ie.x+=Ze[0],Ie.y+=Ze[1])}r.hoverData.draggingEles=!0,we.silentShift(Ie).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else De();ue=!0}if(Y[2]=S[0],Y[3]=S[1],ue)return F.stopPropagation&&F.stopPropagation(),F.preventDefault&&F.preventDefault(),!1}},!1);var N,E,C;r.registerBinding(window,"mouseup",function(F){var Q=r.hoverData.capture;if(!!Q){r.hoverData.capture=!1;var ue=r.cy,oe=r.projectIntoViewport(F.clientX,F.clientY),Z=r.selection,P=r.findNearestElement(oe[0],oe[1],!0,!1),S=r.dragData.possibleDragElements,A=r.hoverData.down,_=i(F);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,A&&A.unactivate(),r.hoverData.which===3){var Y={originalEvent:F,type:"cxttapend",position:{x:oe[0],y:oe[1]}};if(A?A.emit(Y):ue.emit(Y),!r.hoverData.cxtDragged){var ne={originalEvent:F,type:"cxttap",position:{x:oe[0],y:oe[1]}};A?A.emit(ne):ue.emit(ne)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(t(P,["mouseup","tapend","vmouseup"],F,{x:oe[0],y:oe[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(t(A,["click","tap","vclick"],F,{x:oe[0],y:oe[1]}),E=!1,F.timeStamp-C<=ue.multiClickDebounceTime()?(N&&clearTimeout(N),E=!0,C=null,t(A,["dblclick","dbltap","vdblclick"],F,{x:oe[0],y:oe[1]})):(N=setTimeout(function(){E||t(A,["oneclick","onetap","voneclick"],F,{x:oe[0],y:oe[1]})},ue.multiClickDebounceTime()),C=F.timeStamp)),A==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!i(F)&&(ue.$(e).unselect(["tapunselect"]),S.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=S=ue.collection()),P==A&&!r.dragData.didDrag&&!r.hoverData.selecting&&P!=null&&P._private.selectable&&(r.hoverData.dragging||(ue.selectionType()==="additive"||_?P.selected()?P.unselect(["tapunselect"]):P.select(["tapselect"]):_||(ue.$(e).unmerge(P).unselect(["tapunselect"]),P.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var pe=ue.collection(r.getAllInBox(Z[0],Z[1],Z[2],Z[3]));r.redrawHint("select",!0),pe.length>0&&r.redrawHint("eles",!0),ue.emit({type:"boxend",originalEvent:F,position:{x:oe[0],y:oe[1]}});var he=function(Ee){return Ee.selectable()&&!Ee.selected()};ue.selectionType()==="additive"||_||ue.$(e).unmerge(pe).unselect(),pe.emit("box").stdFilter(he).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!Z[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var ge=A&&A.grabbed();g(S),ge&&(A.emit("freeon"),S.emit("free"),r.dragData.didDrag&&(A.emit("dragfreeon"),S.emit("dragfree")))}}Z[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null}},!1);var b=function(F){if(!r.scrollingPage){var Q=r.cy,ue=Q.zoom(),oe=Q.pan(),Z=r.projectIntoViewport(F.clientX,F.clientY),P=[Z[0]*ue+oe.x,Z[1]*ue+oe.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||R()){F.preventDefault();return}if(Q.panningEnabled()&&Q.userPanningEnabled()&&Q.zoomingEnabled()&&Q.userZoomingEnabled()){F.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var S;F.deltaY!=null?S=F.deltaY/-250:F.wheelDeltaY!=null?S=F.wheelDeltaY/1e3:S=F.wheelDelta/1e3,S=S*r.wheelSensitivity;var A=F.deltaMode===1;A&&(S*=33);var _=Q.zoom()*Math.pow(10,S);F.type==="gesturechange"&&(_=r.gestureStartZoom*F.scale),Q.zoom({level:_,renderedPosition:{x:P[0],y:P[1]}}),Q.emit(F.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",b,!0),r.registerBinding(window,"scroll",function(F){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(F){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||F.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(se){r.hasTouchStarted||b(se)},!0),r.registerBinding(r.container,"mouseout",function(F){var Q=r.projectIntoViewport(F.clientX,F.clientY);r.cy.emit({originalEvent:F,type:"mouseout",position:{x:Q[0],y:Q[1]}})},!1),r.registerBinding(r.container,"mouseover",function(F){var Q=r.projectIntoViewport(F.clientX,F.clientY);r.cy.emit({originalEvent:F,type:"mouseover",position:{x:Q[0],y:Q[1]}})},!1);var M,D,H,k,B,U,W,J,G,X,ie,ee,q,$=function(F,Q,ue,oe){return Math.sqrt((ue-F)*(ue-F)+(oe-Q)*(oe-Q))},V=function(F,Q,ue,oe){return(ue-F)*(ue-F)+(oe-Q)*(oe-Q)},re;r.registerBinding(r.container,"touchstart",re=function(F){if(r.hasTouchStarted=!0,!!L(F)){p(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var Q=r.cy,ue=r.touchData.now,oe=r.touchData.earlier;if(F.touches[0]){var Z=r.projectIntoViewport(F.touches[0].clientX,F.touches[0].clientY);ue[0]=Z[0],ue[1]=Z[1]}if(F.touches[1]){var Z=r.projectIntoViewport(F.touches[1].clientX,F.touches[1].clientY);ue[2]=Z[0],ue[3]=Z[1]}if(F.touches[2]){var Z=r.projectIntoViewport(F.touches[2].clientX,F.touches[2].clientY);ue[4]=Z[0],ue[5]=Z[1]}if(F.touches[1]){r.touchData.singleTouchMoved=!0,g(r.dragData.touchDragEles);var P=r.findContainerClientCoords();G=P[0],X=P[1],ie=P[2],ee=P[3],M=F.touches[0].clientX-G,D=F.touches[0].clientY-X,H=F.touches[1].clientX-G,k=F.touches[1].clientY-X,q=0<=M&&M<=ie&&0<=H&&H<=ie&&0<=D&&D<=ee&&0<=k&&k<=ee;var S=Q.pan(),A=Q.zoom();B=$(M,D,H,k),U=V(M,D,H,k),W=[(M+H)/2,(D+k)/2],J=[(W[0]-S.x)/A,(W[1]-S.y)/A];var _=200,Y=_*_;if(U<Y&&!F.touches[2]){var ne=r.findNearestElement(ue[0],ue[1],!0,!0),pe=r.findNearestElement(ue[2],ue[3],!0,!0);ne&&ne.isNode()?(ne.activate().emit({originalEvent:F,type:"cxttapstart",position:{x:ue[0],y:ue[1]}}),r.touchData.start=ne):pe&&pe.isNode()?(pe.activate().emit({originalEvent:F,type:"cxttapstart",position:{x:ue[0],y:ue[1]}}),r.touchData.start=pe):Q.emit({originalEvent:F,type:"cxttapstart",position:{x:ue[0],y:ue[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(F.touches[2])Q.boxSelectionEnabled()&&F.preventDefault();else if(!F.touches[1]){if(F.touches[0]){var he=r.findNearestElements(ue[0],ue[1],!0,!0),ge=he[0];if(ge!=null&&(ge.activate(),r.touchData.start=ge,r.touchData.starts=he,r.nodeIsGrabbable(ge))){var we=r.dragData.touchDragEles=Q.collection(),Ee=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),ge.selected()?(Ee=Q.$(function(Me){return Me.selected()&&r.nodeIsGrabbable(Me)}),c(Ee,{addToList:we})):v(ge,{addToList:we}),u(ge);var Pe=function(Re){return{originalEvent:F,type:Re,position:{x:ue[0],y:ue[1]}}};ge.emit(Pe("grabon")),Ee?Ee.forEach(function(Me){Me.emit(Pe("grab"))}):ge.emit(Pe("grab"))}t(ge,["touchstart","tapstart","vmousedown"],F,{x:ue[0],y:ue[1]}),ge==null&&(r.data.bgActivePosistion={x:Z[0],y:Z[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&t(r.touchData.start,["taphold"],F,{x:ue[0],y:ue[1]})},r.tapholdDuration)}}if(F.touches.length>=1){for(var Ce=r.touchData.startPosition=[],be=0;be<ue.length;be++)Ce[be]=oe[be]=ue[be];var xe=F.touches[0];r.touchData.startGPosition=[xe.clientX,xe.clientY]}}},!1);var ae;r.registerBinding(window,"touchmove",ae=function(F){var Q=r.touchData.capture;if(!(!Q&&!L(F))){var ue=r.selection,oe=r.cy,Z=r.touchData.now,P=r.touchData.earlier,S=oe.zoom();if(F.touches[0]){var A=r.projectIntoViewport(F.touches[0].clientX,F.touches[0].clientY);Z[0]=A[0],Z[1]=A[1]}if(F.touches[1]){var A=r.projectIntoViewport(F.touches[1].clientX,F.touches[1].clientY);Z[2]=A[0],Z[3]=A[1]}if(F.touches[2]){var A=r.projectIntoViewport(F.touches[2].clientX,F.touches[2].clientY);Z[4]=A[0],Z[5]=A[1]}var _=r.touchData.startGPosition,Y;if(Q&&F.touches[0]&&_){for(var ne=[],pe=0;pe<Z.length;pe++)ne[pe]=Z[pe]-P[pe];var he=F.touches[0].clientX-_[0],ge=he*he,we=F.touches[0].clientY-_[1],Ee=we*we,Pe=ge+Ee;Y=Pe>=r.touchTapThreshold2}if(Q&&r.touchData.cxt){F.preventDefault();var Ce=F.touches[0].clientX-G,be=F.touches[0].clientY-X,xe=F.touches[1].clientX-G,Me=F.touches[1].clientY-X,Re=V(Ce,be,xe,Me),De=Re/U,ze=150,Be=ze*ze,et=1.5,lt=et*et;if(De>=lt||Re>=Be){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var ut={originalEvent:F,type:"cxttapend",position:{x:Z[0],y:Z[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(ut),r.touchData.start=null):oe.emit(ut)}}if(Q&&r.touchData.cxt){var ut={originalEvent:F,type:"cxtdrag",position:{x:Z[0],y:Z[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(ut):oe.emit(ut),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var Fe=r.findNearestElement(Z[0],Z[1],!0,!0);(!r.touchData.cxtOver||Fe!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:F,type:"cxtdragout",position:{x:Z[0],y:Z[1]}}),r.touchData.cxtOver=Fe,Fe&&Fe.emit({originalEvent:F,type:"cxtdragover",position:{x:Z[0],y:Z[1]}}))}else if(Q&&F.touches[2]&&oe.boxSelectionEnabled())F.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||oe.emit({originalEvent:F,type:"boxstart",position:{x:Z[0],y:Z[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,ue[4]=1,!ue||ue.length===0||ue[0]===void 0?(ue[0]=(Z[0]+Z[2]+Z[4])/3,ue[1]=(Z[1]+Z[3]+Z[5])/3,ue[2]=(Z[0]+Z[2]+Z[4])/3+1,ue[3]=(Z[1]+Z[3]+Z[5])/3+1):(ue[2]=(Z[0]+Z[2]+Z[4])/3,ue[3]=(Z[1]+Z[3]+Z[5])/3),r.redrawHint("select",!0),r.redraw();else if(Q&&F.touches[1]&&!r.touchData.didSelect&&oe.zoomingEnabled()&&oe.panningEnabled()&&oe.userZoomingEnabled()&&oe.userPanningEnabled()){F.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Ie=r.dragData.touchDragEles;if(Ie){r.redrawHint("drag",!0);for(var Ze=0;Ze<Ie.length;Ze++){var ft=Ie[Ze]._private;ft.grabbed=!1,ft.rscratch.inDragLayer=!1}}var ht=r.touchData.start,Ce=F.touches[0].clientX-G,be=F.touches[0].clientY-X,xe=F.touches[1].clientX-G,Me=F.touches[1].clientY-X,bt=$(Ce,be,xe,Me),fr=bt/B;if(q){var cr=Ce-M,er=be-D,Jr=xe-H,dr=Me-k,vr=(cr+Jr)/2,pn=(er+dr)/2,tr=oe.zoom(),$r=tr*fr,gr=oe.pan(),mn=J[0]*tr+gr.x,ei=J[1]*tr+gr.y,yn={x:-$r/tr*(mn-gr.x-vr)+mn,y:-$r/tr*(ei-gr.y-pn)+ei};if(ht&&ht.active()){var Ie=r.dragData.touchDragEles;g(Ie),r.redrawHint("drag",!0),r.redrawHint("eles",!0),ht.unactivate().emit("freeon"),Ie.emit("free"),r.dragData.didDrag&&(ht.emit("dragfreeon"),Ie.emit("dragfree"))}oe.viewport({zoom:$r,pan:yn,cancelOnFailedZoom:!0}),oe.emit("pinchzoom"),B=bt,M=Ce,D=be,H=xe,k=Me,r.pinching=!0}if(F.touches[0]){var A=r.projectIntoViewport(F.touches[0].clientX,F.touches[0].clientY);Z[0]=A[0],Z[1]=A[1]}if(F.touches[1]){var A=r.projectIntoViewport(F.touches[1].clientX,F.touches[1].clientY);Z[2]=A[0],Z[3]=A[1]}if(F.touches[2]){var A=r.projectIntoViewport(F.touches[2].clientX,F.touches[2].clientY);Z[4]=A[0],Z[5]=A[1]}}else if(F.touches[0]&&!r.touchData.didSelect){var Ot=r.touchData.start,Fr=r.touchData.last,Fe;if(!r.hoverData.draggingEles&&!r.swipePanning&&(Fe=r.findNearestElement(Z[0],Z[1],!0,!0)),Q&&Ot!=null&&F.preventDefault(),Q&&Ot!=null&&r.nodeIsDraggable(Ot))if(Y){var Ie=r.dragData.touchDragEles,Oi=!r.dragData.didDrag;Oi&&c(Ie,{inDragLayer:!0}),r.dragData.didDrag=!0;var it={x:0,y:0};if(Se(ne[0])&&Se(ne[1])&&(it.x+=ne[0],it.y+=ne[1],Oi)){r.redrawHint("eles",!0);var Ae=r.touchData.dragDelta;Ae&&Se(Ae[0])&&Se(Ae[1])&&(it.x+=Ae[0],it.y+=Ae[1])}r.hoverData.draggingEles=!0,Ie.silentShift(it).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==P[0]&&r.touchData.startPosition[1]==P[1]&&r.redrawHint("eles",!0),r.redraw()}else{var Ae=r.touchData.dragDelta=r.touchData.dragDelta||[];Ae.length===0?(Ae.push(ne[0]),Ae.push(ne[1])):(Ae[0]+=ne[0],Ae[1]+=ne[1])}if(t(Ot||Fe,["touchmove","tapdrag","vmousemove"],F,{x:Z[0],y:Z[1]}),(!Ot||!Ot.grabbed())&&Fe!=Fr&&(Fr&&Fr.emit({originalEvent:F,type:"tapdragout",position:{x:Z[0],y:Z[1]}}),Fe&&Fe.emit({originalEvent:F,type:"tapdragover",position:{x:Z[0],y:Z[1]}})),r.touchData.last=Fe,Q)for(var Ze=0;Ze<Z.length;Ze++)Z[Ze]&&r.touchData.startPosition[Ze]&&Y&&(r.touchData.singleTouchMoved=!0);if(Q&&(Ot==null||Ot.pannable())&&oe.panningEnabled()&&oe.userPanningEnabled()){var We=n(Ot,r.touchData.starts);We&&(F.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=li(r.touchData.startPosition)),r.swipePanning?(oe.panBy({x:ne[0]*S,y:ne[1]*S}),oe.emit("dragpan")):Y&&(r.swipePanning=!0,oe.panBy({x:he*S,y:we*S}),oe.emit("dragpan"),Ot&&(Ot.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var A=r.projectIntoViewport(F.touches[0].clientX,F.touches[0].clientY);Z[0]=A[0],Z[1]=A[1]}}for(var pe=0;pe<Z.length;pe++)P[pe]=Z[pe];Q&&F.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var de;r.registerBinding(window,"touchcancel",de=function(F){var Q=r.touchData.start;r.touchData.capture=!1,Q&&Q.unactivate()});var ye,Te,Oe,ce;if(r.registerBinding(window,"touchend",ye=function(F){var Q=r.touchData.start,ue=r.touchData.capture;if(ue)F.touches.length===0&&(r.touchData.capture=!1),F.preventDefault();else return;var oe=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var Z=r.cy,P=Z.zoom(),S=r.touchData.now,A=r.touchData.earlier;if(F.touches[0]){var _=r.projectIntoViewport(F.touches[0].clientX,F.touches[0].clientY);S[0]=_[0],S[1]=_[1]}if(F.touches[1]){var _=r.projectIntoViewport(F.touches[1].clientX,F.touches[1].clientY);S[2]=_[0],S[3]=_[1]}if(F.touches[2]){var _=r.projectIntoViewport(F.touches[2].clientX,F.touches[2].clientY);S[4]=_[0],S[5]=_[1]}Q&&Q.unactivate();var Y;if(r.touchData.cxt){if(Y={originalEvent:F,type:"cxttapend",position:{x:S[0],y:S[1]}},Q?Q.emit(Y):Z.emit(Y),!r.touchData.cxtDragged){var ne={originalEvent:F,type:"cxttap",position:{x:S[0],y:S[1]}};Q?Q.emit(ne):Z.emit(ne)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!F.touches[2]&&Z.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var pe=Z.collection(r.getAllInBox(oe[0],oe[1],oe[2],oe[3]));oe[0]=void 0,oe[1]=void 0,oe[2]=void 0,oe[3]=void 0,oe[4]=0,r.redrawHint("select",!0),Z.emit({type:"boxend",originalEvent:F,position:{x:S[0],y:S[1]}});var he=function(Be){return Be.selectable()&&!Be.selected()};pe.emit("box").stdFilter(he).select().emit("boxselect"),pe.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(Q!=null&&Q.unactivate(),F.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!F.touches[1]){if(!F.touches[0]){if(!F.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var ge=r.dragData.touchDragEles;if(Q!=null){var we=Q._private.grabbed;g(ge),r.redrawHint("drag",!0),r.redrawHint("eles",!0),we&&(Q.emit("freeon"),ge.emit("free"),r.dragData.didDrag&&(Q.emit("dragfreeon"),ge.emit("dragfree"))),t(Q,["touchend","tapend","vmouseup","tapdragout"],F,{x:S[0],y:S[1]}),Q.unactivate(),r.touchData.start=null}else{var Ee=r.findNearestElement(S[0],S[1],!0,!0);t(Ee,["touchend","tapend","vmouseup","tapdragout"],F,{x:S[0],y:S[1]})}var Pe=r.touchData.startPosition[0]-S[0],Ce=Pe*Pe,be=r.touchData.startPosition[1]-S[1],xe=be*be,Me=Ce+xe,Re=Me*P*P;r.touchData.singleTouchMoved||(Q||Z.$(":selected").unselect(["tapunselect"]),t(Q,["tap","vclick"],F,{x:S[0],y:S[1]}),Te=!1,F.timeStamp-ce<=Z.multiClickDebounceTime()?(Oe&&clearTimeout(Oe),Te=!0,ce=null,t(Q,["dbltap","vdblclick"],F,{x:S[0],y:S[1]})):(Oe=setTimeout(function(){Te||t(Q,["onetap","voneclick"],F,{x:S[0],y:S[1]})},Z.multiClickDebounceTime()),ce=F.timeStamp)),Q!=null&&!r.dragData.didDrag&&Q._private.selectable&&Re<r.touchTapThreshold2&&!r.pinching&&(Z.selectionType()==="single"?(Z.$(e).unmerge(Q).unselect(["tapunselect"]),Q.select(["tapselect"])):Q.selected()?Q.unselect(["tapunselect"]):Q.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var De=0;De<S.length;De++)A[De]=S[De];r.dragData.didDrag=!1,F.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=null,r.touchData.startGPosition=null,r.touchData.didSelect=!1),F.touches.length<2&&(F.touches.length===1&&(r.touchData.startGPosition=[F.touches[0].clientX,F.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var x=[],z=function(F){return{clientX:F.clientX,clientY:F.clientY,force:1,identifier:F.pointerId,pageX:F.pageX,pageY:F.pageY,radiusX:F.width/2,radiusY:F.height/2,screenX:F.screenX,screenY:F.screenY,target:F.target}},j=function(F){return{event:F,touch:z(F)}},te=function(F){x.push(j(F))},K=function(F){for(var Q=0;Q<x.length;Q++){var ue=x[Q];if(ue.event.pointerId===F.pointerId){x.splice(Q,1);return}}},le=function(F){var Q=x.filter(function(ue){return ue.event.pointerId===F.pointerId})[0];Q.event=F,Q.touch=z(F)},fe=function(F){F.touches=x.map(function(Q){return Q.touch})},me=function(F){return F.pointerType==="mouse"||F.pointerType===4};r.registerBinding(r.container,"pointerdown",function(se){me(se)||(se.preventDefault(),te(se),fe(se),re(se))}),r.registerBinding(r.container,"pointerup",function(se){me(se)||(K(se),fe(se),ye(se))}),r.registerBinding(r.container,"pointercancel",function(se){me(se)||(K(se),fe(se),de(se))}),r.registerBinding(r.container,"pointermove",function(se){me(se)||(se.preventDefault(),le(se),fe(se),ae(se))})}};var ur={};ur.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(i,n,a,o,s){this.renderer.nodeShapeImpl("polygon",i,n,a,o,s,this.points)},intersectLine:function(i,n,a,o,s,l,u){return Ki(s,l,this.points,i,n,a/2,o/2,u)},checkPoint:function(i,n,a,o,s,l,u){return sr(i,n,this.points,l,u,o,s,[0,-1],a)}}};ur.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,i,n,a){this.renderer.nodeShapeImpl(this.name,e,t,i,n,a)},intersectLine:function(e,t,i,n,a,o,s){return f0(a,o,e,t,i/2+s,n/2+s)},checkPoint:function(e,t,i,n,a,o,s){return Ur(e,t,n,a,o,s,i)}}};ur.generateRoundPolygon=function(r,e){for(var t=new Array(e.length*2),i=0;i<e.length/2;i++){var n=i*2,a=void 0;i<e.length/2-1?a=(i+1)*2:a=0,t[i*4]=e[n],t[i*4+1]=e[n+1];var o=e[a]-e[n],s=e[a+1]-e[n+1],l=Math.sqrt(o*o+s*s);t[i*4+2]=o/l,t[i*4+3]=s/l}return this.nodeShapes[r]={renderer:this,name:r,points:t,draw:function(h,f,d,c,v){this.renderer.nodeShapeImpl("round-polygon",h,f,d,c,v,this.points)},intersectLine:function(h,f,d,c,v,g,m){return c0(v,g,this.points,h,f,d,c)},checkPoint:function(h,f,d,c,v,g,m){return h0(h,f,this.points,g,m,c,v)}}};ur.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Pt(4,0),draw:function(e,t,i,n,a){this.renderer.nodeShapeImpl(this.name,e,t,i,n,a)},intersectLine:function(e,t,i,n,a,o,s){return Fu(a,o,e,t,i,n,s)},checkPoint:function(e,t,i,n,a,o,s){var l=hn(n,a),u=l*2;return!!(sr(e,t,this.points,o,s,n,a-u,[0,-1],i)||sr(e,t,this.points,o,s,n-u,a,[0,-1],i)||Ur(e,t,u,u,o-n/2+l,s-a/2+l,i)||Ur(e,t,u,u,o+n/2-l,s-a/2+l,i)||Ur(e,t,u,u,o+n/2-l,s+a/2-l,i)||Ur(e,t,u,u,o-n/2+l,s+a/2-l,i))}}};ur.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:Hu(),points:Pt(4,0),draw:function(e,t,i,n,a){this.renderer.nodeShapeImpl(this.name,e,t,i,n,a)},generateCutTrianglePts:function(e,t,i,n){var a=this.cornerLength,o=t/2,s=e/2,l=i-s,u=i+s,h=n-o,f=n+o;return{topLeft:[l,h+a,l+a,h,l+a,h+a],topRight:[u-a,h,u,h+a,u-a,h+a],bottomRight:[u,f-a,u-a,f,u-a,f-a],bottomLeft:[l+a,f,l,f-a,l+a,f-a]}},intersectLine:function(e,t,i,n,a,o,s){var l=this.generateCutTrianglePts(i+2*s,n+2*s,e,t),u=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return Ki(a,o,u,e,t)},checkPoint:function(e,t,i,n,a,o,s){if(sr(e,t,this.points,o,s,n,a-2*this.cornerLength,[0,-1],i)||sr(e,t,this.points,o,s,n-2*this.cornerLength,a,[0,-1],i))return!0;var l=this.generateCutTrianglePts(n,a,o,s);return Nt(e,t,l.topLeft)||Nt(e,t,l.topRight)||Nt(e,t,l.bottomRight)||Nt(e,t,l.bottomLeft)}}};ur.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Pt(4,0),draw:function(e,t,i,n,a){this.renderer.nodeShapeImpl(this.name,e,t,i,n,a)},intersectLine:function(e,t,i,n,a,o,s){var l=.15,u=.5,h=.85,f=this.generateBarrelBezierPts(i+2*s,n+2*s,e,t),d=function(g){var m=fi({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},l),p=fi({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},u),y=fi({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},h);return[g[0],g[1],m.x,m.y,p.x,p.y,y.x,y.y,g[4],g[5]]},c=[].concat(d(f.topLeft),d(f.topRight),d(f.bottomRight),d(f.bottomLeft));return Ki(a,o,c,e,t)},generateBarrelBezierPts:function(e,t,i,n){var a=t/2,o=e/2,s=i-o,l=i+o,u=n-a,h=n+a,f=$a(e,t),d=f.heightOffset,c=f.widthOffset,v=f.ctrlPtOffsetPct*e,g={topLeft:[s,u+d,s+v,u,s+c,u],topRight:[l-c,u,l-v,u,l,u+d],bottomRight:[l,h-d,l-v,h,l-c,h],bottomLeft:[s+c,h,s+v,h,s,h-d]};return g.topLeft.isTop=!0,g.topRight.isTop=!0,g.bottomLeft.isBottom=!0,g.bottomRight.isBottom=!0,g},checkPoint:function(e,t,i,n,a,o,s){var l=$a(n,a),u=l.heightOffset,h=l.widthOffset;if(sr(e,t,this.points,o,s,n,a-2*u,[0,-1],i)||sr(e,t,this.points,o,s,n-2*h,a,[0,-1],i))return!0;for(var f=this.generateBarrelBezierPts(n,a,o,s),d=function(R,L,N){var E=N[4],C=N[2],b=N[0],M=N[5],D=N[1],H=Math.min(E,b),k=Math.max(E,b),B=Math.min(M,D),U=Math.max(M,D);if(H<=R&&R<=k&&B<=L&&L<=U){var W=d0(E,C,b),J=o0(W[0],W[1],W[2],R),G=J.filter(function(X){return 0<=X&&X<=1});if(G.length>0)return G[0]}return null},c=Object.keys(f),v=0;v<c.length;v++){var g=c[v],m=f[g],p=d(e,t,m);if(p!=null){var y=m[5],w=m[3],T=m[1],O=gt(y,w,T,p);if(m.isTop&&O<=t||m.isBottom&&t<=O)return!0}}return!1}}};ur.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Pt(4,0),draw:function(e,t,i,n,a){this.renderer.nodeShapeImpl(this.name,e,t,i,n,a)},intersectLine:function(e,t,i,n,a,o,s){var l=e-(i/2+s),u=t-(n/2+s),h=u,f=e+(i/2+s),d=Sr(a,o,e,t,l,u,f,h,!1);return d.length>0?d:Fu(a,o,e,t,i,n,s)},checkPoint:function(e,t,i,n,a,o,s){var l=hn(n,a),u=2*l;if(sr(e,t,this.points,o,s,n,a-u,[0,-1],i)||sr(e,t,this.points,o,s,n-u,a,[0,-1],i))return!0;var h=n/2+2*i,f=a/2+2*i,d=[o-h,s-f,o-h,s,o+h,s,o+h,s-f];return!!(Nt(e,t,d)||Ur(e,t,u,u,o+n/2-l,s+a/2-l,i)||Ur(e,t,u,u,o-n/2+l,s+a/2-l,i))}}};ur.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Pt(3,0)),this.generateRoundPolygon("round-triangle",Pt(3,0)),this.generatePolygon("rectangle",Pt(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",Pt(5,0)),this.generateRoundPolygon("round-pentagon",Pt(5,0)),this.generatePolygon("hexagon",Pt(6,0)),this.generateRoundPolygon("round-hexagon",Pt(6,0)),this.generatePolygon("heptagon",Pt(7,0)),this.generateRoundPolygon("round-heptagon",Pt(7,0)),this.generatePolygon("octagon",Pt(8,0)),this.generateRoundPolygon("round-octagon",Pt(8,0));var i=new Array(20);{var n=Ja(5,0),a=Ja(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<a.length/2;s++)a[s*2]*=o,a[s*2+1]*=o;for(var s=0;s<20/4;s++)i[s*4]=n[s*2],i[s*4+1]=n[s*2+1],i[s*4+2]=a[s*2],i[s*4+3]=a[s*2+1]}i=zu(i),this.generatePolygon("star",i),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}r.makePolygon=function(u){var h=u.join("$"),f="polygon-"+h,d;return(d=this[f])?d:e.generatePolygon(f,u)}};var vn={};vn.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};vn.redraw=function(r){r=r||Nu();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};vn.beforeRender=function(r,e){if(!this.destroyed){e==null&&at("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(i,n){return n.priority-i.priority})}};var cl=function(e,t,i){for(var n=e.beforeRenderCallbacks,a=0;a<n.length;a++)n[a].fn(t,i)};vn.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function i(n){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){cl(r,!0,n);var a=or();r.render(r.renderOptions);var o=r.lastDrawTime=or();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-a),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var s=o-a;r.redrawTotalTime+=s,r.lastRedrawTime=s,r.averageRedrawTime=r.averageRedrawTime/2+s/2,r.requestedFrame=!1}else cl(r,!1,n);r.skipFrame=!1,qn(i)}};qn(t)}};var BE=function(e){this.init(e)},Ph=BE,Pi=Ph.prototype;Pi.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Pi.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container();if(rt){var i=rt.document,n=i.head,a="__________cytoscape_stylesheet",o="__________cytoscape_container",s=i.getElementById(a)!=null;if(t.className.indexOf(o)<0&&(t.className=(t.className||"")+" "+o),!s){var l=i.createElement("style");l.id=a,l.innerHTML="."+o+" { position: relative; }",n.insertBefore(l,n.children[0])}var u=rt.getComputedStyle(t),h=u.getPropertyValue("position");h==="static"&&Xe("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Se(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Pi.notify=function(r,e){var t=this,i=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&i.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Pi.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],i=t,n=i.target;(n.off||n.removeEventListener).apply(n,i.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};Pi.isHeadless=function(){return!1};[Ho,Dh,Rh,Ri,ur,vn].forEach(function(r){_e(Pi,r)});var Wa=1e3/60,Lh={setupDequeueing:function(e){return function(){var i=this,n=this.renderer;if(!i.dequeueingSetup){i.dequeueingSetup=!0;var a=fa.default(function(){n.redrawHint("eles",!0),n.redrawHint("drag",!0),n.redraw()},e.deqRedrawThreshold),o=function(u,h){var f=or(),d=n.averageRedrawTime,c=n.lastRedrawTime,v=[],g=n.cy.extent(),m=n.getPixelRatio();for(u||n.flushRenderedStyleQueue();;){var p=or(),y=p-f,w=p-h;if(c<Wa){var T=Wa-(u?d:0);if(w>=e.deqFastCost*T)break}else if(u){if(y>=e.deqCost*c||y>=e.deqAvgCost*d)break}else if(w>=e.deqNoDrawCost*Wa)break;var O=e.deq(i,m,g);if(O.length>0)for(var I=0;I<O.length;I++)v.push(O[I]);else break}v.length>0&&(e.onDeqd(i,v),!u&&e.shouldRedraw(i,v,m,g)&&a())},s=e.priority||Po;n.beforeRender(o,s(i))}}}},kE=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yn;xo(this,r),this.idsByKey=new Kt,this.keyForId=new Kt,this.cachesByLvl=new Kt,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return So(r,[{key:"getIdsFor",value:function(t){t==null&&at("Can not get id list for null key");var i=this.idsByKey,n=this.idsByKey.get(t);return n||(n=new xi,i.set(t,n)),n}},{key:"addIdForKey",value:function(t,i){t!=null&&this.getIdsFor(t).add(i)}},{key:"deleteIdForKey",value:function(t,i){t!=null&&this.getIdsFor(t).delete(i)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var i=t.id(),n=this.keyForId.get(i),a=this.getKey(t);this.deleteIdForKey(n,i),this.addIdForKey(a,i),this.keyForId.set(i,a)}},{key:"deleteKeyMappingFor",value:function(t){var i=t.id(),n=this.keyForId.get(i);this.deleteIdForKey(n,i),this.keyForId.delete(i)}},{key:"keyHasChangedFor",value:function(t){var i=t.id(),n=this.keyForId.get(i),a=this.getKey(t);return n!==a}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var i=this.cachesByLvl,n=this.lvls,a=i.get(t);return a||(a=new Kt,i.set(t,a),n.push(t)),a}},{key:"getCache",value:function(t,i){return this.getCachesAt(i).get(t)}},{key:"get",value:function(t,i){var n=this.getKey(t),a=this.getCache(n,i);return a!=null&&this.updateKeyMappingFor(t),a}},{key:"getForCachedKey",value:function(t,i){var n=this.keyForId.get(t.id()),a=this.getCache(n,i);return a}},{key:"hasCache",value:function(t,i){return this.getCachesAt(i).has(t)}},{key:"has",value:function(t,i){var n=this.getKey(t);return this.hasCache(n,i)}},{key:"setCache",value:function(t,i,n){n.key=t,this.getCachesAt(i).set(t,n)}},{key:"set",value:function(t,i,n){var a=this.getKey(t);this.setCache(a,i,n),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,i){this.getCachesAt(i).delete(t)}},{key:"delete",value:function(t,i){var n=this.getKey(t);this.deleteCache(n,i)}},{key:"invalidateKey",value:function(t){var i=this;this.lvls.forEach(function(n){return i.deleteCache(t,n)})}},{key:"invalidate",value:function(t){var i=t.id(),n=this.keyForId.get(i);this.deleteKeyMappingFor(t);var a=this.doesEleInvalidateKey(t);return a&&this.invalidateKey(n),a||this.getNumberOfIdsForKey(n)===0}}]),r}(),dl=25,Mn=50,Hn=-4,oo=3,zE=7.99,HE=8,UE=1024,GE=1024,VE=1024,WE=.2,qE=.8,YE=10,XE=.15,ZE=.1,KE=.9,QE=.9,jE=100,JE=1,ui={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},$E=Et({getKey:null,doesEleInvalidateKey:Yn,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Lu,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),zi=function(e,t){var i=this;i.renderer=e,i.onDequeues=[];var n=$E(t);_e(i,n),i.lookup=new kE(n.getKey,n.doesEleInvalidateKey),i.setupDequeueing()},vt=zi.prototype;vt.reasons=ui;vt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};vt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},i=t[r]=t[r]||[];return i};vt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new sn.default(function(t,i){return i.reqs-t.reqs});return e};vt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};vt.getElement=function(r,e,t,i,n){var a=this,o=this.renderer,s=o.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!a.allowEdgeTxrCaching&&r.isEdge()||!a.allowParentTxrCaching&&r.isParent())return null;if(i==null&&(i=Math.ceil(Oo(s*t))),i<Hn)i=Hn;else if(s>=zE||i>oo)return null;var u=Math.pow(2,i),h=e.h*u,f=e.w*u,d=o.eleTextBiggerThanMin(r,u);if(!this.isVisible(r,d))return null;var c=l.get(r,i);if(c&&c.invalidated&&(c.invalidated=!1,c.texture.invalidatedWidth-=c.width),c)return c;var v;if(h<=dl?v=dl:h<=Mn?v=Mn:v=Math.ceil(h/Mn)*Mn,h>VE||f>GE)return null;var g=a.getTextureQueue(v),m=g[g.length-2],p=function(){return a.recycleTexture(v,f)||a.addTexture(v,f)};m||(m=g[g.length-1]),m||(m=p()),m.width-m.usedWidth<f&&(m=p());for(var y=function(k){return k&&k.scaledLabelShown===d},w=n&&n===ui.dequeue,T=n&&n===ui.highQuality,O=n&&n===ui.downscale,I,R=i+1;R<=oo;R++){var L=l.get(r,R);if(L){I=L;break}}var N=I&&I.level===i+1?I:null,E=function(){m.context.drawImage(N.texture.canvas,N.x,0,N.width,N.height,m.usedWidth,0,f,h)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,f,v),y(N))E();else if(y(I))if(T){for(var C=I.level;C>i;C--)N=a.getElement(r,e,t,C,ui.downscale);E()}else return a.queueElement(r,I.level-1),I;else{var b;if(!w&&!T&&!O)for(var M=i-1;M>=Hn;M--){var D=l.get(r,M);if(D){b=D;break}}if(y(b))return a.queueElement(r,i),b;m.context.translate(m.usedWidth,0),m.context.scale(u,u),this.drawElement(m.context,r,e,d,!1),m.context.scale(1/u,1/u),m.context.translate(-m.usedWidth,0)}return c={x:m.usedWidth,texture:m,level:i,scale:u,width:f,height:h,scaledLabelShown:d},m.usedWidth+=Math.ceil(f+HE),m.eleCaches.push(c),l.set(r,i,c),a.checkTextureFullness(m),c};vt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};vt.invalidateElement=function(r){var e=this,t=e.lookup,i=[],n=t.isInvalid(r);if(!!n){for(var a=Hn;a<=oo;a++){var o=t.getForCachedKey(r,a);o&&i.push(o)}var s=t.invalidate(r);if(s)for(var l=0;l<i.length;l++){var u=i[l],h=u.texture;h.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(h)}e.removeFromQueue(r)}};vt.checkTextureUtility=function(r){r.invalidatedWidth>=WE*r.width&&this.retireTexture(r)};vt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>qE&&r.fullnessChecks>=YE?Or(t,r):r.fullnessChecks++};vt.retireTexture=function(r){var e=this,t=r.height,i=e.getTextureQueue(t),n=this.lookup;Or(i,r),r.retired=!0;for(var a=r.eleCaches,o=0;o<a.length;o++){var s=a[o];n.deleteCache(s.key,s.level)}Lo(a);var l=e.getRetiredTextureQueue(t);l.push(r)};vt.addTexture=function(r,e){var t=this,i=t.getTextureQueue(r),n={};return i.push(n),n.eleCaches=[],n.height=r,n.width=Math.max(UE,e),n.usedWidth=0,n.invalidatedWidth=0,n.fullnessChecks=0,n.canvas=t.renderer.makeOffscreenCanvas(n.width,n.height),n.context=n.canvas.getContext("2d"),n};vt.recycleTexture=function(r,e){for(var t=this,i=t.getTextureQueue(r),n=t.getRetiredTextureQueue(r),a=0;a<n.length;a++){var o=n[a];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,Lo(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),Or(n,o),i.push(o),o}};vt.queueElement=function(r,e){var t=this,i=t.getElementQueue(),n=t.getElementKeyToQueue(),a=this.getKey(r),o=n[a];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,i.updateItem(o);else{var s={eles:r.spawn().merge(r),level:e,reqs:1,key:a};i.push(s),n[a]=s}};vt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),i=e.getElementKeyToQueue(),n=[],a=e.lookup,o=0;o<JE&&t.size()>0;o++){var s=t.pop(),l=s.key,u=s.eles[0],h=a.hasCache(u,s.level);if(i[l]=null,h)continue;n.push(s);var f=e.getBoundingBox(u);e.getElement(u,f,r,s.level,ui.dequeue)}return n};vt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),i=e.getElementKeyToQueue(),n=this.getKey(r),a=i[n];a!=null&&(a.eles.length===1?(a.reqs=Ro,t.updateItem(a),t.pop(),i[n]=null):a.eles.unmerge(r))};vt.onDequeue=function(r){this.onDequeues.push(r)};vt.offDequeue=function(r){Or(this.onDequeues,r)};vt.setupDequeueing=Lh.setupDequeueing({deqRedrawThreshold:jE,deqCost:XE,deqAvgCost:ZE,deqNoDrawCost:KE,deqFastCost:QE,deq:function(e,t,i){return e.dequeue(t,i)},onDeqd:function(e,t){for(var i=0;i<e.onDequeues.length;i++){var n=e.onDequeues[i];n(t)}},shouldRedraw:function(e,t,i,n){for(var a=0;a<t.length;a++)for(var o=t[a].eles,s=0;s<o.length;s++){var l=o[s].boundingBox();if(Mo(l,n))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var eT=1,Gi=-4,Jn=2,tT=3.99,rT=50,iT=50,nT=.15,aT=.1,oT=.9,sT=.9,lT=1,vl=250,uT=4e3*4e3,hT=!0,Oh=function(e){var t=this,i=t.renderer=e,n=i.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=or()-2*vl,t.skipping=!1,t.eleTxrDeqs=n.collection(),t.scheduleElementRefinement=fa.default(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},iT),i.beforeRender(function(o,s){s-t.lastInvalidationTime<=vl?t.skipping=!0:t.skipping=!1},i.beforeRenderPriorities.lyrTxrSkip);var a=function(s,l){return l.reqs-s.reqs};t.layersQueue=new sn.default(a),t.setupDequeueing()},Tt=Oh.prototype,gl=0,fT=Math.pow(2,53)-1;Tt.makeLayer=function(r,e){var t=Math.pow(2,e),i=Math.ceil(r.w*t),n=Math.ceil(r.h*t),a=this.renderer.makeOffscreenCanvas(i,n),o={id:gl=++gl%fT,bb:r,level:e,width:i,height:n,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,l=-o.bb.x1,u=-o.bb.y1;return s.scale(t,t),s.translate(l,u),o};Tt.getLayers=function(r,e,t){var i=this,n=i.renderer,a=n.cy,o=a.zoom(),s=i.firstGet;if(i.firstGet=!1,t==null){if(t=Math.ceil(Oo(o*e)),t<Gi)t=Gi;else if(o>=tT||t>Jn)return null}i.validateLayersElesOrdering(t,r);var l=i.layersByLevel,u=Math.pow(2,t),h=l[t]=l[t]||[],f,d=i.levelIsComplete(t,r),c,v=function(){var E=function(H){if(i.validateLayersElesOrdering(H,r),i.levelIsComplete(H,r))return c=l[H],!0},C=function(H){if(!c)for(var k=t+H;Gi<=k&&k<=Jn&&!E(k);k+=H);};C(1),C(-1);for(var b=h.length-1;b>=0;b--){var M=h[b];M.invalid&&Or(h,M)}};if(!d)v();else return h;var g=function(){if(!f){f=It();for(var E=0;E<r.length;E++)t0(f,r[E].boundingBox())}return f},m=function(E){E=E||{};var C=E.after;g();var b=f.w*u*(f.h*u);if(b>uT)return null;var M=i.makeLayer(f,t);if(C!=null){var D=h.indexOf(C)+1;h.splice(D,0,M)}else(E.insert===void 0||E.insert)&&h.unshift(M);return M};if(i.skipping&&!s)return null;for(var p=null,y=r.length/eT,w=!s,T=0;T<r.length;T++){var O=r[T],I=O._private.rscratch,R=I.imgLayerCaches=I.imgLayerCaches||{},L=R[t];if(L){p=L;continue}if((!p||p.eles.length>=y||!_u(p.bb,O.boundingBox()))&&(p=m({insert:!0,after:p}),!p))return null;c||w?i.queueLayer(p,O):i.drawEleInLayer(p,O,t,e),p.eles.push(O),R[t]=p}return c||(w?null:h)};Tt.getEleLevelForLayerLevel=function(r,e){return r};Tt.drawEleInLayer=function(r,e,t,i){var n=this,a=this.renderer,o=r.context,s=e.boundingBox();s.w===0||s.h===0||!e.visible()||(t=n.getEleLevelForLayerLevel(t,i),a.setImgSmoothing(o,!1),a.drawCachedElement(o,e,null,null,t,hT),a.setImgSmoothing(o,!0))};Tt.levelIsComplete=function(r,e){var t=this,i=t.layersByLevel[r];if(!i||i.length===0)return!1;for(var n=0,a=0;a<i.length;a++){var o=i[a];if(o.reqs>0||o.invalid)return!1;n+=o.eles.length}return n===e.length};Tt.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(!!t)for(var i=0;i<t.length;i++){for(var n=t[i],a=-1,o=0;o<e.length;o++)if(n.eles[0]===e[o]){a=o;break}if(a<0){this.invalidateLayer(n);continue}for(var s=a,o=0;o<n.eles.length;o++)if(n.eles[o]!==e[s+o]){this.invalidateLayer(n);break}}};Tt.updateElementsInLayers=function(r,e){for(var t=this,i=un(r[0]),n=0;n<r.length;n++)for(var a=i?null:r[n],o=i?r[n]:r[n].ele,s=o._private.rscratch,l=s.imgLayerCaches=s.imgLayerCaches||{},u=Gi;u<=Jn;u++){var h=l[u];!h||a&&t.getEleLevelForLayerLevel(h.level)!==a.level||e(h,o,a)}};Tt.haveLayers=function(){for(var r=this,e=!1,t=Gi;t<=Jn;t++){var i=r.layersByLevel[t];if(i&&i.length>0){e=!0;break}}return e};Tt.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=or(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(i,n,a){e.invalidateLayer(i)}))};Tt.invalidateLayer=function(r){if(this.lastInvalidationTime=or(),!r.invalid){var e=r.level,t=r.eles,i=this.layersByLevel[e];Or(i,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var n=0;n<t.length;n++){var a=t[n]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};Tt.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(i,n,a){var o=i.replacement;if(o||(o=i.replacement=e.makeLayer(i.bb,i.level),o.replaces=i,o.eles=i.eles),!o.reqs)for(var s=0;s<o.eles.length;s++)e.queueLayer(o,o.eles[s])})};Tt.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};Tt.queueLayer=function(r,e){var t=this,i=t.layersQueue,n=r.elesQueue,a=n.hasId=n.hasId||{};if(!r.replacement){if(e){if(a[e.id()])return;n.push(e),a[e.id()]=!0}r.reqs?(r.reqs++,i.updateItem(r)):(r.reqs=1,i.push(r))}};Tt.dequeue=function(r){for(var e=this,t=e.layersQueue,i=[],n=0;n<lT&&t.size()!==0;){var a=t.peek();if(a.replacement){t.pop();continue}if(a.replaces&&a!==a.replaces.replacement){t.pop();continue}if(a.invalid){t.pop();continue}var o=a.elesQueue.shift();o&&(e.drawEleInLayer(a,o,a.level,r),n++),i.length===0&&i.push(!0),a.elesQueue.length===0&&(t.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return i};Tt.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],i=r.replaces,n=t.indexOf(i);if(!(n<0||i.invalid)){t[n]=r;for(var a=0;a<r.eles.length;a++){var o=r.eles[a]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[r.level]=r)}e.requestRedraw()}};Tt.requestRedraw=fa.default(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);Tt.setupDequeueing=Lh.setupDequeueing({deqRedrawThreshold:rT,deqCost:nT,deqAvgCost:aT,deqNoDrawCost:oT,deqFastCost:sT,deq:function(e,t){return e.dequeue(t)},onDeqd:Po,shouldRedraw:Lu,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var Mh={},pl;function cT(r,e){for(var t=0;t<e.length;t++){var i=e[t];r.lineTo(i.x,i.y)}}function dT(r,e,t){for(var i,n=0;n<e.length;n++){var a=e[n];n===0&&(i=a),r.lineTo(a.x,a.y)}r.quadraticCurveTo(t.x,t.y,i.x,i.y)}function ml(r,e,t){r.beginPath&&r.beginPath();for(var i=e,n=0;n<i.length;n++){var a=i[n];r.lineTo(a.x,a.y)}var o=t,s=t[0];r.moveTo(s.x,s.y);for(var n=1;n<o.length;n++){var a=o[n];r.lineTo(a.x,a.y)}r.closePath&&r.closePath()}function vT(r,e,t,i,n){r.beginPath&&r.beginPath(),r.arc(t,i,n,0,Math.PI*2,!1);var a=e,o=a[0];r.moveTo(o.x,o.y);for(var s=0;s<a.length;s++){var l=a[s];r.lineTo(l.x,l.y)}r.closePath&&r.closePath()}function gT(r,e,t,i){r.arc(e,t,i,0,Math.PI*2,!1)}Mh.arrowShapeImpl=function(r){return(pl||(pl={polygon:cT,"triangle-backcurve":dT,"triangle-tee":ml,"circle-triangle":vT,"triangle-cross":ml,circle:gT}))[r]};var $t={};$t.drawElement=function(r,e,t,i,n,a){var o=this;e.isNode()?o.drawNode(r,e,t,i,n,a):o.drawEdge(r,e,t,i,n,a)};$t.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};$t.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};$t.drawCachedElementPortion=function(r,e,t,i,n,a,o,s){var l=this,u=t.getBoundingBox(e);if(!(u.w===0||u.h===0)){var h=t.getElement(e,u,i,n,a);if(h!=null){var f=s(l,e);if(f===0)return;var d=o(l,e),c=u.x1,v=u.y1,g=u.w,m=u.h,p,y,w,T,O;if(d!==0){var I=t.getRotationPoint(e);w=I.x,T=I.y,r.translate(w,T),r.rotate(d),O=l.getImgSmoothing(r),O||l.setImgSmoothing(r,!0);var R=t.getRotationOffset(e);p=R.x,y=R.y}else p=c,y=v;var L;f!==1&&(L=r.globalAlpha,r.globalAlpha=L*f),r.drawImage(h.texture.canvas,h.x,0,h.width,h.height,p,y,g,m),f!==1&&(r.globalAlpha=L),d!==0&&(r.rotate(-d),r.translate(-w,-T),O||l.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var pT=function(){return 0},mT=function(e,t){return e.getTextAngle(t,null)},yT=function(e,t){return e.getTextAngle(t,"source")},wT=function(e,t){return e.getTextAngle(t,"target")},ET=function(e,t){return t.effectiveOpacity()},qa=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};$t.drawCachedElement=function(r,e,t,i,n,a){var o=this,s=o.data,l=s.eleTxrCache,u=s.lblTxrCache,h=s.slbTxrCache,f=s.tlbTxrCache,d=e.boundingBox(),c=a===!0?l.reasons.highQuality:null;if(!(d.w===0||d.h===0||!e.visible())&&(!i||Mo(d,i))){var v=e.isEdge(),g=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,l,t,n,c,pT,ET),(!v||!g)&&o.drawCachedElementPortion(r,e,u,t,n,c,mT,qa),v&&!g&&(o.drawCachedElementPortion(r,e,h,t,n,c,yT,qa),o.drawCachedElementPortion(r,e,f,t,n,c,wT,qa)),o.drawElementOverlay(r,e)}};$t.drawElements=function(r,e){for(var t=this,i=0;i<e.length;i++){var n=e[i];t.drawElement(r,n)}};$t.drawCachedElements=function(r,e,t,i){for(var n=this,a=0;a<e.length;a++){var o=e[a];n.drawCachedElement(r,o,t,i)}};$t.drawCachedNodes=function(r,e,t,i){for(var n=this,a=0;a<e.length;a++){var o=e[a];!o.isNode()||n.drawCachedElement(r,o,t,i)}};$t.drawLayeredElements=function(r,e,t,i){var n=this,a=n.data.lyrTxrCache.getLayers(e,t);if(a)for(var o=0;o<a.length;o++){var s=a[o],l=s.bb;l.w===0||l.h===0||r.drawImage(s.canvas,l.x1,l.y1,l.w,l.h)}else n.drawCachedElements(r,e,t,i)};var hr={};hr.drawEdge=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s=e._private.rscratch;if(!(a&&!e.visible())&&!(s.badLine||s.allpts==null||isNaN(s.allpts[0]))){var l;t&&(l=t,r.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,h=a?e.pstyle("line-opacity").value:1,f=e.pstyle("curve-style").value,d=e.pstyle("line-style").value,c=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,g=u*h,m=u*h,p=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;f==="straight-triangle"?(o.eleStrokeStyle(r,e,b),o.drawEdgeTrianglePath(e,r,s.allpts)):(r.lineWidth=c,r.lineCap=v,o.eleStrokeStyle(r,e,b),o.drawEdgePath(e,r,s.allpts,d),r.lineCap="butt")},y=function(){!n||o.drawEdgeOverlay(r,e)},w=function(){!n||o.drawEdgeUnderlay(r,e)},T=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;o.drawArrowheads(r,e,b)},O=function(){o.drawElementText(r,e,null,i)};r.lineJoin="round";var I=e.pstyle("ghost").value==="yes";if(I){var R=e.pstyle("ghost-offset-x").pfValue,L=e.pstyle("ghost-offset-y").pfValue,N=e.pstyle("ghost-opacity").value,E=g*N;r.translate(R,L),p(E),T(E),r.translate(-R,-L)}w(),p(),T(),y(),O(),t&&r.translate(l.x1,l.y1)}};var Nh=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,i){if(!!i.visible()){var n=i.pstyle("".concat(e,"-opacity")).value;if(n!==0){var a=this,o=a.usePaths(),s=i._private.rscratch,l=i.pstyle("".concat(e,"-padding")).pfValue,u=2*l,h=i.pstyle("".concat(e,"-color")).value;t.lineWidth=u,s.edgeType==="self"&&!o?t.lineCap="butt":t.lineCap="round",a.colorStrokeStyle(t,h[0],h[1],h[2],n),a.drawEdgePath(i,t,s.allpts,"solid")}}}};hr.drawEdgeOverlay=Nh("overlay");hr.drawEdgeUnderlay=Nh("underlay");hr.drawEdgePath=function(r,e,t,i){var n=r._private.rscratch,a=e,o,s=!1,l=this.usePaths(),u=r.pstyle("line-dash-pattern").pfValue,h=r.pstyle("line-dash-offset").pfValue;if(l){var f=t.join("$"),d=n.pathCacheKey&&n.pathCacheKey===f;d?(o=e=n.pathCache,s=!0):(o=e=new Path2D,n.pathCacheKey=f,n.pathCache=o)}if(a.setLineDash)switch(i){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=h;break;case"solid":a.setLineDash([]);break}if(!s&&!n.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),n.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var c=2;c+3<t.length;c+=4)e.quadraticCurveTo(t[c],t[c+1],t[c+2],t[c+3]);break;case"straight":case"segments":case"haystack":for(var v=2;v+1<t.length;v+=2)e.lineTo(t[v],t[v+1]);break}e=a,l?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};hr.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var i=r.pstyle("width").pfValue,n=0;n+1<t.length;n+=2){var a=[t[n+2]-t[n],t[n+3]-t[n+1]],o=Math.sqrt(a[0]*a[0]+a[1]*a[1]),s=[a[1]/o,-a[0]/o],l=[s[0]*i/2,s[1]*i/2];e.beginPath(),e.moveTo(t[n]-l[0],t[n+1]-l[1]),e.lineTo(t[n]+l[0],t[n+1]+l[1]),e.lineTo(t[n+2],t[n+3]),e.closePath(),e.fill()}};hr.drawArrowheads=function(r,e,t){var i=e._private.rscratch,n=i.edgeType==="haystack";n||this.drawArrowhead(r,e,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,t),n||this.drawArrowhead(r,e,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,t)};hr.drawArrowhead=function(r,e,t,i,n,a,o){if(!(isNaN(i)||i==null||isNaN(n)||n==null||isNaN(a)||a==null)){var s=this,l=e.pstyle(t+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",h=e.pstyle(t+"-arrow-fill").value,f=e.pstyle("width").pfValue,d=e.pstyle("opacity").value;o===void 0&&(o=d);var c=r.globalCompositeOperation;(o!==1||h==="hollow")&&(r.globalCompositeOperation="destination-out",s.colorFillStyle(r,255,255,255,1),s.colorStrokeStyle(r,255,255,255,1),s.drawArrowShape(e,r,u,f,l,i,n,a),r.globalCompositeOperation=c);var v=e.pstyle(t+"-arrow-color").value;s.colorFillStyle(r,v[0],v[1],v[2],o),s.colorStrokeStyle(r,v[0],v[1],v[2],o),s.drawArrowShape(e,r,h,f,l,i,n,a)}}};hr.drawArrowShape=function(r,e,t,i,n,a,o,s){var l=this,u=this.usePaths()&&n!=="triangle-cross",h=!1,f,d=e,c={x:a,y:o},v=r.pstyle("arrow-scale").value,g=this.getArrowWidth(i,v),m=l.arrowShapes[n];if(u){var p=l.arrowPathCache=l.arrowPathCache||[],y=Gr(n),w=p[y];w!=null?(f=e=w,h=!0):(f=e=new Path2D,p[y]=f)}h||(e.beginPath&&e.beginPath(),u?m.draw(e,1,0,{x:0,y:0},1):m.draw(e,g,s,c,i),e.closePath&&e.closePath()),e=d,u&&(e.translate(a,o),e.rotate(s),e.scale(g,g)),(t==="filled"||t==="both")&&(u?e.fill(f):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=(m.matchEdgeWidth?i:1)/(u?g:1),e.lineJoin="miter",u?e.stroke(f):e.stroke()),u&&(e.scale(1/g,1/g),e.rotate(-s),e.translate(-a,-o))};var Go={};Go.safeDrawImage=function(r,e,t,i,n,a,o,s,l,u){if(!(n<=0||a<=0||l<=0||u<=0))try{r.drawImage(e,t,i,n,a,o,s,l,u)}catch(h){Xe(h)}};Go.drawInscribedImage=function(r,e,t,i,n){var a=this,o=t.position(),s=o.x,l=o.y,u=t.cy().style(),h=u.getIndexedStyle.bind(u),f=h(t,"background-fit","value",i),d=h(t,"background-repeat","value",i),c=t.width(),v=t.height(),g=t.padding()*2,m=c+(h(t,"background-width-relative-to","value",i)==="inner"?0:g),p=v+(h(t,"background-height-relative-to","value",i)==="inner"?0:g),y=t._private.rscratch,w=h(t,"background-clip","value",i),T=w==="node",O=h(t,"background-image-opacity","value",i)*n,I=h(t,"background-image-smoothing","value",i),R=e.width||e.cachedW,L=e.height||e.cachedH;(R==null||L==null)&&(document.body.appendChild(e),R=e.cachedW=e.width||e.offsetWidth,L=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var N=R,E=L;if(h(t,"background-width","value",i)!=="auto"&&(h(t,"background-width","units",i)==="%"?N=h(t,"background-width","pfValue",i)*m:N=h(t,"background-width","pfValue",i)),h(t,"background-height","value",i)!=="auto"&&(h(t,"background-height","units",i)==="%"?E=h(t,"background-height","pfValue",i)*p:E=h(t,"background-height","pfValue",i)),!(N===0||E===0)){if(f==="contain"){var C=Math.min(m/N,p/E);N*=C,E*=C}else if(f==="cover"){var C=Math.max(m/N,p/E);N*=C,E*=C}var b=s-m/2,M=h(t,"background-position-x","units",i),D=h(t,"background-position-x","pfValue",i);M==="%"?b+=(m-N)*D:b+=D;var H=h(t,"background-offset-x","units",i),k=h(t,"background-offset-x","pfValue",i);H==="%"?b+=(m-N)*k:b+=k;var B=l-p/2,U=h(t,"background-position-y","units",i),W=h(t,"background-position-y","pfValue",i);U==="%"?B+=(p-E)*W:B+=W;var J=h(t,"background-offset-y","units",i),G=h(t,"background-offset-y","pfValue",i);J==="%"?B+=(p-E)*G:B+=G,y.pathCache&&(b-=s,B-=l,s=0,l=0);var X=r.globalAlpha;r.globalAlpha=O;var ie=a.getImgSmoothing(r),ee=!1;if(I==="no"&&ie?(a.setImgSmoothing(r,!1),ee=!0):I==="yes"&&!ie&&(a.setImgSmoothing(r,!0),ee=!0),d==="no-repeat")T&&(r.save(),y.pathCache?r.clip(y.pathCache):(a.nodeShapes[a.getNodeShape(t)].draw(r,s,l,m,p),r.clip())),a.safeDrawImage(r,e,0,0,R,L,b,B,N,E),T&&r.restore();else{var q=r.createPattern(e,d);r.fillStyle=q,a.nodeShapes[a.getNodeShape(t)].draw(r,s,l,m,p),r.translate(b,B),r.fill(),r.translate(-b,-B)}r.globalAlpha=X,ee&&a.setImgSmoothing(r,ie)}};var jr={};jr.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),i=this.getPixelRatio(),n=Math.ceil(Oo(t*i));e=Math.pow(2,n)}var a=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(a<o)};jr.drawElementText=function(r,e,t,i,n){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(i==null){if(a&&!o.eleTextBiggerThanMin(e))return}else if(i===!1)return;if(e.isNode()){var s=e.pstyle("label");if(!s||!s.value)return;var l=o.getLabelJustification(e);r.textAlign=l,r.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,h=e.pstyle("label"),f=e.pstyle("source-label"),d=e.pstyle("target-label");if(u||(!h||!h.value)&&(!f||!f.value)&&(!d||!d.value))return;r.textAlign="center",r.textBaseline="bottom"}var c=!t,v;t&&(v=t,r.translate(-v.x1,-v.y1)),n==null?(o.drawText(r,e,null,c,a),e.isEdge()&&(o.drawText(r,e,"source",c,a),o.drawText(r,e,"target",c,a))):o.drawText(r,e,n,c,a),t&&r.translate(v.x1,v.y1)};jr.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};jr.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=e.pstyle("font-style").strValue,n=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*s,u=e.pstyle("color").value,h=e.pstyle("text-outline-color").value;r.font=i+" "+o+" "+n+" "+a,r.lineJoin="round",this.colorFillStyle(r,u[0],u[1],u[2],s),this.colorStrokeStyle(r,h[0],h[1],h[2],l)};function TT(r,e,t,i,n){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5;r.beginPath(),r.moveTo(e+a,t),r.lineTo(e+i-a,t),r.quadraticCurveTo(e+i,t,e+i,t+a),r.lineTo(e+i,t+n-a),r.quadraticCurveTo(e+i,t+n,e+i-a,t+n),r.lineTo(e+a,t+n),r.quadraticCurveTo(e,t+n,e,t+n-a),r.lineTo(e,t+a),r.quadraticCurveTo(e,t,e+a,t),r.closePath(),r.fill()}jr.getTextAngle=function(r,e){var t,i=r._private,n=i.rscratch,a=e?e+"-":"",o=r.pstyle(a+"text-rotation"),s=Wt(n,"labelAngle",e);return o.strValue==="autorotate"?t=r.isEdge()?s:0:o.strValue==="none"?t=0:t=o.pfValue,t};jr.drawText=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,o=a.rscratch,s=n?e.effectiveOpacity():1;if(!(n&&(s===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var l=Wt(o,"labelX",t),u=Wt(o,"labelY",t),h,f,d=this.getLabelText(e,t);if(d!=null&&d!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(r,e,n);var c=t?t+"-":"",v=Wt(o,"labelWidth",t),g=Wt(o,"labelHeight",t),m=e.pstyle(c+"text-margin-x").pfValue,p=e.pstyle(c+"text-margin-y").pfValue,y=e.isEdge(),w=e.pstyle("text-halign").value,T=e.pstyle("text-valign").value;y&&(w="center",T="center"),l+=m,u+=p;var O;switch(i?O=this.getTextAngle(e,t):O=0,O!==0&&(h=l,f=u,r.translate(h,f),r.rotate(O),l=0,u=0),T){case"top":break;case"center":u+=g/2;break;case"bottom":u+=g;break}var I=e.pstyle("text-background-opacity").value,R=e.pstyle("text-border-opacity").value,L=e.pstyle("text-border-width").pfValue,N=e.pstyle("text-background-padding").pfValue;if(I>0||L>0&&R>0){var E=l-N;switch(w){case"left":E-=v;break;case"center":E-=v/2;break}var C=u-g-N,b=v+2*N,M=g+2*N;if(I>0){var D=r.fillStyle,H=e.pstyle("text-background-color").value;r.fillStyle="rgba("+H[0]+","+H[1]+","+H[2]+","+I*s+")";var k=e.pstyle("text-background-shape").strValue;k.indexOf("round")===0?TT(r,E,C,b,M,2):r.fillRect(E,C,b,M),r.fillStyle=D}if(L>0&&R>0){var B=r.strokeStyle,U=r.lineWidth,W=e.pstyle("text-border-color").value,J=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+W[0]+","+W[1]+","+W[2]+","+R*s+")",r.lineWidth=L,r.setLineDash)switch(J){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=L/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(r.strokeRect(E,C,b,M),J==="double"){var G=L/2;r.strokeRect(E+G,C+G,b-G*2,M-G*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=U,r.strokeStyle=B}}var X=2*e.pstyle("text-outline-width").pfValue;if(X>0&&(r.lineWidth=X),e.pstyle("text-wrap").value==="wrap"){var ie=Wt(o,"labelWrapCachedLines",t),ee=Wt(o,"labelLineHeight",t),q=v/2,$=this.getLabelJustification(e);switch($==="auto"||(w==="left"?$==="left"?l+=-v:$==="center"&&(l+=-q):w==="center"?$==="left"?l+=-q:$==="right"&&(l+=q):w==="right"&&($==="center"?l+=q:$==="right"&&(l+=v))),T){case"top":u-=(ie.length-1)*ee;break;case"center":case"bottom":u-=(ie.length-1)*ee;break}for(var V=0;V<ie.length;V++)X>0&&r.strokeText(ie[V],l,u),r.fillText(ie[V],l,u),u+=ee}else X>0&&r.strokeText(d,l,u),r.fillText(d,l,u);O!==0&&(r.rotate(-O),r.translate(-h,-f))}}};var Li={};Li.drawNode=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s,l,u=e._private,h=u.rscratch,f=e.position();if(!(!Se(f.x)||!Se(f.y))&&!(a&&!e.visible())){var d=a?e.effectiveOpacity():1,c=o.usePaths(),v,g=!1,m=e.padding();s=e.width()+2*m,l=e.height()+2*m;var p;t&&(p=t,r.translate(-p.x1,-p.y1));for(var y=e.pstyle("background-image"),w=y.value,T=new Array(w.length),O=new Array(w.length),I=0,R=0;R<w.length;R++){var L=w[R],N=T[R]=L!=null&&L!=="none";if(N){var E=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",R);I++,O[R]=o.getCachedImage(L,E,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var C=e.pstyle("background-blacken").value,b=e.pstyle("border-width").pfValue,M=e.pstyle("background-opacity").value*d,D=e.pstyle("border-color").value,H=e.pstyle("border-style").value,k=e.pstyle("border-opacity").value*d;r.lineJoin="miter";var B=function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M;o.eleFillStyle(r,e,te)},U=function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k;o.colorStrokeStyle(r,D[0],D[1],D[2],te)},W=e.pstyle("shape").strValue,J=e.pstyle("shape-polygon-points").pfValue;if(c){r.translate(f.x,f.y);var G=o.nodePathCache=o.nodePathCache||[],X=Pu(W==="polygon"?W+","+J.join(","):W,""+l,""+s),ie=G[X];ie!=null?(v=ie,g=!0,h.pathCache=v):(v=new Path2D,G[X]=h.pathCache=v)}var ee=function(){if(!g){var te=f;c&&(te={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(v||r,te.x,te.y,s,l)}c?r.fill(v):r.fill()},q=function(){for(var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=u.backgrounding,fe=0,me=0;me<O.length;me++){var se=e.cy().style().getIndexedStyle(e,"background-image-containment","value",me);if(K&&se==="over"||!K&&se==="inside"){fe++;continue}T[me]&&O[me].complete&&!O[me].error&&(fe++,o.drawInscribedImage(r,O[me],e,me,te))}u.backgrounding=fe!==I,le!==u.backgrounding&&e.updateStyle(!1)},$=function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;o.hasPie(e)&&(o.drawPie(r,e,K),te&&(c||o.nodeShapes[o.getNodeShape(e)].draw(r,f.x,f.y,s,l)))},V=function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d,K=(C>0?C:-C)*te,le=C>0?0:255;C!==0&&(o.colorFillStyle(r,le,le,le,K),c?r.fill(v):r.fill())},re=function(){if(b>0){if(r.lineWidth=b,r.lineCap="butt",r.setLineDash)switch(H){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}if(c?r.stroke(v):r.stroke(),H==="double"){r.lineWidth=b/3;var te=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",c?r.stroke(v):r.stroke(),r.globalCompositeOperation=te}r.setLineDash&&r.setLineDash([])}},ae=function(){n&&o.drawNodeOverlay(r,e,f,s,l)},de=function(){n&&o.drawNodeUnderlay(r,e,f,s,l)},ye=function(){o.drawElementText(r,e,null,i)},Te=e.pstyle("ghost").value==="yes";if(Te){var Oe=e.pstyle("ghost-offset-x").pfValue,ce=e.pstyle("ghost-offset-y").pfValue,x=e.pstyle("ghost-opacity").value,z=x*d;r.translate(Oe,ce),B(x*M),ee(),q(z,!0),U(x*k),re(),$(C!==0||b!==0),q(z,!1),V(z),r.translate(-Oe,-ce)}c&&r.translate(-f.x,-f.y),de(),c&&r.translate(f.x,f.y),B(),ee(),q(d,!0),U(),re(),$(C!==0||b!==0),q(d,!1),V(),c&&r.translate(-f.x,-f.y),ye(),ae(),t&&r.translate(p.x1,p.y1)}};var Ih=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,i,n,a,o){var s=this;if(!!i.visible()){var l=i.pstyle("".concat(e,"-padding")).pfValue,u=i.pstyle("".concat(e,"-opacity")).value,h=i.pstyle("".concat(e,"-color")).value,f=i.pstyle("".concat(e,"-shape")).value;if(u>0){if(n=n||i.position(),a==null||o==null){var d=i.padding();a=i.width()+2*d,o=i.height()+2*d}s.colorFillStyle(t,h[0],h[1],h[2],u),s.nodeShapes[f].draw(t,n.x,n.y,a+l*2,o+l*2),t.fill()}}}};Li.drawNodeOverlay=Ih("overlay");Li.drawNodeUnderlay=Ih("underlay");Li.hasPie=function(r){return r=r[0],r._private.hasPie};Li.drawPie=function(r,e,t,i){e=e[0],i=i||e.position();var n=e.cy().style(),a=e.pstyle("pie-size"),o=i.x,s=i.y,l=e.width(),u=e.height(),h=Math.min(l,u)/2,f=0,d=this.usePaths();d&&(o=0,s=0),a.units==="%"?h=h*a.pfValue:a.pfValue!==void 0&&(h=a.pfValue/2);for(var c=1;c<=n.pieBackgroundN;c++){var v=e.pstyle("pie-"+c+"-background-size").value,g=e.pstyle("pie-"+c+"-background-color").value,m=e.pstyle("pie-"+c+"-background-opacity").value*t,p=v/100;p+f>1&&(p=1-f);var y=1.5*Math.PI+2*Math.PI*f,w=2*Math.PI*p,T=y+w;v===0||f>=1||f+p>1||(r.beginPath(),r.moveTo(o,s),r.arc(o,s,h,y,T),r.closePath(),this.colorFillStyle(r,g[0],g[1],g[2],m),r.fill(),f+=p)}};var Bt={},bT=100;Bt.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e};Bt.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,i,n=0;n<e.length;n++)if(i=e[n],i.context===r){t=!1;break}return t&&(i={context:r},e.push(i)),i};Bt.createGradientStyleFor=function(r,e,t,i,n){var a,o=this.usePaths(),s=t.pstyle(e+"-gradient-stop-colors").value,l=t.pstyle(e+"-gradient-stop-positions").pfValue;if(i==="radial-gradient")if(t.isEdge()){var u=t.sourceEndpoint(),h=t.targetEndpoint(),f=t.midpoint(),d=Vr(u,f),c=Vr(h,f);a=r.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(d,c))}else{var v=o?{x:0,y:0}:t.position(),g=t.paddedWidth(),m=t.paddedHeight();a=r.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(g,m))}else if(t.isEdge()){var p=t.sourceEndpoint(),y=t.targetEndpoint();a=r.createLinearGradient(p.x,p.y,y.x,y.y)}else{var w=o?{x:0,y:0}:t.position(),T=t.paddedWidth(),O=t.paddedHeight(),I=T/2,R=O/2,L=t.pstyle("background-gradient-direction").value;switch(L){case"to-bottom":a=r.createLinearGradient(w.x,w.y-R,w.x,w.y+R);break;case"to-top":a=r.createLinearGradient(w.x,w.y+R,w.x,w.y-R);break;case"to-left":a=r.createLinearGradient(w.x+I,w.y,w.x-I,w.y);break;case"to-right":a=r.createLinearGradient(w.x-I,w.y,w.x+I,w.y);break;case"to-bottom-right":case"to-right-bottom":a=r.createLinearGradient(w.x-I,w.y-R,w.x+I,w.y+R);break;case"to-top-right":case"to-right-top":a=r.createLinearGradient(w.x-I,w.y+R,w.x+I,w.y-R);break;case"to-bottom-left":case"to-left-bottom":a=r.createLinearGradient(w.x+I,w.y-R,w.x-I,w.y+R);break;case"to-top-left":case"to-left-top":a=r.createLinearGradient(w.x+I,w.y+R,w.x-I,w.y-R);break}}if(!a)return null;for(var N=l.length===s.length,E=s.length,C=0;C<E;C++)a.addColorStop(N?l[C]:C/(E-1),"rgba("+s[C][0]+","+s[C][1]+","+s[C][2]+","+n+")");return a};Bt.gradientFillStyle=function(r,e,t,i){var n=this.createGradientStyleFor(r,"background",e,t,i);if(!n)return null;r.fillStyle=n};Bt.colorFillStyle=function(r,e,t,i,n){r.fillStyle="rgba("+e+","+t+","+i+","+n+")"};Bt.eleFillStyle=function(r,e,t){var i=e.pstyle("background-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientFillStyle(r,e,i,t);else{var n=e.pstyle("background-color").value;this.colorFillStyle(r,n[0],n[1],n[2],t)}};Bt.gradientStrokeStyle=function(r,e,t,i){var n=this.createGradientStyleFor(r,"line",e,t,i);if(!n)return null;r.strokeStyle=n};Bt.colorStrokeStyle=function(r,e,t,i,n){r.strokeStyle="rgba("+e+","+t+","+i+","+n+")"};Bt.eleStrokeStyle=function(r,e,t){var i=e.pstyle("line-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientStrokeStyle(r,e,i,t);else{var n=e.pstyle("line-color").value;this.colorStrokeStyle(r,n[0],n[1],n[2],t)}};Bt.matchCanvasSize=function(r){var e=this,t=e.data,i=e.findContainerClientCoords(),n=i[2],a=i[3],o=e.getPixelRatio(),s=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var l=n*o,u=a*o,h;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var f=t.canvasContainer;f.style.width=n+"px",f.style.height=a+"px";for(var d=0;d<e.CANVAS_LAYERS;d++)h=t.canvases[d],h.width=l,h.height=u,h.style.width=n+"px",h.style.height=a+"px";for(var d=0;d<e.BUFFER_COUNT;d++)h=t.bufferCanvases[d],h.width=l,h.height=u,h.style.width=n+"px",h.style.height=a+"px";e.textureMult=1,o<=1&&(h=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,h.width=l*e.textureMult,h.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u}};Bt.renderTo=function(r,e,t,i){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:i})};Bt.render=function(r){r=r||Nu();var e=r.forcedContext,t=r.drawAllLayers,i=r.drawOnlyNodeLayer,n=r.forcedZoom,a=r.forcedPan,o=this,s=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,l=o.cy,u=o.data,h=u.canvasNeedsRedraw,f=o.textureOnViewport&&!e&&(o.pinching||o.hoverData.dragging||o.swipePanning||o.data.wheelZooming),d=r.motionBlur!==void 0?r.motionBlur:o.motionBlur,c=o.motionBlurPxRatio,v=l.hasCompoundNodes(),g=o.hoverData.draggingEles,m=!!(o.hoverData.selecting||o.touchData.selecting);d=d&&!e&&o.motionBlurEnabled&&!m;var p=d;e||(o.prevPxRatio!==s&&(o.invalidateContainerClientCoordsCache(),o.matchCanvasSize(o.container),o.redrawHint("eles",!0),o.redrawHint("drag",!0)),o.prevPxRatio=s),!e&&o.motionBlurTimeout&&clearTimeout(o.motionBlurTimeout),d&&(o.mbFrames==null&&(o.mbFrames=0),o.mbFrames++,o.mbFrames<3&&(p=!1),o.mbFrames>o.minMbLowQualFrames&&(o.motionBlurPxRatio=o.mbPxRBlurry)),o.clearingMotionBlur&&(o.motionBlurPxRatio=1),o.textureDrawLastFrame&&!f&&(h[o.NODE]=!0,h[o.SELECT_BOX]=!0);var y=l.style(),w=l.zoom(),T=n!==void 0?n:w,O=l.pan(),I={x:O.x,y:O.y},R={zoom:w,pan:{x:O.x,y:O.y}},L=o.prevViewport,N=L===void 0||R.zoom!==L.zoom||R.pan.x!==L.pan.x||R.pan.y!==L.pan.y;!N&&!(g&&!v)&&(o.motionBlurPxRatio=1),a&&(I=a),T*=s,I.x*=s,I.y*=s;var E=o.getCachedZSortedEles();function C(ce,x,z,j,te){var K=ce.globalCompositeOperation;ce.globalCompositeOperation="destination-out",o.colorFillStyle(ce,255,255,255,o.motionBlurTransparency),ce.fillRect(x,z,j,te),ce.globalCompositeOperation=K}function b(ce,x){var z,j,te,K;!o.clearingMotionBlur&&(ce===u.bufferContexts[o.MOTIONBLUR_BUFFER_NODE]||ce===u.bufferContexts[o.MOTIONBLUR_BUFFER_DRAG])?(z={x:O.x*c,y:O.y*c},j=w*c,te=o.canvasWidth*c,K=o.canvasHeight*c):(z=I,j=T,te=o.canvasWidth,K=o.canvasHeight),ce.setTransform(1,0,0,1,0,0),x==="motionBlur"?C(ce,0,0,te,K):!e&&(x===void 0||x)&&ce.clearRect(0,0,te,K),t||(ce.translate(z.x,z.y),ce.scale(j,j)),a&&ce.translate(a.x,a.y),n&&ce.scale(n,n)}if(f||(o.textureDrawLastFrame=!1),f){if(o.textureDrawLastFrame=!0,!o.textureCache){o.textureCache={},o.textureCache.bb=l.mutableElements().boundingBox(),o.textureCache.texture=o.data.bufferCanvases[o.TEXTURE_BUFFER];var M=o.data.bufferContexts[o.TEXTURE_BUFFER];M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,o.canvasWidth*o.textureMult,o.canvasHeight*o.textureMult),o.render({forcedContext:M,drawOnlyNodeLayer:!0,forcedPxRatio:s*o.textureMult});var R=o.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:o.canvasWidth,height:o.canvasHeight};R.mpan={x:(0-R.pan.x)/R.zoom,y:(0-R.pan.y)/R.zoom}}h[o.DRAG]=!1,h[o.NODE]=!1;var D=u.contexts[o.NODE],H=o.textureCache.texture,R=o.textureCache.viewport;D.setTransform(1,0,0,1,0,0),d?C(D,0,0,R.width,R.height):D.clearRect(0,0,R.width,R.height);var k=y.core("outside-texture-bg-color").value,B=y.core("outside-texture-bg-opacity").value;o.colorFillStyle(D,k[0],k[1],k[2],B),D.fillRect(0,0,R.width,R.height);var w=l.zoom();b(D,!1),D.clearRect(R.mpan.x,R.mpan.y,R.width/R.zoom/s,R.height/R.zoom/s),D.drawImage(H,R.mpan.x,R.mpan.y,R.width/R.zoom/s,R.height/R.zoom/s)}else o.textureOnViewport&&!e&&(o.textureCache=null);var U=l.extent(),W=o.pinching||o.hoverData.dragging||o.swipePanning||o.data.wheelZooming||o.hoverData.draggingEles||o.cy.animated(),J=o.hideEdgesOnViewport&&W,G=[];if(G[o.NODE]=!h[o.NODE]&&d&&!o.clearedForMotionBlur[o.NODE]||o.clearingMotionBlur,G[o.NODE]&&(o.clearedForMotionBlur[o.NODE]=!0),G[o.DRAG]=!h[o.DRAG]&&d&&!o.clearedForMotionBlur[o.DRAG]||o.clearingMotionBlur,G[o.DRAG]&&(o.clearedForMotionBlur[o.DRAG]=!0),h[o.NODE]||t||i||G[o.NODE]){var X=d&&!G[o.NODE]&&c!==1,D=e||(X?o.data.bufferContexts[o.MOTIONBLUR_BUFFER_NODE]:u.contexts[o.NODE]),ie=d&&!X?"motionBlur":void 0;b(D,ie),J?o.drawCachedNodes(D,E.nondrag,s,U):o.drawLayeredElements(D,E.nondrag,s,U),o.debug&&o.drawDebugPoints(D,E.nondrag),!t&&!d&&(h[o.NODE]=!1)}if(!i&&(h[o.DRAG]||t||G[o.DRAG])){var X=d&&!G[o.DRAG]&&c!==1,D=e||(X?o.data.bufferContexts[o.MOTIONBLUR_BUFFER_DRAG]:u.contexts[o.DRAG]);b(D,d&&!X?"motionBlur":void 0),J?o.drawCachedNodes(D,E.drag,s,U):o.drawCachedElements(D,E.drag,s,U),o.debug&&o.drawDebugPoints(D,E.drag),!t&&!d&&(h[o.DRAG]=!1)}if(o.showFps||!i&&h[o.SELECT_BOX]&&!t){var D=e||u.contexts[o.SELECT_BOX];if(b(D),o.selection[4]==1&&(o.hoverData.selecting||o.touchData.selecting)){var w=o.cy.zoom(),ee=y.core("selection-box-border-width").value/w;D.lineWidth=ee,D.fillStyle="rgba("+y.core("selection-box-color").value[0]+","+y.core("selection-box-color").value[1]+","+y.core("selection-box-color").value[2]+","+y.core("selection-box-opacity").value+")",D.fillRect(o.selection[0],o.selection[1],o.selection[2]-o.selection[0],o.selection[3]-o.selection[1]),ee>0&&(D.strokeStyle="rgba("+y.core("selection-box-border-color").value[0]+","+y.core("selection-box-border-color").value[1]+","+y.core("selection-box-border-color").value[2]+","+y.core("selection-box-opacity").value+")",D.strokeRect(o.selection[0],o.selection[1],o.selection[2]-o.selection[0],o.selection[3]-o.selection[1]))}if(u.bgActivePosistion&&!o.hoverData.selecting){var w=o.cy.zoom(),q=u.bgActivePosistion;D.fillStyle="rgba("+y.core("active-bg-color").value[0]+","+y.core("active-bg-color").value[1]+","+y.core("active-bg-color").value[2]+","+y.core("active-bg-opacity").value+")",D.beginPath(),D.arc(q.x,q.y,y.core("active-bg-size").pfValue/w,0,2*Math.PI),D.fill()}var $=o.lastRedrawTime;if(o.showFps&&$){$=Math.round($);var V=Math.round(1e3/$);D.setTransform(1,0,0,1,0,0),D.fillStyle="rgba(255, 0, 0, 0.75)",D.strokeStyle="rgba(255, 0, 0, 0.75)",D.lineWidth=1,D.fillText("1 frame = "+$+" ms = "+V+" fps",0,20);var re=60;D.strokeRect(0,30,250,20),D.fillRect(0,30,250*Math.min(V/re,1),20)}t||(h[o.SELECT_BOX]=!1)}if(d&&c!==1){var ae=u.contexts[o.NODE],de=o.data.bufferCanvases[o.MOTIONBLUR_BUFFER_NODE],ye=u.contexts[o.DRAG],Te=o.data.bufferCanvases[o.MOTIONBLUR_BUFFER_DRAG],Oe=function(x,z,j){x.setTransform(1,0,0,1,0,0),j||!p?x.clearRect(0,0,o.canvasWidth,o.canvasHeight):C(x,0,0,o.canvasWidth,o.canvasHeight);var te=c;x.drawImage(z,0,0,o.canvasWidth*te,o.canvasHeight*te,0,0,o.canvasWidth,o.canvasHeight)};(h[o.NODE]||G[o.NODE])&&(Oe(ae,de,G[o.NODE]),h[o.NODE]=!1),(h[o.DRAG]||G[o.DRAG])&&(Oe(ye,Te,G[o.DRAG]),h[o.DRAG]=!1)}o.prevViewport=R,o.clearingMotionBlur&&(o.clearingMotionBlur=!1,o.motionBlurCleared=!0,o.motionBlur=!0),d&&(o.motionBlurTimeout=setTimeout(function(){o.motionBlurTimeout=null,o.clearedForMotionBlur[o.NODE]=!1,o.clearedForMotionBlur[o.DRAG]=!1,o.motionBlur=!1,o.clearingMotionBlur=!f,o.mbFrames=0,h[o.NODE]=!0,h[o.DRAG]=!0,o.redraw()},bT)),e||l.emit("render")};var _r={};_r.drawPolygonPath=function(r,e,t,i,n,a){var o=i/2,s=n/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*a[0],t+s*a[1]);for(var l=1;l<a.length/2;l++)r.lineTo(e+o*a[l*2],t+s*a[l*2+1]);r.closePath()};_r.drawRoundPolygonPath=function(r,e,t,i,n,a){var o=i/2,s=n/2,l=No(i,n);r.beginPath&&r.beginPath();for(var u=0;u<a.length/4;u++){var h=void 0,f=void 0;u===0?h=a.length-2:h=u*4-2,f=u*4+2;var d=e+o*a[u*4],c=t+s*a[u*4+1],v=-a[h]*a[f]-a[h+1]*a[f+1],g=l/Math.tan(Math.acos(v)/2),m=d-g*a[h],p=c-g*a[h+1],y=d+g*a[f],w=c+g*a[f+1];u===0?r.moveTo(m,p):r.lineTo(m,p),r.arcTo(d,c,y,w,l)}r.closePath()};_r.drawRoundRectanglePath=function(r,e,t,i,n){var a=i/2,o=n/2,s=hn(i,n);r.beginPath&&r.beginPath(),r.moveTo(e,t-o),r.arcTo(e+a,t-o,e+a,t,s),r.arcTo(e+a,t+o,e,t+o,s),r.arcTo(e-a,t+o,e-a,t,s),r.arcTo(e-a,t-o,e,t-o,s),r.lineTo(e,t-o),r.closePath()};_r.drawBottomRoundRectanglePath=function(r,e,t,i,n){var a=i/2,o=n/2,s=hn(i,n);r.beginPath&&r.beginPath(),r.moveTo(e,t-o),r.lineTo(e+a,t-o),r.lineTo(e+a,t),r.arcTo(e+a,t+o,e,t+o,s),r.arcTo(e-a,t+o,e-a,t,s),r.lineTo(e-a,t-o),r.lineTo(e,t-o),r.closePath()};_r.drawCutRectanglePath=function(r,e,t,i,n){var a=i/2,o=n/2,s=Hu();r.beginPath&&r.beginPath(),r.moveTo(e-a+s,t-o),r.lineTo(e+a-s,t-o),r.lineTo(e+a,t-o+s),r.lineTo(e+a,t+o-s),r.lineTo(e+a-s,t+o),r.lineTo(e-a+s,t+o),r.lineTo(e-a,t+o-s),r.lineTo(e-a,t-o+s),r.closePath()};_r.drawBarrelPath=function(r,e,t,i,n){var a=i/2,o=n/2,s=e-a,l=e+a,u=t-o,h=t+o,f=$a(i,n),d=f.widthOffset,c=f.heightOffset,v=f.ctrlPtOffsetPct*d;r.beginPath&&r.beginPath(),r.moveTo(s,u+c),r.lineTo(s,h-c),r.quadraticCurveTo(s+v,h,s+d,h),r.lineTo(l-d,h),r.quadraticCurveTo(l-v,h,l,h-c),r.lineTo(l,u+c),r.quadraticCurveTo(l-v,u,l-d,u),r.lineTo(s+d,u),r.quadraticCurveTo(s+v,u,s,u+c),r.closePath()};var yl=Math.sin(0),wl=Math.cos(0),so={},lo={},Ah=Math.PI/40;for(var ai=0*Math.PI;ai<2*Math.PI;ai+=Ah)so[ai]=Math.sin(ai),lo[ai]=Math.cos(ai);_r.drawEllipsePath=function(r,e,t,i,n){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,i/2,n/2,0,0,2*Math.PI);else for(var a,o,s=i/2,l=n/2,u=0*Math.PI;u<2*Math.PI;u+=Ah)a=e-s*so[u]*yl+s*lo[u]*wl,o=t+l*lo[u]*yl+l*so[u]*wl,u===0?r.moveTo(a,o):r.lineTo(a,o);r.closePath()};var gn={};gn.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};gn.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),i=t.boundingBox(),n=this.findContainerClientCoords(),a=r.full?Math.ceil(i.w):n[2],o=r.full?Math.ceil(i.h):n[3],s=Se(r.maxWidth)||Se(r.maxHeight),l=this.getPixelRatio(),u=1;if(r.scale!==void 0)a*=r.scale,o*=r.scale,u=r.scale;else if(s){var h=1/0,f=1/0;Se(r.maxWidth)&&(h=u*r.maxWidth/a),Se(r.maxHeight)&&(f=u*r.maxHeight/o),u=Math.min(h,f),a*=u,o*=u}s||(a*=l,o*=l,u*=l);var d=document.createElement("canvas");d.width=a,d.height=o,d.style.width=a+"px",d.style.height=o+"px";var c=d.getContext("2d");if(a>0&&o>0){c.clearRect(0,0,a,o),c.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(r.full)c.translate(-i.x1*u,-i.y1*u),c.scale(u,u),this.drawElements(c,v),c.scale(1/u,1/u),c.translate(i.x1*u,i.y1*u);else{var g=e.pan(),m={x:g.x*u,y:g.y*u};u*=e.zoom(),c.translate(m.x,m.y),c.scale(u,u),this.drawElements(c,v),c.scale(1/u,1/u),c.translate(-m.x,-m.y)}r.bg&&(c.globalCompositeOperation="destination-over",c.fillStyle=r.bg,c.rect(0,0,a,o),c.fill())}return d};function xT(r,e){for(var t=atob(r),i=new ArrayBuffer(t.length),n=new Uint8Array(i),a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return new Blob([i],{type:e})}function El(r){var e=r.indexOf(",");return r.substr(e+1)}function _h(r,e,t){var i=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Si(function(n,a){try{e.toBlob(function(o){o!=null?n(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return xT(El(i()),t);case"base64":return El(i());case"base64uri":default:return i()}}gn.png=function(r){return _h(r,this.bufferCanvasImage(r),"image/png")};gn.jpg=function(r){return _h(r,this.bufferCanvasImage(r),"image/jpeg")};var Fh={};Fh.nodeShapeImpl=function(r,e,t,i,n,a,o){switch(r){case"ellipse":return this.drawEllipsePath(e,t,i,n,a);case"polygon":return this.drawPolygonPath(e,t,i,n,a,o);case"round-polygon":return this.drawRoundPolygonPath(e,t,i,n,a,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,i,n,a);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,i,n,a);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,i,n,a);case"barrel":return this.drawBarrelPath(e,t,i,n,a)}};var ST=Bh,Ge=Bh.prototype;Ge.CANVAS_LAYERS=3;Ge.SELECT_BOX=0;Ge.DRAG=1;Ge.NODE=2;Ge.BUFFER_COUNT=3;Ge.TEXTURE_BUFFER=0;Ge.MOTIONBLUR_BUFFER_NODE=1;Ge.MOTIONBLUR_BUFFER_DRAG=2;function Bh(r){var e=this;e.data={canvases:new Array(Ge.CANVAS_LAYERS),contexts:new Array(Ge.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Ge.CANVAS_LAYERS),bufferCanvases:new Array(Ge.BUFFER_COUNT),bufferContexts:new Array(Ge.CANVAS_LAYERS)};var t="-webkit-tap-highlight-color",i="rgba(0,0,0,0)";e.data.canvasContainer=document.createElement("div");var n=e.data.canvasContainer.style;e.data.canvasContainer.style[t]=i,n.position="relative",n.zIndex="0",n.overflow="hidden";var a=r.cy.container();a.appendChild(e.data.canvasContainer),a.style[t]=i;var o={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};oy()&&(o["-ms-touch-action"]="none",o["touch-action"]="none");for(var s=0;s<Ge.CANVAS_LAYERS;s++){var l=e.data.canvases[s]=document.createElement("canvas");e.data.contexts[s]=l.getContext("2d"),Object.keys(o).forEach(function($){l.style[$]=o[$]}),l.style.position="absolute",l.setAttribute("data-id","layer"+s),l.style.zIndex=String(Ge.CANVAS_LAYERS-s),e.data.canvasContainer.appendChild(l),e.data.canvasNeedsRedraw[s]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[Ge.NODE].setAttribute("data-id","layer"+Ge.NODE+"-node"),e.data.canvases[Ge.SELECT_BOX].setAttribute("data-id","layer"+Ge.SELECT_BOX+"-selectbox"),e.data.canvases[Ge.DRAG].setAttribute("data-id","layer"+Ge.DRAG+"-drag");for(var s=0;s<Ge.BUFFER_COUNT;s++)e.data.bufferCanvases[s]=document.createElement("canvas"),e.data.bufferContexts[s]=e.data.bufferCanvases[s].getContext("2d"),e.data.bufferCanvases[s].style.position="absolute",e.data.bufferCanvases[s].setAttribute("data-id","buffer"+s),e.data.bufferCanvases[s].style.zIndex=String(-s-1),e.data.bufferCanvases[s].style.visibility="hidden";e.pathsEnabled=!0;var u=It(),h=function(V){return{x:(V.x1+V.x2)/2,y:(V.y1+V.y2)/2}},f=function(V){return{x:-V.w/2,y:-V.h/2}},d=function(V){var re=V[0]._private,ae=re.oldBackgroundTimestamp===re.backgroundTimestamp;return!ae},c=function(V){return V[0]._private.nodeKey},v=function(V){return V[0]._private.labelStyleKey},g=function(V){return V[0]._private.sourceLabelStyleKey},m=function(V){return V[0]._private.targetLabelStyleKey},p=function(V,re,ae,de,ye){return e.drawElement(V,re,ae,!1,!1,ye)},y=function(V,re,ae,de,ye){return e.drawElementText(V,re,ae,de,"main",ye)},w=function(V,re,ae,de,ye){return e.drawElementText(V,re,ae,de,"source",ye)},T=function(V,re,ae,de,ye){return e.drawElementText(V,re,ae,de,"target",ye)},O=function(V){return V.boundingBox(),V[0]._private.bodyBounds},I=function(V){return V.boundingBox(),V[0]._private.labelBounds.main||u},R=function(V){return V.boundingBox(),V[0]._private.labelBounds.source||u},L=function(V){return V.boundingBox(),V[0]._private.labelBounds.target||u},N=function(V,re){return re},E=function(V){return h(O(V))},C=function(V,re,ae){var de=V?V+"-":"";return{x:re.x+ae.pstyle(de+"text-margin-x").pfValue,y:re.y+ae.pstyle(de+"text-margin-y").pfValue}},b=function(V,re,ae){var de=V[0]._private.rscratch;return{x:de[re],y:de[ae]}},M=function(V){return C("",b(V,"labelX","labelY"),V)},D=function(V){return C("source",b(V,"sourceLabelX","sourceLabelY"),V)},H=function(V){return C("target",b(V,"targetLabelX","targetLabelY"),V)},k=function(V){return f(O(V))},B=function(V){return f(R(V))},U=function(V){return f(L(V))},W=function(V){var re=I(V),ae=f(I(V));if(V.isNode()){switch(V.pstyle("text-halign").value){case"left":ae.x=-re.w;break;case"right":ae.x=0;break}switch(V.pstyle("text-valign").value){case"top":ae.y=-re.h;break;case"bottom":ae.y=0;break}}return ae},J=e.data.eleTxrCache=new zi(e,{getKey:c,doesEleInvalidateKey:d,drawElement:p,getBoundingBox:O,getRotationPoint:E,getRotationOffset:k,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),G=e.data.lblTxrCache=new zi(e,{getKey:v,drawElement:y,getBoundingBox:I,getRotationPoint:M,getRotationOffset:W,isVisible:N}),X=e.data.slbTxrCache=new zi(e,{getKey:g,drawElement:w,getBoundingBox:R,getRotationPoint:D,getRotationOffset:B,isVisible:N}),ie=e.data.tlbTxrCache=new zi(e,{getKey:m,drawElement:T,getBoundingBox:L,getRotationPoint:H,getRotationOffset:U,isVisible:N}),ee=e.data.lyrTxrCache=new Oh(e);e.onUpdateEleCalcs(function(V,re){J.invalidateElements(re),G.invalidateElements(re),X.invalidateElements(re),ie.invalidateElements(re),ee.invalidateElements(re);for(var ae=0;ae<re.length;ae++){var de=re[ae]._private;de.oldBackgroundTimestamp=de.backgroundTimestamp}});var q=function(V){for(var re=0;re<V.length;re++)ee.enqueueElementRefinement(V[re].ele)};J.onDequeue(q),G.onDequeue(q),X.onDequeue(q),ie.onDequeue(q)}Ge.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[Ge.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[Ge.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[Ge.SELECT_BOX]=e;break}};var CT=typeof Path2D<"u";Ge.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};Ge.usePaths=function(){return CT&&this.pathsEnabled};Ge.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};Ge.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};Ge.makeOffscreenCanvas=function(r,e){var t;return(typeof OffscreenCanvas>"u"?"undefined":dt(OffscreenCanvas))!=="undefined"?t=new OffscreenCanvas(r,e):(t=document.createElement("canvas"),t.width=r,t.height=e),t};[Mh,$t,hr,Go,jr,Li,Bt,_r,gn,Fh].forEach(function(r){_e(Ge,r)});var DT=[{name:"null",impl:Th},{name:"base",impl:Ph},{name:"canvas",impl:ST}],RT=[{type:"layout",extensions:AE},{type:"renderer",extensions:DT}],kh={},zh={};function Hh(r,e,t){var i=t,n=function(L){Xe("Can not register `"+e+"` for `"+r+"` since `"+L+"` already exists in the prototype and can not be overridden")};if(r==="core"){if($i.prototype[e])return n(e);$i.prototype[e]=t}else if(r==="collection"){if(wt.prototype[e])return n(e);wt.prototype[e]=t}else if(r==="layout"){for(var a=function(L){this.options=L,t.call(this,L),Ue(this._private)||(this._private={}),this._private.cy=L.cy,this._private.listeners=[],this.createEmitter()},o=a.prototype=Object.create(t.prototype),s=[],l=0;l<s.length;l++){var u=s[l];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var h=t.prototype.stop;o.stop=function(){var R=this.options;if(R&&R.animate){var L=this.animations;if(L)for(var N=0;N<L.length;N++)L[N].stop()}return h?h.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var f=function(L){return L._private.cy},d={addEventFields:function(L,N){N.layout=L,N.cy=f(L),N.target=L},bubble:function(){return!0},parent:function(L){return f(L)}};_e(o,{createEmitter:function(){return this._private.emitter=new ma(d,this),this},emitter:function(){return this._private.emitter},on:function(L,N){return this.emitter().on(L,N),this},one:function(L,N){return this.emitter().one(L,N),this},once:function(L,N){return this.emitter().one(L,N),this},removeListener:function(L,N){return this.emitter().removeListener(L,N),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(L,N){return this.emitter().emit(L,N),this}}),Ye.eventAliasesOn(o),i=a}else if(r==="renderer"&&e!=="null"&&e!=="base"){var c=Uh("renderer","base"),v=c.prototype,g=t,m=t.prototype,p=function(){c.apply(this,arguments),g.apply(this,arguments)},y=p.prototype;for(var w in v){var T=v[w],O=m[w]!=null;if(O)return n(w);y[w]=T}for(var I in m)y[I]=m[I];v.clientFunctions.forEach(function(R){y[R]=y[R]||function(){at("Renderer does not implement `renderer."+R+"()` on its prototype")}}),i=p}else if(r==="__proto__"||r==="constructor"||r==="prototype")return at(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return xu({map:kh,keys:[r,e],value:i})}function Uh(r,e){return Su({map:kh,keys:[r,e]})}function PT(r,e,t,i,n){return xu({map:zh,keys:[r,e,t,i],value:n})}function LT(r,e,t,i){return Su({map:zh,keys:[r,e,t,i]})}var uo=function(){if(arguments.length===2)return Uh.apply(null,arguments);if(arguments.length===3)return Hh.apply(null,arguments);if(arguments.length===4)return LT.apply(null,arguments);if(arguments.length===5)return PT.apply(null,arguments);at("Invalid extension access syntax")};$i.prototype.extension=uo;RT.forEach(function(r){r.extensions.forEach(function(e){Hh(r.type,e.name,e.impl)})});var Gh=function r(){if(!(this instanceof r))return new r;this.length=0},Yr=Gh.prototype;Yr.instanceString=function(){return"stylesheet"};Yr.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};Yr.css=function(r,e){var t=this.length-1;if(Ne(r))this[t].properties.push({name:r,value:e});else if(Ue(r))for(var i=r,n=Object.keys(i),a=0;a<n.length;a++){var o=n[a],s=i[o];if(s!=null){var l=xt.properties[o]||xt.properties[ca(o)];if(l!=null){var u=l.name,h=s;this[t].properties.push({name:u,value:h})}}}return this};Yr.style=Yr.css;Yr.generateStyle=function(r){var e=new xt(r);return this.appendToStyle(e)};Yr.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],i=t.selector,n=t.properties;r.selector(i);for(var a=0;a<n.length;a++){var o=n[a];r.css(o.name,o.value)}}return r};var OT="3.23.0",Xr=function(e){if(e===void 0&&(e={}),Ue(e))return new $i(e);if(Ne(e))return uo.apply(uo,arguments)};Xr.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Xr),r.apply(null,e),this};Xr.warnings=function(r){return Ou(r)};Xr.version=OT;Xr.stylesheet=Xr.Stylesheet=Gh;var Vo=Xr,Vh={exports:{}},Ya={exports:{}},Xa={exports:{}},Tl;function MT(){return Tl||(Tl=1,function(r,e){(function(i,n){r.exports=n()})(xr,function(){return function(t){var i={};function n(a){if(i[a])return i[a].exports;var o=i[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=i,n.i=function(a){return a},n.d=function(a,o,s){n.o(a,o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:s})},n.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return n.d(o,"a",o),o},n.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},n.p="",n(n.s=28)}([function(t,i,n){function a(){}a.QUALITY=1,a.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,a.DEFAULT_INCREMENTAL=!1,a.DEFAULT_ANIMATION_ON_LAYOUT=!0,a.DEFAULT_ANIMATION_DURING_LAYOUT=!1,a.DEFAULT_ANIMATION_PERIOD=50,a.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,a.DEFAULT_GRAPH_MARGIN=15,a.NODE_DIMENSIONS_INCLUDE_LABELS=!1,a.SIMPLE_NODE_SIZE=40,a.SIMPLE_NODE_HALF_SIZE=a.SIMPLE_NODE_SIZE/2,a.EMPTY_COMPOUND_NODE_SIZE=40,a.MIN_EDGE_LENGTH=1,a.WORLD_BOUNDARY=1e6,a.INITIAL_WORLD_BOUNDARY=a.WORLD_BOUNDARY/1e3,a.WORLD_CENTER_X=1200,a.WORLD_CENTER_Y=900,t.exports=a},function(t,i,n){var a=n(2),o=n(8),s=n(9);function l(h,f,d){a.call(this,d),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=d,this.bendpoints=[],this.source=h,this.target=f}l.prototype=Object.create(a.prototype);for(var u in a)l[u]=a[u];l.prototype.getSource=function(){return this.source},l.prototype.getTarget=function(){return this.target},l.prototype.isInterGraph=function(){return this.isInterGraph},l.prototype.getLength=function(){return this.length},l.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},l.prototype.getBendpoints=function(){return this.bendpoints},l.prototype.getLca=function(){return this.lca},l.prototype.getSourceInLca=function(){return this.sourceInLca},l.prototype.getTargetInLca=function(){return this.targetInLca},l.prototype.getOtherEnd=function(h){if(this.source===h)return this.target;if(this.target===h)return this.source;throw"Node is not incident with this edge"},l.prototype.getOtherEndInGraph=function(h,f){for(var d=this.getOtherEnd(h),c=f.getGraphManager().getRoot();;){if(d.getOwner()==f)return d;if(d.getOwner()==c)break;d=d.getOwner().getParent()}return null},l.prototype.updateLength=function(){var h=new Array(4);this.isOverlapingSourceAndTarget=o.getIntersection(this.target.getRect(),this.source.getRect(),h),this.isOverlapingSourceAndTarget||(this.lengthX=h[0]-h[2],this.lengthY=h[1]-h[3],Math.abs(this.lengthX)<1&&(this.lengthX=s.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=s.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},l.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=s.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=s.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},t.exports=l},function(t,i,n){function a(o){this.vGraphObject=o}t.exports=a},function(t,i,n){var a=n(2),o=n(10),s=n(13),l=n(0),u=n(16),h=n(5);function f(c,v,g,m){g==null&&m==null&&(m=v),a.call(this,m),c.graphManager!=null&&(c=c.graphManager),this.estimatedSize=o.MIN_VALUE,this.inclusionTreeDepth=o.MAX_VALUE,this.vGraphObject=m,this.edges=[],this.graphManager=c,g!=null&&v!=null?this.rect=new s(v.x,v.y,g.width,g.height):this.rect=new s}f.prototype=Object.create(a.prototype);for(var d in a)f[d]=a[d];f.prototype.getEdges=function(){return this.edges},f.prototype.getChild=function(){return this.child},f.prototype.getOwner=function(){return this.owner},f.prototype.getWidth=function(){return this.rect.width},f.prototype.setWidth=function(c){this.rect.width=c},f.prototype.getHeight=function(){return this.rect.height},f.prototype.setHeight=function(c){this.rect.height=c},f.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},f.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},f.prototype.getCenter=function(){return new h(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},f.prototype.getLocation=function(){return new h(this.rect.x,this.rect.y)},f.prototype.getRect=function(){return this.rect},f.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},f.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},f.prototype.setRect=function(c,v){this.rect.x=c.x,this.rect.y=c.y,this.rect.width=v.width,this.rect.height=v.height},f.prototype.setCenter=function(c,v){this.rect.x=c-this.rect.width/2,this.rect.y=v-this.rect.height/2},f.prototype.setLocation=function(c,v){this.rect.x=c,this.rect.y=v},f.prototype.moveBy=function(c,v){this.rect.x+=c,this.rect.y+=v},f.prototype.getEdgeListToNode=function(c){var v=[],g=this;return g.edges.forEach(function(m){if(m.target==c){if(m.source!=g)throw"Incorrect edge source!";v.push(m)}}),v},f.prototype.getEdgesBetween=function(c){var v=[],g=this;return g.edges.forEach(function(m){if(!(m.source==g||m.target==g))throw"Incorrect edge source and/or target";(m.target==c||m.source==c)&&v.push(m)}),v},f.prototype.getNeighborsList=function(){var c=new Set,v=this;return v.edges.forEach(function(g){if(g.source==v)c.add(g.target);else{if(g.target!=v)throw"Incorrect incidency!";c.add(g.source)}}),c},f.prototype.withChildren=function(){var c=new Set,v,g;if(c.add(this),this.child!=null)for(var m=this.child.getNodes(),p=0;p<m.length;p++)v=m[p],g=v.withChildren(),g.forEach(function(y){c.add(y)});return c},f.prototype.getNoOfChildren=function(){var c=0,v;if(this.child==null)c=1;else for(var g=this.child.getNodes(),m=0;m<g.length;m++)v=g[m],c+=v.getNoOfChildren();return c==0&&(c=1),c},f.prototype.getEstimatedSize=function(){if(this.estimatedSize==o.MIN_VALUE)throw"assert failed";return this.estimatedSize},f.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},f.prototype.scatter=function(){var c,v,g=-l.INITIAL_WORLD_BOUNDARY,m=l.INITIAL_WORLD_BOUNDARY;c=l.WORLD_CENTER_X+u.nextDouble()*(m-g)+g;var p=-l.INITIAL_WORLD_BOUNDARY,y=l.INITIAL_WORLD_BOUNDARY;v=l.WORLD_CENTER_Y+u.nextDouble()*(y-p)+p,this.rect.x=c,this.rect.y=v},f.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var c=this.getChild();if(c.updateBounds(!0),this.rect.x=c.getLeft(),this.rect.y=c.getTop(),this.setWidth(c.getRight()-c.getLeft()),this.setHeight(c.getBottom()-c.getTop()),l.NODE_DIMENSIONS_INCLUDE_LABELS){var v=c.getRight()-c.getLeft(),g=c.getBottom()-c.getTop();this.labelWidth&&(this.labelPosHorizontal=="left"?(this.rect.x-=this.labelWidth,this.setWidth(v+this.labelWidth)):this.labelPosHorizontal=="center"&&this.labelWidth>v?(this.rect.x-=(this.labelWidth-v)/2,this.setWidth(this.labelWidth)):this.labelPosHorizontal=="right"&&this.setWidth(v+this.labelWidth)),this.labelHeight&&(this.labelPosVertical=="top"?(this.rect.y-=this.labelHeight,this.setHeight(g+this.labelHeight)):this.labelPosVertical=="center"&&this.labelHeight>g?(this.rect.y-=(this.labelHeight-g)/2,this.setHeight(this.labelHeight)):this.labelPosVertical=="bottom"&&this.setHeight(g+this.labelHeight))}}},f.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==o.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},f.prototype.transform=function(c){var v=this.rect.x;v>l.WORLD_BOUNDARY?v=l.WORLD_BOUNDARY:v<-l.WORLD_BOUNDARY&&(v=-l.WORLD_BOUNDARY);var g=this.rect.y;g>l.WORLD_BOUNDARY?g=l.WORLD_BOUNDARY:g<-l.WORLD_BOUNDARY&&(g=-l.WORLD_BOUNDARY);var m=new h(v,g),p=c.inverseTransformPoint(m);this.setLocation(p.x,p.y)},f.prototype.getLeft=function(){return this.rect.x},f.prototype.getRight=function(){return this.rect.x+this.rect.width},f.prototype.getTop=function(){return this.rect.y},f.prototype.getBottom=function(){return this.rect.y+this.rect.height},f.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},t.exports=f},function(t,i,n){var a=n(0);function o(){}for(var s in a)o[s]=a[s];o.MAX_ITERATIONS=2500,o.DEFAULT_EDGE_LENGTH=50,o.DEFAULT_SPRING_STRENGTH=.45,o.DEFAULT_REPULSION_STRENGTH=4500,o.DEFAULT_GRAVITY_STRENGTH=.4,o.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,o.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,o.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,o.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,o.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,o.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,o.COOLING_ADAPTATION_FACTOR=.33,o.ADAPTATION_LOWER_NODE_LIMIT=1e3,o.ADAPTATION_UPPER_NODE_LIMIT=5e3,o.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,o.MAX_NODE_DISPLACEMENT=o.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,o.MIN_REPULSION_DIST=o.DEFAULT_EDGE_LENGTH/10,o.CONVERGENCE_CHECK_PERIOD=100,o.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,o.MIN_EDGE_LENGTH=1,o.GRID_CALCULATION_CHECK_PERIOD=10,t.exports=o},function(t,i,n){function a(o,s){o==null&&s==null?(this.x=0,this.y=0):(this.x=o,this.y=s)}a.prototype.getX=function(){return this.x},a.prototype.getY=function(){return this.y},a.prototype.setX=function(o){this.x=o},a.prototype.setY=function(o){this.y=o},a.prototype.getDifference=function(o){return new DimensionD(this.x-o.x,this.y-o.y)},a.prototype.getCopy=function(){return new a(this.x,this.y)},a.prototype.translate=function(o){return this.x+=o.width,this.y+=o.height,this},t.exports=a},function(t,i,n){var a=n(2),o=n(10),s=n(0),l=n(7),u=n(3),h=n(1),f=n(13),d=n(12),c=n(11);function v(m,p,y){a.call(this,y),this.estimatedSize=o.MIN_VALUE,this.margin=s.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=m,p!=null&&p instanceof l?this.graphManager=p:p!=null&&p instanceof Layout&&(this.graphManager=p.graphManager)}v.prototype=Object.create(a.prototype);for(var g in a)v[g]=a[g];v.prototype.getNodes=function(){return this.nodes},v.prototype.getEdges=function(){return this.edges},v.prototype.getGraphManager=function(){return this.graphManager},v.prototype.getParent=function(){return this.parent},v.prototype.getLeft=function(){return this.left},v.prototype.getRight=function(){return this.right},v.prototype.getTop=function(){return this.top},v.prototype.getBottom=function(){return this.bottom},v.prototype.isConnected=function(){return this.isConnected},v.prototype.add=function(m,p,y){if(p==null&&y==null){var w=m;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(w)>-1)throw"Node already in graph!";return w.owner=this,this.getNodes().push(w),w}else{var T=m;if(!(this.getNodes().indexOf(p)>-1&&this.getNodes().indexOf(y)>-1))throw"Source or target not in graph!";if(!(p.owner==y.owner&&p.owner==this))throw"Both owners must be this graph!";return p.owner!=y.owner?null:(T.source=p,T.target=y,T.isInterGraph=!1,this.getEdges().push(T),p.edges.push(T),y!=p&&y.edges.push(T),T)}},v.prototype.remove=function(m){var p=m;if(m instanceof u){if(p==null)throw"Node is null!";if(!(p.owner!=null&&p.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var y=p.edges.slice(),w,T=y.length,O=0;O<T;O++)w=y[O],w.isInterGraph?this.graphManager.remove(w):w.source.owner.remove(w);var I=this.nodes.indexOf(p);if(I==-1)throw"Node not in owner node list!";this.nodes.splice(I,1)}else if(m instanceof h){var w=m;if(w==null)throw"Edge is null!";if(!(w.source!=null&&w.target!=null))throw"Source and/or target is null!";if(!(w.source.owner!=null&&w.target.owner!=null&&w.source.owner==this&&w.target.owner==this))throw"Source and/or target owner is invalid!";var R=w.source.edges.indexOf(w),L=w.target.edges.indexOf(w);if(!(R>-1&&L>-1))throw"Source and/or target doesn't know this edge!";w.source.edges.splice(R,1),w.target!=w.source&&w.target.edges.splice(L,1);var I=w.source.owner.getEdges().indexOf(w);if(I==-1)throw"Not in owner's edge list!";w.source.owner.getEdges().splice(I,1)}},v.prototype.updateLeftTop=function(){for(var m=o.MAX_VALUE,p=o.MAX_VALUE,y,w,T,O=this.getNodes(),I=O.length,R=0;R<I;R++){var L=O[R];y=L.getTop(),w=L.getLeft(),m>y&&(m=y),p>w&&(p=w)}return m==o.MAX_VALUE?null:(O[0].getParent().paddingLeft!=null?T=O[0].getParent().paddingLeft:T=this.margin,this.left=p-T,this.top=m-T,new d(this.left,this.top))},v.prototype.updateBounds=function(m){for(var p=o.MAX_VALUE,y=-o.MAX_VALUE,w=o.MAX_VALUE,T=-o.MAX_VALUE,O,I,R,L,N,E=this.nodes,C=E.length,b=0;b<C;b++){var M=E[b];m&&M.child!=null&&M.updateBounds(),O=M.getLeft(),I=M.getRight(),R=M.getTop(),L=M.getBottom(),p>O&&(p=O),y<I&&(y=I),w>R&&(w=R),T<L&&(T=L)}var D=new f(p,w,y-p,T-w);p==o.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),E[0].getParent().paddingLeft!=null?N=E[0].getParent().paddingLeft:N=this.margin,this.left=D.x-N,this.right=D.x+D.width+N,this.top=D.y-N,this.bottom=D.y+D.height+N},v.calculateBounds=function(m){for(var p=o.MAX_VALUE,y=-o.MAX_VALUE,w=o.MAX_VALUE,T=-o.MAX_VALUE,O,I,R,L,N=m.length,E=0;E<N;E++){var C=m[E];O=C.getLeft(),I=C.getRight(),R=C.getTop(),L=C.getBottom(),p>O&&(p=O),y<I&&(y=I),w>R&&(w=R),T<L&&(T=L)}var b=new f(p,w,y-p,T-w);return b},v.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},v.prototype.getEstimatedSize=function(){if(this.estimatedSize==o.MIN_VALUE)throw"assert failed";return this.estimatedSize},v.prototype.calcEstimatedSize=function(){for(var m=0,p=this.nodes,y=p.length,w=0;w<y;w++){var T=p[w];m+=T.calcEstimatedSize()}return m==0?this.estimatedSize=s.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=m/Math.sqrt(this.nodes.length),this.estimatedSize},v.prototype.updateConnected=function(){var m=this;if(this.nodes.length==0){this.isConnected=!0;return}var p=new c,y=new Set,w=this.nodes[0],T,O,I=w.withChildren();for(I.forEach(function(b){p.push(b),y.add(b)});p.length!==0;){w=p.shift(),T=w.getEdges();for(var R=T.length,L=0;L<R;L++){var N=T[L];if(O=N.getOtherEndInGraph(w,this),O!=null&&!y.has(O)){var E=O.withChildren();E.forEach(function(b){p.push(b),y.add(b)})}}}if(this.isConnected=!1,y.size>=this.nodes.length){var C=0;y.forEach(function(b){b.owner==m&&C++}),C==this.nodes.length&&(this.isConnected=!0)}},t.exports=v},function(t,i,n){var a,o=n(1);function s(l){a=n(6),this.layout=l,this.graphs=[],this.edges=[]}s.prototype.addRoot=function(){var l=this.layout.newGraph(),u=this.layout.newNode(null),h=this.add(l,u);return this.setRootGraph(h),this.rootGraph},s.prototype.add=function(l,u,h,f,d){if(h==null&&f==null&&d==null){if(l==null)throw"Graph is null!";if(u==null)throw"Parent node is null!";if(this.graphs.indexOf(l)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(l),l.parent!=null)throw"Already has a parent!";if(u.child!=null)throw"Already has a child!";return l.parent=u,u.child=l,l}else{d=h,f=u,h=l;var c=f.getOwner(),v=d.getOwner();if(!(c!=null&&c.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(v!=null&&v.getGraphManager()==this))throw"Target not in this graph mgr!";if(c==v)return h.isInterGraph=!1,c.add(h,f,d);if(h.isInterGraph=!0,h.source=f,h.target=d,this.edges.indexOf(h)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(h),!(h.source!=null&&h.target!=null))throw"Edge source and/or target is null!";if(!(h.source.edges.indexOf(h)==-1&&h.target.edges.indexOf(h)==-1))throw"Edge already in source and/or target incidency list!";return h.source.edges.push(h),h.target.edges.push(h),h}},s.prototype.remove=function(l){if(l instanceof a){var u=l;if(u.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(u==this.rootGraph||u.parent!=null&&u.parent.graphManager==this))throw"Invalid parent node!";var h=[];h=h.concat(u.getEdges());for(var f,d=h.length,c=0;c<d;c++)f=h[c],u.remove(f);var v=[];v=v.concat(u.getNodes());var g;d=v.length;for(var c=0;c<d;c++)g=v[c],u.remove(g);u==this.rootGraph&&this.setRootGraph(null);var m=this.graphs.indexOf(u);this.graphs.splice(m,1),u.parent=null}else if(l instanceof o){if(f=l,f==null)throw"Edge is null!";if(!f.isInterGraph)throw"Not an inter-graph edge!";if(!(f.source!=null&&f.target!=null))throw"Source and/or target is null!";if(!(f.source.edges.indexOf(f)!=-1&&f.target.edges.indexOf(f)!=-1))throw"Source and/or target doesn't know this edge!";var m=f.source.edges.indexOf(f);if(f.source.edges.splice(m,1),m=f.target.edges.indexOf(f),f.target.edges.splice(m,1),!(f.source.owner!=null&&f.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(f.source.owner.getGraphManager().edges.indexOf(f)==-1)throw"Not in owner graph manager's edge list!";var m=f.source.owner.getGraphManager().edges.indexOf(f);f.source.owner.getGraphManager().edges.splice(m,1)}},s.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},s.prototype.getGraphs=function(){return this.graphs},s.prototype.getAllNodes=function(){if(this.allNodes==null){for(var l=[],u=this.getGraphs(),h=u.length,f=0;f<h;f++)l=l.concat(u[f].getNodes());this.allNodes=l}return this.allNodes},s.prototype.resetAllNodes=function(){this.allNodes=null},s.prototype.resetAllEdges=function(){this.allEdges=null},s.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},s.prototype.getAllEdges=function(){if(this.allEdges==null){var l=[],u=this.getGraphs();u.length;for(var h=0;h<u.length;h++)l=l.concat(u[h].getEdges());l=l.concat(this.edges),this.allEdges=l}return this.allEdges},s.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},s.prototype.setAllNodesToApplyGravitation=function(l){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=l},s.prototype.getRoot=function(){return this.rootGraph},s.prototype.setRootGraph=function(l){if(l.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=l,l.parent==null&&(l.parent=this.layout.newNode("Root node"))},s.prototype.getLayout=function(){return this.layout},s.prototype.isOneAncestorOfOther=function(l,u){if(!(l!=null&&u!=null))throw"assert failed";if(l==u)return!0;var h=l.getOwner(),f;do{if(f=h.getParent(),f==null)break;if(f==u)return!0;if(h=f.getOwner(),h==null)break}while(!0);h=u.getOwner();do{if(f=h.getParent(),f==null)break;if(f==l)return!0;if(h=f.getOwner(),h==null)break}while(!0);return!1},s.prototype.calcLowestCommonAncestors=function(){for(var l,u,h,f,d,c=this.getAllEdges(),v=c.length,g=0;g<v;g++){if(l=c[g],u=l.source,h=l.target,l.lca=null,l.sourceInLca=u,l.targetInLca=h,u==h){l.lca=u.getOwner();continue}for(f=u.getOwner();l.lca==null;){for(l.targetInLca=h,d=h.getOwner();l.lca==null;){if(d==f){l.lca=d;break}if(d==this.rootGraph)break;if(l.lca!=null)throw"assert failed";l.targetInLca=d.getParent(),d=l.targetInLca.getOwner()}if(f==this.rootGraph)break;l.lca==null&&(l.sourceInLca=f.getParent(),f=l.sourceInLca.getOwner())}if(l.lca==null)throw"assert failed"}},s.prototype.calcLowestCommonAncestor=function(l,u){if(l==u)return l.getOwner();var h=l.getOwner();do{if(h==null)break;var f=u.getOwner();do{if(f==null)break;if(f==h)return f;f=f.getParent().getOwner()}while(!0);h=h.getParent().getOwner()}while(!0);return h},s.prototype.calcInclusionTreeDepths=function(l,u){l==null&&u==null&&(l=this.rootGraph,u=1);for(var h,f=l.getNodes(),d=f.length,c=0;c<d;c++)h=f[c],h.inclusionTreeDepth=u,h.child!=null&&this.calcInclusionTreeDepths(h.child,u+1)},s.prototype.includesInvalidEdge=function(){for(var l,u=[],h=this.edges.length,f=0;f<h;f++)l=this.edges[f],this.isOneAncestorOfOther(l.source,l.target)&&u.push(l);for(var f=0;f<u.length;f++)this.remove(u[f]);return!1},t.exports=s},function(t,i,n){var a=n(12);function o(){}o.calcSeparationAmount=function(s,l,u,h){if(!s.intersects(l))throw"assert failed";var f=new Array(2);this.decideDirectionsForOverlappingNodes(s,l,f),u[0]=Math.min(s.getRight(),l.getRight())-Math.max(s.x,l.x),u[1]=Math.min(s.getBottom(),l.getBottom())-Math.max(s.y,l.y),s.getX()<=l.getX()&&s.getRight()>=l.getRight()?u[0]+=Math.min(l.getX()-s.getX(),s.getRight()-l.getRight()):l.getX()<=s.getX()&&l.getRight()>=s.getRight()&&(u[0]+=Math.min(s.getX()-l.getX(),l.getRight()-s.getRight())),s.getY()<=l.getY()&&s.getBottom()>=l.getBottom()?u[1]+=Math.min(l.getY()-s.getY(),s.getBottom()-l.getBottom()):l.getY()<=s.getY()&&l.getBottom()>=s.getBottom()&&(u[1]+=Math.min(s.getY()-l.getY(),l.getBottom()-s.getBottom()));var d=Math.abs((l.getCenterY()-s.getCenterY())/(l.getCenterX()-s.getCenterX()));l.getCenterY()===s.getCenterY()&&l.getCenterX()===s.getCenterX()&&(d=1);var c=d*u[0],v=u[1]/d;u[0]<v?v=u[0]:c=u[1],u[0]=-1*f[0]*(v/2+h),u[1]=-1*f[1]*(c/2+h)},o.decideDirectionsForOverlappingNodes=function(s,l,u){s.getCenterX()<l.getCenterX()?u[0]=-1:u[0]=1,s.getCenterY()<l.getCenterY()?u[1]=-1:u[1]=1},o.getIntersection2=function(s,l,u){var h=s.getCenterX(),f=s.getCenterY(),d=l.getCenterX(),c=l.getCenterY();if(s.intersects(l))return u[0]=h,u[1]=f,u[2]=d,u[3]=c,!0;var v=s.getX(),g=s.getY(),m=s.getRight(),p=s.getX(),y=s.getBottom(),w=s.getRight(),T=s.getWidthHalf(),O=s.getHeightHalf(),I=l.getX(),R=l.getY(),L=l.getRight(),N=l.getX(),E=l.getBottom(),C=l.getRight(),b=l.getWidthHalf(),M=l.getHeightHalf(),D=!1,H=!1;if(h===d){if(f>c)return u[0]=h,u[1]=g,u[2]=d,u[3]=E,!1;if(f<c)return u[0]=h,u[1]=y,u[2]=d,u[3]=R,!1}else if(f===c){if(h>d)return u[0]=v,u[1]=f,u[2]=L,u[3]=c,!1;if(h<d)return u[0]=m,u[1]=f,u[2]=I,u[3]=c,!1}else{var k=s.height/s.width,B=l.height/l.width,U=(c-f)/(d-h),W=void 0,J=void 0,G=void 0,X=void 0,ie=void 0,ee=void 0;if(-k===U?h>d?(u[0]=p,u[1]=y,D=!0):(u[0]=m,u[1]=g,D=!0):k===U&&(h>d?(u[0]=v,u[1]=g,D=!0):(u[0]=w,u[1]=y,D=!0)),-B===U?d>h?(u[2]=N,u[3]=E,H=!0):(u[2]=L,u[3]=R,H=!0):B===U&&(d>h?(u[2]=I,u[3]=R,H=!0):(u[2]=C,u[3]=E,H=!0)),D&&H)return!1;if(h>d?f>c?(W=this.getCardinalDirection(k,U,4),J=this.getCardinalDirection(B,U,2)):(W=this.getCardinalDirection(-k,U,3),J=this.getCardinalDirection(-B,U,1)):f>c?(W=this.getCardinalDirection(-k,U,1),J=this.getCardinalDirection(-B,U,3)):(W=this.getCardinalDirection(k,U,2),J=this.getCardinalDirection(B,U,4)),!D)switch(W){case 1:X=g,G=h+-O/U,u[0]=G,u[1]=X;break;case 2:G=w,X=f+T*U,u[0]=G,u[1]=X;break;case 3:X=y,G=h+O/U,u[0]=G,u[1]=X;break;case 4:G=p,X=f+-T*U,u[0]=G,u[1]=X;break}if(!H)switch(J){case 1:ee=R,ie=d+-M/U,u[2]=ie,u[3]=ee;break;case 2:ie=C,ee=c+b*U,u[2]=ie,u[3]=ee;break;case 3:ee=E,ie=d+M/U,u[2]=ie,u[3]=ee;break;case 4:ie=N,ee=c+-b*U,u[2]=ie,u[3]=ee;break}}return!1},o.getCardinalDirection=function(s,l,u){return s>l?u:1+u%4},o.getIntersection=function(s,l,u,h){if(h==null)return this.getIntersection2(s,l,u);var f=s.x,d=s.y,c=l.x,v=l.y,g=u.x,m=u.y,p=h.x,y=h.y,w=void 0,T=void 0,O=void 0,I=void 0,R=void 0,L=void 0,N=void 0,E=void 0,C=void 0;return O=v-d,R=f-c,N=c*d-f*v,I=y-m,L=g-p,E=p*m-g*y,C=O*L-I*R,C===0?null:(w=(R*E-L*N)/C,T=(I*N-O*E)/C,new a(w,T))},o.angleOfVector=function(s,l,u,h){var f=void 0;return s!==u?(f=Math.atan((h-l)/(u-s)),u<s?f+=Math.PI:h<l&&(f+=this.TWO_PI)):h<l?f=this.ONE_AND_HALF_PI:f=this.HALF_PI,f},o.doIntersect=function(s,l,u,h){var f=s.x,d=s.y,c=l.x,v=l.y,g=u.x,m=u.y,p=h.x,y=h.y,w=(c-f)*(y-m)-(p-g)*(v-d);if(w===0)return!1;var T=((y-m)*(p-f)+(g-p)*(y-d))/w,O=((d-v)*(p-f)+(c-f)*(y-d))/w;return 0<T&&T<1&&0<O&&O<1},o.findCircleLineIntersections=function(s,l,u,h,f,d,c){var v=(u-s)*(u-s)+(h-l)*(h-l),g=2*((s-f)*(u-s)+(l-d)*(h-l)),m=(s-f)*(s-f)+(l-d)*(l-d)-c*c,p=g*g-4*v*m;if(p>=0){var y=(-g+Math.sqrt(g*g-4*v*m))/(2*v),w=(-g-Math.sqrt(g*g-4*v*m))/(2*v),T=null;return y>=0&&y<=1?[y]:w>=0&&w<=1?[w]:T}else return null},o.HALF_PI=.5*Math.PI,o.ONE_AND_HALF_PI=1.5*Math.PI,o.TWO_PI=2*Math.PI,o.THREE_PI=3*Math.PI,t.exports=o},function(t,i,n){function a(){}a.sign=function(o){return o>0?1:o<0?-1:0},a.floor=function(o){return o<0?Math.ceil(o):Math.floor(o)},a.ceil=function(o){return o<0?Math.floor(o):Math.ceil(o)},t.exports=a},function(t,i,n){function a(){}a.MAX_VALUE=2147483647,a.MIN_VALUE=-2147483648,t.exports=a},function(t,i,n){var a=function(){function f(d,c){for(var v=0;v<c.length;v++){var g=c[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,c,v){return c&&f(d.prototype,c),v&&f(d,v),d}}();function o(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}var s=function(d){return{value:d,next:null,prev:null}},l=function(d,c,v,g){return d!==null?d.next=c:g.head=c,v!==null?v.prev=c:g.tail=c,c.prev=d,c.next=v,g.length++,c},u=function(d,c){var v=d.prev,g=d.next;return v!==null?v.next=g:c.head=g,g!==null?g.prev=v:c.tail=v,d.prev=d.next=null,c.length--,d},h=function(){function f(d){var c=this;o(this,f),this.length=0,this.head=null,this.tail=null,d!=null&&d.forEach(function(v){return c.push(v)})}return a(f,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(c,v){return l(v.prev,s(c),v,this)}},{key:"insertAfter",value:function(c,v){return l(v,s(c),v.next,this)}},{key:"insertNodeBefore",value:function(c,v){return l(v.prev,c,v,this)}},{key:"insertNodeAfter",value:function(c,v){return l(v,c,v.next,this)}},{key:"push",value:function(c){return l(this.tail,s(c),null,this)}},{key:"unshift",value:function(c){return l(null,s(c),this.head,this)}},{key:"remove",value:function(c){return u(c,this)}},{key:"pop",value:function(){return u(this.tail,this).value}},{key:"popNode",value:function(){return u(this.tail,this)}},{key:"shift",value:function(){return u(this.head,this).value}},{key:"shiftNode",value:function(){return u(this.head,this)}},{key:"get_object_at",value:function(c){if(c<=this.length()){for(var v=1,g=this.head;v<c;)g=g.next,v++;return g.value}}},{key:"set_object_at",value:function(c,v){if(c<=this.length()){for(var g=1,m=this.head;g<c;)m=m.next,g++;m.value=v}}}]),f}();t.exports=h},function(t,i,n){function a(o,s,l){this.x=null,this.y=null,o==null&&s==null&&l==null?(this.x=0,this.y=0):typeof o=="number"&&typeof s=="number"&&l==null?(this.x=o,this.y=s):o.constructor.name=="Point"&&s==null&&l==null&&(l=o,this.x=l.x,this.y=l.y)}a.prototype.getX=function(){return this.x},a.prototype.getY=function(){return this.y},a.prototype.getLocation=function(){return new a(this.x,this.y)},a.prototype.setLocation=function(o,s,l){o.constructor.name=="Point"&&s==null&&l==null?(l=o,this.setLocation(l.x,l.y)):typeof o=="number"&&typeof s=="number"&&l==null&&(parseInt(o)==o&&parseInt(s)==s?this.move(o,s):(this.x=Math.floor(o+.5),this.y=Math.floor(s+.5)))},a.prototype.move=function(o,s){this.x=o,this.y=s},a.prototype.translate=function(o,s){this.x+=o,this.y+=s},a.prototype.equals=function(o){if(o.constructor.name=="Point"){var s=o;return this.x==s.x&&this.y==s.y}return this==o},a.prototype.toString=function(){return new a().constructor.name+"[x="+this.x+",y="+this.y+"]"},t.exports=a},function(t,i,n){function a(o,s,l,u){this.x=0,this.y=0,this.width=0,this.height=0,o!=null&&s!=null&&l!=null&&u!=null&&(this.x=o,this.y=s,this.width=l,this.height=u)}a.prototype.getX=function(){return this.x},a.prototype.setX=function(o){this.x=o},a.prototype.getY=function(){return this.y},a.prototype.setY=function(o){this.y=o},a.prototype.getWidth=function(){return this.width},a.prototype.setWidth=function(o){this.width=o},a.prototype.getHeight=function(){return this.height},a.prototype.setHeight=function(o){this.height=o},a.prototype.getRight=function(){return this.x+this.width},a.prototype.getBottom=function(){return this.y+this.height},a.prototype.intersects=function(o){return!(this.getRight()<o.x||this.getBottom()<o.y||o.getRight()<this.x||o.getBottom()<this.y)},a.prototype.getCenterX=function(){return this.x+this.width/2},a.prototype.getMinX=function(){return this.getX()},a.prototype.getMaxX=function(){return this.getX()+this.width},a.prototype.getCenterY=function(){return this.y+this.height/2},a.prototype.getMinY=function(){return this.getY()},a.prototype.getMaxY=function(){return this.getY()+this.height},a.prototype.getWidthHalf=function(){return this.width/2},a.prototype.getHeightHalf=function(){return this.height/2},t.exports=a},function(t,i,n){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};function o(){}o.lastID=0,o.createID=function(s){return o.isPrimitive(s)?s:(s.uniqueID!=null||(s.uniqueID=o.getString(),o.lastID++),s.uniqueID)},o.getString=function(s){return s==null&&(s=o.lastID),"Object#"+s},o.isPrimitive=function(s){var l=typeof s>"u"?"undefined":a(s);return s==null||l!="object"&&l!="function"},t.exports=o},function(t,i,n){function a(g){if(Array.isArray(g)){for(var m=0,p=Array(g.length);m<g.length;m++)p[m]=g[m];return p}else return Array.from(g)}var o=n(0),s=n(7),l=n(3),u=n(1),h=n(6),f=n(5),d=n(17),c=n(29);function v(g){c.call(this),this.layoutQuality=o.QUALITY,this.createBendsAsNeeded=o.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=o.DEFAULT_INCREMENTAL,this.animationOnLayout=o.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=o.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=o.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=o.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new s(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,g!=null&&(this.isRemoteUse=g)}v.RANDOM_SEED=1,v.prototype=Object.create(c.prototype),v.prototype.getGraphManager=function(){return this.graphManager},v.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},v.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},v.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},v.prototype.newGraphManager=function(){var g=new s(this);return this.graphManager=g,g},v.prototype.newGraph=function(g){return new h(null,this.graphManager,g)},v.prototype.newNode=function(g){return new l(this.graphManager,g)},v.prototype.newEdge=function(g){return new u(null,null,g)},v.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},v.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var g;return this.checkLayoutSuccess()?g=!1:g=this.layout(),o.ANIMATE==="during"?!1:(g&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,g)},v.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},v.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var g=this.graphManager.getAllEdges(),m=0;m<g.length;m++)g[m];for(var p=this.graphManager.getRoot().getNodes(),m=0;m<p.length;m++)p[m];this.update(this.graphManager.getRoot())}},v.prototype.update=function(g){if(g==null)this.update2();else if(g instanceof l){var m=g;if(m.getChild()!=null)for(var p=m.getChild().getNodes(),y=0;y<p.length;y++)update(p[y]);if(m.vGraphObject!=null){var w=m.vGraphObject;w.update(m)}}else if(g instanceof u){var T=g;if(T.vGraphObject!=null){var O=T.vGraphObject;O.update(T)}}else if(g instanceof h){var I=g;if(I.vGraphObject!=null){var R=I.vGraphObject;R.update(I)}}},v.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=o.QUALITY,this.animationDuringLayout=o.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=o.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=o.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=o.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=o.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=o.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},v.prototype.transform=function(g){if(g==null)this.transform(new f(0,0));else{var m=new d,p=this.graphManager.getRoot().updateLeftTop();if(p!=null){m.setWorldOrgX(g.x),m.setWorldOrgY(g.y),m.setDeviceOrgX(p.x),m.setDeviceOrgY(p.y);for(var y=this.getAllNodes(),w,T=0;T<y.length;T++)w=y[T],w.transform(m)}}},v.prototype.positionNodesRandomly=function(g){if(g==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var m,p,y=g.getNodes(),w=0;w<y.length;w++)m=y[w],p=m.getChild(),p==null||p.getNodes().length==0?m.scatter():(this.positionNodesRandomly(p),m.updateBounds())},v.prototype.getFlatForest=function(){for(var g=[],m=!0,p=this.graphManager.getRoot().getNodes(),y=!0,w=0;w<p.length;w++)p[w].getChild()!=null&&(y=!1);if(!y)return g;var T=new Set,O=[],I=new Map,R=[];for(R=R.concat(p);R.length>0&&m;){for(O.push(R[0]);O.length>0&&m;){var L=O[0];O.splice(0,1),T.add(L);for(var N=L.getEdges(),w=0;w<N.length;w++){var E=N[w].getOtherEnd(L);if(I.get(L)!=E)if(!T.has(E))O.push(E),I.set(E,L);else{m=!1;break}}}if(!m)g=[];else{var C=[].concat(a(T));g.push(C);for(var w=0;w<C.length;w++){var b=C[w],M=R.indexOf(b);M>-1&&R.splice(M,1)}T=new Set,I=new Map}}return g},v.prototype.createDummyNodesForBendpoints=function(g){for(var m=[],p=g.source,y=this.graphManager.calcLowestCommonAncestor(g.source,g.target),w=0;w<g.bendpoints.length;w++){var T=this.newNode(null);T.setRect(new Point(0,0),new Dimension(1,1)),y.add(T);var O=this.newEdge(null);this.graphManager.add(O,p,T),m.add(T),p=T}var O=this.newEdge(null);return this.graphManager.add(O,p,g.target),this.edgeToDummyNodes.set(g,m),g.isInterGraph()?this.graphManager.remove(g):y.remove(g),m},v.prototype.createBendpointsFromDummyNodes=function(){var g=[];g=g.concat(this.graphManager.getAllEdges()),g=[].concat(a(this.edgeToDummyNodes.keys())).concat(g);for(var m=0;m<g.length;m++){var p=g[m];if(p.bendpoints.length>0){for(var y=this.edgeToDummyNodes.get(p),w=0;w<y.length;w++){var T=y[w],O=new f(T.getCenterX(),T.getCenterY()),I=p.bendpoints.get(w);I.x=O.x,I.y=O.y,T.getOwner().remove(T)}this.graphManager.add(p,p.source,p.target)}}},v.transform=function(g,m,p,y){if(p!=null&&y!=null){var w=m;if(g<=50){var T=m/p;w-=(m-T)/50*(50-g)}else{var O=m*y;w+=(O-m)/50*(g-50)}return w}else{var I,R;return g<=50?(I=9*m/500,R=m/10):(I=9*m/50,R=-8*m),I*g+R}},v.findCenterOfTree=function(g){var m=[];m=m.concat(g);var p=[],y=new Map,w=!1,T=null;(m.length==1||m.length==2)&&(w=!0,T=m[0]);for(var O=0;O<m.length;O++){var I=m[O],R=I.getNeighborsList().size;y.set(I,I.getNeighborsList().size),R==1&&p.push(I)}var L=[];for(L=L.concat(p);!w;){var N=[];N=N.concat(L),L=[];for(var O=0;O<m.length;O++){var I=m[O],E=m.indexOf(I);E>=0&&m.splice(E,1);var C=I.getNeighborsList();C.forEach(function(D){if(p.indexOf(D)<0){var H=y.get(D),k=H-1;k==1&&L.push(D),y.set(D,k)}})}p=p.concat(L),(m.length==1||m.length==2)&&(w=!0,T=m[0])}return T},v.prototype.setGraphManager=function(g){this.graphManager=g},t.exports=v},function(t,i,n){function a(){}a.seed=1,a.x=0,a.nextDouble=function(){return a.x=Math.sin(a.seed++)*1e4,a.x-Math.floor(a.x)},t.exports=a},function(t,i,n){var a=n(5);function o(s,l){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}o.prototype.getWorldOrgX=function(){return this.lworldOrgX},o.prototype.setWorldOrgX=function(s){this.lworldOrgX=s},o.prototype.getWorldOrgY=function(){return this.lworldOrgY},o.prototype.setWorldOrgY=function(s){this.lworldOrgY=s},o.prototype.getWorldExtX=function(){return this.lworldExtX},o.prototype.setWorldExtX=function(s){this.lworldExtX=s},o.prototype.getWorldExtY=function(){return this.lworldExtY},o.prototype.setWorldExtY=function(s){this.lworldExtY=s},o.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},o.prototype.setDeviceOrgX=function(s){this.ldeviceOrgX=s},o.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},o.prototype.setDeviceOrgY=function(s){this.ldeviceOrgY=s},o.prototype.getDeviceExtX=function(){return this.ldeviceExtX},o.prototype.setDeviceExtX=function(s){this.ldeviceExtX=s},o.prototype.getDeviceExtY=function(){return this.ldeviceExtY},o.prototype.setDeviceExtY=function(s){this.ldeviceExtY=s},o.prototype.transformX=function(s){var l=0,u=this.lworldExtX;return u!=0&&(l=this.ldeviceOrgX+(s-this.lworldOrgX)*this.ldeviceExtX/u),l},o.prototype.transformY=function(s){var l=0,u=this.lworldExtY;return u!=0&&(l=this.ldeviceOrgY+(s-this.lworldOrgY)*this.ldeviceExtY/u),l},o.prototype.inverseTransformX=function(s){var l=0,u=this.ldeviceExtX;return u!=0&&(l=this.lworldOrgX+(s-this.ldeviceOrgX)*this.lworldExtX/u),l},o.prototype.inverseTransformY=function(s){var l=0,u=this.ldeviceExtY;return u!=0&&(l=this.lworldOrgY+(s-this.ldeviceOrgY)*this.lworldExtY/u),l},o.prototype.inverseTransformPoint=function(s){var l=new a(this.inverseTransformX(s.x),this.inverseTransformY(s.y));return l},t.exports=o},function(t,i,n){function a(c){if(Array.isArray(c)){for(var v=0,g=Array(c.length);v<c.length;v++)g[v]=c[v];return g}else return Array.from(c)}var o=n(15),s=n(4),l=n(0),u=n(8),h=n(9);function f(){o.call(this),this.useSmartIdealEdgeLengthCalculation=s.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=s.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=s.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=s.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=s.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*s.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=s.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=s.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=s.MAX_ITERATIONS}f.prototype=Object.create(o.prototype);for(var d in o)f[d]=o[d];f.prototype.initParameters=function(){o.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=s.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},f.prototype.calcIdealEdgeLengths=function(){for(var c,v,g,m,p,y,w,T=this.getGraphManager().getAllEdges(),O=0;O<T.length;O++)c=T[O],v=c.idealLength,c.isInterGraph&&(m=c.getSource(),p=c.getTarget(),y=c.getSourceInLca().getEstimatedSize(),w=c.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(c.idealLength+=y+w-2*l.SIMPLE_NODE_SIZE),g=c.getLca().getInclusionTreeDepth(),c.idealLength+=v*s.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(m.getInclusionTreeDepth()+p.getInclusionTreeDepth()-2*g))},f.prototype.initSpringEmbedder=function(){var c=this.getAllNodes().length;this.incremental?(c>s.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*s.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(c-s.ADAPTATION_LOWER_NODE_LIMIT)/(s.ADAPTATION_UPPER_NODE_LIMIT-s.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-s.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=s.MAX_NODE_DISPLACEMENT_INCREMENTAL):(c>s.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(s.COOLING_ADAPTATION_FACTOR,1-(c-s.ADAPTATION_LOWER_NODE_LIMIT)/(s.ADAPTATION_UPPER_NODE_LIMIT-s.ADAPTATION_LOWER_NODE_LIMIT)*(1-s.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=s.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.displacementThresholdPerNode=3*s.DEFAULT_EDGE_LENGTH/100,this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},f.prototype.calcSpringForces=function(){for(var c=this.getAllEdges(),v,g=0;g<c.length;g++)v=c[g],this.calcSpringForce(v,v.idealLength)},f.prototype.calcRepulsionForces=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g,m,p,y,w=this.getAllNodes(),T;if(this.useFRGridVariant)for(this.totalIterations%s.GRID_CALCULATION_CHECK_PERIOD==1&&c&&this.updateGrid(),T=new Set,g=0;g<w.length;g++)p=w[g],this.calculateRepulsionForceOfANode(p,T,c,v),T.add(p);else for(g=0;g<w.length;g++)for(p=w[g],m=g+1;m<w.length;m++)y=w[m],p.getOwner()==y.getOwner()&&this.calcRepulsionForce(p,y)},f.prototype.calcGravitationalForces=function(){for(var c,v=this.getAllNodesToApplyGravitation(),g=0;g<v.length;g++)c=v[g],this.calcGravitationalForce(c)},f.prototype.moveNodes=function(){for(var c=this.getAllNodes(),v,g=0;g<c.length;g++)v=c[g],v.move()},f.prototype.calcSpringForce=function(c,v){var g=c.getSource(),m=c.getTarget(),p,y,w,T;if(this.uniformLeafNodeSizes&&g.getChild()==null&&m.getChild()==null)c.updateLengthSimple();else if(c.updateLength(),c.isOverlapingSourceAndTarget)return;p=c.getLength(),p!=0&&(y=c.edgeElasticity*(p-v),w=y*(c.lengthX/p),T=y*(c.lengthY/p),g.springForceX+=w,g.springForceY+=T,m.springForceX-=w,m.springForceY-=T)},f.prototype.calcRepulsionForce=function(c,v){var g=c.getRect(),m=v.getRect(),p=new Array(2),y=new Array(4),w,T,O,I,R,L,N;if(g.intersects(m)){u.calcSeparationAmount(g,m,p,s.DEFAULT_EDGE_LENGTH/2),L=2*p[0],N=2*p[1];var E=c.noOfChildren*v.noOfChildren/(c.noOfChildren+v.noOfChildren);c.repulsionForceX-=E*L,c.repulsionForceY-=E*N,v.repulsionForceX+=E*L,v.repulsionForceY+=E*N}else this.uniformLeafNodeSizes&&c.getChild()==null&&v.getChild()==null?(w=m.getCenterX()-g.getCenterX(),T=m.getCenterY()-g.getCenterY()):(u.getIntersection(g,m,y),w=y[2]-y[0],T=y[3]-y[1]),Math.abs(w)<s.MIN_REPULSION_DIST&&(w=h.sign(w)*s.MIN_REPULSION_DIST),Math.abs(T)<s.MIN_REPULSION_DIST&&(T=h.sign(T)*s.MIN_REPULSION_DIST),O=w*w+T*T,I=Math.sqrt(O),R=(c.nodeRepulsion/2+v.nodeRepulsion/2)*c.noOfChildren*v.noOfChildren/O,L=R*w/I,N=R*T/I,c.repulsionForceX-=L,c.repulsionForceY-=N,v.repulsionForceX+=L,v.repulsionForceY+=N},f.prototype.calcGravitationalForce=function(c){var v,g,m,p,y,w,T,O;v=c.getOwner(),g=(v.getRight()+v.getLeft())/2,m=(v.getTop()+v.getBottom())/2,p=c.getCenterX()-g,y=c.getCenterY()-m,w=Math.abs(p)+c.getWidth()/2,T=Math.abs(y)+c.getHeight()/2,c.getOwner()==this.graphManager.getRoot()?(O=v.getEstimatedSize()*this.gravityRangeFactor,(w>O||T>O)&&(c.gravitationForceX=-this.gravityConstant*p,c.gravitationForceY=-this.gravityConstant*y)):(O=v.getEstimatedSize()*this.compoundGravityRangeFactor,(w>O||T>O)&&(c.gravitationForceX=-this.gravityConstant*p*this.compoundGravityConstant,c.gravitationForceY=-this.gravityConstant*y*this.compoundGravityConstant))},f.prototype.isConverged=function(){var c,v=!1;return this.totalIterations>this.maxIterations/3&&(v=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),c=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,c||v},f.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},f.prototype.calcNoOfChildrenForAllNodes=function(){for(var c,v=this.graphManager.getAllNodes(),g=0;g<v.length;g++)c=v[g],c.noOfChildren=c.getNoOfChildren()},f.prototype.calcGrid=function(c){var v=0,g=0;v=parseInt(Math.ceil((c.getRight()-c.getLeft())/this.repulsionRange)),g=parseInt(Math.ceil((c.getBottom()-c.getTop())/this.repulsionRange));for(var m=new Array(v),p=0;p<v;p++)m[p]=new Array(g);for(var p=0;p<v;p++)for(var y=0;y<g;y++)m[p][y]=new Array;return m},f.prototype.addNodeToGrid=function(c,v,g){var m=0,p=0,y=0,w=0;m=parseInt(Math.floor((c.getRect().x-v)/this.repulsionRange)),p=parseInt(Math.floor((c.getRect().width+c.getRect().x-v)/this.repulsionRange)),y=parseInt(Math.floor((c.getRect().y-g)/this.repulsionRange)),w=parseInt(Math.floor((c.getRect().height+c.getRect().y-g)/this.repulsionRange));for(var T=m;T<=p;T++)for(var O=y;O<=w;O++)this.grid[T][O].push(c),c.setGridCoordinates(m,p,y,w)},f.prototype.updateGrid=function(){var c,v,g=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),c=0;c<g.length;c++)v=g[c],this.addNodeToGrid(v,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},f.prototype.calculateRepulsionForceOfANode=function(c,v,g,m){if(this.totalIterations%s.GRID_CALCULATION_CHECK_PERIOD==1&&g||m){var p=new Set;c.surrounding=new Array;for(var y,w=this.grid,T=c.startX-1;T<c.finishX+2;T++)for(var O=c.startY-1;O<c.finishY+2;O++)if(!(T<0||O<0||T>=w.length||O>=w[0].length)){for(var I=0;I<w[T][O].length;I++)if(y=w[T][O][I],!(c.getOwner()!=y.getOwner()||c==y)&&!v.has(y)&&!p.has(y)){var R=Math.abs(c.getCenterX()-y.getCenterX())-(c.getWidth()/2+y.getWidth()/2),L=Math.abs(c.getCenterY()-y.getCenterY())-(c.getHeight()/2+y.getHeight()/2);R<=this.repulsionRange&&L<=this.repulsionRange&&p.add(y)}}c.surrounding=[].concat(a(p))}for(T=0;T<c.surrounding.length;T++)this.calcRepulsionForce(c,c.surrounding[T])},f.prototype.calcRepulsionRange=function(){return 0},t.exports=f},function(t,i,n){var a=n(1),o=n(4);function s(u,h,f){a.call(this,u,h,f),this.idealLength=o.DEFAULT_EDGE_LENGTH,this.edgeElasticity=o.DEFAULT_SPRING_STRENGTH}s.prototype=Object.create(a.prototype);for(var l in a)s[l]=a[l];t.exports=s},function(t,i,n){var a=n(3),o=n(4);function s(u,h,f,d){a.call(this,u,h,f,d),this.nodeRepulsion=o.DEFAULT_REPULSION_STRENGTH,this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}s.prototype=Object.create(a.prototype);for(var l in a)s[l]=a[l];s.prototype.setGridCoordinates=function(u,h,f,d){this.startX=u,this.finishX=h,this.startY=f,this.finishY=d},t.exports=s},function(t,i,n){function a(o,s){this.width=0,this.height=0,o!==null&&s!==null&&(this.height=s,this.width=o)}a.prototype.getWidth=function(){return this.width},a.prototype.setWidth=function(o){this.width=o},a.prototype.getHeight=function(){return this.height},a.prototype.setHeight=function(o){this.height=o},t.exports=a},function(t,i,n){var a=n(14);function o(){this.map={},this.keys=[]}o.prototype.put=function(s,l){var u=a.createID(s);this.contains(u)||(this.map[u]=l,this.keys.push(s))},o.prototype.contains=function(s){return a.createID(s),this.map[s]!=null},o.prototype.get=function(s){var l=a.createID(s);return this.map[l]},o.prototype.keySet=function(){return this.keys},t.exports=o},function(t,i,n){var a=n(14);function o(){this.set={}}o.prototype.add=function(s){var l=a.createID(s);this.contains(l)||(this.set[l]=s)},o.prototype.remove=function(s){delete this.set[a.createID(s)]},o.prototype.clear=function(){this.set={}},o.prototype.contains=function(s){return this.set[a.createID(s)]==s},o.prototype.isEmpty=function(){return this.size()===0},o.prototype.size=function(){return Object.keys(this.set).length},o.prototype.addAllTo=function(s){for(var l=Object.keys(this.set),u=l.length,h=0;h<u;h++)s.push(this.set[l[h]])},o.prototype.size=function(){return Object.keys(this.set).length},o.prototype.addAll=function(s){for(var l=s.length,u=0;u<l;u++){var h=s[u];this.add(h)}},t.exports=o},function(t,i,n){function a(){}a.multMat=function(o,s){for(var l=[],u=0;u<o.length;u++){l[u]=[];for(var h=0;h<s[0].length;h++){l[u][h]=0;for(var f=0;f<o[0].length;f++)l[u][h]+=o[u][f]*s[f][h]}}return l},a.transpose=function(o){for(var s=[],l=0;l<o[0].length;l++){s[l]=[];for(var u=0;u<o.length;u++)s[l][u]=o[u][l]}return s},a.multCons=function(o,s){for(var l=[],u=0;u<o.length;u++)l[u]=o[u]*s;return l},a.minusOp=function(o,s){for(var l=[],u=0;u<o.length;u++)l[u]=o[u]-s[u];return l},a.dotProduct=function(o,s){for(var l=0,u=0;u<o.length;u++)l+=o[u]*s[u];return l},a.mag=function(o){return Math.sqrt(this.dotProduct(o,o))},a.normalize=function(o){for(var s=[],l=this.mag(o),u=0;u<o.length;u++)s[u]=o[u]/l;return s},a.multGamma=function(o){for(var s=[],l=0,u=0;u<o.length;u++)l+=o[u];l*=-1/o.length;for(var h=0;h<o.length;h++)s[h]=l+o[h];return s},a.multL=function(o,s,l){for(var u=[],h=[],f=[],d=0;d<s[0].length;d++){for(var c=0,v=0;v<s.length;v++)c+=-.5*s[v][d]*o[v];h[d]=c}for(var g=0;g<l.length;g++){for(var m=0,p=0;p<l.length;p++)m+=l[g][p]*h[p];f[g]=m}for(var y=0;y<s.length;y++){for(var w=0,T=0;T<s[0].length;T++)w+=s[y][T]*f[T];u[y]=w}return u},t.exports=a},function(t,i,n){var a=function(){function u(h,f){for(var d=0;d<f.length;d++){var c=f[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}return function(h,f,d){return f&&u(h.prototype,f),d&&u(h,d),h}}();function o(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}var s=n(11),l=function(){function u(h,f){o(this,u),(f!==null||f!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var d=void 0;h instanceof s?d=h.size():d=h.length,this._quicksort(h,0,d-1)}return a(u,[{key:"_quicksort",value:function(f,d,c){if(d<c){var v=this._partition(f,d,c);this._quicksort(f,d,v),this._quicksort(f,v+1,c)}}},{key:"_partition",value:function(f,d,c){for(var v=this._get(f,d),g=d,m=c;;){for(;this.compareFunction(v,this._get(f,m));)m--;for(;this.compareFunction(this._get(f,g),v);)g++;if(g<m)this._swap(f,g,m),g++,m--;else return m}}},{key:"_get",value:function(f,d){return f instanceof s?f.get_object_at(d):f[d]}},{key:"_set",value:function(f,d,c){f instanceof s?f.set_object_at(d,c):f[d]=c}},{key:"_swap",value:function(f,d,c){var v=this._get(f,d);this._set(f,d,this._get(f,c)),this._set(f,c,v)}},{key:"_defaultCompareFunction",value:function(f,d){return d>f}}]),u}();t.exports=l},function(t,i,n){function a(){}a.svd=function(o){this.U=null,this.V=null,this.s=null,this.m=0,this.n=0,this.m=o.length,this.n=o[0].length;var s=Math.min(this.m,this.n);this.s=function(Fe){for(var Ie=[];Fe-- >0;)Ie.push(0);return Ie}(Math.min(this.m+1,this.n)),this.U=function(Fe){var Ie=function Ze(ft){if(ft.length==0)return 0;for(var ht=[],bt=0;bt<ft[0];bt++)ht.push(Ze(ft.slice(1)));return ht};return Ie(Fe)}([this.m,s]),this.V=function(Fe){var Ie=function Ze(ft){if(ft.length==0)return 0;for(var ht=[],bt=0;bt<ft[0];bt++)ht.push(Ze(ft.slice(1)));return ht};return Ie(Fe)}([this.n,this.n]);for(var l=function(Fe){for(var Ie=[];Fe-- >0;)Ie.push(0);return Ie}(this.n),u=function(Fe){for(var Ie=[];Fe-- >0;)Ie.push(0);return Ie}(this.m),h=!0,f=Math.min(this.m-1,this.n),d=Math.max(0,Math.min(this.n-2,this.m)),c=0;c<Math.max(f,d);c++){if(c<f){this.s[c]=0;for(var v=c;v<this.m;v++)this.s[c]=a.hypot(this.s[c],o[v][c]);if(this.s[c]!==0){o[c][c]<0&&(this.s[c]=-this.s[c]);for(var g=c;g<this.m;g++)o[g][c]/=this.s[c];o[c][c]+=1}this.s[c]=-this.s[c]}for(var m=c+1;m<this.n;m++){if(function(Fe,Ie){return Fe&&Ie}(c<f,this.s[c]!==0)){for(var p=0,y=c;y<this.m;y++)p+=o[y][c]*o[y][m];p=-p/o[c][c];for(var w=c;w<this.m;w++)o[w][m]+=p*o[w][c]}l[m]=o[c][m]}if(function(Fe,Ie){return Fe&&Ie}(h,c<f))for(var T=c;T<this.m;T++)this.U[T][c]=o[T][c];if(c<d){l[c]=0;for(var O=c+1;O<this.n;O++)l[c]=a.hypot(l[c],l[O]);if(l[c]!==0){l[c+1]<0&&(l[c]=-l[c]);for(var I=c+1;I<this.n;I++)l[I]/=l[c];l[c+1]+=1}if(l[c]=-l[c],function(Fe,Ie){return Fe&&Ie}(c+1<this.m,l[c]!==0)){for(var R=c+1;R<this.m;R++)u[R]=0;for(var L=c+1;L<this.n;L++)for(var N=c+1;N<this.m;N++)u[N]+=l[L]*o[N][L];for(var E=c+1;E<this.n;E++)for(var C=-l[E]/l[c+1],b=c+1;b<this.m;b++)o[b][E]+=C*u[b]}for(var M=c+1;M<this.n;M++)this.V[M][c]=l[M]}}var D=Math.min(this.n,this.m+1);f<this.n&&(this.s[f]=o[f][f]),this.m<D&&(this.s[D-1]=0),d+1<D&&(l[d]=o[d][D-1]),l[D-1]=0;{for(var H=f;H<s;H++){for(var k=0;k<this.m;k++)this.U[k][H]=0;this.U[H][H]=1}for(var B=f-1;B>=0;B--)if(this.s[B]!==0){for(var U=B+1;U<s;U++){for(var W=0,J=B;J<this.m;J++)W+=this.U[J][B]*this.U[J][U];W=-W/this.U[B][B];for(var G=B;G<this.m;G++)this.U[G][U]+=W*this.U[G][B]}for(var X=B;X<this.m;X++)this.U[X][B]=-this.U[X][B];this.U[B][B]=1+this.U[B][B];for(var ie=0;ie<B-1;ie++)this.U[ie][B]=0}else{for(var ee=0;ee<this.m;ee++)this.U[ee][B]=0;this.U[B][B]=1}}for(var q=this.n-1;q>=0;q--){if(function(Fe,Ie){return Fe&&Ie}(q<d,l[q]!==0))for(var $=q+1;$<s;$++){for(var V=0,re=q+1;re<this.n;re++)V+=this.V[re][q]*this.V[re][$];V=-V/this.V[q+1][q];for(var ae=q+1;ae<this.n;ae++)this.V[ae][$]+=V*this.V[ae][q]}for(var de=0;de<this.n;de++)this.V[de][q]=0;this.V[q][q]=1}for(var ye=D-1,Te=Math.pow(2,-52),Oe=Math.pow(2,-966);D>0;){var ce=void 0,x=void 0;for(ce=D-2;ce>=-1&&ce!==-1;ce--)if(Math.abs(l[ce])<=Oe+Te*(Math.abs(this.s[ce])+Math.abs(this.s[ce+1]))){l[ce]=0;break}if(ce===D-2)x=4;else{var z=void 0;for(z=D-1;z>=ce&&z!==ce;z--){var j=(z!==D?Math.abs(l[z]):0)+(z!==ce+1?Math.abs(l[z-1]):0);if(Math.abs(this.s[z])<=Oe+Te*j){this.s[z]=0;break}}z===ce?x=3:z===D-1?x=1:(x=2,ce=z)}switch(ce++,x){case 1:{var te=l[D-2];l[D-2]=0;for(var K=D-2;K>=ce;K--){var le=a.hypot(this.s[K],te),fe=this.s[K]/le,me=te/le;this.s[K]=le,K!==ce&&(te=-me*l[K-1],l[K-1]=fe*l[K-1]);for(var se=0;se<this.n;se++)le=fe*this.V[se][K]+me*this.V[se][D-1],this.V[se][D-1]=-me*this.V[se][K]+fe*this.V[se][D-1],this.V[se][K]=le}}break;case 2:{var F=l[ce-1];l[ce-1]=0;for(var Q=ce;Q<D;Q++){var ue=a.hypot(this.s[Q],F),oe=this.s[Q]/ue,Z=F/ue;this.s[Q]=ue,F=-Z*l[Q],l[Q]=oe*l[Q];for(var P=0;P<this.m;P++)ue=oe*this.U[P][Q]+Z*this.U[P][ce-1],this.U[P][ce-1]=-Z*this.U[P][Q]+oe*this.U[P][ce-1],this.U[P][Q]=ue}}break;case 3:{var S=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[D-1]),Math.abs(this.s[D-2])),Math.abs(l[D-2])),Math.abs(this.s[ce])),Math.abs(l[ce])),A=this.s[D-1]/S,_=this.s[D-2]/S,Y=l[D-2]/S,ne=this.s[ce]/S,pe=l[ce]/S,he=((_+A)*(_-A)+Y*Y)/2,ge=A*Y*(A*Y),we=0;(function(Fe,Ie){return Fe||Ie})(he!==0,ge!==0)&&(we=Math.sqrt(he*he+ge),he<0&&(we=-we),we=ge/(he+we));for(var Ee=(ne+A)*(ne-A)+we,Pe=ne*pe,Ce=ce;Ce<D-1;Ce++){var be=a.hypot(Ee,Pe),xe=Ee/be,Me=Pe/be;Ce!==ce&&(l[Ce-1]=be),Ee=xe*this.s[Ce]+Me*l[Ce],l[Ce]=xe*l[Ce]-Me*this.s[Ce],Pe=Me*this.s[Ce+1],this.s[Ce+1]=xe*this.s[Ce+1];for(var Re=0;Re<this.n;Re++)be=xe*this.V[Re][Ce]+Me*this.V[Re][Ce+1],this.V[Re][Ce+1]=-Me*this.V[Re][Ce]+xe*this.V[Re][Ce+1],this.V[Re][Ce]=be;if(be=a.hypot(Ee,Pe),xe=Ee/be,Me=Pe/be,this.s[Ce]=be,Ee=xe*l[Ce]+Me*this.s[Ce+1],this.s[Ce+1]=-Me*l[Ce]+xe*this.s[Ce+1],Pe=Me*l[Ce+1],l[Ce+1]=xe*l[Ce+1],Ce<this.m-1)for(var De=0;De<this.m;De++)be=xe*this.U[De][Ce]+Me*this.U[De][Ce+1],this.U[De][Ce+1]=-Me*this.U[De][Ce]+xe*this.U[De][Ce+1],this.U[De][Ce]=be}l[D-2]=Ee}break;case 4:{if(this.s[ce]<=0){this.s[ce]=this.s[ce]<0?-this.s[ce]:0;for(var ze=0;ze<=ye;ze++)this.V[ze][ce]=-this.V[ze][ce]}for(;ce<ye&&!(this.s[ce]>=this.s[ce+1]);){var Be=this.s[ce];if(this.s[ce]=this.s[ce+1],this.s[ce+1]=Be,ce<this.n-1)for(var et=0;et<this.n;et++)Be=this.V[et][ce+1],this.V[et][ce+1]=this.V[et][ce],this.V[et][ce]=Be;if(ce<this.m-1)for(var lt=0;lt<this.m;lt++)Be=this.U[lt][ce+1],this.U[lt][ce+1]=this.U[lt][ce],this.U[lt][ce]=Be;ce++}D--}break}}var ut={U:this.U,V:this.V,S:this.s};return ut},a.hypot=function(o,s){var l=void 0;return Math.abs(o)>Math.abs(s)?(l=s/o,l=Math.abs(o)*Math.sqrt(1+l*l)):s!=0?(l=o/s,l=Math.abs(s)*Math.sqrt(1+l*l)):l=0,l},t.exports=a},function(t,i,n){var a=function(){function l(u,h){for(var f=0;f<h.length;f++){var d=h[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}return function(u,h,f){return h&&l(u.prototype,h),f&&l(u,f),u}}();function o(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var s=function(){function l(u,h){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;o(this,l),this.sequence1=u,this.sequence2=h,this.match_score=f,this.mismatch_penalty=d,this.gap_penalty=c,this.iMax=u.length+1,this.jMax=h.length+1,this.grid=new Array(this.iMax);for(var v=0;v<this.iMax;v++){this.grid[v]=new Array(this.jMax);for(var g=0;g<this.jMax;g++)this.grid[v][g]=0}this.tracebackGrid=new Array(this.iMax);for(var m=0;m<this.iMax;m++){this.tracebackGrid[m]=new Array(this.jMax);for(var p=0;p<this.jMax;p++)this.tracebackGrid[m][p]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return a(l,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var h=1;h<this.jMax;h++)this.grid[0][h]=this.grid[0][h-1]+this.gap_penalty,this.tracebackGrid[0][h]=[!1,!1,!0];for(var f=1;f<this.iMax;f++)this.grid[f][0]=this.grid[f-1][0]+this.gap_penalty,this.tracebackGrid[f][0]=[!1,!0,!1];for(var d=1;d<this.iMax;d++)for(var c=1;c<this.jMax;c++){var v=void 0;this.sequence1[d-1]===this.sequence2[c-1]?v=this.grid[d-1][c-1]+this.match_score:v=this.grid[d-1][c-1]+this.mismatch_penalty;var g=this.grid[d-1][c]+this.gap_penalty,m=this.grid[d][c-1]+this.gap_penalty,p=[v,g,m],y=this.arrayAllMaxIndexes(p);this.grid[d][c]=p[y[0]],this.tracebackGrid[d][c]=[y.includes(0),y.includes(1),y.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var h=[];for(h.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});h[0];){var f=h[0],d=this.tracebackGrid[f.pos[0]][f.pos[1]];d[0]&&h.push({pos:[f.pos[0]-1,f.pos[1]-1],seq1:this.sequence1[f.pos[0]-1]+f.seq1,seq2:this.sequence2[f.pos[1]-1]+f.seq2}),d[1]&&h.push({pos:[f.pos[0]-1,f.pos[1]],seq1:this.sequence1[f.pos[0]-1]+f.seq1,seq2:"-"+f.seq2}),d[2]&&h.push({pos:[f.pos[0],f.pos[1]-1],seq1:"-"+f.seq1,seq2:this.sequence2[f.pos[1]-1]+f.seq2}),f.pos[0]===0&&f.pos[1]===0&&this.alignments.push({sequence1:f.seq1,sequence2:f.seq2}),h.shift()}return this.alignments}},{key:"getAllIndexes",value:function(h,f){for(var d=[],c=-1;(c=h.indexOf(f,c+1))!==-1;)d.push(c);return d}},{key:"arrayAllMaxIndexes",value:function(h){return this.getAllIndexes(h,Math.max.apply(null,h))}}]),l}();t.exports=s},function(t,i,n){var a=function(){};a.FDLayout=n(18),a.FDLayoutConstants=n(4),a.FDLayoutEdge=n(19),a.FDLayoutNode=n(20),a.DimensionD=n(21),a.HashMap=n(22),a.HashSet=n(23),a.IGeometry=n(8),a.IMath=n(9),a.Integer=n(10),a.Point=n(12),a.PointD=n(5),a.RandomSeed=n(16),a.RectangleD=n(13),a.Transform=n(17),a.UniqueIDGeneretor=n(14),a.Quicksort=n(25),a.LinkedList=n(11),a.LGraphObject=n(2),a.LGraph=n(6),a.LEdge=n(1),a.LGraphManager=n(7),a.LNode=n(3),a.Layout=n(15),a.LayoutConstants=n(0),a.NeedlemanWunsch=n(27),a.Matrix=n(24),a.SVD=n(26),t.exports=a},function(t,i,n){function a(){this.listeners=[]}var o=a.prototype;o.addListener=function(s,l){this.listeners.push({event:s,callback:l})},o.removeListener=function(s,l){for(var u=this.listeners.length;u>=0;u--){var h=this.listeners[u];h.event===s&&h.callback===l&&this.listeners.splice(u,1)}},o.emit=function(s,l){for(var u=0;u<this.listeners.length;u++){var h=this.listeners[u];s===h.event&&h.callback(l)}},t.exports=a}])})}(Xa)),Xa.exports}var bl;function NT(){return bl||(bl=1,function(r,e){(function(i,n){r.exports=n(MT())})(xr,function(t){return function(i){var n={};function a(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return i[o].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=i,a.c=n,a.i=function(o){return o},a.d=function(o,s,l){a.o(o,s)||Object.defineProperty(o,s,{configurable:!1,enumerable:!0,get:l})},a.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(s,"a",s),s},a.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},a.p="",a(a.s=8)}([function(i,n){i.exports=t},function(i,n,a){var o=a(0).FDLayoutConstants;function s(){}for(var l in o)s[l]=o[l];s.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,s.DEFAULT_RADIAL_SEPARATION=o.DEFAULT_EDGE_LENGTH,s.DEFAULT_COMPONENT_SEPERATION=60,s.TILE=!0,s.TILING_PADDING_VERTICAL=10,s.TILING_PADDING_HORIZONTAL=10,s.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,s.ENFORCE_CONSTRAINTS=!0,s.APPLY_LAYOUT=!0,s.RELAX_MOVEMENT_ON_CONSTRAINTS=!0,s.TREE_REDUCTION_ON_INCREMENTAL=!0,s.PURE_INCREMENTAL=s.DEFAULT_INCREMENTAL,i.exports=s},function(i,n,a){var o=a(0).FDLayoutEdge;function s(u,h,f){o.call(this,u,h,f)}s.prototype=Object.create(o.prototype);for(var l in o)s[l]=o[l];i.exports=s},function(i,n,a){var o=a(0).LGraph;function s(u,h,f){o.call(this,u,h,f)}s.prototype=Object.create(o.prototype);for(var l in o)s[l]=o[l];i.exports=s},function(i,n,a){var o=a(0).LGraphManager;function s(u){o.call(this,u)}s.prototype=Object.create(o.prototype);for(var l in o)s[l]=o[l];i.exports=s},function(i,n,a){var o=a(0).FDLayoutNode,s=a(0).IMath;function l(h,f,d,c){o.call(this,h,f,d,c)}l.prototype=Object.create(o.prototype);for(var u in o)l[u]=o[u];l.prototype.calculateDisplacement=function(){var h=this.graphManager.getLayout();this.getChild()!=null&&this.fixedNodeWeight?(this.displacementX+=h.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.fixedNodeWeight,this.displacementY+=h.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.fixedNodeWeight):(this.displacementX+=h.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY+=h.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren),Math.abs(this.displacementX)>h.coolingFactor*h.maxNodeDisplacement&&(this.displacementX=h.coolingFactor*h.maxNodeDisplacement*s.sign(this.displacementX)),Math.abs(this.displacementY)>h.coolingFactor*h.maxNodeDisplacement&&(this.displacementY=h.coolingFactor*h.maxNodeDisplacement*s.sign(this.displacementY)),this.child&&this.child.getNodes().length>0&&this.propogateDisplacementToChildren(this.displacementX,this.displacementY)},l.prototype.propogateDisplacementToChildren=function(h,f){for(var d=this.getChild().getNodes(),c,v=0;v<d.length;v++)c=d[v],c.getChild()==null?(c.displacementX+=h,c.displacementY+=f):c.propogateDisplacementToChildren(h,f)},l.prototype.move=function(){var h=this.graphManager.getLayout();(this.child==null||this.child.getNodes().length==0)&&(this.moveBy(this.displacementX,this.displacementY),h.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},l.prototype.setPred1=function(h){this.pred1=h},l.prototype.getPred1=function(){return pred1},l.prototype.getPred2=function(){return pred2},l.prototype.setNext=function(h){this.next=h},l.prototype.getNext=function(){return next},l.prototype.setProcessed=function(h){this.processed=h},l.prototype.isProcessed=function(){return processed},i.exports=l},function(i,n,a){function o(d){if(Array.isArray(d)){for(var c=0,v=Array(d.length);c<d.length;c++)v[c]=d[c];return v}else return Array.from(d)}var s=a(1),l=a(0).LinkedList,u=a(0).Matrix,h=a(0).SVD;function f(){}f.handleConstraints=function(d){var c={};c.fixedNodeConstraint=d.constraints.fixedNodeConstraint,c.alignmentConstraint=d.constraints.alignmentConstraint,c.relativePlacementConstraint=d.constraints.relativePlacementConstraint;for(var v=new Map,g=new Map,m=[],p=[],y=d.getAllNodes(),w=0,T=0;T<y.length;T++){var O=y[T];O.getChild()==null&&(g.set(O.id,w++),m.push(O.getCenterX()),p.push(O.getCenterY()),v.set(O.id,O))}c.relativePlacementConstraint&&c.relativePlacementConstraint.forEach(function(Z){!Z.gap&&Z.gap!=0&&(Z.left?Z.gap=s.DEFAULT_EDGE_LENGTH+v.get(Z.left).getWidth()/2+v.get(Z.right).getWidth()/2:Z.gap=s.DEFAULT_EDGE_LENGTH+v.get(Z.top).getHeight()/2+v.get(Z.bottom).getHeight()/2)});var I=function(P,S){return{x:P.x-S.x,y:P.y-S.y}},R=function(P){var S=0,A=0;return P.forEach(function(_){S+=m[g.get(_)],A+=p[g.get(_)]}),{x:S/P.size,y:A/P.size}},L=function(P,S,A,_,Y){function ne(be,xe){var Me=new Set(be),Re=!0,De=!1,ze=void 0;try{for(var Be=xe[Symbol.iterator](),et;!(Re=(et=Be.next()).done);Re=!0){var lt=et.value;Me.add(lt)}}catch(ut){De=!0,ze=ut}finally{try{!Re&&Be.return&&Be.return()}finally{if(De)throw ze}}return Me}var pe=new Map;P.forEach(function(be,xe){pe.set(xe,0)}),P.forEach(function(be,xe){be.forEach(function(Me){pe.set(Me.id,pe.get(Me.id)+1)})});var he=new Map,ge=new Map,we=new l;pe.forEach(function(be,xe){be==0?(we.push(xe),A||(S=="horizontal"?he.set(xe,g.has(xe)?m[g.get(xe)]:_.get(xe)):he.set(xe,g.has(xe)?p[g.get(xe)]:_.get(xe)))):he.set(xe,Number.NEGATIVE_INFINITY),A&&ge.set(xe,new Set([xe]))}),A&&Y.forEach(function(be){var xe=[];if(be.forEach(function(De){A.has(De)&&xe.push(De)}),xe.length>0){var Me=0;xe.forEach(function(De){S=="horizontal"?(he.set(De,g.has(De)?m[g.get(De)]:_.get(De)),Me+=he.get(De)):(he.set(De,g.has(De)?p[g.get(De)]:_.get(De)),Me+=he.get(De))}),Me=Me/xe.length,be.forEach(function(De){A.has(De)||he.set(De,Me)})}else{var Re=0;be.forEach(function(De){S=="horizontal"?Re+=g.has(De)?m[g.get(De)]:_.get(De):Re+=g.has(De)?p[g.get(De)]:_.get(De)}),Re=Re/be.length,be.forEach(function(De){he.set(De,Re)})}});for(var Ee=function(){var xe=we.shift(),Me=P.get(xe);Me.forEach(function(Re){if(he.get(Re.id)<he.get(xe)+Re.gap)if(A&&A.has(Re.id)){var De=void 0;if(S=="horizontal"?De=g.has(Re.id)?m[g.get(Re.id)]:_.get(Re.id):De=g.has(Re.id)?p[g.get(Re.id)]:_.get(Re.id),he.set(Re.id,De),De<he.get(xe)+Re.gap){var ze=he.get(xe)+Re.gap-De;ge.get(xe).forEach(function(Be){he.set(Be,he.get(Be)-ze)})}}else he.set(Re.id,he.get(xe)+Re.gap);pe.set(Re.id,pe.get(Re.id)-1),pe.get(Re.id)==0&&we.push(Re.id),A&&ge.set(Re.id,ne(ge.get(xe),ge.get(Re.id)))})};we.length!=0;)Ee();if(A){var Pe=new Set;P.forEach(function(be,xe){be.length==0&&Pe.add(xe)});var Ce=[];ge.forEach(function(be,xe){if(Pe.has(xe)){var Me=!1,Re=!0,De=!1,ze=void 0;try{for(var Be=be[Symbol.iterator](),et;!(Re=(et=Be.next()).done);Re=!0){var lt=et.value;A.has(lt)&&(Me=!0)}}catch(Ie){De=!0,ze=Ie}finally{try{!Re&&Be.return&&Be.return()}finally{if(De)throw ze}}if(!Me){var ut=!1,Fe=void 0;Ce.forEach(function(Ie,Ze){Ie.has([].concat(o(be))[0])&&(ut=!0,Fe=Ze)}),ut?be.forEach(function(Ie){Ce[Fe].add(Ie)}):Ce.push(new Set(be))}}}),Ce.forEach(function(be,xe){var Me=Number.POSITIVE_INFINITY,Re=Number.POSITIVE_INFINITY,De=Number.NEGATIVE_INFINITY,ze=Number.NEGATIVE_INFINITY,Be=!0,et=!1,lt=void 0;try{for(var ut=be[Symbol.iterator](),Fe;!(Be=(Fe=ut.next()).done);Be=!0){var Ie=Fe.value,Ze=void 0;S=="horizontal"?Ze=g.has(Ie)?m[g.get(Ie)]:_.get(Ie):Ze=g.has(Ie)?p[g.get(Ie)]:_.get(Ie);var ft=he.get(Ie);Ze<Me&&(Me=Ze),Ze>De&&(De=Ze),ft<Re&&(Re=ft),ft>ze&&(ze=ft)}}catch(vr){et=!0,lt=vr}finally{try{!Be&&ut.return&&ut.return()}finally{if(et)throw lt}}var ht=(Me+De)/2-(Re+ze)/2,bt=!0,fr=!1,cr=void 0;try{for(var er=be[Symbol.iterator](),Jr;!(bt=(Jr=er.next()).done);bt=!0){var dr=Jr.value;he.set(dr,he.get(dr)+ht)}}catch(vr){fr=!0,cr=vr}finally{try{!bt&&er.return&&er.return()}finally{if(fr)throw cr}}})}return he},N=function(P){var S=0,A=0,_=0,Y=0;if(P.forEach(function(ge){ge.left?m[g.get(ge.left)]-m[g.get(ge.right)]>=0?S++:A++:p[g.get(ge.top)]-p[g.get(ge.bottom)]>=0?_++:Y++}),S>A&&_>Y)for(var ne=0;ne<g.size;ne++)m[ne]=-1*m[ne],p[ne]=-1*p[ne];else if(S>A)for(var pe=0;pe<g.size;pe++)m[pe]=-1*m[pe];else if(_>Y)for(var he=0;he<g.size;he++)p[he]=-1*p[he]},E=function(P){var S=[],A=new l,_=new Set,Y=0;return P.forEach(function(ne,pe){if(!_.has(pe)){S[Y]=[];var he=pe;for(A.push(he),_.add(he),S[Y].push(he);A.length!=0;){he=A.shift();var ge=P.get(he);ge.forEach(function(we){_.has(we.id)||(A.push(we.id),_.add(we.id),S[Y].push(we.id))})}Y++}}),S},C=function(P){var S=new Map;return P.forEach(function(A,_){S.set(_,[])}),P.forEach(function(A,_){A.forEach(function(Y){S.get(_).push(Y),S.get(Y.id).push({id:_,gap:Y.gap,direction:Y.direction})})}),S},b=function(P){var S=new Map;return P.forEach(function(A,_){S.set(_,[])}),P.forEach(function(A,_){A.forEach(function(Y){S.get(Y.id).push({id:_,gap:Y.gap,direction:Y.direction})})}),S},M=[],D=[],H=!1,k=!1,B=new Set,U=new Map,W=new Map,J=[];if(c.fixedNodeConstraint&&c.fixedNodeConstraint.forEach(function(Z){B.add(Z.nodeId)}),c.relativePlacementConstraint&&(c.relativePlacementConstraint.forEach(function(Z){Z.left?(U.has(Z.left)?U.get(Z.left).push({id:Z.right,gap:Z.gap,direction:"horizontal"}):U.set(Z.left,[{id:Z.right,gap:Z.gap,direction:"horizontal"}]),U.has(Z.right)||U.set(Z.right,[])):(U.has(Z.top)?U.get(Z.top).push({id:Z.bottom,gap:Z.gap,direction:"vertical"}):U.set(Z.top,[{id:Z.bottom,gap:Z.gap,direction:"vertical"}]),U.has(Z.bottom)||U.set(Z.bottom,[]))}),W=C(U),J=E(W)),s.TRANSFORM_ON_CONSTRAINT_HANDLING){if(c.fixedNodeConstraint&&c.fixedNodeConstraint.length>1)c.fixedNodeConstraint.forEach(function(Z,P){M[P]=[Z.position.x,Z.position.y],D[P]=[m[g.get(Z.nodeId)],p[g.get(Z.nodeId)]]}),H=!0;else if(c.alignmentConstraint)(function(){var Z=0;if(c.alignmentConstraint.vertical){for(var P=c.alignmentConstraint.vertical,S=function(he){var ge=new Set;P[he].forEach(function(Pe){ge.add(Pe)});var we=new Set([].concat(o(ge)).filter(function(Pe){return B.has(Pe)})),Ee=void 0;we.size>0?Ee=m[g.get(we.values().next().value)]:Ee=R(ge).x,P[he].forEach(function(Pe){M[Z]=[Ee,p[g.get(Pe)]],D[Z]=[m[g.get(Pe)],p[g.get(Pe)]],Z++})},A=0;A<P.length;A++)S(A);H=!0}if(c.alignmentConstraint.horizontal){for(var _=c.alignmentConstraint.horizontal,Y=function(he){var ge=new Set;_[he].forEach(function(Pe){ge.add(Pe)});var we=new Set([].concat(o(ge)).filter(function(Pe){return B.has(Pe)})),Ee=void 0;we.size>0?Ee=m[g.get(we.values().next().value)]:Ee=R(ge).y,_[he].forEach(function(Pe){M[Z]=[m[g.get(Pe)],Ee],D[Z]=[m[g.get(Pe)],p[g.get(Pe)]],Z++})},ne=0;ne<_.length;ne++)Y(ne);H=!0}c.relativePlacementConstraint&&(k=!0)})();else if(c.relativePlacementConstraint){for(var G=0,X=0,ie=0;ie<J.length;ie++)J[ie].length>G&&(G=J[ie].length,X=ie);if(G<W.size/2)N(c.relativePlacementConstraint),H=!1,k=!1;else{var ee=new Map,q=new Map,$=[];J[X].forEach(function(Z){U.get(Z).forEach(function(P){P.direction=="horizontal"?(ee.has(Z)?ee.get(Z).push(P):ee.set(Z,[P]),ee.has(P.id)||ee.set(P.id,[]),$.push({left:Z,right:P.id})):(q.has(Z)?q.get(Z).push(P):q.set(Z,[P]),q.has(P.id)||q.set(P.id,[]),$.push({top:Z,bottom:P.id}))})}),N($),k=!1;var V=L(ee,"horizontal"),re=L(q,"vertical");J[X].forEach(function(Z,P){D[P]=[m[g.get(Z)],p[g.get(Z)]],M[P]=[],V.has(Z)?M[P][0]=V.get(Z):M[P][0]=m[g.get(Z)],re.has(Z)?M[P][1]=re.get(Z):M[P][1]=p[g.get(Z)]}),H=!0}}if(H){for(var ae=void 0,de=u.transpose(M),ye=u.transpose(D),Te=0;Te<de.length;Te++)de[Te]=u.multGamma(de[Te]),ye[Te]=u.multGamma(ye[Te]);var Oe=u.multMat(de,u.transpose(ye)),ce=h.svd(Oe);ae=u.multMat(ce.V,u.transpose(ce.U));for(var x=0;x<g.size;x++){var z=[m[x],p[x]],j=[ae[0][0],ae[1][0]],te=[ae[0][1],ae[1][1]];m[x]=u.dotProduct(z,j),p[x]=u.dotProduct(z,te)}k&&N(c.relativePlacementConstraint)}}if(s.ENFORCE_CONSTRAINTS){if(c.fixedNodeConstraint&&c.fixedNodeConstraint.length>0){var K={x:0,y:0};c.fixedNodeConstraint.forEach(function(Z,P){var S={x:m[g.get(Z.nodeId)],y:p[g.get(Z.nodeId)]},A=Z.position,_=I(A,S);K.x+=_.x,K.y+=_.y}),K.x/=c.fixedNodeConstraint.length,K.y/=c.fixedNodeConstraint.length,m.forEach(function(Z,P){m[P]+=K.x}),p.forEach(function(Z,P){p[P]+=K.y}),c.fixedNodeConstraint.forEach(function(Z){m[g.get(Z.nodeId)]=Z.position.x,p[g.get(Z.nodeId)]=Z.position.y})}if(c.alignmentConstraint){if(c.alignmentConstraint.vertical)for(var le=c.alignmentConstraint.vertical,fe=function(P){var S=new Set;le[P].forEach(function(Y){S.add(Y)});var A=new Set([].concat(o(S)).filter(function(Y){return B.has(Y)})),_=void 0;A.size>0?_=m[g.get(A.values().next().value)]:_=R(S).x,S.forEach(function(Y){B.has(Y)||(m[g.get(Y)]=_)})},me=0;me<le.length;me++)fe(me);if(c.alignmentConstraint.horizontal)for(var se=c.alignmentConstraint.horizontal,F=function(P){var S=new Set;se[P].forEach(function(Y){S.add(Y)});var A=new Set([].concat(o(S)).filter(function(Y){return B.has(Y)})),_=void 0;A.size>0?_=p[g.get(A.values().next().value)]:_=R(S).y,S.forEach(function(Y){B.has(Y)||(p[g.get(Y)]=_)})},Q=0;Q<se.length;Q++)F(Q)}c.relativePlacementConstraint&&function(){var Z=new Map,P=new Map,S=new Map,A=new Map,_=new Map,Y=new Map,ne=new Set,pe=new Set;if(B.forEach(function(it){ne.add(it),pe.add(it)}),c.alignmentConstraint){if(c.alignmentConstraint.vertical)for(var he=c.alignmentConstraint.vertical,ge=function(Ae){S.set("dummy"+Ae,[]),he[Ae].forEach(function(We){Z.set(We,"dummy"+Ae),S.get("dummy"+Ae).push(We),B.has(We)&&ne.add("dummy"+Ae)}),_.set("dummy"+Ae,m[g.get(he[Ae][0])])},we=0;we<he.length;we++)ge(we);if(c.alignmentConstraint.horizontal)for(var Ee=c.alignmentConstraint.horizontal,Pe=function(Ae){A.set("dummy"+Ae,[]),Ee[Ae].forEach(function(We){P.set(We,"dummy"+Ae),A.get("dummy"+Ae).push(We),B.has(We)&&pe.add("dummy"+Ae)}),Y.set("dummy"+Ae,p[g.get(Ee[Ae][0])])},Ce=0;Ce<Ee.length;Ce++)Pe(Ce)}var be=new Map,xe=new Map,Me=function(Ae){U.get(Ae).forEach(function(We){var pr=void 0,kt=void 0;We.direction=="horizontal"?(pr=Z.get(Ae)?Z.get(Ae):Ae,Z.get(We.id)?kt={id:Z.get(We.id),gap:We.gap,direction:We.direction}:kt=We,be.has(pr)?be.get(pr).push(kt):be.set(pr,[kt]),be.has(kt.id)||be.set(kt.id,[])):(pr=P.get(Ae)?P.get(Ae):Ae,P.get(We.id)?kt={id:P.get(We.id),gap:We.gap,direction:We.direction}:kt=We,xe.has(pr)?xe.get(pr).push(kt):xe.set(pr,[kt]),xe.has(kt.id)||xe.set(kt.id,[]))})},Re=!0,De=!1,ze=void 0;try{for(var Be=U.keys()[Symbol.iterator](),et;!(Re=(et=Be.next()).done);Re=!0){var lt=et.value;Me(lt)}}catch(it){De=!0,ze=it}finally{try{!Re&&Be.return&&Be.return()}finally{if(De)throw ze}}var ut=C(be),Fe=C(xe),Ie=E(ut),Ze=E(Fe),ft=b(be),ht=b(xe),bt=[],fr=[];Ie.forEach(function(it,Ae){bt[Ae]=[],it.forEach(function(We){ft.get(We).length==0&&bt[Ae].push(We)})}),Ze.forEach(function(it,Ae){fr[Ae]=[],it.forEach(function(We){ht.get(We).length==0&&fr[Ae].push(We)})});var cr=L(be,"horizontal",ne,_,bt),er=L(xe,"vertical",pe,Y,fr),Jr=function(Ae){S.get(Ae)?S.get(Ae).forEach(function(We){m[g.get(We)]=cr.get(Ae)}):m[g.get(Ae)]=cr.get(Ae)},dr=!0,vr=!1,pn=void 0;try{for(var tr=cr.keys()[Symbol.iterator](),$r;!(dr=($r=tr.next()).done);dr=!0){var gr=$r.value;Jr(gr)}}catch(it){vr=!0,pn=it}finally{try{!dr&&tr.return&&tr.return()}finally{if(vr)throw pn}}var mn=function(Ae){A.get(Ae)?A.get(Ae).forEach(function(We){p[g.get(We)]=er.get(Ae)}):p[g.get(Ae)]=er.get(Ae)},ei=!0,yn=!1,Ot=void 0;try{for(var Fr=er.keys()[Symbol.iterator](),Oi;!(ei=(Oi=Fr.next()).done);ei=!0){var gr=Oi.value;mn(gr)}}catch(it){yn=!0,Ot=it}finally{try{!ei&&Fr.return&&Fr.return()}finally{if(yn)throw Ot}}}()}for(var ue=0;ue<y.length;ue++){var oe=y[ue];oe.getChild()==null&&oe.setCenter(m[g.get(oe.id)],p[g.get(oe.id)])}},i.exports=f},function(i,n,a){var o=a(0).FDLayout,s=a(4),l=a(3),u=a(5),h=a(2),f=a(1),d=a(6),c=a(0).FDLayoutConstants,v=a(0).LayoutConstants,g=a(0).Point,m=a(0).PointD,p=a(0).DimensionD,y=a(0).Layout,w=a(0).Integer,T=a(0).IGeometry,O=a(0).LGraph,I=a(0).Transform,R=a(0).LinkedList;function L(){o.call(this),this.toBeTiled={},this.constraints={}}L.prototype=Object.create(o.prototype);for(var N in o)L[N]=o[N];L.prototype.newGraphManager=function(){var E=new s(this);return this.graphManager=E,E},L.prototype.newGraph=function(E){return new l(null,this.graphManager,E)},L.prototype.newNode=function(E){return new u(this.graphManager,E)},L.prototype.newEdge=function(E){return new h(null,null,E)},L.prototype.initParameters=function(){o.prototype.initParameters.call(this,arguments),this.isSubLayout||(f.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=f.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=f.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=c.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=c.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=c.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=c.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1)},L.prototype.initSpringEmbedder=function(){o.prototype.initSpringEmbedder.call(this),this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/c.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=.04,this.coolingAdjuster=1},L.prototype.layout=function(){var E=v.DEFAULT_CREATE_BENDS_AS_NEEDED;return E&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},L.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(f.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var C=new Set(this.getAllNodes()),b=this.nodesWithGravity.filter(function(H){return C.has(H)});this.graphManager.setAllNodesToApplyGravitation(b)}}else{var E=this.getFlatForest();if(E.length>0)this.positionNodesRadially(E);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var C=new Set(this.getAllNodes()),b=this.nodesWithGravity.filter(function(M){return C.has(M)});this.graphManager.setAllNodesToApplyGravitation(b),this.positionNodesRandomly()}}return Object.keys(this.constraints).length>0&&(d.handleConstraints(this),this.initConstraintVariables()),this.initSpringEmbedder(),f.APPLY_LAYOUT&&this.runSpringEmbedder(),!0},L.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%c.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var E=new Set(this.getAllNodes()),C=this.nodesWithGravity.filter(function(D){return E.has(D)});this.graphManager.setAllNodesToApplyGravitation(C),this.graphManager.updateBounds(),this.updateGrid(),f.PURE_INCREMENTAL?this.coolingFactor=c.DEFAULT_COOLING_FACTOR_INCREMENTAL/2:this.coolingFactor=c.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),f.PURE_INCREMENTAL?this.coolingFactor=c.DEFAULT_COOLING_FACTOR_INCREMENTAL/2*((100-this.afterGrowthIterations)/100):this.coolingFactor=c.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var b=!this.isTreeGrowing&&!this.isGrowthFinished,M=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(b,M),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},L.prototype.getPositionsData=function(){for(var E=this.graphManager.getAllNodes(),C={},b=0;b<E.length;b++){var M=E[b].rect,D=E[b].id;C[D]={id:D,x:M.getCenterX(),y:M.getCenterY(),w:M.width,h:M.height}}return C},L.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var E=!1;if(c.ANIMATE==="during")this.emit("layoutstarted");else{for(;!E;)E=this.tick();this.graphManager.updateBounds()}},L.prototype.moveNodes=function(){for(var E=this.getAllNodes(),C,b=0;b<E.length;b++)C=E[b],C.calculateDisplacement();Object.keys(this.constraints).length>0&&this.updateDisplacements();for(var b=0;b<E.length;b++)C=E[b],C.move()},L.prototype.initConstraintVariables=function(){var E=this;this.idToNodeMap=new Map,this.fixedNodeSet=new Set;for(var C=this.graphManager.getAllNodes(),b=0;b<C.length;b++){var M=C[b];this.idToNodeMap.set(M.id,M)}var D=function q($){for(var V=$.getChild().getNodes(),re,ae=0,de=0;de<V.length;de++)re=V[de],re.getChild()==null?E.fixedNodeSet.has(re.id)&&(ae+=100):ae+=q(re);return ae};if(this.constraints.fixedNodeConstraint){this.constraints.fixedNodeConstraint.forEach(function(V){E.fixedNodeSet.add(V.nodeId)});for(var C=this.graphManager.getAllNodes(),M,b=0;b<C.length;b++)if(M=C[b],M.getChild()!=null){var H=D(M);H>0&&(M.fixedNodeWeight=H)}}if(this.constraints.relativePlacementConstraint){var k=new Map,B=new Map;if(this.dummyToNodeForVerticalAlignment=new Map,this.dummyToNodeForHorizontalAlignment=new Map,this.fixedNodesOnHorizontal=new Set,this.fixedNodesOnVertical=new Set,this.fixedNodeSet.forEach(function(q){E.fixedNodesOnHorizontal.add(q),E.fixedNodesOnVertical.add(q)}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var U=this.constraints.alignmentConstraint.vertical,b=0;b<U.length;b++)this.dummyToNodeForVerticalAlignment.set("dummy"+b,[]),U[b].forEach(function($){k.set($,"dummy"+b),E.dummyToNodeForVerticalAlignment.get("dummy"+b).push($),E.fixedNodeSet.has($)&&E.fixedNodesOnHorizontal.add("dummy"+b)});if(this.constraints.alignmentConstraint.horizontal)for(var W=this.constraints.alignmentConstraint.horizontal,b=0;b<W.length;b++)this.dummyToNodeForHorizontalAlignment.set("dummy"+b,[]),W[b].forEach(function($){B.set($,"dummy"+b),E.dummyToNodeForHorizontalAlignment.get("dummy"+b).push($),E.fixedNodeSet.has($)&&E.fixedNodesOnVertical.add("dummy"+b)})}if(f.RELAX_MOVEMENT_ON_CONSTRAINTS)this.shuffle=function(q){var $,V,re;for(re=q.length-1;re>=2*q.length/3;re--)$=Math.floor(Math.random()*(re+1)),V=q[re],q[re]=q[$],q[$]=V;return q},this.nodesInRelativeHorizontal=[],this.nodesInRelativeVertical=[],this.nodeToRelativeConstraintMapHorizontal=new Map,this.nodeToRelativeConstraintMapVertical=new Map,this.nodeToTempPositionMapHorizontal=new Map,this.nodeToTempPositionMapVertical=new Map,this.constraints.relativePlacementConstraint.forEach(function(q){if(q.left){var $=k.has(q.left)?k.get(q.left):q.left,V=k.has(q.right)?k.get(q.right):q.right;E.nodesInRelativeHorizontal.includes($)||(E.nodesInRelativeHorizontal.push($),E.nodeToRelativeConstraintMapHorizontal.set($,[]),E.dummyToNodeForVerticalAlignment.has($)?E.nodeToTempPositionMapHorizontal.set($,E.idToNodeMap.get(E.dummyToNodeForVerticalAlignment.get($)[0]).getCenterX()):E.nodeToTempPositionMapHorizontal.set($,E.idToNodeMap.get($).getCenterX())),E.nodesInRelativeHorizontal.includes(V)||(E.nodesInRelativeHorizontal.push(V),E.nodeToRelativeConstraintMapHorizontal.set(V,[]),E.dummyToNodeForVerticalAlignment.has(V)?E.nodeToTempPositionMapHorizontal.set(V,E.idToNodeMap.get(E.dummyToNodeForVerticalAlignment.get(V)[0]).getCenterX()):E.nodeToTempPositionMapHorizontal.set(V,E.idToNodeMap.get(V).getCenterX())),E.nodeToRelativeConstraintMapHorizontal.get($).push({right:V,gap:q.gap}),E.nodeToRelativeConstraintMapHorizontal.get(V).push({left:$,gap:q.gap})}else{var re=B.has(q.top)?B.get(q.top):q.top,ae=B.has(q.bottom)?B.get(q.bottom):q.bottom;E.nodesInRelativeVertical.includes(re)||(E.nodesInRelativeVertical.push(re),E.nodeToRelativeConstraintMapVertical.set(re,[]),E.dummyToNodeForHorizontalAlignment.has(re)?E.nodeToTempPositionMapVertical.set(re,E.idToNodeMap.get(E.dummyToNodeForHorizontalAlignment.get(re)[0]).getCenterY()):E.nodeToTempPositionMapVertical.set(re,E.idToNodeMap.get(re).getCenterY())),E.nodesInRelativeVertical.includes(ae)||(E.nodesInRelativeVertical.push(ae),E.nodeToRelativeConstraintMapVertical.set(ae,[]),E.dummyToNodeForHorizontalAlignment.has(ae)?E.nodeToTempPositionMapVertical.set(ae,E.idToNodeMap.get(E.dummyToNodeForHorizontalAlignment.get(ae)[0]).getCenterY()):E.nodeToTempPositionMapVertical.set(ae,E.idToNodeMap.get(ae).getCenterY())),E.nodeToRelativeConstraintMapVertical.get(re).push({bottom:ae,gap:q.gap}),E.nodeToRelativeConstraintMapVertical.get(ae).push({top:re,gap:q.gap})}});else{var J=new Map,G=new Map;this.constraints.relativePlacementConstraint.forEach(function(q){if(q.left){var $=k.has(q.left)?k.get(q.left):q.left,V=k.has(q.right)?k.get(q.right):q.right;J.has($)?J.get($).push(V):J.set($,[V]),J.has(V)?J.get(V).push($):J.set(V,[$])}else{var re=B.has(q.top)?B.get(q.top):q.top,ae=B.has(q.bottom)?B.get(q.bottom):q.bottom;G.has(re)?G.get(re).push(ae):G.set(re,[ae]),G.has(ae)?G.get(ae).push(re):G.set(ae,[re])}});var X=function($,V){var re=[],ae=[],de=new R,ye=new Set,Te=0;return $.forEach(function(Oe,ce){if(!ye.has(ce)){re[Te]=[],ae[Te]=!1;var x=ce;for(de.push(x),ye.add(x),re[Te].push(x);de.length!=0;){x=de.shift(),V.has(x)&&(ae[Te]=!0);var z=$.get(x);z.forEach(function(j){ye.has(j)||(de.push(j),ye.add(j),re[Te].push(j))})}Te++}}),{components:re,isFixed:ae}},ie=X(J,E.fixedNodesOnHorizontal);this.componentsOnHorizontal=ie.components,this.fixedComponentsOnHorizontal=ie.isFixed;var ee=X(G,E.fixedNodesOnVertical);this.componentsOnVertical=ee.components,this.fixedComponentsOnVertical=ee.isFixed}}},L.prototype.updateDisplacements=function(){var E=this;if(this.constraints.fixedNodeConstraint&&this.constraints.fixedNodeConstraint.forEach(function(ee){var q=E.idToNodeMap.get(ee.nodeId);q.displacementX=0,q.displacementY=0}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var C=this.constraints.alignmentConstraint.vertical,b=0;b<C.length;b++){for(var M=0,D=0;D<C[b].length;D++){if(this.fixedNodeSet.has(C[b][D])){M=0;break}M+=this.idToNodeMap.get(C[b][D]).displacementX}for(var H=M/C[b].length,D=0;D<C[b].length;D++)this.idToNodeMap.get(C[b][D]).displacementX=H}if(this.constraints.alignmentConstraint.horizontal)for(var k=this.constraints.alignmentConstraint.horizontal,b=0;b<k.length;b++){for(var B=0,D=0;D<k[b].length;D++){if(this.fixedNodeSet.has(k[b][D])){B=0;break}B+=this.idToNodeMap.get(k[b][D]).displacementY}for(var U=B/k[b].length,D=0;D<k[b].length;D++)this.idToNodeMap.get(k[b][D]).displacementY=U}}if(this.constraints.relativePlacementConstraint)if(f.RELAX_MOVEMENT_ON_CONSTRAINTS)this.totalIterations%10==0&&(this.shuffle(this.nodesInRelativeHorizontal),this.shuffle(this.nodesInRelativeVertical)),this.nodesInRelativeHorizontal.forEach(function(ee){if(!E.fixedNodesOnHorizontal.has(ee)){var q=0;E.dummyToNodeForVerticalAlignment.has(ee)?q=E.idToNodeMap.get(E.dummyToNodeForVerticalAlignment.get(ee)[0]).displacementX:q=E.idToNodeMap.get(ee).displacementX,E.nodeToRelativeConstraintMapHorizontal.get(ee).forEach(function($){if($.right){var V=E.nodeToTempPositionMapHorizontal.get($.right)-E.nodeToTempPositionMapHorizontal.get(ee)-q;V<$.gap&&(q-=$.gap-V)}else{var V=E.nodeToTempPositionMapHorizontal.get(ee)-E.nodeToTempPositionMapHorizontal.get($.left)+q;V<$.gap&&(q+=$.gap-V)}}),E.nodeToTempPositionMapHorizontal.set(ee,E.nodeToTempPositionMapHorizontal.get(ee)+q),E.dummyToNodeForVerticalAlignment.has(ee)?E.dummyToNodeForVerticalAlignment.get(ee).forEach(function($){E.idToNodeMap.get($).displacementX=q}):E.idToNodeMap.get(ee).displacementX=q}}),this.nodesInRelativeVertical.forEach(function(ee){if(!E.fixedNodesOnHorizontal.has(ee)){var q=0;E.dummyToNodeForHorizontalAlignment.has(ee)?q=E.idToNodeMap.get(E.dummyToNodeForHorizontalAlignment.get(ee)[0]).displacementY:q=E.idToNodeMap.get(ee).displacementY,E.nodeToRelativeConstraintMapVertical.get(ee).forEach(function($){if($.bottom){var V=E.nodeToTempPositionMapVertical.get($.bottom)-E.nodeToTempPositionMapVertical.get(ee)-q;V<$.gap&&(q-=$.gap-V)}else{var V=E.nodeToTempPositionMapVertical.get(ee)-E.nodeToTempPositionMapVertical.get($.top)+q;V<$.gap&&(q+=$.gap-V)}}),E.nodeToTempPositionMapVertical.set(ee,E.nodeToTempPositionMapVertical.get(ee)+q),E.dummyToNodeForHorizontalAlignment.has(ee)?E.dummyToNodeForHorizontalAlignment.get(ee).forEach(function($){E.idToNodeMap.get($).displacementY=q}):E.idToNodeMap.get(ee).displacementY=q}});else{for(var b=0;b<this.componentsOnHorizontal.length;b++){var W=this.componentsOnHorizontal[b];if(this.fixedComponentsOnHorizontal[b])for(var D=0;D<W.length;D++)this.dummyToNodeForVerticalAlignment.has(W[D])?this.dummyToNodeForVerticalAlignment.get(W[D]).forEach(function($){E.idToNodeMap.get($).displacementX=0}):this.idToNodeMap.get(W[D]).displacementX=0;else{for(var J=0,G=0,D=0;D<W.length;D++)if(this.dummyToNodeForVerticalAlignment.has(W[D])){var X=this.dummyToNodeForVerticalAlignment.get(W[D]);J+=X.length*this.idToNodeMap.get(X[0]).displacementX,G+=X.length}else J+=this.idToNodeMap.get(W[D]).displacementX,G++;for(var ie=J/G,D=0;D<W.length;D++)this.dummyToNodeForVerticalAlignment.has(W[D])?this.dummyToNodeForVerticalAlignment.get(W[D]).forEach(function($){E.idToNodeMap.get($).displacementX=ie}):this.idToNodeMap.get(W[D]).displacementX=ie}}for(var b=0;b<this.componentsOnVertical.length;b++){var W=this.componentsOnVertical[b];if(this.fixedComponentsOnVertical[b])for(var D=0;D<W.length;D++)this.dummyToNodeForHorizontalAlignment.has(W[D])?this.dummyToNodeForHorizontalAlignment.get(W[D]).forEach(function(V){E.idToNodeMap.get(V).displacementY=0}):this.idToNodeMap.get(W[D]).displacementY=0;else{for(var J=0,G=0,D=0;D<W.length;D++)if(this.dummyToNodeForHorizontalAlignment.has(W[D])){var X=this.dummyToNodeForHorizontalAlignment.get(W[D]);J+=X.length*this.idToNodeMap.get(X[0]).displacementY,G+=X.length}else J+=this.idToNodeMap.get(W[D]).displacementY,G++;for(var ie=J/G,D=0;D<W.length;D++)this.dummyToNodeForHorizontalAlignment.has(W[D])?this.dummyToNodeForHorizontalAlignment.get(W[D]).forEach(function(de){E.idToNodeMap.get(de).displacementY=ie}):this.idToNodeMap.get(W[D]).displacementY=ie}}}},L.prototype.calculateNodesToApplyGravitationTo=function(){var E=[],C,b=this.graphManager.getGraphs(),M=b.length,D;for(D=0;D<M;D++)C=b[D],C.updateConnected(),C.isConnected||(E=E.concat(C.getNodes()));return E},L.prototype.createBendpoints=function(){var E=[];E=E.concat(this.graphManager.getAllEdges());var C=new Set,b;for(b=0;b<E.length;b++){var M=E[b];if(!C.has(M)){var D=M.getSource(),H=M.getTarget();if(D==H)M.getBendpoints().push(new m),M.getBendpoints().push(new m),this.createDummyNodesForBendpoints(M),C.add(M);else{var k=[];if(k=k.concat(D.getEdgeListToNode(H)),k=k.concat(H.getEdgeListToNode(D)),!C.has(k[0])){if(k.length>1){var B;for(B=0;B<k.length;B++){var U=k[B];U.getBendpoints().push(new m),this.createDummyNodesForBendpoints(U)}}k.forEach(function(W){C.add(W)})}}}if(C.size==E.length)break}},L.prototype.positionNodesRadially=function(E){for(var C=new g(0,0),b=Math.ceil(Math.sqrt(E.length)),M=0,D=0,H=0,k=new m(0,0),B=0;B<E.length;B++){B%b==0&&(H=0,D=M,B!=0&&(D+=f.DEFAULT_COMPONENT_SEPERATION),M=0);var U=E[B],W=y.findCenterOfTree(U);C.x=H,C.y=D,k=L.radialLayout(U,W,C),k.y>M&&(M=Math.floor(k.y)),H=Math.floor(k.x+f.DEFAULT_COMPONENT_SEPERATION)}this.transform(new m(v.WORLD_CENTER_X-k.x/2,v.WORLD_CENTER_Y-k.y/2))},L.radialLayout=function(E,C,b){var M=Math.max(this.maxDiagonalInTree(E),f.DEFAULT_RADIAL_SEPARATION);L.branchRadialLayout(C,null,0,359,0,M);var D=O.calculateBounds(E),H=new I;H.setDeviceOrgX(D.getMinX()),H.setDeviceOrgY(D.getMinY()),H.setWorldOrgX(b.x),H.setWorldOrgY(b.y);for(var k=0;k<E.length;k++){var B=E[k];B.transform(H)}var U=new m(D.getMaxX(),D.getMaxY());return H.inverseTransformPoint(U)},L.branchRadialLayout=function(E,C,b,M,D,H){var k=(M-b+1)/2;k<0&&(k+=180);var B=(k+b)%360,U=B*T.TWO_PI/360,W=D*Math.cos(U),J=D*Math.sin(U);E.setCenter(W,J);var G=[];G=G.concat(E.getEdges());var X=G.length;C!=null&&X--;for(var ie=0,ee=G.length,q,$=E.getEdgesBetween(C);$.length>1;){var V=$[0];$.splice(0,1);var re=G.indexOf(V);re>=0&&G.splice(re,1),ee--,X--}C!=null?q=(G.indexOf($[0])+1)%ee:q=0;for(var ae=Math.abs(M-b)/X,de=q;ie!=X;de=++de%ee){var ye=G[de].getOtherEnd(E);if(ye!=C){var Te=(b+ie*ae)%360,Oe=(Te+ae)%360;L.branchRadialLayout(ye,E,Te,Oe,D+H,H),ie++}}},L.maxDiagonalInTree=function(E){for(var C=w.MIN_VALUE,b=0;b<E.length;b++){var M=E[b],D=M.getDiagonal();D>C&&(C=D)}return C},L.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},L.prototype.groupZeroDegreeMembers=function(){var E=this,C={};this.memberGroups={},this.idToDummyNode={};for(var b=[],M=this.graphManager.getAllNodes(),D=0;D<M.length;D++){var H=M[D],k=H.getParent();this.getNodeDegreeWithChildren(H)===0&&(k.id==null||!this.getToBeTiled(k))&&b.push(H)}for(var D=0;D<b.length;D++){var H=b[D],B=H.getParent().id;typeof C[B]>"u"&&(C[B]=[]),C[B]=C[B].concat(H)}Object.keys(C).forEach(function(U){if(C[U].length>1){var W="DummyCompound_"+U;E.memberGroups[W]=C[U];var J=C[U][0].getParent(),G=new u(E.graphManager);G.id=W,G.paddingLeft=J.paddingLeft||0,G.paddingRight=J.paddingRight||0,G.paddingBottom=J.paddingBottom||0,G.paddingTop=J.paddingTop||0,E.idToDummyNode[W]=G;var X=E.getGraphManager().add(E.newGraph(),G),ie=J.getChild();ie.add(G);for(var ee=0;ee<C[U].length;ee++){var q=C[U][ee];ie.remove(q),X.add(q)}}})},L.prototype.clearCompounds=function(){var E={},C={};this.performDFSOnCompounds();for(var b=0;b<this.compoundOrder.length;b++)C[this.compoundOrder[b].id]=this.compoundOrder[b],E[this.compoundOrder[b].id]=[].concat(this.compoundOrder[b].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[b].getChild()),this.compoundOrder[b].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(E,C)},L.prototype.clearZeroDegreeMembers=function(){var E=this,C=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(b){var M=E.idToDummyNode[b];if(C[b]=E.tileNodes(E.memberGroups[b],M.paddingLeft+M.paddingRight),M.rect.width=C[b].width,M.rect.height=C[b].height,M.setCenter(C[b].centerX,C[b].centerY),M.labelMarginLeft=0,M.labelMarginTop=0,f.NODE_DIMENSIONS_INCLUDE_LABELS){var D=M.rect.width,H=M.rect.height;M.labelWidth&&(M.labelPosHorizontal=="left"?(M.rect.x-=M.labelWidth,M.setWidth(D+M.labelWidth),M.labelMarginLeft=M.labelWidth):M.labelPosHorizontal=="center"&&M.labelWidth>D?(M.rect.x-=(M.labelWidth-D)/2,M.setWidth(M.labelWidth),M.labelMarginLeft=(M.labelWidth-D)/2):M.labelPosHorizontal=="right"&&M.setWidth(D+M.labelWidth)),M.labelHeight&&(M.labelPosVertical=="top"?(M.rect.y-=M.labelHeight,M.setHeight(H+M.labelHeight),M.labelMarginTop=M.labelHeight):M.labelPosVertical=="center"&&M.labelHeight>H?(M.rect.y-=(M.labelHeight-H)/2,M.setHeight(M.labelHeight),M.labelMarginTop=(M.labelHeight-H)/2):M.labelPosVertical=="bottom"&&M.setHeight(H+M.labelHeight))}})},L.prototype.repopulateCompounds=function(){for(var E=this.compoundOrder.length-1;E>=0;E--){var C=this.compoundOrder[E],b=C.id,M=C.paddingLeft,D=C.paddingTop,H=C.labelMarginLeft,k=C.labelMarginTop;this.adjustLocations(this.tiledMemberPack[b],C.rect.x,C.rect.y,M,D,H,k)}},L.prototype.repopulateZeroDegreeMembers=function(){var E=this,C=this.tiledZeroDegreePack;Object.keys(C).forEach(function(b){var M=E.idToDummyNode[b],D=M.paddingLeft,H=M.paddingTop,k=M.labelMarginLeft,B=M.labelMarginTop;E.adjustLocations(C[b],M.rect.x,M.rect.y,D,H,k,B)})},L.prototype.getToBeTiled=function(E){var C=E.id;if(this.toBeTiled[C]!=null)return this.toBeTiled[C];var b=E.getChild();if(b==null)return this.toBeTiled[C]=!1,!1;for(var M=b.getNodes(),D=0;D<M.length;D++){var H=M[D];if(this.getNodeDegree(H)>0)return this.toBeTiled[C]=!1,!1;if(H.getChild()==null){this.toBeTiled[H.id]=!1;continue}if(!this.getToBeTiled(H))return this.toBeTiled[C]=!1,!1}return this.toBeTiled[C]=!0,!0},L.prototype.getNodeDegree=function(E){E.id;for(var C=E.getEdges(),b=0,M=0;M<C.length;M++){var D=C[M];D.getSource().id!==D.getTarget().id&&(b=b+1)}return b},L.prototype.getNodeDegreeWithChildren=function(E){var C=this.getNodeDegree(E);if(E.getChild()==null)return C;for(var b=E.getChild().getNodes(),M=0;M<b.length;M++){var D=b[M];C+=this.getNodeDegreeWithChildren(D)}return C},L.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},L.prototype.fillCompexOrderByDFS=function(E){for(var C=0;C<E.length;C++){var b=E[C];b.getChild()!=null&&this.fillCompexOrderByDFS(b.getChild().getNodes()),this.getToBeTiled(b)&&this.compoundOrder.push(b)}},L.prototype.adjustLocations=function(E,C,b,M,D,H,k){C+=M+H,b+=D+k;for(var B=C,U=0;U<E.rows.length;U++){var W=E.rows[U];C=B;for(var J=0,G=0;G<W.length;G++){var X=W[G];X.rect.x=C,X.rect.y=b,C+=X.rect.width+E.horizontalPadding,X.rect.height>J&&(J=X.rect.height)}b+=J+E.verticalPadding}},L.prototype.tileCompoundMembers=function(E,C){var b=this;this.tiledMemberPack=[],Object.keys(E).forEach(function(M){var D=C[M];if(b.tiledMemberPack[M]=b.tileNodes(E[M],D.paddingLeft+D.paddingRight),D.rect.width=b.tiledMemberPack[M].width,D.rect.height=b.tiledMemberPack[M].height,D.setCenter(b.tiledMemberPack[M].centerX,b.tiledMemberPack[M].centerY),D.labelMarginLeft=0,D.labelMarginTop=0,f.NODE_DIMENSIONS_INCLUDE_LABELS){var H=D.rect.width,k=D.rect.height;D.labelWidth&&(D.labelPosHorizontal=="left"?(D.rect.x-=D.labelWidth,D.setWidth(H+D.labelWidth),D.labelMarginLeft=D.labelWidth):D.labelPosHorizontal=="center"&&D.labelWidth>H?(D.rect.x-=(D.labelWidth-H)/2,D.setWidth(D.labelWidth),D.labelMarginLeft=(D.labelWidth-H)/2):D.labelPosHorizontal=="right"&&D.setWidth(H+D.labelWidth)),D.labelHeight&&(D.labelPosVertical=="top"?(D.rect.y-=D.labelHeight,D.setHeight(k+D.labelHeight),D.labelMarginTop=D.labelHeight):D.labelPosVertical=="center"&&D.labelHeight>k?(D.rect.y-=(D.labelHeight-k)/2,D.setHeight(D.labelHeight),D.labelMarginTop=(D.labelHeight-k)/2):D.labelPosVertical=="bottom"&&D.setHeight(k+D.labelHeight))}})},L.prototype.tileNodes=function(E,C){var b=f.TILING_PADDING_VERTICAL,M=f.TILING_PADDING_HORIZONTAL,D={rows:[],rowWidth:[],rowHeight:[],width:0,height:C,verticalPadding:b,horizontalPadding:M,centerX:0,centerY:0};E.sort(function(W,J){return W.rect.width*W.rect.height>J.rect.width*J.rect.height?-1:W.rect.width*W.rect.height<J.rect.width*J.rect.height?1:0});for(var H=0,k=0,B=0;B<E.length;B++){var U=E[B];H+=U.getCenterX(),k+=U.getCenterY()}D.centerX=H/E.length,D.centerY=k/E.length;for(var B=0;B<E.length;B++){var U=E[B];D.rows.length==0?this.insertNodeToRow(D,U,0,C):this.canAddHorizontal(D,U.rect.width,U.rect.height)?this.insertNodeToRow(D,U,this.getShortestRowIndex(D),C):this.insertNodeToRow(D,U,D.rows.length,C),this.shiftToLastRow(D)}return D},L.prototype.insertNodeToRow=function(E,C,b,M){var D=M;if(b==E.rows.length){var H=[];E.rows.push(H),E.rowWidth.push(D),E.rowHeight.push(0)}var k=E.rowWidth[b]+C.rect.width;E.rows[b].length>0&&(k+=E.horizontalPadding),E.rowWidth[b]=k,E.width<k&&(E.width=k);var B=C.rect.height;b>0&&(B+=E.verticalPadding);var U=0;B>E.rowHeight[b]&&(U=E.rowHeight[b],E.rowHeight[b]=B,U=E.rowHeight[b]-U),E.height+=U,E.rows[b].push(C)},L.prototype.getShortestRowIndex=function(E){for(var C=-1,b=Number.MAX_VALUE,M=0;M<E.rows.length;M++)E.rowWidth[M]<b&&(C=M,b=E.rowWidth[M]);return C},L.prototype.getLongestRowIndex=function(E){for(var C=-1,b=Number.MIN_VALUE,M=0;M<E.rows.length;M++)E.rowWidth[M]>b&&(C=M,b=E.rowWidth[M]);return C},L.prototype.canAddHorizontal=function(E,C,b){var M=this.getShortestRowIndex(E);if(M<0)return!0;var D=E.rowWidth[M];if(D+E.horizontalPadding+C<=E.width)return!0;var H=0;E.rowHeight[M]<b&&M>0&&(H=b+E.verticalPadding-E.rowHeight[M]);var k;E.width-D>=C+E.horizontalPadding?k=(E.height+H)/(D+C+E.horizontalPadding):k=(E.height+H)/E.width,H=b+E.verticalPadding;var B;return E.width<C?B=(E.height+H)/C:B=(E.height+H)/E.width,B<1&&(B=1/B),k<1&&(k=1/k),k<B},L.prototype.shiftToLastRow=function(E){var C=this.getLongestRowIndex(E),b=E.rowWidth.length-1,M=E.rows[C],D=M[M.length-1],H=D.width+E.horizontalPadding;if(E.width-E.rowWidth[b]>H&&C!=b){M.splice(-1,1),E.rows[b].push(D),E.rowWidth[C]=E.rowWidth[C]-H,E.rowWidth[b]=E.rowWidth[b]+H,E.width=E.rowWidth[instance.getLongestRowIndex(E)];for(var k=Number.MIN_VALUE,B=0;B<M.length;B++)M[B].height>k&&(k=M[B].height);C>0&&(k+=E.verticalPadding);var U=E.rowHeight[C]+E.rowHeight[b];E.rowHeight[C]=k,E.rowHeight[b]<D.height+E.verticalPadding&&(E.rowHeight[b]=D.height+E.verticalPadding);var W=E.rowHeight[C]+E.rowHeight[b];E.height+=W-U,this.shiftToLastRow(E)}},L.prototype.tilingPreLayout=function(){f.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},L.prototype.tilingPostLayout=function(){f.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},L.prototype.reduceTrees=function(){for(var E=[],C=!0,b;C;){var M=this.graphManager.getAllNodes(),D=[];C=!1;for(var H=0;H<M.length;H++)if(b=M[H],b.getEdges().length==1&&!b.getEdges()[0].isInterGraph&&b.getChild()==null){if(f.PURE_INCREMENTAL){var k=b.getEdges()[0].getOtherEnd(b),B=new p(b.getCenterX()-k.getCenterX(),b.getCenterY()-k.getCenterY());D.push([b,b.getEdges()[0],b.getOwner(),B])}else D.push([b,b.getEdges()[0],b.getOwner()]);C=!0}if(C==!0){for(var U=[],W=0;W<D.length;W++)D[W][0].getEdges().length==1&&(U.push(D[W]),D[W][0].getOwner().remove(D[W][0]));E.push(U),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=E},L.prototype.growTree=function(E){for(var C=E.length,b=E[C-1],M,D=0;D<b.length;D++)M=b[D],this.findPlaceforPrunedNode(M),M[2].add(M[0]),M[2].add(M[1],M[1].source,M[1].target);E.splice(E.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},L.prototype.findPlaceforPrunedNode=function(E){var C,b,M=E[0];if(M==E[1].source?b=E[1].target:b=E[1].source,f.PURE_INCREMENTAL)M.setCenter(b.getCenterX()+E[3].getWidth(),b.getCenterY()+E[3].getHeight());else{var D=b.startX,H=b.finishX,k=b.startY,B=b.finishY,U=0,W=0,J=0,G=0,X=[U,J,W,G];if(k>0)for(var ie=D;ie<=H;ie++)X[0]+=this.grid[ie][k-1].length+this.grid[ie][k].length-1;if(H<this.grid.length-1)for(var ie=k;ie<=B;ie++)X[1]+=this.grid[H+1][ie].length+this.grid[H][ie].length-1;if(B<this.grid[0].length-1)for(var ie=D;ie<=H;ie++)X[2]+=this.grid[ie][B+1].length+this.grid[ie][B].length-1;if(D>0)for(var ie=k;ie<=B;ie++)X[3]+=this.grid[D-1][ie].length+this.grid[D][ie].length-1;for(var ee=w.MAX_VALUE,q,$,V=0;V<X.length;V++)X[V]<ee?(ee=X[V],q=1,$=V):X[V]==ee&&q++;if(q==3&&ee==0)X[0]==0&&X[1]==0&&X[2]==0?C=1:X[0]==0&&X[1]==0&&X[3]==0?C=0:X[0]==0&&X[2]==0&&X[3]==0?C=3:X[1]==0&&X[2]==0&&X[3]==0&&(C=2);else if(q==2&&ee==0){var re=Math.floor(Math.random()*2);X[0]==0&&X[1]==0?re==0?C=0:C=1:X[0]==0&&X[2]==0?re==0?C=0:C=2:X[0]==0&&X[3]==0?re==0?C=0:C=3:X[1]==0&&X[2]==0?re==0?C=1:C=2:X[1]==0&&X[3]==0?re==0?C=1:C=3:re==0?C=2:C=3}else if(q==4&&ee==0){var re=Math.floor(Math.random()*4);C=re}else C=$;C==0?M.setCenter(b.getCenterX(),b.getCenterY()-b.getHeight()/2-c.DEFAULT_EDGE_LENGTH-M.getHeight()/2):C==1?M.setCenter(b.getCenterX()+b.getWidth()/2+c.DEFAULT_EDGE_LENGTH+M.getWidth()/2,b.getCenterY()):C==2?M.setCenter(b.getCenterX(),b.getCenterY()+b.getHeight()/2+c.DEFAULT_EDGE_LENGTH+M.getHeight()/2):M.setCenter(b.getCenterX()-b.getWidth()/2-c.DEFAULT_EDGE_LENGTH-M.getWidth()/2,b.getCenterY())}},i.exports=L},function(i,n,a){var o={};o.layoutBase=a(0),o.CoSEConstants=a(1),o.CoSEEdge=a(2),o.CoSEGraph=a(3),o.CoSEGraphManager=a(4),o.CoSELayout=a(7),o.CoSENode=a(5),o.ConstraintHandler=a(6),i.exports=o}])})}(Ya)),Ya.exports}(function(r,e){(function(i,n){r.exports=n(NT())})(self,function(t){return(()=>{var i={658:s=>{s.exports=Object.assign!=null?Object.assign.bind(Object):function(l){for(var u=arguments.length,h=Array(u>1?u-1:0),f=1;f<u;f++)h[f-1]=arguments[f];return h.forEach(function(d){Object.keys(d).forEach(function(c){return l[c]=d[c]})}),l}},548:(s,l,u)=>{var h=u(281).layoutBase.LinkedList,f={};f.getTopMostNodes=function(d){for(var c={},v=0;v<d.length;v++)c[d[v].id()]=!0;var g=d.filter(function(m,p){typeof m=="number"&&(m=p);for(var y=m.parent()[0];y!=null;){if(c[y.id()])return!1;y=y.parent()[0]}return!0});return g},f.connectComponents=function(d,c,v,g){var m=new h,p=new Set,y=[],w=void 0,T=void 0,O=void 0,I=!1,R=1,L=[],N=[],E=function(){var b=d.collection();N.push(b);var M=v[0],D=d.collection();D.merge(M).merge(M.descendants().intersection(c)),y.push(M),D.forEach(function(B){m.push(B),p.add(B),b.merge(B)});for(var H=function(){M=m.shift();var U=d.collection();M.neighborhood().nodes().forEach(function(X){c.intersection(M.edgesWith(X)).length>0&&U.merge(X)});for(var W=0;W<U.length;W++){var J=U[W];if(w=v.intersection(J.union(J.ancestors())),w!=null&&!p.has(w[0])){var G=w.union(w.descendants());G.forEach(function(X){m.push(X),p.add(X),b.merge(X),v.has(X)&&y.push(X)})}}};m.length!=0;)H();if(b.forEach(function(B){c.intersection(B.connectedEdges()).forEach(function(U){b.has(U.source())&&b.has(U.target())&&b.merge(U)})}),y.length==v.length&&(I=!0),!I||I&&R>1){T=y[0],O=T.connectedEdges().length,y.forEach(function(B){B.connectedEdges().length<O&&(O=B.connectedEdges().length,T=B)}),L.push(T.id());var k=d.collection();k.merge(y[0]),y.forEach(function(B){k.merge(B)}),y=[],v=v.difference(k),R++}};do E();while(!I);return g&&L.length>0&&g.set("dummy"+(g.size+1),L),N},f.calcBoundingBox=function(d,c,v,g){for(var m=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,y=Number.MAX_SAFE_INTEGER,w=Number.MIN_SAFE_INTEGER,T=void 0,O=void 0,I=void 0,R=void 0,L=d.descendants().not(":parent"),N=L.length,E=0;E<N;E++){var C=L[E];T=c[g.get(C.id())]-C.width()/2,O=c[g.get(C.id())]+C.width()/2,I=v[g.get(C.id())]-C.height()/2,R=v[g.get(C.id())]+C.height()/2,m>T&&(m=T),p<O&&(p=O),y>I&&(y=I),w<R&&(w=R)}var b={};return b.topLeftX=m,b.topLeftY=y,b.width=p-m,b.height=w-y,b},s.exports=f},816:(s,l,u)=>{var h=u(548),f=u(281).CoSELayout,d=u(281).CoSENode,c=u(281).layoutBase.PointD,v=u(281).layoutBase.DimensionD,g=u(281).layoutBase.LayoutConstants,m=u(281).layoutBase.FDLayoutConstants,p=u(281).CoSEConstants,y=function(T,O){var I=T.eles,R=I.nodes(),L=I.edges(),N=void 0,E=void 0,C=void 0,b={};T.randomize&&(N=O.nodeIndexes,E=O.xCoords,C=O.yCoords);var M=function(G){return typeof G=="function"},D=function(G,X){return M(G)?G(X):G},H=function J(G,X,ie,ee){for(var q=X.length,$=0;$<q;$++){var V=X[$],re=V.children(),ae=void 0,de=V.layoutDimensions({nodeDimensionsIncludeLabels:ee.nodeDimensionsIncludeLabels});if(V.outerWidth()!=null&&V.outerHeight()!=null)if(ee.randomize)if(!V.isParent())ae=G.add(new d(ie.graphManager,new c(E[N.get(V.id())]-de.w/2,C[N.get(V.id())]-de.h/2),new v(parseFloat(de.w),parseFloat(de.h))));else{var ye=h.calcBoundingBox(V,E,C,N);ae=G.add(new d(ie.graphManager,new c(ye.topLeftX,ye.topLeftY),new v(ye.width,ye.height)))}else ae=G.add(new d(ie.graphManager,new c(V.position("x")-de.w/2,V.position("y")-de.h/2),new v(parseFloat(de.w),parseFloat(de.h))));else ae=G.add(new d(this.graphManager));if(ae.id=V.data("id"),ae.nodeRepulsion=D(ee.nodeRepulsion,V),ae.paddingLeft=parseInt(V.css("padding")),ae.paddingTop=parseInt(V.css("padding")),ae.paddingRight=parseInt(V.css("padding")),ae.paddingBottom=parseInt(V.css("padding")),ee.nodeDimensionsIncludeLabels&&(ae.labelWidth=V.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w,ae.labelHeight=V.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h,ae.labelPosVertical=V.css("text-valign"),ae.labelPosHorizontal=V.css("text-halign")),b[V.data("id")]=ae,isNaN(ae.rect.x)&&(ae.rect.x=0),isNaN(ae.rect.y)&&(ae.rect.y=0),re!=null&&re.length>0){var Te=void 0;Te=ie.getGraphManager().add(ie.newGraph(),ae),J(Te,re,ie,ee)}}},k=function(G,X,ie){for(var ee=0,q=0,$=0;$<ie.length;$++){var V=ie[$],re=b[V.data("source")],ae=b[V.data("target")];if(re!==ae&&re.getEdgesBetween(ae).length==0){var de=X.add(G.newEdge(),re,ae);de.id=V.id(),de.idealLength=D(T.idealEdgeLength,V),de.edgeElasticity=D(T.edgeElasticity,V),ee+=de.idealLength,q++}}T.idealEdgeLength!=null&&(q>0?p.DEFAULT_EDGE_LENGTH=m.DEFAULT_EDGE_LENGTH=ee/q:M(T.idealEdgeLength)?p.DEFAULT_EDGE_LENGTH=m.DEFAULT_EDGE_LENGTH=50:p.DEFAULT_EDGE_LENGTH=m.DEFAULT_EDGE_LENGTH=T.idealEdgeLength,p.MIN_REPULSION_DIST=m.MIN_REPULSION_DIST=m.DEFAULT_EDGE_LENGTH/10,p.DEFAULT_RADIAL_SEPARATION=m.DEFAULT_EDGE_LENGTH)},B=function(G,X){X.fixedNodeConstraint&&(G.constraints.fixedNodeConstraint=X.fixedNodeConstraint),X.alignmentConstraint&&(G.constraints.alignmentConstraint=X.alignmentConstraint),X.relativePlacementConstraint&&(G.constraints.relativePlacementConstraint=X.relativePlacementConstraint)};T.nestingFactor!=null&&(p.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=m.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=T.nestingFactor),T.gravity!=null&&(p.DEFAULT_GRAVITY_STRENGTH=m.DEFAULT_GRAVITY_STRENGTH=T.gravity),T.numIter!=null&&(p.MAX_ITERATIONS=m.MAX_ITERATIONS=T.numIter),T.gravityRange!=null&&(p.DEFAULT_GRAVITY_RANGE_FACTOR=m.DEFAULT_GRAVITY_RANGE_FACTOR=T.gravityRange),T.gravityCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_STRENGTH=m.DEFAULT_COMPOUND_GRAVITY_STRENGTH=T.gravityCompound),T.gravityRangeCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=m.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=T.gravityRangeCompound),T.initialEnergyOnIncremental!=null&&(p.DEFAULT_COOLING_FACTOR_INCREMENTAL=m.DEFAULT_COOLING_FACTOR_INCREMENTAL=T.initialEnergyOnIncremental),T.quality=="proof"?g.QUALITY=2:g.QUALITY=0,p.NODE_DIMENSIONS_INCLUDE_LABELS=m.NODE_DIMENSIONS_INCLUDE_LABELS=g.NODE_DIMENSIONS_INCLUDE_LABELS=T.nodeDimensionsIncludeLabels,p.DEFAULT_INCREMENTAL=m.DEFAULT_INCREMENTAL=g.DEFAULT_INCREMENTAL=!T.randomize,p.ANIMATE=m.ANIMATE=g.ANIMATE=T.animate,p.TILE=T.tile,p.TILING_PADDING_VERTICAL=typeof T.tilingPaddingVertical=="function"?T.tilingPaddingVertical.call():T.tilingPaddingVertical,p.TILING_PADDING_HORIZONTAL=typeof T.tilingPaddingHorizontal=="function"?T.tilingPaddingHorizontal.call():T.tilingPaddingHorizontal,p.DEFAULT_INCREMENTAL=m.DEFAULT_INCREMENTAL=g.DEFAULT_INCREMENTAL=!0,p.PURE_INCREMENTAL=!T.randomize,g.DEFAULT_UNIFORM_LEAF_NODE_SIZES=T.uniformNodeDimensions,T.step=="transformed"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!1),T.step=="enforced"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!1),T.step=="cose"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!0),T.step=="all"&&(T.randomize?p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0:p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!0),T.fixedNodeConstraint||T.alignmentConstraint||T.relativePlacementConstraint?p.TREE_REDUCTION_ON_INCREMENTAL=!1:p.TREE_REDUCTION_ON_INCREMENTAL=!0;var U=new f,W=U.newGraphManager();return H(W.addRoot(),h.getTopMostNodes(R),U,T),k(U,W,L),B(U,T),U.runLayout(),b};s.exports={coseLayout:y}},212:(s,l,u)=>{var h=function(){function T(O,I){for(var R=0;R<I.length;R++){var L=I[R];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(O,L.key,L)}}return function(O,I,R){return I&&T(O.prototype,I),R&&T(O,R),O}}();function f(T,O){if(!(T instanceof O))throw new TypeError("Cannot call a class as a function")}var d=u(658),c=u(548),v=u(657),g=v.spectralLayout,m=u(816),p=m.coseLayout,y=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:void 0,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1e-7,nodeRepulsion:function(O){return 4500},idealEdgeLength:function(O){return 50},edgeElasticity:function(O){return .45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:void 0,alignmentConstraint:void 0,relativePlacementConstraint:void 0,ready:function(){},stop:function(){}}),w=function(){function T(O){f(this,T),this.options=d({},y,O)}return h(T,[{key:"run",value:function(){var I=this,R=this.options,L=R.cy,N=R.eles,E=[],C=[],b=void 0;R.fixedNodeConstraint&&(!Array.isArray(R.fixedNodeConstraint)||R.fixedNodeConstraint.length==0)&&(R.fixedNodeConstraint=void 0),R.alignmentConstraint&&(R.alignmentConstraint.vertical&&(!Array.isArray(R.alignmentConstraint.vertical)||R.alignmentConstraint.vertical.length==0)&&(R.alignmentConstraint.vertical=void 0),R.alignmentConstraint.horizontal&&(!Array.isArray(R.alignmentConstraint.horizontal)||R.alignmentConstraint.horizontal.length==0)&&(R.alignmentConstraint.horizontal=void 0)),R.relativePlacementConstraint&&(!Array.isArray(R.relativePlacementConstraint)||R.relativePlacementConstraint.length==0)&&(R.relativePlacementConstraint=void 0);var M=R.fixedNodeConstraint||R.alignmentConstraint||R.relativePlacementConstraint;M&&(R.tile=!1,R.packComponents=!1);var D=void 0,H=!1;if(L.layoutUtilities&&R.packComponents&&(D=L.layoutUtilities("get"),D||(D=L.layoutUtilities()),H=!0),N.nodes().length>0){if(H){var B=c.getTopMostNodes(R.eles.nodes());if(b=c.connectComponents(L,R.eles,B),R.randomize&&b.forEach(function(K){R.eles=K,E.push(g(R))}),R.quality=="default"||R.quality=="proof"){var U=L.collection();if(R.tile){var W=new Map,J=[],G=[],X=0,ie={nodeIndexes:W,xCoords:J,yCoords:G},ee=[];if(b.forEach(function(K,le){K.edges().length==0&&(K.nodes().forEach(function(fe,me){U.merge(K.nodes()[me]),fe.isParent()||(ie.nodeIndexes.set(K.nodes()[me].id(),X++),ie.xCoords.push(K.nodes()[0].position().x),ie.yCoords.push(K.nodes()[0].position().y))}),ee.push(le))}),U.length>1){b.push(U),E.push(ie);for(var q=ee.length-1;q>=0;q--)b.splice(ee[q],1),E.splice(ee[q],1)}}b.forEach(function(K,le){R.eles=K,C.push(p(R,E[le]))})}if(b.length>1){var $=[];b.forEach(function(K,le){var fe=void 0;R.quality=="draft"&&(fe=E[le].nodeIndexes);var me={};me.nodes=[],me.edges=[];var se=void 0;K.nodes().forEach(function(F){if(R.quality=="draft")if(!F.isParent())se=fe.get(F.id()),me.nodes.push({x:E[le].xCoords[se]-F.boundingbox().w/2,y:E[le].yCoords[se]-F.boundingbox().h/2,width:F.boundingbox().w,height:F.boundingbox().h});else{var Q=c.calcBoundingBox(F,E[le].xCoords,E[le].yCoords,fe);me.nodes.push({x:Q.topLeftX,y:Q.topLeftY,width:Q.width,height:Q.height})}else me.nodes.push({x:C[le][F.id()].getLeft(),y:C[le][F.id()].getTop(),width:C[le][F.id()].getWidth(),height:C[le][F.id()].getHeight()})}),K.edges().forEach(function(F){var Q=F.source(),ue=F.target();if(R.quality=="draft"){var oe=fe.get(Q.id()),Z=fe.get(ue.id()),P=[],S=[];if(Q.isParent()){var A=c.calcBoundingBox(Q,E[le].xCoords,E[le].yCoords,fe);P.push(A.topLeftX+A.width/2),P.push(A.topLeftY+A.height/2)}else P.push(E[le].xCoords[oe]),P.push(E[le].yCoords[oe]);if(ue.isParent()){var _=c.calcBoundingBox(ue,E[le].xCoords,E[le].yCoords,fe);S.push(_.topLeftX+_.width/2),S.push(_.topLeftY+_.height/2)}else S.push(E[le].xCoords[Z]),S.push(E[le].yCoords[Z]);me.edges.push({startX:P[0],startY:P[1],endX:S[0],endY:S[1]})}else me.edges.push({startX:C[le][Q.id()].getCenterX(),startY:C[le][Q.id()].getCenterY(),endX:C[le][ue.id()].getCenterX(),endY:C[le][ue.id()].getCenterY()})}),$.push(me)});var V=D.packComponents($,R.randomize).shifts;R.quality=="draft"?E.forEach(function(K,le){var fe=K.xCoords.map(function(se){return se+V[le].dx}),me=K.yCoords.map(function(se){return se+V[le].dy});K.xCoords=fe,K.yCoords=me}):C.forEach(function(K,le){Object.keys(K).forEach(function(fe){var me=K[fe];me.setCenter(me.getCenterX()+V[le].dx,me.getCenterY()+V[le].dy)})})}}else{if(R.randomize){var k=g(R);E.push(k)}(R.quality=="default"||R.quality=="proof")&&C.push(p(R,E[0]))}if(R.randomize&&!R.fixedNodeConstraint){var re=Number.POSITIVE_INFINITY,ae=Number.NEGATIVE_INFINITY,de=Number.POSITIVE_INFINITY,ye=Number.NEGATIVE_INFINITY;if(R.quality=="draft"){E.forEach(function(K){K.xCoords.forEach(function(le){le<re&&(re=le),le>ae&&(ae=le)}),K.yCoords.forEach(function(le){le<de&&(de=le),le>ye&&(ye=le)})});var Te=R.eles.boundingBox(),Oe=Te.x1+Te.w/2-(ae+re)/2,ce=Te.y1+Te.h/2-(ye+de)/2;E.forEach(function(K){K.xCoords=K.xCoords.map(function(le){return le+Oe}),K.yCoords=K.yCoords.map(function(le){return le+ce})})}else{C.forEach(function(K){Object.keys(K).forEach(function(le){var fe=K[le];fe.getCenterX()<re&&(re=fe.getCenterX()),fe.getCenterX()>ae&&(ae=fe.getCenterX()),fe.getCenterY()<de&&(de=fe.getCenterY()),fe.getCenterY()>ye&&(ye=fe.getCenterY())})});var x=R.eles.boundingBox(),z=x.x1+x.w/2-(ae+re)/2,j=x.y1+x.h/2-(ye+de)/2;C.forEach(function(K,le){Object.keys(K).forEach(function(fe){var me=K[fe];me.setCenter(me.getCenterX()+z,me.getCenterY()+j)})})}}}var te=function(le,fe){if(R.quality=="default"||R.quality=="proof"){typeof le=="number"&&(le=fe);var me=void 0,se=void 0,F=le.data("id");return C.forEach(function(ue){F in ue&&(me={x:ue[F].getRect().getCenterX(),y:ue[F].getRect().getCenterY()},se=ue[F])}),R.nodeDimensionsIncludeLabels&&(se.labelWidth&&(se.labelPosHorizontal=="left"?me.x+=se.labelWidth/2:se.labelPosHorizontal=="right"&&(me.x-=se.labelWidth/2)),se.labelHeight&&(se.labelPosVertical=="top"?me.y+=se.labelHeight/2:se.labelPosVertical=="bottom"&&(me.y-=se.labelHeight/2))),{x:me.x,y:me.y}}else{var Q=void 0;return E.forEach(function(ue){var oe=ue.nodeIndexes.get(le.id());oe!=null&&(Q={x:ue.xCoords[oe],y:ue.yCoords[oe]})}),Q==null&&(Q={x:le.position("x"),y:le.position("y")}),{x:Q.x,y:Q.y}}};R.quality=="default"||R.quality=="proof"||R.randomize?(R.eles=N,N.nodes().not(":parent").layoutPositions(I,R,te)):console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}]),T}();s.exports=w},657:(s,l,u)=>{var h=u(548),f=u(281).layoutBase.Matrix,d=u(281).layoutBase.SVD,c=function(g){var m=g.cy,p=g.eles,y=p.nodes(),w=p.nodes(":parent"),T=new Map,O=new Map,I=new Map,R=[],L=[],N=[],E=[],C=[],b=[],M=[],D=[],H=void 0,k=1e8,B=1e-9,U=g.piTol,W=g.samplingType,J=g.nodeSeparation,G=void 0,X=function(){for(var Y=0,ne=0,pe=!1;ne<G;){Y=Math.floor(Math.random()*H),pe=!1;for(var he=0;he<ne;he++)if(E[he]==Y){pe=!0;break}if(!pe)E[ne]=Y,ne++;else continue}},ie=function(Y,ne,pe){for(var he=[],ge=0,we=0,Ee=0,Pe=void 0,Ce=[],be=0,xe=1,Me=0;Me<H;Me++)Ce[Me]=k;for(he[we]=Y,Ce[Y]=0;we>=ge;){Ee=he[ge++];for(var Re=R[Ee],De=0;De<Re.length;De++)Pe=O.get(Re[De]),Ce[Pe]==k&&(Ce[Pe]=Ce[Ee]+1,he[++we]=Pe);b[Ee][ne]=Ce[Ee]*J}if(pe){for(var ze=0;ze<H;ze++)b[ze][ne]<C[ze]&&(C[ze]=b[ze][ne]);for(var Be=0;Be<H;Be++)C[Be]>be&&(be=C[Be],xe=Be)}return xe},ee=function(Y){var ne=void 0;if(Y){ne=Math.floor(Math.random()*H);for(var he=0;he<H;he++)C[he]=k;for(var ge=0;ge<G;ge++)E[ge]=ne,ne=ie(ne,ge,Y)}else{X();for(var pe=0;pe<G;pe++)ie(E[pe],pe,Y)}for(var we=0;we<H;we++)for(var Ee=0;Ee<G;Ee++)b[we][Ee]*=b[we][Ee];for(var Pe=0;Pe<G;Pe++)M[Pe]=[];for(var Ce=0;Ce<G;Ce++)for(var be=0;be<G;be++)M[Ce][be]=b[E[be]][Ce]},q=function(){for(var Y=d.svd(M),ne=Y.S,pe=Y.U,he=Y.V,ge=ne[0]*ne[0]*ne[0],we=[],Ee=0;Ee<G;Ee++){we[Ee]=[];for(var Pe=0;Pe<G;Pe++)we[Ee][Pe]=0,Ee==Pe&&(we[Ee][Pe]=ne[Ee]/(ne[Ee]*ne[Ee]+ge/(ne[Ee]*ne[Ee])))}D=f.multMat(f.multMat(he,we),f.transpose(pe))},$=function(){for(var Y=void 0,ne=void 0,pe=[],he=[],ge=[],we=[],Ee=0;Ee<H;Ee++)pe[Ee]=Math.random(),he[Ee]=Math.random();pe=f.normalize(pe),he=f.normalize(he);for(var Pe=B,Ce=B,be=void 0;;){for(var xe=0;xe<H;xe++)ge[xe]=pe[xe];if(pe=f.multGamma(f.multL(f.multGamma(ge),b,D)),Y=f.dotProduct(ge,pe),pe=f.normalize(pe),Pe=f.dotProduct(ge,pe),be=Math.abs(Pe/Ce),be<=1+U&&be>=1)break;Ce=Pe}for(var Me=0;Me<H;Me++)ge[Me]=pe[Me];for(Ce=B;;){for(var Re=0;Re<H;Re++)we[Re]=he[Re];if(we=f.minusOp(we,f.multCons(ge,f.dotProduct(ge,we))),he=f.multGamma(f.multL(f.multGamma(we),b,D)),ne=f.dotProduct(we,he),he=f.normalize(he),Pe=f.dotProduct(we,he),be=Math.abs(Pe/Ce),be<=1+U&&be>=1)break;Ce=Pe}for(var De=0;De<H;De++)we[De]=he[De];L=f.multCons(ge,Math.sqrt(Math.abs(Y))),N=f.multCons(we,Math.sqrt(Math.abs(ne)))};h.connectComponents(m,p,h.getTopMostNodes(y),T),w.forEach(function(_){h.connectComponents(m,p,h.getTopMostNodes(_.descendants().intersection(p)),T)});for(var V=0,re=0;re<y.length;re++)y[re].isParent()||O.set(y[re].id(),V++);var ae=!0,de=!1,ye=void 0;try{for(var Te=T.keys()[Symbol.iterator](),Oe;!(ae=(Oe=Te.next()).done);ae=!0){var ce=Oe.value;O.set(ce,V++)}}catch(_){de=!0,ye=_}finally{try{!ae&&Te.return&&Te.return()}finally{if(de)throw ye}}for(var x=0;x<O.size;x++)R[x]=[];w.forEach(function(_){for(var Y=_.children().intersection(p);Y.nodes(":childless").length==0;)Y=Y.nodes()[0].children().intersection(p);var ne=0,pe=Y.nodes(":childless")[0].connectedEdges().length;Y.nodes(":childless").forEach(function(he,ge){he.connectedEdges().length<pe&&(pe=he.connectedEdges().length,ne=ge)}),I.set(_.id(),Y.nodes(":childless")[ne].id())}),y.forEach(function(_){var Y=void 0;_.isParent()?Y=O.get(I.get(_.id())):Y=O.get(_.id()),_.neighborhood().nodes().forEach(function(ne){p.intersection(_.edgesWith(ne)).length>0&&(ne.isParent()?R[Y].push(I.get(ne.id())):R[Y].push(ne.id()))})});var z=function(Y){var ne=O.get(Y),pe=void 0;T.get(Y).forEach(function(he){m.getElementById(he).isParent()?pe=I.get(he):pe=he,R[ne].push(pe),R[O.get(pe)].push(Y)})},j=!0,te=!1,K=void 0;try{for(var le=T.keys()[Symbol.iterator](),fe;!(j=(fe=le.next()).done);j=!0){var me=fe.value;z(me)}}catch(_){te=!0,K=_}finally{try{!j&&le.return&&le.return()}finally{if(te)throw K}}H=O.size;var se=void 0;if(H>2){G=H<g.sampleSize?H:g.sampleSize;for(var F=0;F<H;F++)b[F]=[];for(var Q=0;Q<G;Q++)D[Q]=[];return g.quality=="draft"||g.step=="all"?(ee(W),q(),$(),se={nodeIndexes:O,xCoords:L,yCoords:N}):(O.forEach(function(_,Y){L.push(m.getElementById(Y).position("x")),N.push(m.getElementById(Y).position("y"))}),se={nodeIndexes:O,xCoords:L,yCoords:N}),se}else{var ue=O.keys(),oe=m.getElementById(ue.next().value),Z=oe.position(),P=oe.outerWidth();if(L.push(Z.x),N.push(Z.y),H==2){var S=m.getElementById(ue.next().value),A=S.outerWidth();L.push(Z.x+P/2+A/2+g.idealEdgeLength),N.push(Z.y)}return se={nodeIndexes:O,xCoords:L,yCoords:N},se}};s.exports={spectralLayout:c}},579:(s,l,u)=>{var h=u(212),f=function(c){!c||c("layout","fcose",h)};typeof cytoscape<"u"&&f(cytoscape),s.exports=f},281:s=>{s.exports=t}},n={};function a(s){var l=n[s];if(l!==void 0)return l.exports;var u=n[s]={exports:{}};return i[s](u,u.exports,a),u.exports}var o=a(579);return o})()})})(Vh);const IT=Vh.exports;var Wh={exports:{}};(function(r){(function(){var e=function(i){if(!!i){var n=function(o){var s=this,l=s.container(),u=document.createElement("canvas");l.appendChild(u);var h={zIndex:1,pixelRatio:"auto"},f=Object.assign({},h,o);f.pixelRatio==="auto"&&(f.pixelRatio=window.devicePixelRatio||1);function d(){var c=l.offsetWidth,v=l.offsetHeight,g=c*f.pixelRatio,m=v*f.pixelRatio;u.width=g,u.height=m,u.style.width=c+"px",u.style.height=v+"px",s.trigger("cyCanvas.resize")}return s.on("resize",function(){d()}),u.setAttribute("style","position:absolute; top:0; left:0; z-index:"+f.zIndex+";"),d(),{getCanvas:function(){return u},clear:function(v){var g=s.width(),m=s.height();v.save(),v.setTransform(1,0,0,1,0,0),v.clearRect(0,0,g*f.pixelRatio,m*f.pixelRatio),v.restore()},resetTransform:function(v){v.setTransform(1,0,0,1,0,0)},setTransform:function(v){var g=s.pan(),m=s.zoom();v.setTransform(1,0,0,1,0,0),v.translate(g.x*f.pixelRatio,g.y*f.pixelRatio),v.scale(m*f.pixelRatio,m*f.pixelRatio)}}};i("core","cyCanvas",n)}};r.exports&&(r.exports=function(t){e(t)}),typeof cytoscape<"u"&&e(cytoscape)})()})(Wh);const AT=Wh.exports;var qh={exports:{}};(function(r){//! openseadragon 4.0.0
//! Built on 2022-12-16
//! Git commit: v4.0.0-0-8e6196a
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function e(t){return new e.Viewer(t)}(function(t){t.version={versionStr:"4.0.0",major:parseInt("4",10),minor:parseInt("0",10),revision:parseInt("0",10)};var i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},n=Object.prototype.toString,a=Object.prototype.hasOwnProperty;t.isFunction=function(o){return t.type(o)==="function"},t.isArray=Array.isArray||function(o){return t.type(o)==="array"},t.isWindow=function(o){return o&&typeof o=="object"&&"setInterval"in o},t.type=function(o){return o==null?String(o):i[n.call(o)]||"object"},t.isPlainObject=function(o){if(!o||e.type(o)!=="object"||o.nodeType||t.isWindow(o)||o.constructor&&!a.call(o,"constructor")&&!a.call(o.constructor.prototype,"isPrototypeOf"))return!1;var s;for(var l in o)s=l;return s===void 0||a.call(o,s)},t.isEmptyObject=function(o){for(var s in o)return!1;return!0},t.freezeObject=function(o){return Object.freeze?t.freezeObject=Object.freeze:t.freezeObject=function(s){return s},t.freezeObject(o)},t.supportsCanvas=function(){var o=document.createElement("canvas");return!!(t.isFunction(o.getContext)&&o.getContext("2d"))}(),t.isCanvasTainted=function(o){var s=!1;try{o.getContext("2d").getImageData(0,0,1,1)}catch{s=!0}return s},t.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),t.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),t.supportsEventListenerOptions=function(){var o=0;if(t.supportsAddEventListener)try{var s={get capture(){return o++,!1},get once(){return o++,!1},get passive(){return o++,!1}};window.addEventListener("test",null,s),window.removeEventListener("test",null,s)}catch{o=0}return o>=3}(),t.getCurrentPixelDensityRatio=function(){if(t.supportsCanvas){var o=document.createElement("canvas").getContext("2d"),s=window.devicePixelRatio||1,l=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1;return Math.max(s,1)/l}else return 1},t.pixelDensityRatio=t.getCurrentPixelDensityRatio()})(e),function(t){t.extend=function(){var l,u,h,f,d,c,v=arguments[0]||{},g=arguments.length,m=!1,p=1;for(typeof v=="boolean"&&(m=v,v=arguments[1]||{},p=2),typeof v!="object"&&!e.isFunction(v)&&(v={}),g===p&&(v=this,--p);p<g;p++)if(l=arguments[p],l!==null||l!==void 0)for(u in l){var y=Object.getOwnPropertyDescriptor(l,u);if(y!==void 0){if(y.get||y.set){Object.defineProperty(v,u,y);continue}f=y.value}else{t.console.warn('Could not copy inherited property "'+u+'".');continue}v!==f&&(m&&f&&(e.isPlainObject(f)||(d=e.isArray(f)))?(h=v[u],d?(d=!1,c=h&&e.isArray(h)?h:[]):c=h&&e.isPlainObject(h)?h:{},v[u]=e.extend(m,c,f)):f!==void 0&&(v[u]=f))}return v};var i=function(){if(typeof navigator!="object")return!1;var l=navigator.userAgent;return typeof l!="string"?!1:l.indexOf("iPhone")!==-1||l.indexOf("iPad")!==-1||l.indexOf("iPod")!==-1};t.extend(t,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:i(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(l,u){return function(){var h=arguments;return h===void 0&&(h=[]),u.apply(l,h)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(l){return t._viewers.get(this.getElement(l))},getElement:function(l){return typeof l=="string"&&(l=document.getElementById(l)),l},getElementPosition:function(l){var u=new t.Point,h,f;for(l=t.getElement(l),h=t.getElementStyle(l).position==="fixed",f=s(l,h);f;)u.x+=l.offsetLeft,u.y+=l.offsetTop,h&&(u=u.plus(t.getPageScroll())),l=f,h=t.getElementStyle(l).position==="fixed",f=s(l,h);return u},getElementOffset:function(l){l=t.getElement(l);var u=l&&l.ownerDocument,h,f,d={top:0,left:0};return u?(h=u.documentElement,typeof l.getBoundingClientRect<"u"&&(d=l.getBoundingClientRect()),f=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new t.Point(d.left+(f.pageXOffset||h.scrollLeft)-(h.clientLeft||0),d.top+(f.pageYOffset||h.scrollTop)-(h.clientTop||0))):new t.Point},getElementSize:function(l){return l=t.getElement(l),new t.Point(l.clientWidth,l.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(l){return l=t.getElement(l),l.currentStyle}:function(l){return l=t.getElement(l),window.getComputedStyle(l,"")},getCssPropertyWithVendorPrefix:function(l){var u={};return t.getCssPropertyWithVendorPrefix=function(h){if(u[h]!==void 0)return u[h];var f=document.createElement("div").style,d=null;if(f[h]!==void 0)d=h;else for(var c=["Webkit","Moz","MS","O","webkit","moz","ms","o"],v=t.capitalizeFirstLetter(h),g=0;g<c.length;g++){var m=c[g]+v;if(f[m]!==void 0){d=m;break}}return u[h]=d,d},t.getCssPropertyWithVendorPrefix(l)},capitalizeFirstLetter:function(l){return l.charAt(0).toUpperCase()+l.slice(1)},positiveModulo:function(l,u){var h=l%u;return h<0&&(h+=u),h},pointInElement:function(l,u){l=t.getElement(l);var h=t.getElementOffset(l),f=t.getElementSize(l);return u.x>=h.x&&u.x<h.x+f.x&&u.y<h.y+f.y&&u.y>=h.y},getMousePosition:function(l){if(typeof l.pageX=="number")t.getMousePosition=function(u){var h=new t.Point;return h.x=u.pageX,h.y=u.pageY,h};else if(typeof l.clientX=="number")t.getMousePosition=function(u){var h=new t.Point;return h.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,h.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,h};else throw new Error("Unknown event mouse position, no known technique.");return t.getMousePosition(l)},getPageScroll:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")t.getPageScroll=function(){return new t.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)t.getPageScroll=function(){return new t.Point(document.body.scrollLeft,document.body.scrollTop)};else if(l.scrollLeft||l.scrollTop)t.getPageScroll=function(){return new t.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new t.Point(0,0);return t.getPageScroll()},setPageScroll:function(l){if(typeof window.scrollTo<"u")t.setPageScroll=function(f){window.scrollTo(f.x,f.y)};else{var u=t.getPageScroll();if(u.x===l.x&&u.y===l.y)return;document.body.scrollLeft=l.x,document.body.scrollTop=l.y;var h=t.getPageScroll();if(h.x!==u.x&&h.y!==u.y){t.setPageScroll=function(f){document.body.scrollLeft=f.x,document.body.scrollTop=f.y};return}if(document.documentElement.scrollLeft=l.x,document.documentElement.scrollTop=l.y,h=t.getPageScroll(),h.x!==u.x&&h.y!==u.y){t.setPageScroll=function(f){document.documentElement.scrollLeft=f.x,document.documentElement.scrollTop=f.y};return}t.setPageScroll=function(f){}}t.setPageScroll(l)},getWindowSize:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")t.getWindowSize=function(){return new t.Point(window.innerWidth,window.innerHeight)};else if(l.clientWidth||l.clientHeight)t.getWindowSize=function(){return new t.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)t.getWindowSize=function(){return new t.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return t.getWindowSize()},makeCenteredNode:function(l){l=t.getElement(l);var u=[t.makeNeutralElement("div"),t.makeNeutralElement("div"),t.makeNeutralElement("div")];return t.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),t.extend(u[1].style,{display:"table-row"}),t.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(l),u[0]},makeNeutralElement:function(l){var u=document.createElement(l),h=u.style;return h.background="transparent none",h.border="none",h.margin="0px",h.padding="0px",h.position="static",u},now:function(){return Date.now?t.now=Date.now:t.now=function(){return new Date().getTime()},t.now()},makeTransparentImage:function(l){var u=t.makeNeutralElement("img");return u.src=l,u},setElementOpacity:function(l,u,h){var f,d;l=t.getElement(l),h&&!t.Browser.alpha&&(u=Math.round(u)),t.Browser.opacity?l.style.opacity=u<1?u:"":u<1?(f=Math.round(100*u),d="alpha(opacity="+f+")",l.style.filter=d):l.style.filter=""},setElementTouchActionNone:function(l){l=t.getElement(l),typeof l.style.touchAction<"u"?l.style.touchAction="none":typeof l.style.msTouchAction<"u"&&(l.style.msTouchAction="none")},setElementPointerEvents:function(l,u){l=t.getElement(l),typeof l.style<"u"&&typeof l.style.pointerEvents<"u"&&(l.style.pointerEvents=u)},setElementPointerEventsNone:function(l){t.setElementPointerEvents(l,"none")},addClass:function(l,u){l=t.getElement(l),l.className?(" "+l.className+" ").indexOf(" "+u+" ")===-1&&(l.className+=" "+u):l.className=u},indexOf:function(l,u,h){return Array.prototype.indexOf?this.indexOf=function(f,d,c){return f.indexOf(d,c)}:this.indexOf=function(f,d,c){var v,g=c||0,m;if(!f)throw new TypeError;if(m=f.length,m===0||g>=m)return-1;for(g<0&&(g=m-Math.abs(g)),v=g;v<m;v++)if(f[v]===d)return v;return-1},this.indexOf(l,u,h)},removeClass:function(l,u){var h,f=[],d;for(l=t.getElement(l),h=l.className.split(/\s+/),d=0;d<h.length;d++)h[d]&&h[d]!==u&&f.push(h[d]);l.className=f.join(" ")},normalizeEventListenerOptions:function(l){var u;return typeof l<"u"?typeof l=="boolean"?u=t.supportsEventListenerOptions?{capture:l}:l:u=t.supportsEventListenerOptions?l:typeof l.capture<"u"?l.capture:!1:u=t.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:function(){if(t.supportsAddEventListener)return function(l,u,h,f){f=t.normalizeEventListenerOptions(f),l=t.getElement(l),l.addEventListener(u,h,f)};if(document.documentElement.attachEvent&&document.attachEvent)return function(l,u,h){l=t.getElement(l),l.attachEvent("on"+u,h)};throw new Error("No known event model.")}(),removeEvent:function(){if(t.supportsRemoveEventListener)return function(l,u,h,f){f=t.normalizeEventListenerOptions(f),l=t.getElement(l),l.removeEventListener(u,h,f)};if(document.documentElement.detachEvent&&document.detachEvent)return function(l,u,h){l=t.getElement(l),l.detachEvent("on"+u,h)};throw new Error("No known event model.")}(),cancelEvent:function(l){l.preventDefault()},eventIsCanceled:function(l){return l.defaultPrevented},stopEvent:function(l){l.stopPropagation()},createCallback:function(l,u){var h=[],f;for(f=2;f<arguments.length;f++)h.push(arguments[f]);return function(){var d=h.concat([]),c;for(c=0;c<arguments.length;c++)d.push(arguments[c]);return u.apply(l,d)}},getUrlParameter:function(l){var u=o[l];return u||null},getUrlProtocol:function(l){var u=l.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(l){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?t.createAjaxRequest=function(h){return h?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:t.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)t.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return t.createAjaxRequest(l)},makeAjaxRequest:function(l,u,h){var f,d,c,v;t.isPlainObject(l)&&(u=l.success,h=l.error,f=l.withCredentials,d=l.headers,c=l.responseType||null,v=l.postData||null,l=l.url);var g=t.getUrlProtocol(l),m=t.createAjaxRequest(g==="file:");if(!t.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");m.onreadystatechange=function(){m.readyState===4&&(m.onreadystatechange=function(){},m.status>=200&&m.status<300||m.status===0&&g!=="http:"&&g!=="https:"?u(m):t.isFunction(h)?h(m):t.console.error("AJAX request returned %d: %s",m.status,l))};var p=v?"POST":"GET";try{if(m.open(p,l,!0),c&&(m.responseType=c),d)for(var y in d)Object.prototype.hasOwnProperty.call(d,y)&&d[y]&&m.setRequestHeader(y,d[y]);f&&(m.withCredentials=!0),m.send(v)}catch(w){t.console.error("%s while making AJAX request: %s",w.name,w.message),m.onreadystatechange=function(){},t.isFunction(h)&&h(m,w)}return m},jsonp:function(l){var u,h=l.url,f=document.head||document.getElementsByTagName("head")[0]||document.documentElement,d=l.callbackName||"openseadragon"+t.now(),c=window[d],v="$1"+d+"$2",g=l.param||"callback",m=l.callback;h=h.replace(/(=)\?(&|$)|\?\?/i,v),h+=(/\?/.test(h)?"&":"?")+g+"="+d,window[d]=function(p){if(c)window[d]=c;else try{delete window[d]}catch{}m&&t.isFunction(m)&&m(p)},u=document.createElement("script"),(l.async!==void 0||l.async!==!1)&&(u.async="async"),l.scriptCharset&&(u.charset=l.scriptCharset),u.src=h,u.onload=u.onreadystatechange=function(p,y){(y||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,f&&u.parentNode&&f.removeChild(u),u=void 0)},f.insertBefore(u,f.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(l){if(window.DOMParser)t.parseXml=function(u){var h=null,f;return f=new DOMParser,h=f.parseFromString(u,"text/xml"),h};else if(window.ActiveXObject)t.parseXml=function(u){var h=null;return h=new ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.loadXML(u),h};else throw new Error("Browser doesn't support XML DOM.");return t.parseXml(l)},parseJSON:function(l){return t.parseJSON=window.JSON.parse,t.parseJSON(l)},imageFormatSupported:function(l){return l=l||"",!!a[l.toLowerCase()]},setImageFormatsSupported:function(l){t.extend(a,l)}});var n=function(l){};t.console=window.console||{log:n,debug:n,info:n,warn:n,error:n,assert:n},t.Browser={vendor:t.BROWSERS.UNKNOWN,version:0,alpha:!0};var a={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},o={};(function(){var l=navigator.appVersion,u=navigator.userAgent,h;switch(navigator.appName){case"Microsoft Internet Explorer":!!window.attachEvent&&!!window.ActiveXObject&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(t.Browser.vendor=t.BROWSERS.EDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(t.Browser.vendor=t.BROWSERS.CHROMEEDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(t.Browser.vendor=t.BROWSERS.FIREFOX,t.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(t.Browser.vendor=u.indexOf("Chrome")>=0?t.BROWSERS.CHROME:t.BROWSERS.SAFARI,t.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(h=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),h.exec(u)!==null&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":t.Browser.vendor=t.BROWSERS.OPERA,t.Browser.version=parseFloat(l);break}var f=window.location.search.substring(1),d=f.split("&"),c,v,g;for(g=0;g<d.length;g++)if(c=d[g],v=c.indexOf("="),v>0){var m=c.substring(0,v),p=c.substring(v+1);try{o[m]=decodeURIComponent(p)}catch{t.console.error("Ignoring malformed URL parameter: %s=%s",m,p)}}t.Browser.alpha=!(t.Browser.vendor===t.BROWSERS.CHROME&&t.Browser.version<2),t.Browser.opacity=!0,t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<11&&t.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(l){var u=l.requestAnimationFrame||l.mozRequestAnimationFrame||l.webkitRequestAnimationFrame||l.msRequestAnimationFrame,h=l.cancelAnimationFrame||l.mozCancelAnimationFrame||l.webkitCancelAnimationFrame||l.msCancelAnimationFrame;if(u&&h)t.requestAnimationFrame=function(){return u.apply(l,arguments)},t.cancelAnimationFrame=function(){return h.apply(l,arguments)};else{var f=[],d=[],c=0,v;t.requestAnimationFrame=function(g){return f.push([++c,g]),v||(v=setInterval(function(){if(f.length){var m=t.now(),p=d;for(d=f,f=p;d.length;)d.shift()[1](m)}else clearInterval(v),v=void 0},1e3/50)),c},t.cancelAnimationFrame=function(g){var m,p;for(m=0,p=f.length;m<p;m+=1)if(f[m][0]===g){f.splice(m,1);return}for(m=0,p=d.length;m<p;m+=1)if(d[m][0]===g){d.splice(m,1);return}}}}(window);function s(l,u){return u&&l!==document.body?document.body:l.offsetParent}}(e),function(t,i){r.exports?r.exports=i():t.OpenSeadragon=i()}(xr,function(){return e}),function(t){var i={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.fullscreenElement},i.requestFullScreen=function(n){return n.requestFullscreen()},i.exitFullScreen=function(){document.exitFullscreen()},i.fullScreenEventName="fullscreenchange",i.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.msFullscreenElement},i.requestFullScreen=function(n){return n.msRequestFullscreen()},i.exitFullScreen=function(){document.msExitFullscreen()},i.fullScreenEventName="MSFullscreenChange",i.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitFullscreenElement},i.requestFullScreen=function(n){return n.webkitRequestFullscreen()},i.exitFullScreen=function(){document.webkitExitFullscreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},i.requestFullScreen=function(n){return n.webkitRequestFullScreen()},i.exitFullScreen=function(){document.webkitCancelFullScreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.mozFullScreenElement},i.requestFullScreen=function(n){return n.mozRequestFullScreen()},i.exitFullScreen=function(){document.mozCancelFullScreen()},i.fullScreenEventName="mozfullscreenchange",i.fullScreenErrorEventName="mozfullscreenerror"),i.isFullScreen=function(){return i.getFullScreenElement()!==null},i.cancelFullScreen=function(){t.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),i.exitFullScreen()},t.extend(t,i)}(e),function(t){t.EventSource=function(){this.events={}},t.EventSource.prototype={addOnceHandler:function(i,n,a,o){var s=this;o=o||1;var l=0,u=function(h){l++,l===o&&s.removeHandler(i,u),n(h)};this.addHandler(i,u,a)},addHandler:function(i,n,a){var o=this.events[i];o||(this.events[i]=o=[]),n&&t.isFunction(n)&&(o[o.length]={handler:n,userData:a||null})},removeHandler:function(i,n){var a=this.events[i],o=[],s;if(!!a&&t.isArray(a)){for(s=0;s<a.length;s++)a[s].handler!==n&&o.push(a[s]);this.events[i]=o}},numberOfHandlers:function(i){var n=this.events[i];return n?n.length:0},removeAllHandlers:function(i){if(i)this.events[i]=[];else for(var n in this.events)this.events[n]=[]},getHandler:function(i){var n=this.events[i];return!n||!n.length?null:(n=n.length===1?[n[0]]:Array.apply(null,n),function(a,o){var s,l=n.length;for(s=0;s<l;s++)n[s]&&(o.eventSource=a,o.userData=n[s].userData,n[s].handler(o))})},raiseEvent:function(i,n){var a=this.getHandler(i);a&&(n||(n={}),a(this,n))}}}(e),function(t){var i={};t.MouseTracker=function(P){var S=arguments;t.isPlainObject(P)||(P={element:S[0],clickTimeThreshold:S[1],clickDistThreshold:S[2]}),this.hash=Math.random(),this.element=t.getElement(P.element),this.clickTimeThreshold=P.clickTimeThreshold||t.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=P.clickDistThreshold||t.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=P.dblClickTimeThreshold||t.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=P.dblClickDistThreshold||t.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=P.userData||null,this.stopDelay=P.stopDelay||50,this.preProcessEventHandler=P.preProcessEventHandler||null,this.contextMenuHandler=P.contextMenuHandler||null,this.enterHandler=P.enterHandler||null,this.leaveHandler=P.leaveHandler||null,this.exitHandler=P.exitHandler||null,this.overHandler=P.overHandler||null,this.outHandler=P.outHandler||null,this.pressHandler=P.pressHandler||null,this.nonPrimaryPressHandler=P.nonPrimaryPressHandler||null,this.releaseHandler=P.releaseHandler||null,this.nonPrimaryReleaseHandler=P.nonPrimaryReleaseHandler||null,this.moveHandler=P.moveHandler||null,this.scrollHandler=P.scrollHandler||null,this.clickHandler=P.clickHandler||null,this.dblClickHandler=P.dblClickHandler||null,this.dragHandler=P.dragHandler||null,this.dragEndHandler=P.dragEndHandler||null,this.pinchHandler=P.pinchHandler||null,this.stopHandler=P.stopHandler||null,this.keyDownHandler=P.keyDownHandler||null,this.keyUpHandler=P.keyUpHandler||null,this.keyHandler=P.keyHandler||null,this.focusHandler=P.focusHandler||null,this.blurHandler=P.blurHandler||null;var A=this;i[this.hash]={click:function(_){w(A,_)},dblclick:function(_){T(A,_)},keydown:function(_){O(A,_)},keyup:function(_){I(A,_)},keypress:function(_){R(A,_)},focus:function(_){L(A,_)},blur:function(_){N(A,_)},contextmenu:function(_){E(A,_)},wheel:function(_){C(A,_)},mousewheel:function(_){b(A,_)},DOMMouseScroll:function(_){b(A,_)},MozMousePixelScroll:function(_){b(A,_)},losecapture:function(_){D(A,_)},mouseenter:function(_){ie(A,_)},mouseleave:function(_){ee(A,_)},mouseover:function(_){q(A,_)},mouseout:function(_){$(A,_)},mousedown:function(_){V(A,_)},mouseup:function(_){re(A,_)},mousemove:function(_){ye(A,_)},touchstart:function(_){H(A,_)},touchend:function(_){k(A,_)},touchmove:function(_){B(A,_)},touchcancel:function(_){U(A,_)},gesturestart:function(_){W(A,_)},gesturechange:function(_){J(A,_)},gotpointercapture:function(_){G(A,_)},lostpointercapture:function(_){X(A,_)},pointerenter:function(_){ie(A,_)},pointerleave:function(_){ee(A,_)},pointerover:function(_){q(A,_)},pointerout:function(_){$(A,_)},pointerdown:function(_){V(A,_)},pointerup:function(_){re(A,_)},pointermove:function(_){ye(A,_)},pointercancel:function(_){ce(A,_)},pointerupcaptured:function(_){ae(A,_)},pointermovecaptured:function(_){Te(A,_)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,t.MouseTracker.havePointerEvents&&t.setElementPointerEvents(this.element,"auto"),this.exitHandler&&t.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),P.startDisabled||this.setTracking(!0)},t.MouseTracker.prototype={destroy:function(){l(this),this.element=null,i[this.hash]=null,delete i[this.hash]},isTracking:function(){return i[this.hash].tracking},setTracking:function(P){return P?s(this):l(this),this},getActivePointersListByType:function(P){var S=i[this.hash],A,_=S.activePointersLists.length,Y;for(A=0;A<_;A++)if(S.activePointersLists[A].type===P)return S.activePointersLists[A];return Y=new t.MouseTracker.GesturePointList(P),S.activePointersLists.push(Y),Y},getActivePointerCount:function(){var P=i[this.hash],S,A=P.activePointersLists.length,_=0;for(S=0;S<A;S++)_+=P.activePointersLists[S].getLength();return _},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var n=function(){try{return window.self!==window.top}catch{return!0}}();function a(P){try{return P.addEventListener&&P.removeEventListener}catch{return!1}}t.MouseTracker.gesturePointVelocityTracker=function(){var P=[],S=0,A=0,_=function(he,ge){return he.hash.toString()+ge.type+ge.id.toString()},Y=function(){var he,ge=P.length,we,Ee,Pe=t.now(),Ce,be,xe;for(Ce=Pe-A,A=Pe,he=0;he<ge;he++)we=P[he],Ee=we.gPoint,Ee.direction=Math.atan2(Ee.currentPos.y-we.lastPos.y,Ee.currentPos.x-we.lastPos.x),be=we.lastPos.distanceTo(Ee.currentPos),we.lastPos=Ee.currentPos,xe=1e3*be/(Ce+1),Ee.speed=.75*xe+.25*Ee.speed},ne=function(he,ge){var we=_(he,ge);P.push({guid:we,gPoint:ge,lastPos:ge.currentPos}),P.length===1&&(A=t.now(),S=window.setInterval(Y,50))},pe=function(he,ge){var we=_(he,ge),Ee,Pe=P.length;for(Ee=0;Ee<Pe;Ee++)if(P[Ee].guid===we){P.splice(Ee,1),Pe--,Pe===0&&window.clearInterval(S);break}};return{addPoint:ne,removePoint:pe}}(),t.MouseTracker.captureElement=document,t.MouseTracker.wheelEventName=t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",t.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",t.MouseTracker.wheelEventName],t.MouseTracker.wheelEventName==="DOMMouseScroll"&&t.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),t.MouseTracker.havePointerCapture=function(){var P=document.createElement("div");return t.isFunction(P.setPointerCapture)&&t.isFunction(P.releasePointerCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(t.MouseTracker.havePointerEvents=!1,t.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),t.MouseTracker.mousePointerId="legacy-mouse",t.MouseTracker.havePointerCapture=function(){var P=document.createElement("div");return t.isFunction(P.setCapture)&&t.isFunction(P.releaseCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&t.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&t.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),t.MouseTracker.GesturePointList=function(P){this._gPoints=[],this.type=P,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},t.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(P){return this._gPoints.push(P)},removeById:function(P){var S,A=this._gPoints.length;for(S=0;S<A;S++)if(this._gPoints[S].id===P){this._gPoints.splice(S,1);break}return this._gPoints.length},getByIndex:function(P){return P<this._gPoints.length?this._gPoints[P]:null},getById:function(P){var S,A=this._gPoints.length;for(S=0;S<A;S++)if(this._gPoints[S].id===P)return this._gPoints[S];return null},getPrimary:function(P){var S,A=this._gPoints.length;for(S=0;S<A;S++)if(this._gPoints[S].isPrimary)return this._gPoints[S];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(t.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function o(P){var S=i[P.hash],A,_,Y,ne,pe,he=S.activePointersLists.length;for(A=0;A<he;A++)if(Y=S.activePointersLists[A],Y.getLength()>0){for(pe=[],ne=Y.asArray(),_=0;_<ne.length;_++)pe.push(ne[_]);for(_=0;_<pe.length;_++)z(P,Y,pe[_])}for(A=0;A<he;A++)S.activePointersLists.pop();S.sentDragEvent=!1}function s(P){var S=i[P.hash],A,_;if(!S.tracking){for(_=0;_<t.MouseTracker.subscribeEvents.length;_++)A=t.MouseTracker.subscribeEvents[_],t.addEvent(P.element,A,S[A],A===t.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);o(P),S.tracking=!0}}function l(P){var S=i[P.hash],A,_;if(S.tracking){for(_=0;_<t.MouseTracker.subscribeEvents.length;_++)A=t.MouseTracker.subscribeEvents[_],t.removeEvent(P.element,A,S[A],!1);o(P),S.tracking=!1}}function u(P,S){var A=i[P.hash];if(S==="pointerevent")return{upName:"pointerup",upHandler:A.pointerupcaptured,moveName:"pointermove",moveHandler:A.pointermovecaptured};if(S==="mouse")return{upName:"pointerup",upHandler:A.pointerupcaptured,moveName:"pointermove",moveHandler:A.pointermovecaptured};if(S==="touch")return{upName:"touchend",upHandler:A.touchendcaptured,moveName:"touchmove",moveHandler:A.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function h(P,S){var A;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents)try{P.element.setPointerCapture(S.id)}catch{t.console.warn("setPointerCapture() called on invalid pointer ID");return}else P.element.setCapture(!0);else A=u(P,t.MouseTracker.havePointerEvents?"pointerevent":S.type),n&&a(window.top)&&t.addEvent(window.top,A.upName,A.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,A.upName,A.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,A.moveName,A.moveHandler,!0);K(P,S,!0)}function f(P,S){var A,_,Y;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents){if(_=P.getActivePointersListByType(S.type),Y=_.getById(S.id),!Y||!Y.captured)return;try{P.element.releasePointerCapture(S.id)}catch{}}else P.element.releaseCapture();else A=u(P,t.MouseTracker.havePointerEvents?"pointerevent":S.type),n&&a(window.top)&&t.removeEvent(window.top,A.upName,A.upHandler,!0),t.removeEvent(t.MouseTracker.captureElement,A.moveName,A.moveHandler,!0),t.removeEvent(t.MouseTracker.captureElement,A.upName,A.upHandler,!0);K(P,S,!1)}function d(P){return t.MouseTracker.havePointerEvents?P.pointerId:t.MouseTracker.mousePointerId}function c(P){return t.MouseTracker.havePointerEvents?P.pointerType||(t.Browser.vendor===t.BROWSERS.IE?"mouse":""):"mouse"}function v(P){return t.MouseTracker.havePointerEvents?P.isPrimary:!0}function g(P){return t.getMousePosition(P)}function m(P,S){return p(g(P),S)}function p(P,S){var A=t.getElementOffset(S);return P.minus(A)}function y(P,S){return new t.Point((P.x+S.x)/2,(P.y+S.y)/2)}function w(P,S){var A={originalEvent:S,eventType:"click",pointerType:"mouse",isEmulated:!1};te(P,A),A.preventDefault&&!A.defaultPrevented&&t.cancelEvent(S),A.stopPropagation&&t.stopEvent(S)}function T(P,S){var A={originalEvent:S,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};te(P,A),A.preventDefault&&!A.defaultPrevented&&t.cancelEvent(S),A.stopPropagation&&t.stopEvent(S)}function O(P,S){var A=null,_={originalEvent:S,eventType:"keydown",pointerType:"",isEmulated:!1};te(P,_),P.keyDownHandler&&!_.preventGesture&&!_.defaultPrevented&&(A={eventSource:P,keyCode:S.keyCode?S.keyCode:S.charCode,ctrl:S.ctrlKey,shift:S.shiftKey,alt:S.altKey,meta:S.metaKey,originalEvent:S,preventDefault:_.preventDefault||_.defaultPrevented,userData:P.userData},P.keyDownHandler(A)),(A&&A.preventDefault||_.preventDefault&&!_.defaultPrevented)&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function I(P,S){var A=null,_={originalEvent:S,eventType:"keyup",pointerType:"",isEmulated:!1};te(P,_),P.keyUpHandler&&!_.preventGesture&&!_.defaultPrevented&&(A={eventSource:P,keyCode:S.keyCode?S.keyCode:S.charCode,ctrl:S.ctrlKey,shift:S.shiftKey,alt:S.altKey,meta:S.metaKey,originalEvent:S,preventDefault:_.preventDefault||_.defaultPrevented,userData:P.userData},P.keyUpHandler(A)),(A&&A.preventDefault||_.preventDefault&&!_.defaultPrevented)&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function R(P,S){var A=null,_={originalEvent:S,eventType:"keypress",pointerType:"",isEmulated:!1};te(P,_),P.keyHandler&&!_.preventGesture&&!_.defaultPrevented&&(A={eventSource:P,keyCode:S.keyCode?S.keyCode:S.charCode,ctrl:S.ctrlKey,shift:S.shiftKey,alt:S.altKey,meta:S.metaKey,originalEvent:S,preventDefault:_.preventDefault||_.defaultPrevented,userData:P.userData},P.keyHandler(A)),(A&&A.preventDefault||_.preventDefault&&!_.defaultPrevented)&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function L(P,S){var A={originalEvent:S,eventType:"focus",pointerType:"",isEmulated:!1};te(P,A),P.focusHandler&&!A.preventGesture&&P.focusHandler({eventSource:P,originalEvent:S,userData:P.userData})}function N(P,S){var A={originalEvent:S,eventType:"blur",pointerType:"",isEmulated:!1};te(P,A),P.blurHandler&&!A.preventGesture&&P.blurHandler({eventSource:P,originalEvent:S,userData:P.userData})}function E(P,S){var A=null,_={originalEvent:S,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};te(P,_),P.contextMenuHandler&&!_.preventGesture&&!_.defaultPrevented&&(A={eventSource:P,position:p(g(S),P.element),originalEvent:_.originalEvent,preventDefault:_.preventDefault||_.defaultPrevented,userData:P.userData},P.contextMenuHandler(A)),(A&&A.preventDefault||_.preventDefault&&!_.defaultPrevented)&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function C(P,S){M(P,S,S)}function b(P,S){var A={target:S.target||S.srcElement,type:"wheel",shiftKey:S.shiftKey||!1,clientX:S.clientX,clientY:S.clientY,pageX:S.pageX?S.pageX:S.clientX,pageY:S.pageY?S.pageY:S.clientY,deltaMode:S.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};t.MouseTracker.wheelEventName==="mousewheel"?A.deltaY=-S.wheelDelta/t.DEFAULT_SETTINGS.pixelsPerWheelLine:A.deltaY=S.detail,M(P,A,S)}function M(P,S,A){var _=0,Y,ne=null;_=S.deltaY<0?1:-1,Y={originalEvent:S,eventType:"wheel",pointerType:"mouse",isEmulated:S!==A},te(P,Y),P.scrollHandler&&!Y.preventGesture&&!Y.defaultPrevented&&(ne={eventSource:P,pointerType:"mouse",position:m(S,P.element),scroll:_,shift:S.shiftKey,isTouchEvent:!1,originalEvent:A,preventDefault:Y.preventDefault||Y.defaultPrevented,userData:P.userData},P.scrollHandler(ne)),Y.stopPropagation&&t.stopEvent(A),(ne&&ne.preventDefault||Y.preventDefault&&!Y.defaultPrevented)&&t.cancelEvent(A)}function D(P,S){var A={id:t.MouseTracker.mousePointerId,type:"mouse"},_={originalEvent:S,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};te(P,_),S.target===P.element&&K(P,A,!1),_.stopPropagation&&t.stopEvent(S)}function H(P,S){var A,_,Y=S.changedTouches.length,ne,pe=P.getActivePointersListByType("touch");A=t.now(),pe.getLength()>S.touches.length-Y&&t.console.warn("Tracked touch contact count doesn't match event.touches.length");var he={originalEvent:S,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(te(P,he),_=0;_<Y;_++)ne={id:S.changedTouches[_].identifier,type:"touch",isPrimary:pe.getLength()===0,currentPos:g(S.changedTouches[_]),currentTime:A},le(P,he,ne),F(P,he,ne,0),K(P,ne,!0);he.preventDefault&&!he.defaultPrevented&&t.cancelEvent(S),he.stopPropagation&&t.stopEvent(S)}function k(P,S){var A,_,Y=S.changedTouches.length,ne;A=t.now();var pe={originalEvent:S,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(te(P,pe),_=0;_<Y;_++)ne={id:S.changedTouches[_].identifier,type:"touch",currentPos:g(S.changedTouches[_]),currentTime:A},Q(P,pe,ne,0),K(P,ne,!1),fe(P,pe,ne);pe.preventDefault&&!pe.defaultPrevented&&t.cancelEvent(S),pe.stopPropagation&&t.stopEvent(S)}function B(P,S){var A,_,Y=S.changedTouches.length,ne;A=t.now();var pe={originalEvent:S,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(te(P,pe),_=0;_<Y;_++)ne={id:S.changedTouches[_].identifier,type:"touch",currentPos:g(S.changedTouches[_]),currentTime:A},ue(P,pe,ne);pe.preventDefault&&!pe.defaultPrevented&&t.cancelEvent(S),pe.stopPropagation&&t.stopEvent(S)}function U(P,S){var A=S.changedTouches.length,_,Y,ne={originalEvent:S,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(te(P,ne),_=0;_<A;_++)Y={id:S.changedTouches[_].identifier,type:"touch"},oe(P,ne,Y);ne.stopPropagation&&t.stopEvent(S)}function W(P,S){return t.eventIsCanceled(S)||S.preventDefault(),!1}function J(P,S){return t.eventIsCanceled(S)||S.preventDefault(),!1}function G(P,S){var A={originalEvent:S,eventType:"gotpointercapture",pointerType:c(S),isEmulated:!1};te(P,A),S.target===P.element&&K(P,{id:S.pointerId,type:c(S)},!0),A.stopPropagation&&t.stopEvent(S)}function X(P,S){var A={originalEvent:S,eventType:"lostpointercapture",pointerType:c(S),isEmulated:!1};te(P,A),S.target===P.element&&K(P,{id:S.pointerId,type:c(S)},!1),A.stopPropagation&&t.stopEvent(S)}function ie(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_={originalEvent:S,eventType:"pointerenter",pointerType:A.type,isEmulated:!1};te(P,_),le(P,_,A)}function ee(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_={originalEvent:S,eventType:"pointerleave",pointerType:A.type,isEmulated:!1};te(P,_),fe(P,_,A)}function q(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_={originalEvent:S,eventType:"pointerover",pointerType:A.type,isEmulated:!1};te(P,_),me(P,_,A),_.preventDefault&&!_.defaultPrevented&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function $(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_={originalEvent:S,eventType:"pointerout",pointerType:A.type,isEmulated:!1};te(P,_),se(P,_,A),_.preventDefault&&!_.defaultPrevented&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function V(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_=t.MouseTracker.havePointerEvents&&A.type==="touch"&&t.Browser.vendor!==t.BROWSERS.IE,Y={originalEvent:S,eventType:"pointerdown",pointerType:A.type,isEmulated:!1};te(P,Y),F(P,Y,A,S.button),Y.preventDefault&&!Y.defaultPrevented&&t.cancelEvent(S),Y.stopPropagation&&t.stopEvent(S),Y.shouldCapture&&(_?K(P,A,!0):h(P,A))}function re(P,S){de(P,S)}function ae(P,S){var A=P.getActivePointersListByType(c(S));A.getById(S.pointerId)&&de(P,S),t.stopEvent(S)}function de(P,S){var A;A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()};var _={originalEvent:S,eventType:"pointerup",pointerType:A.type,isEmulated:!1};te(P,_),Q(P,_,A,S.button),_.preventDefault&&!_.defaultPrevented&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S),_.shouldReleaseCapture&&(S.target===P.element?f(P,A):K(P,A,!1))}function ye(P,S){Oe(P,S)}function Te(P,S){var A=P.getActivePointersListByType(c(S));A.getById(S.pointerId)&&Oe(P,S),t.stopEvent(S)}function Oe(P,S){var A={id:d(S),type:c(S),isPrimary:v(S),currentPos:g(S),currentTime:t.now()},_={originalEvent:S,eventType:"pointermove",pointerType:A.type,isEmulated:!1};te(P,_),ue(P,_,A),_.preventDefault&&!_.defaultPrevented&&t.cancelEvent(S),_.stopPropagation&&t.stopEvent(S)}function ce(P,S){var A={id:S.pointerId,type:c(S)},_={originalEvent:S,eventType:"pointercancel",pointerType:A.type,isEmulated:!1};te(P,_),oe(P,_,A),_.stopPropagation&&t.stopEvent(S)}function x(P,S){return S.speed=0,S.direction=0,S.contactPos=S.currentPos,S.contactTime=S.currentTime,S.lastPos=S.currentPos,S.lastTime=S.currentTime,P.add(S)}function z(P,S,A){var _,Y=S.getById(A.id);return Y?(Y.captured&&(t.console.warn("stopTrackingPointer() called on captured pointer"),f(P,Y)),S.removeContact(),_=S.removeById(A.id)):_=S.getLength(),_}function j(P,S){switch(S.eventType){case"pointermove":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!1,S.preventGesture=!P.hasGestureHandlers,S.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!1,S.preventGesture=!1,S.stopPropagation=!1;break;case"pointerdown":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!1,S.preventGesture=!P.hasGestureHandlers,S.stopPropagation=!1;break;case"pointerup":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!1,S.preventGesture=!P.hasGestureHandlers,S.stopPropagation=!1;break;case"wheel":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!1,S.preventGesture=!P.hasScrollHandler,S.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":S.isStoppable=!0,S.isCancelable=!1,S.preventDefault=!1,S.preventGesture=!1,S.stopPropagation=!1;break;case"click":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!!P.clickHandler,S.preventGesture=!1,S.stopPropagation=!1;break;case"dblclick":S.isStoppable=!0,S.isCancelable=!0,S.preventDefault=!!P.dblClickHandler,S.preventGesture=!1,S.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:S.isStoppable=!1,S.isCancelable=!1,S.preventDefault=!1,S.preventGesture=!1,S.stopPropagation=!1;break}}function te(P,S){S.eventSource=P,S.eventPhase=S.originalEvent&&typeof S.originalEvent.eventPhase<"u"?S.originalEvent.eventPhase:0,S.defaultPrevented=t.eventIsCanceled(S.originalEvent),S.shouldCapture=!1,S.shouldReleaseCapture=!1,S.userData=P.userData,j(P,S),P.preProcessEventHandler&&P.preProcessEventHandler(S)}function K(P,S,A){var _=P.getActivePointersListByType(S.type),Y=_.getById(S.id);Y?A&&!Y.captured?(Y.captured=!0,_.captureCount++):!A&&Y.captured&&(Y.captured=!1,_.captureCount--,_.captureCount<0&&(_.captureCount=0,t.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):t.console.warn("updatePointerCaptured() called on untracked pointer")}function le(P,S,A){var _=P.getActivePointersListByType(A.type),Y;Y=_.getById(A.id),Y?(Y.insideElement=!0,Y.lastPos=Y.currentPos,Y.lastTime=Y.currentTime,Y.currentPos=A.currentPos,Y.currentTime=A.currentTime,A=Y):(A.captured=!1,A.insideElementPressed=!1,A.insideElement=!0,x(_,A)),P.enterHandler&&P.enterHandler({eventSource:P,pointerType:A.type,position:p(A.currentPos,P.element),buttons:_.buttons,pointers:P.getActivePointerCount(),insideElementPressed:A.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData})}function fe(P,S,A){var _=P.getActivePointersListByType(A.type),Y,ne;Y=_.getById(A.id),Y?(Y.captured?(Y.insideElement=!1,Y.lastPos=Y.currentPos,Y.lastTime=Y.currentTime,Y.currentPos=A.currentPos,Y.currentTime=A.currentTime):z(P,_,Y),A=Y):(A.captured=!1,A.insideElementPressed=!1),(P.leaveHandler||P.exitHandler)&&(ne={eventSource:P,pointerType:A.type,position:A.currentPos&&p(A.currentPos,P.element),buttons:_.buttons,pointers:P.getActivePointerCount(),insideElementPressed:A.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData},P.leaveHandler&&P.leaveHandler(ne),P.exitHandler&&P.exitHandler(ne))}function me(P,S,A){var _,Y;_=P.getActivePointersListByType(A.type),Y=_.getById(A.id),Y?A=Y:(A.captured=!1,A.insideElementPressed=!1),P.overHandler&&P.overHandler({eventSource:P,pointerType:A.type,position:p(A.currentPos,P.element),buttons:_.buttons,pointers:P.getActivePointerCount(),insideElementPressed:A.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData})}function se(P,S,A){var _,Y;_=P.getActivePointersListByType(A.type),Y=_.getById(A.id),Y?A=Y:(A.captured=!1,A.insideElementPressed=!1),P.outHandler&&P.outHandler({eventSource:P,pointerType:A.type,position:A.currentPos&&p(A.currentPos,P.element),buttons:_.buttons,pointers:P.getActivePointerCount(),insideElementPressed:A.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData})}function F(P,S,A,_){var Y=i[P.hash],ne=P.getActivePointersListByType(A.type),pe;if(typeof S.originalEvent.buttons<"u"?ne.buttons=S.originalEvent.buttons:_===0?ne.buttons|=1:_===1?ne.buttons|=4:_===2?ne.buttons|=2:_===3?ne.buttons|=8:_===4?ne.buttons|=16:_===5&&(ne.buttons|=32),_!==0){S.shouldCapture=!1,S.shouldReleaseCapture=!1,P.nonPrimaryPressHandler&&!S.preventGesture&&!S.defaultPrevented&&(S.preventDefault=!0,P.nonPrimaryPressHandler({eventSource:P,pointerType:A.type,position:p(A.currentPos,P.element),button:_,buttons:ne.buttons,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData}));return}pe=ne.getById(A.id),pe?(pe.insideElementPressed=!0,pe.insideElement=!0,pe.originalTarget=S.originalEvent.target,pe.contactPos=A.currentPos,pe.contactTime=A.currentTime,pe.lastPos=pe.currentPos,pe.lastTime=pe.currentTime,pe.currentPos=A.currentPos,pe.currentTime=A.currentTime,A=pe):(A.captured=!1,A.insideElementPressed=!0,A.insideElement=!0,A.originalTarget=S.originalEvent.target,x(ne,A)),ne.addContact(),!S.preventGesture&&!S.defaultPrevented?(S.shouldCapture=!0,S.shouldReleaseCapture=!1,S.preventDefault=!0,(P.dragHandler||P.dragEndHandler||P.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.addPoint(P,A),ne.contacts===1?P.pressHandler&&!S.preventGesture&&P.pressHandler({eventSource:P,pointerType:A.type,position:p(A.contactPos,P.element),buttons:ne.buttons,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData}):ne.contacts===2&&P.pinchHandler&&A.type==="touch"&&(Y.pinchGPoints=ne.asArray(),Y.lastPinchDist=Y.currentPinchDist=Y.pinchGPoints[0].currentPos.distanceTo(Y.pinchGPoints[1].currentPos),Y.lastPinchCenter=Y.currentPinchCenter=y(Y.pinchGPoints[0].currentPos,Y.pinchGPoints[1].currentPos))):(S.shouldCapture=!1,S.shouldReleaseCapture=!1)}function Q(P,S,A,_){var Y=i[P.hash],ne=P.getActivePointersListByType(A.type),pe,he,ge,we=!1,Ee;if(typeof S.originalEvent.buttons<"u"?ne.buttons=S.originalEvent.buttons:_===0?ne.buttons^=-2:_===1?ne.buttons^=-5:_===2?ne.buttons^=-3:_===3?ne.buttons^=-9:_===4?ne.buttons^=-17:_===5&&(ne.buttons^=-33),S.shouldCapture=!1,_!==0){S.shouldReleaseCapture=!1,P.nonPrimaryReleaseHandler&&!S.preventGesture&&!S.defaultPrevented&&(S.preventDefault=!0,P.nonPrimaryReleaseHandler({eventSource:P,pointerType:A.type,position:p(A.currentPos,P.element),button:_,buttons:ne.buttons,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData}));return}ge=ne.getById(A.id),ge?(ne.removeContact(),ge.captured&&(we=!0),ge.lastPos=ge.currentPos,ge.lastTime=ge.currentTime,ge.currentPos=A.currentPos,ge.currentTime=A.currentTime,ge.insideElement||z(P,ne,ge),pe=ge.currentPos,he=ge.currentTime):(A.captured=!1,A.insideElementPressed=!1,A.insideElement=!0,x(ne,A),ge=A),!S.preventGesture&&!S.defaultPrevented&&(we?(S.shouldReleaseCapture=!0,S.preventDefault=!0,(P.dragHandler||P.dragEndHandler||P.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.removePoint(P,ge),ne.contacts===0?(P.releaseHandler&&pe&&P.releaseHandler({eventSource:P,pointerType:ge.type,position:p(pe,P.element),buttons:ne.buttons,insideElementPressed:ge.insideElementPressed,insideElementReleased:ge.insideElement,isTouchEvent:ge.type==="touch",originalEvent:S.originalEvent,userData:P.userData}),P.dragEndHandler&&Y.sentDragEvent&&P.dragEndHandler({eventSource:P,pointerType:ge.type,position:p(ge.currentPos,P.element),speed:ge.speed,direction:ge.direction,shift:S.originalEvent.shiftKey,isTouchEvent:ge.type==="touch",originalEvent:S.originalEvent,userData:P.userData}),Y.sentDragEvent=!1,(P.clickHandler||P.dblClickHandler)&&ge.insideElement&&(Ee=he-ge.contactTime<=P.clickTimeThreshold&&ge.contactPos.distanceTo(pe)<=P.clickDistThreshold,P.clickHandler&&P.clickHandler({eventSource:P,pointerType:ge.type,position:p(ge.currentPos,P.element),quick:Ee,shift:S.originalEvent.shiftKey,isTouchEvent:ge.type==="touch",originalEvent:S.originalEvent,originalTarget:ge.originalTarget,userData:P.userData}),P.dblClickHandler&&Ee&&(ne.clicks++,ne.clicks===1?(Y.lastClickPos=pe,Y.dblClickTimeOut=setTimeout(function(){ne.clicks=0},P.dblClickTimeThreshold)):ne.clicks===2&&(clearTimeout(Y.dblClickTimeOut),ne.clicks=0,Y.lastClickPos.distanceTo(pe)<=P.dblClickDistThreshold&&P.dblClickHandler({eventSource:P,pointerType:ge.type,position:p(ge.currentPos,P.element),shift:S.originalEvent.shiftKey,isTouchEvent:ge.type==="touch",originalEvent:S.originalEvent,userData:P.userData}),Y.lastClickPos=null)))):ne.contacts===2&&P.pinchHandler&&ge.type==="touch"&&(Y.pinchGPoints=ne.asArray(),Y.lastPinchDist=Y.currentPinchDist=Y.pinchGPoints[0].currentPos.distanceTo(Y.pinchGPoints[1].currentPos),Y.lastPinchCenter=Y.currentPinchCenter=y(Y.pinchGPoints[0].currentPos,Y.pinchGPoints[1].currentPos))):(S.shouldReleaseCapture=!1,P.releaseHandler&&pe&&(P.releaseHandler({eventSource:P,pointerType:ge.type,position:p(pe,P.element),buttons:ne.buttons,insideElementPressed:ge.insideElementPressed,insideElementReleased:ge.insideElement,isTouchEvent:ge.type==="touch",originalEvent:S.originalEvent,userData:P.userData}),S.preventDefault=!0)))}function ue(P,S,A){var _=i[P.hash],Y=P.getActivePointersListByType(A.type),ne,pe,he;if(typeof S.originalEvent.buttons<"u"&&(Y.buttons=S.originalEvent.buttons),ne=Y.getById(A.id),ne)ne.lastPos=ne.currentPos,ne.lastTime=ne.currentTime,ne.currentPos=A.currentPos,ne.currentTime=A.currentTime;else return;S.shouldCapture=!1,S.shouldReleaseCapture=!1,P.stopHandler&&A.type==="mouse"&&(clearTimeout(P.stopTimeOut),P.stopTimeOut=setTimeout(function(){Z(P,S.originalEvent,A.type)},P.stopDelay)),Y.contacts===0?P.moveHandler&&P.moveHandler({eventSource:P,pointerType:A.type,position:p(A.currentPos,P.element),buttons:Y.buttons,isTouchEvent:A.type==="touch",originalEvent:S.originalEvent,userData:P.userData}):Y.contacts===1?(P.moveHandler&&(ne=Y.asArray()[0],P.moveHandler({eventSource:P,pointerType:ne.type,position:p(ne.currentPos,P.element),buttons:Y.buttons,isTouchEvent:ne.type==="touch",originalEvent:S.originalEvent,userData:P.userData})),P.dragHandler&&!S.preventGesture&&!S.defaultPrevented&&(ne=Y.asArray()[0],he=ne.currentPos.minus(ne.lastPos),P.dragHandler({eventSource:P,pointerType:ne.type,position:p(ne.currentPos,P.element),buttons:Y.buttons,delta:he,speed:ne.speed,direction:ne.direction,shift:S.originalEvent.shiftKey,isTouchEvent:ne.type==="touch",originalEvent:S.originalEvent,userData:P.userData}),S.preventDefault=!0,_.sentDragEvent=!0)):Y.contacts===2&&(P.moveHandler&&(pe=Y.asArray(),P.moveHandler({eventSource:P,pointerType:pe[0].type,position:p(y(pe[0].currentPos,pe[1].currentPos),P.element),buttons:Y.buttons,isTouchEvent:pe[0].type==="touch",originalEvent:S.originalEvent,userData:P.userData})),P.pinchHandler&&A.type==="touch"&&!S.preventGesture&&!S.defaultPrevented&&(he=_.pinchGPoints[0].currentPos.distanceTo(_.pinchGPoints[1].currentPos),he!==_.currentPinchDist&&(_.lastPinchDist=_.currentPinchDist,_.currentPinchDist=he,_.lastPinchCenter=_.currentPinchCenter,_.currentPinchCenter=y(_.pinchGPoints[0].currentPos,_.pinchGPoints[1].currentPos),P.pinchHandler({eventSource:P,pointerType:"touch",gesturePoints:_.pinchGPoints,lastCenter:p(_.lastPinchCenter,P.element),center:p(_.currentPinchCenter,P.element),lastDistance:_.lastPinchDist,distance:_.currentPinchDist,shift:S.originalEvent.shiftKey,originalEvent:S.originalEvent,userData:P.userData}),S.preventDefault=!0)))}function oe(P,S,A){var _=P.getActivePointersListByType(A.type),Y;Y=_.getById(A.id),Y&&z(P,_,Y)}function Z(P,S,A){P.stopHandler&&P.stopHandler({eventSource:P,pointerType:A,position:m(S,P.element),buttons:P.getActivePointersListByType(A).buttons,isTouchEvent:A==="touch",originalEvent:S,userData:P.userData})}}(e),function(t){t.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},t.Control=function(i,n,a){var o=i.parentNode;typeof n=="number"&&(t.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),n={anchor:n}),n.attachToViewer=typeof n.attachToViewer>"u"?!0:n.attachToViewer,this.autoFade=typeof n.autoFade>"u"?!0:n.autoFade,this.element=i,this.anchor=n.anchor,this.container=a,this.anchor===t.ControlAnchor.ABSOLUTE?(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof n.top=="number"?n.top+"px":n.top,this.wrapper.style.left=typeof n.left=="number"?n.left+"px":n.left,this.wrapper.style.height=typeof n.height=="number"?n.height+"px":n.height,this.wrapper.style.width=typeof n.width=="number"?n.width+"px":n.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===t.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),n.attachToViewer?this.anchor===t.ControlAnchor.TOP_RIGHT||this.anchor===t.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},t.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==t.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(i){this.wrapper.style.display=i?this.anchor===t.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(i){this.element[t.SIGNAL]&&t.Browser.vendor===t.BROWSERS.IE?t.setElementOpacity(this.element,i,!0):t.setElementOpacity(this.wrapper,i,!0)}}}(e),function(t){t.ControlDock=function(n){var a=["topleft","topright","bottomright","bottomleft"],o,s;for(t.extend(!0,this,{id:"controldock-"+t.now()+"-"+Math.floor(Math.random()*1e6),container:t.makeNeutralElement("div"),controls:[]},n),this.container.onsubmit=function(){return!1},this.element&&(this.element=t.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),s=0;s<a.length;s++)o=a[s],this.controls[o]=t.makeNeutralElement("div"),this.controls[o].style.position="absolute",o.match("left")&&(this.controls[o].style.left="0px"),o.match("right")&&(this.controls[o].style.right="0px"),o.match("top")&&(this.controls[o].style.top="0px"),o.match("bottom")&&(this.controls[o].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},t.ControlDock.prototype={addControl:function(n,a){n=t.getElement(n);var o=null;if(!(i(this,n)>=0)){switch(a.anchor){case t.ControlAnchor.TOP_RIGHT:o=this.controls.topright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingTop="0px";break;case t.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingBottom="0px";break;case t.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingBottom="0px";break;case t.ControlAnchor.TOP_LEFT:o=this.controls.topleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingTop="0px";break;case t.ControlAnchor.ABSOLUTE:o=this.container,n.style.margin="0px",n.style.padding="0px";break;default:case t.ControlAnchor.NONE:o=this.container,n.style.margin="0px",n.style.padding="0px";break}this.controls.push(new t.Control(n,a,o)),n.style.display="inline-block"}},removeControl:function(n){n=t.getElement(n);var a=i(this,n);return a>=0&&(this.controls[a].destroy(),this.controls.splice(a,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var n;for(n=this.controls.length-1;n>=0;n--)if(this.controls[n].isVisible())return!0;return!1},setControlsEnabled:function(n){var a;for(a=this.controls.length-1;a>=0;a--)this.controls[a].setVisible(n);return this}};function i(n,a){var o=n.controls,s;for(s=o.length-1;s>=0;s--)if(o[s].element===a)return s;return-1}}(e),function(t){t.Placement=t.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(e),function(t){var i={},n=1;t.Viewer=function(x){var z=arguments,j=this,te;if(t.isPlainObject(x)||(x={id:z[0],xmlPath:z.length>1?z[1]:void 0,prefixUrl:z.length>2?z[2]:void 0,controls:z.length>3?z[3]:void 0,overlays:z.length>4?z[4]:void 0}),x.config&&(t.extend(!0,x,x.config),delete x.config),t.extend(!0,this,{id:x.id,hash:x.hash||n++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},t.DEFAULT_SETTINGS,x),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof i[this.hash]<"u"&&t.console.warn("Hash "+this.hash+" has already been used."),i[this.hash]={fsBoundsDelta:new t.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=t.now(),t.EventSource.call(this),this.addHandler("open-failed",function(K){var le=t.getString("Errors.OpenFailed",K.eventSource,K.message);j._showMessage(le)}),t.ControlDock.call(this,x),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=t.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(K){K.width="100%",K.height="100%",K.overflow="hidden",K.position="absolute",K.top="0px",K.left="0px"}(this.canvas.style),t.setElementTouchActionNone(this.canvas),x.tabIndex!==""&&(this.canvas.tabIndex=x.tabIndex===void 0?0:x.tabIndex),this.container.className="openseadragon-container",function(K){K.width="100%",K.height="100%",K.position="relative",K.overflow="hidden",K.left="0px",K.top="0px",K.textAlign="left"}(this.container.style),t.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new t.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:t.delegate(this,m),keyDownHandler:t.delegate(this,p),keyHandler:t.delegate(this,y),clickHandler:t.delegate(this,w),dblClickHandler:t.delegate(this,T),dragHandler:t.delegate(this,O),dragEndHandler:t.delegate(this,I),enterHandler:t.delegate(this,R),leaveHandler:t.delegate(this,L),pressHandler:t.delegate(this,N),releaseHandler:t.delegate(this,E),nonPrimaryPressHandler:t.delegate(this,C),nonPrimaryReleaseHandler:t.delegate(this,b),scrollHandler:t.delegate(this,D),pinchHandler:t.delegate(this,M)}),this.outerTracker=new t.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:t.delegate(this,H),leaveHandler:t.delegate(this,k)}),this.toolbar&&(this.toolbar=new t.ControlDock({element:this.toolbar})),this.bindStandardControls(),i[this.hash].prevContainerSize=a(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){i[j.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new t.World({viewer:this}),this.world.addHandler("add-item",function(K){j.source=j.world.getItemAt(0).source,i[j.hash].forceRedraw=!0,j._updateRequestId||(j._updateRequestId=u(j,B))}),this.world.addHandler("remove-item",function(K){j.world.getItemCount()?j.source=j.world.getItemAt(0).source:j.source=null,i[j.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(K){j.viewport&&j.viewport._setContentBounds(j.world.getHomeBounds(),j.world.getContentFactor())}),this.world.addHandler("item-index-change",function(K){j.source=j.world.getItemAt(0).source}),this.viewport=new t.Viewport({containerSize:i[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new t.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:x.timeout}),this.tileCache=new t.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new t.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=t.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(te=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(te,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(te=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(te,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new t.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),te=0;te<this.customControls.length;te++)this.addControl(this.customControls[te].id,{anchor:this.customControls[te].anchor});t.requestAnimationFrame(function(){f(j)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),t._viewers.set(this.element,this)},t.extend(t.Viewer.prototype,t.EventSource.prototype,t.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(x){return t.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(x)},openTileSource:function(x){return t.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(x)},get buttons(){return t.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(x,z){var j=this;if(this.close(),!x)return this;if(this.sequenceMode&&t.isArray(x))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof z<"u"&&!isNaN(z)&&(this.initialPage=z),this.tileSources=x,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(t.isArray(x)||(x=[x]),!x.length)return this;this._opening=!0;for(var te=x.length,K=0,le=0,fe,me=function(){if(K+le===te)if(K){(j._firstOpen||!j.preserveViewport)&&(j.viewport.goHome(!0),j.viewport.update()),j._firstOpen=!1;var Q=x[0];if(Q.tileSource&&(Q=Q.tileSource),j.overlays&&!j.preserveOverlays)for(var ue=0;ue<j.overlays.length;ue++)j.currentOverlays[ue]=s(j,j.overlays[ue]);j._drawOverlays(),j._opening=!1,j.raiseEvent("open",{source:Q})}else j._opening=!1,j.raiseEvent("open-failed",fe)},se=function(Q){(!t.isPlainObject(Q)||!Q.tileSource)&&(Q={tileSource:Q}),Q.index!==void 0&&(t.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete Q.index),Q.collectionImmediately===void 0&&(Q.collectionImmediately=!0);var ue=Q.success;Q.success=function(Z){if(K++,Q.tileSource.overlays)for(var P=0;P<Q.tileSource.overlays.length;P++)j.addOverlay(Q.tileSource.overlays[P]);ue&&ue(Z),me()};var oe=Q.error;Q.error=function(Z){le++,fe||(fe=Z),oe&&oe(Z),me()},j.addTiledImage(Q)},F=0;F<x.length;F++)se(x[F]);return this},close:function(){return i[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),i[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(!!i[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(t.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),i[this.navigator.hash]=null,delete i[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),i[this.hash]=null,delete i[this.hash],this.canvas=null,this.container=null,t._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(x){return this.innerTracker.setTracking(x),this.outerTracker.setTracking(x),this.raiseEvent("mouse-enabled",{enabled:x}),this},areControlsEnabled:function(){var x=this.controls.length,z;for(z=0;z<this.controls.length;z++)x=x&&this.controls[z].isVisible();return x},setControlsEnabled:function(x){return x?c(this):f(this),this.raiseEvent("controls-enabled",{enabled:x}),this},setDebugMode:function(x){for(var z=0;z<this.world.getItemCount();z++)this.world.getItemAt(z).debugMode=x;this.debugMode=x,this.forceRedraw()},isFullPage:function(){return i[this.hash].fullPage},setFullPage:function(x){var z=document.body,j=z.style,te=document.documentElement.style,K=this,le,fe;if(x===this.isFullPage())return this;var me={fullPage:x,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",me),me.preventDefaultAction)return this;if(x){for(this.elementSize=t.getElementSize(this.element),this.pageScroll=t.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=j.margin,this.docMargin=te.margin,j.margin="0",te.margin="0",this.bodyPadding=j.padding,this.docPadding=te.padding,j.padding="0",te.padding="0",this.bodyWidth=j.width,this.docWidth=te.width,j.width="100%",te.width="100%",this.bodyHeight=j.height,this.docHeight=te.height,j.height="100%",te.height="100%",this.bodyDisplay=j.display,j.display="block",this.previousBody=[],i[this.hash].prevElementParent=this.element.parentNode,i[this.hash].prevNextSibling=this.element.nextSibling,i[this.hash].prevElementWidth=this.element.style.width,i[this.hash].prevElementHeight=this.element.style.height,le=z.childNodes.length,fe=0;fe<le;fe++)this.previousBody.push(z.childNodes[0]),z.removeChild(z.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,z.appendChild(this.toolbar.element),t.addClass(this.toolbar.element,"fullpage")),t.addClass(this.element,"fullpage"),z.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=t.getElementSize(this.element).y-t.getElementSize(this.toolbar.element).y+"px"),i[this.hash].fullPage=!0,t.delegate(this,H)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,j.margin=this.bodyMargin,te.margin=this.docMargin,j.padding=this.bodyPadding,te.padding=this.docPadding,j.width=this.bodyWidth,te.width=this.docWidth,j.height=this.bodyHeight,te.height=this.docHeight,j.display=this.bodyDisplay,z.removeChild(this.element),le=this.previousBody.length,fe=0;fe<le;fe++)z.appendChild(this.previousBody.shift());t.removeClass(this.element,"fullpage"),i[this.hash].prevElementParent.insertBefore(this.element,i[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(z.removeChild(this.toolbar.element),t.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=i[this.hash].prevElementWidth,this.element.style.height=i[this.hash].prevElementHeight;var se=0,F=function(){t.setPageScroll(K.pageScroll);var Q=t.getPageScroll();se++,se<10&&(Q.x!==K.pageScroll.x||Q.y!==K.pageScroll.y)&&t.requestAnimationFrame(F)};t.requestAnimationFrame(F),i[this.hash].fullPage=!1,t.delegate(this,k)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:x}),this},setFullScreen:function(x){var z=this;if(!t.supportsFullScreen)return this.setFullPage(x);if(t.isFullScreen()===x)return this;var j={fullScreen:x,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",j),j.preventDefaultAction)return this;if(x){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var te=function(){var K=t.isFullScreen();K||(t.removeEvent(document,t.fullScreenEventName,te),t.removeEvent(document,t.fullScreenErrorEventName,te),z.setFullPage(!1),z.isFullPage()&&(z.element.style.width=z.fullPageStyleWidth,z.element.style.height=z.fullPageStyleHeight)),z.navigator&&z.viewport&&setTimeout(function(){z.navigator.update(z.viewport)}),z.raiseEvent("full-screen",{fullScreen:K})};t.addEvent(document,t.fullScreenEventName,te),t.addEvent(document,t.fullScreenErrorEventName,te),t.requestFullScreen(document.body)}else t.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return t.isFullScreen()&&this.isFullPage()},setVisible:function(x){return this.container.style.visibility=x?"":"hidden",this.raiseEvent("visible",{visible:x}),this},addTiledImage:function(x){t.console.assert(x,"[Viewer.addTiledImage] options is required"),t.console.assert(x.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),t.console.assert(!x.replace||x.index>-1&&x.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var z=this;x.replace&&(x.replaceItem=z.world.getItemAt(x.index)),this._hideMessage(),x.placeholderFillStyle===void 0&&(x.placeholderFillStyle=this.placeholderFillStyle),x.opacity===void 0&&(x.opacity=this.opacity),x.preload===void 0&&(x.preload=this.preload),x.compositeOperation===void 0&&(x.compositeOperation=this.compositeOperation),x.crossOriginPolicy===void 0&&(x.crossOriginPolicy=x.tileSource.crossOriginPolicy!==void 0?x.tileSource.crossOriginPolicy:this.crossOriginPolicy),x.ajaxWithCredentials===void 0&&(x.ajaxWithCredentials=this.ajaxWithCredentials),x.loadTilesWithAjax===void 0&&(x.loadTilesWithAjax=this.loadTilesWithAjax),x.ajaxHeaders===void 0||x.ajaxHeaders===null?x.ajaxHeaders=this.ajaxHeaders:t.isPlainObject(x.ajaxHeaders)&&t.isPlainObject(this.ajaxHeaders)&&(x.ajaxHeaders=t.extend({},this.ajaxHeaders,x.ajaxHeaders));var j={options:x};function te(fe){for(var me=0;me<z._loadQueue.length;me++)if(z._loadQueue[me]===j){z._loadQueue.splice(me,1);break}z._loadQueue.length===0&&K(j),z.raiseEvent("add-item-failed",fe),x.error&&x.error(fe)}function K(fe){z.collectionMode&&(z.world.arrange({immediately:fe.options.collectionImmediately,rows:z.collectionRows,columns:z.collectionColumns,layout:z.collectionLayout,tileSize:z.collectionTileSize,tileMargin:z.collectionTileMargin}),z.world.setAutoRefigureSizes(!0))}if(t.isArray(x.tileSource)){setTimeout(function(){te({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:x.tileSource,options:x})});return}this._loadQueue.push(j);function le(){for(var fe,me,se;z._loadQueue.length&&(fe=z._loadQueue[0],!!fe.tileSource);){if(z._loadQueue.splice(0,1),fe.options.replace){var F=z.world.getIndexOfItem(fe.options.replaceItem);F!==-1&&(fe.options.index=F),z.world.removeItem(fe.options.replaceItem)}me=new t.TiledImage({viewer:z,source:fe.tileSource,viewport:z.viewport,drawer:z.drawer,tileCache:z.tileCache,imageLoader:z.imageLoader,x:fe.options.x,y:fe.options.y,width:fe.options.width,height:fe.options.height,fitBounds:fe.options.fitBounds,fitBoundsPlacement:fe.options.fitBoundsPlacement,clip:fe.options.clip,placeholderFillStyle:fe.options.placeholderFillStyle,opacity:fe.options.opacity,preload:fe.options.preload,degrees:fe.options.degrees,flipped:fe.options.flipped,compositeOperation:fe.options.compositeOperation,springStiffness:z.springStiffness,animationTime:z.animationTime,minZoomImageRatio:z.minZoomImageRatio,wrapHorizontal:z.wrapHorizontal,wrapVertical:z.wrapVertical,immediateRender:z.immediateRender,blendTime:z.blendTime,alwaysBlend:z.alwaysBlend,minPixelRatio:z.minPixelRatio,smoothTileEdgesMinZoom:z.smoothTileEdgesMinZoom,iOSDevice:z.iOSDevice,crossOriginPolicy:fe.options.crossOriginPolicy,ajaxWithCredentials:fe.options.ajaxWithCredentials,loadTilesWithAjax:fe.options.loadTilesWithAjax,ajaxHeaders:fe.options.ajaxHeaders,debugMode:z.debugMode,subPixelRoundingForTransparency:z.subPixelRoundingForTransparency}),z.collectionMode&&z.world.setAutoRefigureSizes(!1),z.navigator&&(se=t.extend({},fe.options,{replace:!1,originalTiledImage:me,tileSource:fe.tileSource}),z.navigator.addTiledImage(se)),z.world.addItem(me,{index:fe.options.index}),z._loadQueue.length===0&&K(fe),z.world.getItemCount()===1&&!z.preserveViewport&&z.viewport.goHome(!0),fe.options.success&&fe.options.success({item:me})}}o(this,x.tileSource,x,function(fe){j.tileSource=fe,le()},function(fe){fe.options=x,te(fe),le()})},addSimpleImage:function(x){t.console.assert(x,"[Viewer.addSimpleImage] options is required"),t.console.assert(x.url,"[Viewer.addSimpleImage] options.url is required");var z=t.extend({},x,{tileSource:{type:"image",url:x.url}});delete z.url,this.addTiledImage(z)},addLayer:function(x){var z=this;t.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var j=t.extend({},x,{success:function(te){z.raiseEvent("add-layer",{options:x,drawer:te.item})},error:function(te){z.raiseEvent("add-layer-failed",te)}});return this.addTiledImage(j),this},getLayerAtLevel:function(x){return t.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(x)},getLevelOfLayer:function(x){return t.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(x)},getLayersCount:function(){return t.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(x,z){return t.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(x,z)},removeLayer:function(x){return t.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(x)},forceRedraw:function(){return i[this.hash].forceRedraw=!0,this},forceResize:function(){i[this.hash].needsResize=!0,i[this.hash].forceResize=!0},bindSequenceControls:function(){var x=t.delegate(this,v),z=t.delegate(this,g),j=t.delegate(this,this.goToNextPage),te=t.delegate(this,this.goToPreviousPage),K=this.navImages,le=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(le=!1),this.previousButton=new t.Button({element:this.previousButton?t.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.PreviousPage"),srcRest:G(this.prefixUrl,K.previous.REST),srcGroup:G(this.prefixUrl,K.previous.GROUP),srcHover:G(this.prefixUrl,K.previous.HOVER),srcDown:G(this.prefixUrl,K.previous.DOWN),onRelease:te,onFocus:x,onBlur:z}),this.nextButton=new t.Button({element:this.nextButton?t.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.NextPage"),srcRest:G(this.prefixUrl,K.next.REST),srcGroup:G(this.prefixUrl,K.next.GROUP),srcHover:G(this.prefixUrl,K.next.HOVER),srcDown:G(this.prefixUrl,K.next.DOWN),onRelease:j,onFocus:x,onBlur:z}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),le&&(this.paging=new t.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:t.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var x=t.delegate(this,X),z=t.delegate(this,ee),j=t.delegate(this,V),te=t.delegate(this,ie),K=t.delegate(this,re),le=t.delegate(this,de),fe=t.delegate(this,ye),me=t.delegate(this,Te),se=t.delegate(this,Oe),F=t.delegate(this,ce),Q=t.delegate(this,v),ue=t.delegate(this,g),oe=this.navImages,Z=[],P=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(P=!1),this.showZoomControl&&(Z.push(this.zoomInButton=new t.Button({element:this.zoomInButton?t.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomIn"),srcRest:G(this.prefixUrl,oe.zoomIn.REST),srcGroup:G(this.prefixUrl,oe.zoomIn.GROUP),srcHover:G(this.prefixUrl,oe.zoomIn.HOVER),srcDown:G(this.prefixUrl,oe.zoomIn.DOWN),onPress:x,onRelease:z,onClick:j,onEnter:x,onExit:z,onFocus:Q,onBlur:ue})),Z.push(this.zoomOutButton=new t.Button({element:this.zoomOutButton?t.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomOut"),srcRest:G(this.prefixUrl,oe.zoomOut.REST),srcGroup:G(this.prefixUrl,oe.zoomOut.GROUP),srcHover:G(this.prefixUrl,oe.zoomOut.HOVER),srcDown:G(this.prefixUrl,oe.zoomOut.DOWN),onPress:te,onRelease:z,onClick:K,onEnter:te,onExit:z,onFocus:Q,onBlur:ue}))),this.showHomeControl&&Z.push(this.homeButton=new t.Button({element:this.homeButton?t.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Home"),srcRest:G(this.prefixUrl,oe.home.REST),srcGroup:G(this.prefixUrl,oe.home.GROUP),srcHover:G(this.prefixUrl,oe.home.HOVER),srcDown:G(this.prefixUrl,oe.home.DOWN),onRelease:le,onFocus:Q,onBlur:ue})),this.showFullPageControl&&Z.push(this.fullPageButton=new t.Button({element:this.fullPageButton?t.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.FullPage"),srcRest:G(this.prefixUrl,oe.fullpage.REST),srcGroup:G(this.prefixUrl,oe.fullpage.GROUP),srcHover:G(this.prefixUrl,oe.fullpage.HOVER),srcDown:G(this.prefixUrl,oe.fullpage.DOWN),onRelease:fe,onFocus:Q,onBlur:ue})),this.showRotationControl&&(Z.push(this.rotateLeftButton=new t.Button({element:this.rotateLeftButton?t.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateLeft"),srcRest:G(this.prefixUrl,oe.rotateleft.REST),srcGroup:G(this.prefixUrl,oe.rotateleft.GROUP),srcHover:G(this.prefixUrl,oe.rotateleft.HOVER),srcDown:G(this.prefixUrl,oe.rotateleft.DOWN),onRelease:me,onFocus:Q,onBlur:ue})),Z.push(this.rotateRightButton=new t.Button({element:this.rotateRightButton?t.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateRight"),srcRest:G(this.prefixUrl,oe.rotateright.REST),srcGroup:G(this.prefixUrl,oe.rotateright.GROUP),srcHover:G(this.prefixUrl,oe.rotateright.HOVER),srcDown:G(this.prefixUrl,oe.rotateright.DOWN),onRelease:se,onFocus:Q,onBlur:ue}))),this.showFlipControl&&Z.push(this.flipButton=new t.Button({element:this.flipButton?t.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Flip"),srcRest:G(this.prefixUrl,oe.flip.REST),srcGroup:G(this.prefixUrl,oe.flip.GROUP),srcHover:G(this.prefixUrl,oe.flip.HOVER),srcDown:G(this.prefixUrl,oe.flip.DOWN),onRelease:F,onFocus:Q,onBlur:ue})),P?(this.buttonGroup=new t.ButtonGroup({buttons:Z,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",t.delegate(this,ae)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT})):this.customButtons=Z),this},currentPage:function(){return this._sequenceIndex},goToPage:function(x){return this.tileSources&&x>=0&&x<this.tileSources.length&&(this._sequenceIndex=x,this._updateSequenceButtons(x),this.open(this.tileSources[x]),this.referenceStrip&&this.referenceStrip.setFocus(x),this.raiseEvent("page",{page:x})),this},addOverlay:function(x,z,j,te){var K;if(t.isPlainObject(x)?K=x:K={element:x,location:z,placement:j,onDraw:te},x=t.getElement(K.element),l(this.currentOverlays,x)>=0)return this;var le=s(this,K);return this.currentOverlays.push(le),le.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:x,location:K.location,placement:K.placement}),this},updateOverlay:function(x,z,j){var te;return x=t.getElement(x),te=l(this.currentOverlays,x),te>=0&&(this.currentOverlays[te].update(z,j),i[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:x,location:z,placement:j})),this},removeOverlay:function(x){var z;return x=t.getElement(x),z=l(this.currentOverlays,x),z>=0&&(this.currentOverlays[z].destroy(),this.currentOverlays.splice(z,1),i[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:x})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return i[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(x){var z;return x=t.getElement(x),z=l(this.currentOverlays,x),z>=0?this.currentOverlays[z]:null},_updateSequenceButtons:function(x){this.nextButton&&(!this.tileSources||this.tileSources.length-1===x?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(x>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(x){this._hideMessage();var z=t.makeNeutralElement("div");z.appendChild(document.createTextNode(x)),this.messageDiv=t.makeCenteredNode(z),t.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var x=this.messageDiv;x&&(x.parentNode.removeChild(x),delete this.messageDiv)},gestureSettingsByDeviceType:function(x){switch(x){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var x,z=this.currentOverlays.length;for(x=0;x<z;x++)this.currentOverlays[x].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new t.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else t.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),t.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){t.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var x=t.pixelDensityRatio,z=t.getCurrentPixelDensityRatio();x!==z&&(t.pixelDensityRatio=z,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var x=this._sequenceIndex-1;this.navPrevNextWrap&&x<0&&(x+=this.tileSources.length),this.goToPage(x)},goToNextPage:function(){var x=this._sequenceIndex+1;this.navPrevNextWrap&&x>=this.tileSources.length&&(x=0),this.goToPage(x)},isAnimating:function(){return i[this.hash].animating}});function a(x){return x=t.getElement(x),new t.Point(x.clientWidth===0?1:x.clientWidth,x.clientHeight===0?1:x.clientHeight)}function o(x,z,j,te,K){var le=x;if(t.type(z)==="string"){if(z.match(/^\s*<.*>\s*$/))z=t.parseXml(z);else if(z.match(/^\s*[{[].*[}\]]\s*$/))try{var fe=t.parseJSON(z);z=fe}catch{}}function me(se,F){se.ready?te(se):(se.addHandler("ready",function(){te(se)}),se.addHandler("open-failed",function(Q){K({message:Q.message,source:F})}))}setTimeout(function(){if(t.type(z)==="string")z=new t.TileSource({url:z,crossOriginPolicy:j.crossOriginPolicy!==void 0?j.crossOriginPolicy:x.crossOriginPolicy,ajaxWithCredentials:x.ajaxWithCredentials,ajaxHeaders:j.ajaxHeaders?j.ajaxHeaders:x.ajaxHeaders,splitHashDataForPost:x.splitHashDataForPost,useCanvas:x.useCanvas,success:function(ue){te(ue.tileSource)}}),z.addHandler("open-failed",function(ue){K(ue)});else if(t.isPlainObject(z)||z.nodeType)if(z.crossOriginPolicy===void 0&&(j.crossOriginPolicy!==void 0||x.crossOriginPolicy!==void 0)&&(z.crossOriginPolicy=j.crossOriginPolicy!==void 0?j.crossOriginPolicy:x.crossOriginPolicy),z.ajaxWithCredentials===void 0&&(z.ajaxWithCredentials=x.ajaxWithCredentials),z.useCanvas===void 0&&(z.useCanvas=x.useCanvas),t.isFunction(z.getTileUrl)){var se=new t.TileSource(z);se.getTileUrl=z.getTileUrl,te(se)}else{var F=t.TileSource.determineType(le,z);if(!F){K({message:"Unable to load TileSource",source:z});return}var Q=F.prototype.configure.apply(le,[z]);me(new F(Q),z)}else me(z,z)})}function s(x,z){if(z instanceof t.Overlay)return z;var j=null;if(z.element)j=t.getElement(z.element);else{var te=z.id?z.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);j=t.getElement(z.id),j||(j=document.createElement("a"),j.href="#/overlay/"+te),j.id=te,t.addClass(j,z.className?z.className:"openseadragon-overlay")}var K=z.location,le=z.width,fe=z.height;if(!K){var me=z.x,se=z.y;if(z.px!==void 0){var F=x.viewport.imageToViewportRectangle(new t.Rect(z.px,z.py,le||0,fe||0));me=F.x,se=F.y,le=le!==void 0?F.width:void 0,fe=fe!==void 0?F.height:void 0}K=new t.Point(me,se)}var Q=z.placement;return Q&&t.type(Q)==="string"&&(Q=t.Placement[z.placement.toUpperCase()]),new t.Overlay({element:j,location:K,placement:Q,onDraw:z.onDraw,checkResize:z.checkResize,width:le,height:fe,rotationMode:z.rotationMode})}function l(x,z){var j;for(j=x.length-1;j>=0;j--)if(x[j].element===z)return j;return-1}function u(x,z){return t.requestAnimationFrame(function(){z(x)})}function h(x){t.requestAnimationFrame(function(){d(x)})}function f(x){!x.autoHideControls||(x.controlsShouldFade=!0,x.controlsFadeBeginTime=t.now()+x.controlsFadeDelay,window.setTimeout(function(){h(x)},x.controlsFadeDelay))}function d(x){var z,j,te,K;if(x.controlsShouldFade){for(z=t.now(),j=z-x.controlsFadeBeginTime,te=1-j/x.controlsFadeLength,te=Math.min(1,te),te=Math.max(0,te),K=x.controls.length-1;K>=0;K--)x.controls[K].autoFade&&x.controls[K].setOpacity(te);te>0&&h(x)}}function c(x){var z;for(x.controlsShouldFade=!1,z=x.controls.length-1;z>=0;z--)x.controls[z].setOpacity(1)}function v(){c(this)}function g(){f(this)}function m(x){var z={tracker:x.eventSource,position:x.position,originalEvent:x.originalEvent,preventDefault:x.preventDefault};this.raiseEvent("canvas-contextmenu",z),x.preventDefault=z.preventDefault}function p(x){var z={originalEvent:x.originalEvent,preventDefaultAction:!1,preventVerticalPan:x.preventVerticalPan||!this.panVertical,preventHorizontalPan:x.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",z),!z.preventDefaultAction&&!x.ctrl&&!x.alt&&!x.meta)switch(x.keyCode){case 38:z.preventVerticalPan||(x.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 40:z.preventVerticalPan||(x.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 37:z.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 39:z.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),x.preventDefault=!0;break;default:x.preventDefault=!1;break}else x.preventDefault=!1}function y(x){var z={originalEvent:x.originalEvent,preventDefaultAction:!1,preventVerticalPan:x.preventVerticalPan||!this.panVertical,preventHorizontalPan:x.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",z),!z.preventDefaultAction&&!x.ctrl&&!x.alt&&!x.meta)switch(x.keyCode){case 43:case 61:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),x.preventDefault=!0;break;case 45:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),x.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),x.preventDefault=!0;break;case 119:case 87:z.preventVerticalPan||(x.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 115:case 83:z.preventVerticalPan||(x.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 97:z.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 100:z.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints()),x.preventDefault=!0;break;case 114:this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),x.preventDefault=!0;break;case 82:this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement),this.viewport.applyConstraints(),x.preventDefault=!0;break;case 102:this.viewport.toggleFlip(),x.preventDefault=!0;break;case 106:this.goToPreviousPage();break;case 107:this.goToNextPage();break;default:x.preventDefault=!1;break}else x.preventDefault=!1}function w(x){var z,j=document.activeElement===this.canvas;j||this.canvas.focus(),this.viewport.flipped&&(x.position.x=this.viewport.getContainerSize().x-x.position.x);var te={tracker:x.eventSource,position:x.position,quick:x.quick,shift:x.shift,originalEvent:x.originalEvent,originalTarget:x.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",te),!te.preventDefaultAction&&this.viewport&&x.quick&&(z=this.gestureSettingsByDeviceType(x.pointerType),z.clickToZoom===!0&&(this.viewport.zoomBy(x.shift?1/this.zoomPerClick:this.zoomPerClick,z.zoomToRefPoint?this.viewport.pointFromPixel(x.position,!0):null),this.viewport.applyConstraints()),z.dblClickDragToZoom&&(i[this.hash].draggingToZoom===!0?(i[this.hash].lastClickTime=null,i[this.hash].draggingToZoom=!1):i[this.hash].lastClickTime=t.now()))}function T(x){var z,j={tracker:x.eventSource,position:x.position,shift:x.shift,originalEvent:x.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",j),!j.preventDefaultAction&&this.viewport&&(z=this.gestureSettingsByDeviceType(x.pointerType),z.dblClickToZoom&&(this.viewport.zoomBy(x.shift?1/this.zoomPerClick:this.zoomPerClick,z.zoomToRefPoint?this.viewport.pointFromPixel(x.position,!0):null),this.viewport.applyConstraints()))}function O(x){var z,j={tracker:x.eventSource,pointerType:x.pointerType,position:x.position,delta:x.delta,speed:x.speed,direction:x.direction,shift:x.shift,originalEvent:x.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",j),z=this.gestureSettingsByDeviceType(x.pointerType),!j.preventDefaultAction&&this.viewport){if(z.dblClickDragToZoom&&i[this.hash].draggingToZoom){var te=Math.pow(this.zoomPerDblClickDrag,x.delta.y/50);this.viewport.zoomBy(te)}else if(z.dragToPan&&!i[this.hash].draggingToZoom){if(this.panHorizontal||(x.delta.x=0),this.panVertical||(x.delta.y=0),this.viewport.flipped&&(x.delta.x=-x.delta.x),this.constrainDuringPan){var K=this.viewport.deltaPointsFromPixels(x.delta.negate());this.viewport.centerSpringX.target.value+=K.x,this.viewport.centerSpringY.target.value+=K.y;var le=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=K.x,this.viewport.centerSpringY.target.value-=K.y,le.xConstrained&&(x.delta.x=0),le.yConstrained&&(x.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(x.delta.negate()),z.flickEnabled&&!this.constrainDuringPan)}}}function I(x){var z,j={tracker:x.eventSource,pointerType:x.pointerType,position:x.position,speed:x.speed,direction:x.direction,shift:x.shift,originalEvent:x.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",j),z=this.gestureSettingsByDeviceType(x.pointerType),!j.preventDefaultAction&&this.viewport){if(!i[this.hash].draggingToZoom&&z.flickEnabled&&x.speed>=z.flickMinSpeed){var te=0;this.panHorizontal&&(te=z.flickMomentum*x.speed*Math.cos(x.direction));var K=0;this.panVertical&&(K=z.flickMomentum*x.speed*Math.sin(x.direction));var le=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),fe=this.viewport.pointFromPixel(new t.Point(le.x-te,le.y-K));this.viewport.panTo(fe,!1)}this.viewport.applyConstraints()}z.dblClickDragToZoom&&i[this.hash].draggingToZoom===!0&&(i[this.hash].draggingToZoom=!1)}function R(x){this.raiseEvent("canvas-enter",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,buttons:x.buttons,pointers:x.pointers,insideElementPressed:x.insideElementPressed,buttonDownAny:x.buttonDownAny,originalEvent:x.originalEvent})}function L(x){this.raiseEvent("canvas-exit",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,buttons:x.buttons,pointers:x.pointers,insideElementPressed:x.insideElementPressed,buttonDownAny:x.buttonDownAny,originalEvent:x.originalEvent})}function N(x){var z;if(this.raiseEvent("canvas-press",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,insideElementPressed:x.insideElementPressed,insideElementReleased:x.insideElementReleased,originalEvent:x.originalEvent}),z=this.gestureSettingsByDeviceType(x.pointerType),z.dblClickDragToZoom){var j=i[this.hash].lastClickTime,te=t.now();if(j===null)return;te-j<this.dblClickTimeThreshold&&(i[this.hash].draggingToZoom=!0),i[this.hash].lastClickTime=null}}function E(x){this.raiseEvent("canvas-release",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,insideElementPressed:x.insideElementPressed,insideElementReleased:x.insideElementReleased,originalEvent:x.originalEvent})}function C(x){this.raiseEvent("canvas-nonprimary-press",{tracker:x.eventSource,position:x.position,pointerType:x.pointerType,button:x.button,buttons:x.buttons,originalEvent:x.originalEvent})}function b(x){this.raiseEvent("canvas-nonprimary-release",{tracker:x.eventSource,position:x.position,pointerType:x.pointerType,button:x.button,buttons:x.buttons,originalEvent:x.originalEvent})}function M(x){var z,j,te,K,le={tracker:x.eventSource,pointerType:x.pointerType,gesturePoints:x.gesturePoints,lastCenter:x.lastCenter,center:x.center,lastDistance:x.lastDistance,distance:x.distance,shift:x.shift,originalEvent:x.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",le),this.viewport&&(z=this.gestureSettingsByDeviceType(x.pointerType),z.pinchToZoom&&(!le.preventDefaultPanAction||!le.preventDefaultZoomAction)&&(j=this.viewport.pointFromPixel(x.center,!0),z.zoomToRefPoint&&!le.preventDefaultPanAction&&(te=this.viewport.pointFromPixel(x.lastCenter,!0),K=te.minus(j),this.panHorizontal||(K.x=0),this.panVertical||(K.y=0),this.viewport.panBy(K,!0)),le.preventDefaultZoomAction||this.viewport.zoomBy(x.distance/x.lastDistance,j,!0),this.viewport.applyConstraints()),z.pinchRotate&&!le.preventDefaultRotateAction)){var fe=Math.atan2(x.gesturePoints[0].currentPos.y-x.gesturePoints[1].currentPos.y,x.gesturePoints[0].currentPos.x-x.gesturePoints[1].currentPos.x),me=Math.atan2(x.gesturePoints[0].lastPos.y-x.gesturePoints[1].lastPos.y,x.gesturePoints[0].lastPos.x-x.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(fe-me)*(180/Math.PI))}}function D(x){var z,j,te,K,le;K=t.now(),le=K-this._lastScrollTime,le>this.minScrollDeltaTime?(this._lastScrollTime=K,z={tracker:x.eventSource,position:x.position,scroll:x.scroll,shift:x.shift,originalEvent:x.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",z),!z.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(x.position.x=this.viewport.getContainerSize().x-x.position.x),j=this.gestureSettingsByDeviceType(x.pointerType),j.scrollToZoom&&(te=Math.pow(this.zoomPerScroll,x.scroll),this.viewport.zoomBy(te,j.zoomToRefPoint?this.viewport.pointFromPixel(x.position,!0):null),this.viewport.applyConstraints())),x.preventDefault=z.preventDefault):x.preventDefault=!0}function H(x){i[this.hash].mouseInside=!0,c(this),this.raiseEvent("container-enter",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,buttons:x.buttons,pointers:x.pointers,insideElementPressed:x.insideElementPressed,buttonDownAny:x.buttonDownAny,originalEvent:x.originalEvent})}function k(x){x.pointers<1&&(i[this.hash].mouseInside=!1,i[this.hash].animating||f(this)),this.raiseEvent("container-exit",{tracker:x.eventSource,pointerType:x.pointerType,position:x.position,buttons:x.buttons,pointers:x.pointers,insideElementPressed:x.insideElementPressed,buttonDownAny:x.buttonDownAny,originalEvent:x.originalEvent})}function B(x){W(x),x.isOpen()?x._updateRequestId=u(x,B):x._updateRequestId=!1}function U(x,z){var j=x.viewport,te=j.getZoom(),K=j.getCenter();j.resize(z,x.preserveImageSizeOnResize),j.panTo(K,!0);var le;if(x.preserveImageSizeOnResize)le=i[x.hash].prevContainerSize.x/z.x;else{var fe=new t.Point(0,0),me=new t.Point(i[x.hash].prevContainerSize.x,i[x.hash].prevContainerSize.y).distanceTo(fe),se=new t.Point(z.x,z.y).distanceTo(fe);le=se/me*i[x.hash].prevContainerSize.x/z.x}j.zoomTo(te*le,null,!0),i[x.hash].prevContainerSize=z,i[x.hash].forceRedraw=!0,i[x.hash].needsResize=!1,i[x.hash].forceResize=!1}function W(x){if(!(x._opening||!i[x.hash])){if(x.autoResize||i[x.hash].forceResize){var z;if(x._autoResizePolling){z=a(x.container);var j=i[x.hash].prevContainerSize;z.equals(j)||(i[x.hash].needsResize=!0)}i[x.hash].needsResize&&U(x,z||a(x.container))}var te=x.viewport.update(),K=x.world.update()||te;te&&x.raiseEvent("viewport-change"),x.referenceStrip&&(K=x.referenceStrip.update(x.viewport)||K);var le=i[x.hash].animating;!le&&K&&(x.raiseEvent("animation-start"),c(x));var fe=le&&!K;fe&&(i[x.hash].animating=!1),(K||fe||i[x.hash].forceRedraw||x.world.needsDraw())&&(J(x),x._drawOverlays(),x.navigator&&x.navigator.update(x.viewport),i[x.hash].forceRedraw=!1,K&&x.raiseEvent("animation")),fe&&(x.raiseEvent("animation-finish"),i[x.hash].mouseInside||f(x)),i[x.hash].animating=K}}function J(x){x.imageLoader.clear(),x.drawer.clear(),x.world.draw(),x.raiseEvent("update-viewport",{})}function G(x,z){return x?x+z:z}function X(){i[this.hash].lastZoomTime=t.now(),i[this.hash].zoomFactor=this.zoomPerSecond,i[this.hash].zooming=!0,q(this)}function ie(){i[this.hash].lastZoomTime=t.now(),i[this.hash].zoomFactor=1/this.zoomPerSecond,i[this.hash].zooming=!0,q(this)}function ee(){i[this.hash].zooming=!1}function q(x){t.requestAnimationFrame(t.delegate(x,$))}function $(){var x,z,j;i[this.hash].zooming&&this.viewport&&(x=t.now(),z=x-i[this.hash].lastZoomTime,j=Math.pow(i[this.hash].zoomFactor,z/1e3),this.viewport.zoomBy(j),this.viewport.applyConstraints(),i[this.hash].lastZoomTime=x,q(this))}function V(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function re(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function ae(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function de(){this.viewport&&this.viewport.goHome()}function ye(){this.isFullPage()&&!t.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Te(){if(this.viewport){var x=this.viewport.getRotation();this.viewport.flipped?x+=this.rotationIncrement:x-=this.rotationIncrement,this.viewport.setRotation(x)}}function Oe(){if(this.viewport){var x=this.viewport.getRotation();this.viewport.flipped?x-=this.rotationIncrement:x+=this.rotationIncrement,this.viewport.setRotation(x)}}function ce(){this.viewport.toggleFlip()}}(e),function(t){t.Navigator=function(u){var h=u.viewer,f=this,d,c;u.element||u.id?(u.element?(u.id&&t.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),u.element.id?u.id=u.element.id:u.id="navigator-"+t.now(),this.element=u.element):this.element=document.getElementById(u.id),u.controlOptions={anchor:t.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+t.now(),this.element=t.makeNeutralElement("div"),u.controlOptions={anchor:t.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=t.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=t.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:u.animationTime,autoResize:!1,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=h.minPixelRatio,t.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new t.Point(1,1),this.totalBorderWidths=new t.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==t.ControlAnchor.NONE&&function(m,p){m.margin="0px",m.border=p+"px solid "+u.borderColor,m.padding="0px",m.background=u.background,m.opacity=u.opacity,m.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=t.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(m,p){m.position="relative",m.top="0px",m.left="0px",m.fontSize="0px",m.overflow="hidden",m.border=p+"px solid "+u.displayRegionColor,m.margin="0px",m.padding="0px",m.background="transparent",m.float="left",m.cssFloat="left",m.styleFloat="left",m.zIndex=999999999,m.cursor="default"}(this.displayRegion.style,this.borderWidth),t.setElementPointerEventsNone(this.displayRegion),t.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=t.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",t.setElementPointerEventsNone(this.displayRegionContainer),t.setElementTouchActionNone(this.displayRegionContainer),h.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==t.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==t.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(d=t.getElementSize(h.element),this.element.style.height=Math.round(d.y*u.sizeRatio)+"px",this.element.style.width=Math.round(d.x*u.sizeRatio)+"px",this.oldViewerSize=d,c=t.getElementSize(this.element),this.elementArea=c.x*c.y),this.oldContainerSize=new t.Point(0,0),t.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function v(m){s(f.displayRegionContainer,m),s(f.displayRegion,-m),f.viewport.setRotation(m)}if(u.navigatorRotate){var g=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;v(g),u.viewer.addHandler("rotate",function(m){v(m.degrees)})}this.innerTracker.destroy(),this.innerTracker=new t.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:t.delegate(this,n),clickHandler:t.delegate(this,i),releaseHandler:t.delegate(this,a),scrollHandler:t.delegate(this,o),preProcessEventHandler:function(m){m.eventType==="wheel"&&(m.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",t.setElementPointerEventsNone(this.canvas),t.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){f.viewport&&f.viewport.goHome(!0)}),h.world.addHandler("item-index-change",function(m){window.setTimeout(function(){var p=f.world.getItemAt(m.previousIndex);f.world.setItemIndex(p,m.newIndex)},1)}),h.world.addHandler("remove-item",function(m){var p=m.item,y=f._getMatchingItem(p);y&&f.world.removeItem(y)}),this.update(h.viewport)},t.extend(t.Navigator.prototype,t.EventSource.prototype,t.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new t.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){l(this.displayRegion,u),l(this.canvas,u),l(this.element,u)},update:function(u){var h,f,d,c,v,g;if(h=t.getElementSize(this.viewer.element),this._resizeWithViewer&&h.x&&h.y&&!h.equals(this.oldViewerSize)&&(this.oldViewerSize=h,this.maintainSizeRatio||!this.elementArea?(f=h.x*this.sizeRatio,d=h.y*this.sizeRatio):(f=Math.sqrt(this.elementArea*(h.x/h.y)),d=this.elementArea/f),this.element.style.width=Math.round(f)+"px",this.element.style.height=Math.round(d)+"px",this.elementArea||(this.elementArea=f*d),this.updateSize()),u&&this.viewport){c=u.getBoundsNoRotate(!0),v=this.viewport.pixelFromPointNoRotate(c.getTopLeft(),!1),g=this.viewport.pixelFromPointNoRotate(c.getBottomRight(),!1).minus(this.totalBorderWidths);var m=this.displayRegion.style;m.display=this.world.getItemCount()?"block":"none",m.top=Math.round(v.y)+"px",m.left=Math.round(v.x)+"px";var p=Math.abs(v.x-g.x),y=Math.abs(v.y-g.y);m.width=Math.round(Math.max(p,0))+"px",m.height=Math.round(Math.max(y,0))+"px"}},addTiledImage:function(u){var h=this,f=u.originalTiledImage;delete u.original;var d=t.extend({},u,{success:function(c){var v=c.item;v._originalForNavigator=f,h._matchBounds(v,f,!0),h._matchOpacity(v,f),h._matchCompositeOperation(v,f);function g(){h._matchBounds(v,f)}function m(){h._matchOpacity(v,f)}function p(){h._matchCompositeOperation(v,f)}f.addHandler("bounds-change",g),f.addHandler("clip-change",g),f.addHandler("opacity-change",m),f.addHandler("composite-operation-change",p)}});return t.Viewer.prototype.addTiledImage.apply(this,[d])},destroy:function(){return t.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var h=this.world.getItemCount(),f,d=0;d<h;d++)if(f=this.world.getItemAt(d),f._originalForNavigator===u)return f;return null},_matchBounds:function(u,h,f){var d=h.getBoundsNoRotate();u.setPosition(d.getTopLeft(),f),u.setWidth(d.width,f),u.setRotation(h.getRotation(),f),u.setClip(h.getClip()),u.setFlip(h.getFlip())},_matchOpacity:function(u,h){u.setOpacity(h.opacity)},_matchCompositeOperation:function(u,h){u.setCompositeOperation(h.compositeOperation)}});function i(u){var h={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",h),!h.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var f=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(f.x=this.viewer.viewport.getCenter(!0).x):f.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(f),this.viewer.viewport.applyConstraints()}}function n(u){var h={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",h),!h.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function a(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function o(u){var h={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",h),u.preventDefault=h.preventDefault}function s(u,h){l(u,"rotate("+h+"deg)")}function l(u,h){u.style.webkitTransform=h,u.style.mozTransform=h,u.style.msTransform=h,u.style.oTransform=h,u.style.transform=h}}(e),function(t){var i={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};t.extend(t,{getString:function(n){var a=n.split("."),o=null,s=arguments,l=i,u;for(u=0;u<a.length-1;u++)l=l[a[u]]||{};return o=l[a[u]],typeof o!="string"&&(t.console.error("Untranslated source string:",n),o=""),o.replace(/\{\d+\}/g,function(h){var f=parseInt(h.match(/\d+/),10)+1;return f<s.length?s[f]:""})},setString:function(n,a){var o=n.split("."),s=i,l;for(l=0;l<o.length-1;l++)s[o[l]]||(s[o[l]]={}),s=s[o[l]];s[o[l]]=a}})}(e),function(t){t.Point=function(i,n){this.x=typeof i=="number"?i:0,this.y=typeof n=="number"?n:0},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},plus:function(i){return new t.Point(this.x+i.x,this.y+i.y)},minus:function(i){return new t.Point(this.x-i.x,this.y-i.y)},times:function(i){return new t.Point(this.x*i,this.y*i)},divide:function(i){return new t.Point(this.x/i,this.y/i)},negate:function(){return new t.Point(-this.x,-this.y)},distanceTo:function(i){return Math.sqrt(Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2))},squaredDistanceTo:function(i){return Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2)},apply:function(i){return new t.Point(i(this.x),i(this.y))},equals:function(i){return i instanceof t.Point&&this.x===i.x&&this.y===i.y},rotate:function(i,n){n=n||new t.Point(0,0);var a,o;if(i%90===0){var s=t.positiveModulo(i,360);switch(s){case 0:a=1,o=0;break;case 90:a=0,o=1;break;case 180:a=-1,o=0;break;case 270:a=0,o=-1;break}}else{var l=i*Math.PI/180;a=Math.cos(l),o=Math.sin(l)}var u=a*(this.x-n.x)-o*(this.y-n.y)+n.x,h=o*(this.x-n.x)+a*(this.y-n.y)+n.y;return new t.Point(u,h)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(e),function(t){t.TileSource=function(n,a,o,s,l,u){var h=this,f=arguments,d,c;if(t.isPlainObject(n)?d=n:d={width:f[0],height:f[1],tileSize:f[2],tileOverlap:f[3],minLevel:f[4],maxLevel:f[5]},t.EventSource.call(this),t.extend(!0,this,d),!this.success){for(c=0;c<arguments.length;c++)if(t.isFunction(arguments[c])){this.success=arguments[c];break}}this.success&&this.addHandler("ready",function(v){h.success(v)}),t.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new t.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=d.width&&d.height?d.width/d.height:1,this.dimensions=new t.Point(d.width,d.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=d.tileOverlap?d.tileOverlap:0,this.minLevel=d.minLevel?d.minLevel:0,this.maxLevel=d.maxLevel!==void 0&&d.maxLevel!==null?d.maxLevel:d.width&&d.height?Math.ceil(Math.log(Math.max(d.width,d.height))/Math.log(2)):0,this.success&&t.isFunction(this.success)&&this.success(this))},t.TileSource.prototype={getTileSize:function(n){return t.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(n){return this._tileWidth?this._tileWidth:this.getTileSize(n)},getTileHeight:function(n){return this._tileHeight?this._tileHeight:this.getTileSize(n)},setMaxLevel:function(n){this.maxLevel=n,this._memoizeLevelScale()},getLevelScale:function(n){return this._memoizeLevelScale(),this.getLevelScale(n)},_memoizeLevelScale:function(){var n={},a;for(a=0;a<=this.maxLevel;a++)n[a]=1/Math.pow(2,this.maxLevel-a);this.getLevelScale=function(o){return n[o]}},getNumTiles:function(n){var a=this.getLevelScale(n),o=Math.ceil(a*this.dimensions.x/this.getTileWidth(n)),s=Math.ceil(a*this.dimensions.y/this.getTileHeight(n));return new t.Point(o,s)},getPixelRatio:function(n){var a=this.dimensions.times(this.getLevelScale(n)),o=1/a.x*t.pixelDensityRatio,s=1/a.y*t.pixelDensityRatio;return new t.Point(o,s)},getClosestLevel:function(){var n,a;for(n=this.minLevel+1;n<=this.maxLevel&&(a=this.getNumTiles(n),!(a.x>1||a.y>1));n++);return n-1},getTileAtPoint:function(n,a){var o=a.x>=0&&a.x<=1&&a.y>=0&&a.y<=1/this.aspectRatio;t.console.assert(o,"[TileSource.getTileAtPoint] must be called with a valid point.");var s=this.dimensions.x*this.getLevelScale(n),l=a.x*s,u=a.y*s,h=Math.floor(l/this.getTileWidth(n)),f=Math.floor(u/this.getTileHeight(n));a.x>=1&&(h=this.getNumTiles(n).x-1);var d=1e-15;return a.y>=1/this.aspectRatio-d&&(f=this.getNumTiles(n).y-1),new t.Point(h,f)},getTileBounds:function(n,a,o,s){var l=this.dimensions.times(this.getLevelScale(n)),u=this.getTileWidth(n),h=this.getTileHeight(n),f=a===0?0:u*a-this.tileOverlap,d=o===0?0:h*o-this.tileOverlap,c=u+(a===0?1:2)*this.tileOverlap,v=h+(o===0?1:2)*this.tileOverlap,g=1/l.x;return c=Math.min(c,l.x-f),v=Math.min(v,l.y-d),s?new t.Rect(0,0,c,v):new t.Rect(f*g,d*g,c*g,v*g)},getImageInfo:function(n){var a=this,o,s,l,u,h,f,d;n&&(h=n.split("/"),f=h[h.length-1],d=f.lastIndexOf("."),d>-1&&(h[h.length-1]=f.slice(0,d)));var c=null;if(this.splitHashDataForPost){var v=n.indexOf("#");v!==-1&&(c=n.substring(v+1),n=n.substr(0,v))}s=function(g){typeof g=="string"&&(g=t.parseXml(g));var m=t.TileSource.determineType(a,g,n);if(!m){a.raiseEvent("open-failed",{message:"Unable to load TileSource",source:n});return}u=m.prototype.configure.apply(a,[g,n,c]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=a.ajaxWithCredentials),l=new m(u),a.ready=!0,a.raiseEvent("ready",{tileSource:l})},n.match(/\.js$/)?(o=n.split("/").pop().replace(".js",""),t.jsonp({url:n,async:!1,callbackName:o,callback:s})):t.makeAjaxRequest({url:n,postData:c,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(g){var m=i(g);s(m)},error:function(g,m){var p;try{p="HTTP "+g.status+" attempting to load TileSource: "+n}catch{var y;typeof m>"u"||!m.toString?y="Unknown error":y=m.toString(),p=y+" attempting to load TileSource: "+n}t.console.error(p),a.raiseEvent("open-failed",{message:p,source:n,postData:c})}})},supports:function(n,a){return!1},configure:function(n,a,o){throw new Error("Method not implemented.")},getTileUrl:function(n,a,o){throw new Error("Method not implemented.")},getTilePostData:function(n,a,o){return null},getTileAjaxHeaders:function(n,a,o){return{}},getTileHashKey:function(n,a,o,s,l,u){function h(f){return l?f+"+"+JSON.stringify(l):f}return h(typeof s!="string"?n+"/"+a+"_"+o:s)},tileExists:function(n,a,o){var s=this.getNumTiles(n);return n>=this.minLevel&&n<=this.maxLevel&&a>=0&&o>=0&&a<s.x&&o<s.y},hasTransparency:function(n,a,o,s){return!!n||a.match(".png")},downloadTileStart:function(n){var a=n.userData,o=new Image;a.image=o,a.request=null;var s=function(l){if(!o){n.finish(null,a.request,"Image load failed: undefined Image instance.");return}o.onload=o.onerror=o.onabort=null,n.finish(l?null:o,a.request,l)};o.onload=function(){s()},o.onabort=o.onerror=function(){s("Image load aborted.")},n.loadWithAjax?a.request=t.makeAjaxRequest({url:n.src,withCredentials:n.ajaxWithCredentials,headers:n.ajaxHeaders,responseType:"arraybuffer",postData:n.postData,success:function(l){var u;try{u=new window.Blob([l.response])}catch(d){var h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(d.name==="TypeError"&&h){var f=new h;f.append(l.response),u=f.getBlob()}}u.size===0?s("Empty image response."):o.src=(window.URL||window.webkitURL).createObjectURL(u)},error:function(l){s("Image load aborted - XHR error")}}):(n.crossOriginPolicy!==!1&&(o.crossOrigin=n.crossOriginPolicy),o.src=n.src)},downloadTileAbort:function(n){n.userData.request&&n.userData.request.abort();var a=n.userData.image;n.userData.image&&(a.onload=a.onerror=a.onabort=null)},createTileCache:function(n,a,o){n._data=a},destroyTileCache:function(n){n._data=null,n._renderedContext=null},getTileCacheData:function(n){return n._data},getTileCacheDataAsImage:function(n){return n._data},getTileCacheDataAsContext2D:function(n){if(!n._renderedContext){var a=document.createElement("canvas");a.width=n._data.width,a.height=n._data.height,n._renderedContext=a.getContext("2d"),n._renderedContext.drawImage(n._data,0,0),n._data=null}return n._renderedContext}},t.extend(!0,t.TileSource.prototype,t.EventSource.prototype);function i(n){var a=n.responseText,o=n.status,s,l;if(n){if(n.status!==200&&n.status!==0)throw o=n.status,s=o===404?"Not Found":n.statusText,new Error(t.getString("Errors.Status",o,s))}else throw new Error(t.getString("Errors.Security"));if(a.match(/\s*<.*/))try{l=n.responseXML&&n.responseXML.documentElement?n.responseXML:t.parseXml(a)}catch{l=n.responseText}else if(a.match(/\s*[{[].*/))try{l=t.parseJSON(a)}catch{l=a}else l=a;return l}t.TileSource.determineType=function(n,a,o){var s;for(s in e)if(s.match(/.+TileSource$/)&&t.isFunction(e[s])&&t.isFunction(e[s].prototype.supports)&&e[s].prototype.supports.call(n,a,o))return e[s];return t.console.error("No TileSource was able to open %s %s",o,a),null}}(e),function(t){t.DziTileSource=function(a,o,s,l,u,h,f,d,c){var v,g,m,p;if(t.isPlainObject(a)?p=a:p={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=p.tilesUrl,this.fileFormat=p.fileFormat,this.displayRects=p.displayRects,this.displayRects)for(v=this.displayRects.length-1;v>=0;v--)for(g=this.displayRects[v],m=g.minLevel;m<=g.maxLevel;m++)this._levelRects[m]||(this._levelRects[m]=[]),this._levelRects[m].push(g);t.TileSource.apply(this,[p])},t.extend(t.DziTileSource.prototype,t.TileSource.prototype,{supports:function(a,o){var s;return a.Image?s=a.Image.xmlns:a.documentElement&&(a.documentElement.localName==="Image"||a.documentElement.tagName==="Image")&&(s=a.documentElement.namespaceURI),s=(s||"").toLowerCase(),s.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||s.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(a,o,s){var l;return t.isPlainObject(a)?l=n(this,a):l=i(this,a),o&&!l.tilesUrl&&(l.tilesUrl=o.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),o.search(/\.(dzi|xml|js)\?/)!==-1?l.queryParams=o.match(/\?.*/):l.queryParams=""),l},getTileUrl:function(a,o,s){return[this.tilesUrl,a,"/",o,"_",s,".",this.fileFormat,this.queryParams].join("")},tileExists:function(a,o,s){var l=this._levelRects[a],u,h,f,d,c,v,g;if(this.minLevel&&a<this.minLevel||this.maxLevel&&a>this.maxLevel)return!1;if(!l||!l.length)return!0;for(g=l.length-1;g>=0;g--)if(u=l[g],!(a<u.minLevel||a>u.maxLevel)&&(h=this.getLevelScale(a),f=u.x*h,d=u.y*h,c=f+u.width*h,v=d+u.height*h,f=Math.floor(f/this._tileWidth),d=Math.floor(d/this._tileWidth),c=Math.ceil(c/this._tileWidth),v=Math.ceil(v/this._tileWidth),f<=o&&o<c&&d<=s&&s<v))return!0;return!1}});function i(a,o){if(!o||!o.documentElement)throw new Error(t.getString("Errors.Xml"));var s=o.documentElement,l=s.localName||s.tagName,u=o.documentElement.namespaceURI,h=null,f=[],d,c,v,g,m;if(l==="Image")try{if(g=s.getElementsByTagName("Size")[0],g===void 0&&(g=s.getElementsByTagNameNS(u,"Size")[0]),h={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:s.getAttribute("Url"),Format:s.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(s.getAttribute("Overlap"),10),TileSize:parseInt(s.getAttribute("TileSize"),10),Size:{Height:parseInt(g.getAttribute("Height"),10),Width:parseInt(g.getAttribute("Width"),10)}}},!t.imageFormatSupported(h.Image.Format))throw new Error(t.getString("Errors.ImageFormat",h.Image.Format.toUpperCase()));for(d=s.getElementsByTagName("DisplayRect"),d===void 0&&(d=s.getElementsByTagNameNS(u,"DisplayRect")[0]),m=0;m<d.length;m++)c=d[m],v=c.getElementsByTagName("Rect")[0],v===void 0&&(v=c.getElementsByTagNameNS(u,"Rect")[0]),f.push({Rect:{X:parseInt(v.getAttribute("X"),10),Y:parseInt(v.getAttribute("Y"),10),Width:parseInt(v.getAttribute("Width"),10),Height:parseInt(v.getAttribute("Height"),10),MinLevel:parseInt(c.getAttribute("MinLevel"),10),MaxLevel:parseInt(c.getAttribute("MaxLevel"),10)}});return f.length&&(h.Image.DisplayRect=f),n(a,h)}catch(w){throw w instanceof Error?w:new Error(t.getString("Errors.Dzi"))}else{if(l==="Collection")throw new Error(t.getString("Errors.Dzc"));if(l==="Error"){var p=s.getElementsByTagName("Message")[0],y=p.firstChild.nodeValue;throw new Error(y)}}throw new Error(t.getString("Errors.Dzi"))}function n(a,o){var s=o.Image,l=s.Url,u=s.Format,h=s.Size,f=s.DisplayRect||[],d=parseInt(h.Width,10),c=parseInt(h.Height,10),v=parseInt(s.TileSize,10),g=parseInt(s.Overlap,10),m=[],p,y;for(y=0;y<f.length;y++)p=f[y].Rect,m.push(new t.DisplayRect(parseInt(p.X,10),parseInt(p.Y,10),parseInt(p.Width,10),parseInt(p.Height,10),parseInt(p.MinLevel,10),parseInt(p.MaxLevel,10)));return t.extend(!0,{width:d,height:c,tileSize:v,tileOverlap:g,minLevel:null,maxLevel:null,tilesUrl:l,fileFormat:u,displayRects:m},o)}}(e),function(t){t.IIIFTileSource=function(s){if(t.extend(!0,this,s),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(s.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=s.version,this.tile_width&&this.tile_height)s.tileWidth=this.tile_width,s.tileHeight=this.tile_height;else if(this.tile_width)s.tileSize=this.tile_width;else if(this.tile_height)s.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)s.tileWidth=this.tiles[0].width,s.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var l=0;l<this.tiles.length;l++)for(var u=0;u<this.tiles[l].scaleFactors.length;u++){var h=this.tiles[l].scaleFactors[u];this.scale_factors.push(h),s.tileSizePerScaleFactor[h]={width:this.tiles[l].width,height:this.tiles[l].height||this.tiles[l].width}}}else if(i(s)){for(var f=Math.min(this.height,this.width),d=[256,512,1024],c=[],v=0;v<d.length;v++)d[v]<=f&&c.push(d[v]);c.length>0?s.tileSize=Math.max.apply(null,c):s.tileSize=f}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,s.levels=n(this),t.extend(!0,s,{width:s.levels[s.levels.length-1].width,height:s.levels[s.levels.length-1].height,tileSize:Math.max(s.height,s.width),tileOverlap:0,minLevel:0,maxLevel:s.levels.length-1}),this.levels=s.levels):t.console.error("Nothing in the info.json to construct image pyramids from");if(!s.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)s.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var g=Math.max.apply(null,this.scale_factors);s.maxLevel=Math.round(Math.log(g)*Math.LOG2E)}t.TileSource.apply(this,[s])},t.extend(t.IIIFTileSource.prototype,t.TileSource.prototype,{supports:function(s,l){return s.protocol&&s.protocol==="http://iiif.io/api/image"||s["@context"]&&(s["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||s["@context"]==="http://iiif.io/api/image/1/context.json")||s.profile&&s.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||s.identifier&&s.width&&s.height?!0:!!(s.documentElement&&s.documentElement.tagName==="info"&&s.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(s,l,u){if(t.isPlainObject(s)){if(!s["@context"])s["@context"]="http://iiif.io/api/image/1.0/context.json",s["@id"]=l.replace("/info.json",""),s.version=1;else{var f=s["@context"];if(Array.isArray(f)){for(var d=0;d<f.length;d++)if(typeof f[d]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(f[d])||f[d]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){f=f[d];break}}switch(f){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":s.version=1;break;case"http://iiif.io/api/image/2/context.json":s.version=2;break;case"http://iiif.io/api/image/3/context.json":s.version=3;break;default:t.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(s.preferredFormats){for(var c=0;c<s.preferredFormats.length;c++)if(e.imageFormatSupported(s.preferredFormats[c])){s.tileFormat=s.preferredFormats[c];break}}return s}else{var h=a(s);return h["@context"]="http://iiif.io/api/image/1.0/context.json",h["@id"]=l.replace("/info.xml",""),h.version=1,h}},getTileWidth:function(s){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileWidth.call(this,s);var l=Math.pow(2,this.maxLevel-s);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].width:this._tileWidth},getTileHeight:function(s){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileHeight.call(this,s);var l=Math.pow(2,this.maxLevel-s);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].height:this._tileHeight},getLevelScale:function(s){if(this.emulateLegacyImagePyramid){var l=NaN;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(l=this.levels[s].width/this.levels[this.maxLevel].width),l}return t.TileSource.prototype.getLevelScale.call(this,s)},getNumTiles:function(s){if(this.emulateLegacyImagePyramid){var l=this.getLevelScale(s);return l?new t.Point(1,1):new t.Point(0,0)}return t.TileSource.prototype.getNumTiles.call(this,s)},getTileAtPoint:function(s,l){return this.emulateLegacyImagePyramid?new t.Point(0,0):t.TileSource.prototype.getTileAtPoint.call(this,s,l)},getTileUrl:function(s,l,u){if(this.emulateLegacyImagePyramid){var h=null;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(h=this.levels[s].url),h}var f="0",d=Math.pow(.5,this.maxLevel-s),c=Math.round(this.width*d),v=Math.round(this.height*d),g,m,p,y,w,T,O,I,R,L,N,E,C,b;return g=this.getTileWidth(s),m=this.getTileHeight(s),p=Math.round(g/d),y=Math.round(m/d),this.version===1?C="native."+this.tileFormat:C="default."+this.tileFormat,c<g&&v<m?(this.version===2&&c===this.width?L="full":this.version===3&&c===this.width&&v===this.height?L="max":this.version===3?L=c+","+v:L=c+",",w="full"):(T=l*p,O=u*y,I=Math.min(p,this.width-T),R=Math.min(y,this.height-O),l===0&&u===0&&I===this.width&&R===this.height?w="full":w=[T,O,I,R].join(","),N=Math.round(I*d),E=Math.round(R*d),this.version===2&&N===this.width?L="full":this.version===3&&N===this.width&&E===this.height?L="max":this.version===3?L=N+","+E:L=N+","),b=[this._id,w,L,f,C].join("/"),b},__testonly__:{canBeTiled:i,constructLevels:n}});function i(s){var l=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(s.profile)?s.profile[0]:s.profile,h=l.indexOf(u)!==-1,f=!1;return s.version===2&&s.profile.length>1&&s.profile[1].supports&&(f=s.profile[1].supports.indexOf("sizeByW")!==-1),s.version===3&&s.extraFeatures&&(f=s.extraFeatures.indexOf("sizeByWh")!==-1),!h||f}function n(s){for(var l=[],u=0;u<s.sizes.length;u++)l.push({url:s._id+"/full/"+s.sizes[u].width+","+(s.version===3?s.sizes[u].height:"")+"/0/default."+s.tileFormat,width:s.sizes[u].width,height:s.sizes[u].height});return l.sort(function(h,f){return h.width-f.width})}function a(s){if(!s||!s.documentElement)throw new Error(t.getString("Errors.Xml"));var l=s.documentElement,u=l.tagName,h=null;if(u==="info")try{return h={},o(l,h),h}catch(f){throw f instanceof Error?f:new Error(t.getString("Errors.IIIF"))}throw new Error(t.getString("Errors.IIIF"))}function o(s,l,u){var h,f;if(s.nodeType===3&&u)f=s.nodeValue.trim(),f.match(/^\d*$/)&&(f=Number(f)),l[u]?(t.isArray(l[u])||(l[u]=[l[u]]),l[u].push(f)):l[u]=f;else if(s.nodeType===1)for(h=0;h<s.childNodes.length;h++)o(s.childNodes[h],l,s.nodeName)}}(e),function(t){t.OsmTileSource=function(i,n,a,o,s){var l;t.isPlainObject(i)?l=i:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!l.width||!l.height)&&(l.width=65572864,l.height=65572864),l.tileSize||(l.tileSize=256,l.tileOverlap=0),l.tilesUrl||(l.tilesUrl="http://tile.openstreetmap.org/"),l.minLevel=8,t.TileSource.apply(this,[l])},t.extend(t.OsmTileSource.prototype,t.TileSource.prototype,{supports:function(i,n){return i.type&&i.type==="openstreetmaps"},configure:function(i,n,a){return i},getTileUrl:function(i,n,a){return this.tilesUrl+(i-8)+"/"+n+"/"+a+".png"}})}(e),function(t){t.TmsTileSource=function(i,n,a,o,s){var l;t.isPlainObject(i)?l=i:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(l.width/256)*256,h=Math.ceil(l.height/256)*256,f;u>h?f=u/256:f=h/256,l.maxLevel=Math.ceil(Math.log(f)/Math.log(2))-1,l.tileSize=256,l.width=u,l.height=h,t.TileSource.apply(this,[l])},t.extend(t.TmsTileSource.prototype,t.TileSource.prototype,{supports:function(i,n){return i.type&&i.type==="tiledmapservice"},configure:function(i,n,a){return i},getTileUrl:function(i,n,a){var o=this.getNumTiles(i).y-1;return this.tilesUrl+i+"/"+n+"/"+(o-a)+".png"}})}(e),function(t){t.ZoomifyTileSource=function(i){typeof i.tileSize>"u"&&(i.tileSize=256),typeof i.fileFormat>"u"&&(i.fileFormat="jpg",this.fileFormat=i.fileFormat);var n={x:i.width,y:i.height};for(i.imageSizes=[{x:i.width,y:i.height}],i.gridSize=[this._getGridSize(i.width,i.height,i.tileSize)];parseInt(n.x,10)>i.tileSize||parseInt(n.y,10)>i.tileSize;)n.x=Math.floor(n.x/2),n.y=Math.floor(n.y/2),i.imageSizes.push({x:n.x,y:n.y}),i.gridSize.push(this._getGridSize(n.x,n.y,i.tileSize));i.imageSizes.reverse(),i.gridSize.reverse(),i.minLevel=0,i.maxLevel=i.gridSize.length-1,e.TileSource.apply(this,[i])},t.extend(t.ZoomifyTileSource.prototype,t.TileSource.prototype,{_getGridSize:function(i,n,a){return{x:Math.ceil(i/a),y:Math.ceil(n/a)}},_calculateAbsoluteTileNumber:function(i,n,a){for(var o=0,s={},l=0;l<i;l++)s=this.gridSize[l],o+=s.x*s.y;return s=this.gridSize[i],o+=s.x*a+n,o},supports:function(i,n){return i.type&&i.type==="zoomifytileservice"},configure:function(i,n,a){return i},getTileUrl:function(i,n,a){var o=0,s=this._calculateAbsoluteTileNumber(i,n,a);return o=Math.floor(s/256),this.tilesUrl+"TileGroup"+o+"/"+i+"-"+n+"-"+a+"."+this.fileFormat}})}(e),function(t){t.LegacyTileSource=function(o){var s,l,u;t.isArray(o)&&(s={type:"legacy-image-pyramid",levels:o}),s.levels=i(s.levels),s.levels.length>0?(l=s.levels[s.levels.length-1].width,u=s.levels[s.levels.length-1].height):(l=0,u=0,t.console.error("No supported image formats found")),t.extend(!0,s,{width:l,height:u,tileSize:Math.max(u,l),tileOverlap:0,minLevel:0,maxLevel:s.levels.length>0?s.levels.length-1:0}),t.TileSource.apply(this,[s]),this.levels=s.levels},t.extend(t.LegacyTileSource.prototype,t.TileSource.prototype,{supports:function(o,s){return o.type&&o.type==="legacy-image-pyramid"||o.documentElement&&o.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(o,s,l){var u;return t.isPlainObject(o)?u=a(this,o):u=n(this,o),u},getLevelScale:function(o){var s=NaN;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(s=this.levels[o].width/this.levels[this.maxLevel].width),s},getNumTiles:function(o){var s=this.getLevelScale(o);return s?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(o,s,l){var u=null;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(u=this.levels[o].url),u}});function i(o){var s=[],l,u;for(u=0;u<o.length;u++)l=o[u],l.height&&l.width&&l.url?s.push({url:l.url,width:Number(l.width),height:Number(l.height)}):t.console.error("Unsupported image format: %s",l.url?l.url:"<no URL>");return s.sort(function(h,f){return h.height-f.height})}function n(o,s){if(!s||!s.documentElement)throw new Error(t.getString("Errors.Xml"));var l=s.documentElement,u=l.tagName,h=null,f=[],d,c;if(u==="image")try{for(h={type:l.getAttribute("type"),levels:[]},f=l.getElementsByTagName("level"),c=0;c<f.length;c++)d=f[c],h.levels.push({url:d.getAttribute("url"),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10)});return a(o,h)}catch(v){throw v instanceof Error?v:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+s)}throw new Error("Unknown element "+u)}function a(o,s){return s.levels}}(e),function(t){t.ImageTileSource=function(i){i=t.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},i),t.TileSource.apply(this,[i])},t.extend(t.ImageTileSource.prototype,t.TileSource.prototype,{supports:function(i,n){return i.type&&i.type==="image"},configure:function(i,n,a){return i},getImageInfo:function(i){var n=this._image=new Image,a=this;this.crossOriginPolicy&&(n.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(n.useCredentials=this.ajaxWithCredentials),t.addEvent(n,"load",function(){a.width=n.naturalWidth,a.height=n.naturalHeight,a.aspectRatio=a.width/a.height,a.dimensions=new t.Point(a.width,a.height),a._tileWidth=a.width,a._tileHeight=a.height,a.tileOverlap=0,a.minLevel=0,a.levels=a._buildLevels(),a.maxLevel=a.levels.length-1,a.ready=!0,a.raiseEvent("ready",{tileSource:a})}),t.addEvent(n,"error",function(){a.raiseEvent("open-failed",{message:"Error loading image at "+i,source:i})}),n.src=i},getLevelScale:function(i){var n=NaN;return i>=this.minLevel&&i<=this.maxLevel&&(n=this.levels[i].width/this.levels[this.maxLevel].width),n},getNumTiles:function(i){var n=this.getLevelScale(i);return n?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(i,n,a){var o=null;return i>=this.minLevel&&i<=this.maxLevel&&(o=this.levels[i].url),o},getContext2D:function(i,n,a){var o=null;return i>=this.minLevel&&i<=this.maxLevel&&(o=this.levels[i].context2D),o},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var i=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!t.supportsCanvas||!this.useCanvas)return delete this._image,i;var n=this._image.naturalWidth,a=this._image.naturalHeight,o=document.createElement("canvas"),s=o.getContext("2d");if(o.width=n,o.height=a,s.drawImage(this._image,0,0,n,a),i[0].context2D=s,delete this._image,t.isCanvasTainted(o))return i;for(;n>=2&&a>=2;){n=Math.floor(n/2),a=Math.floor(a/2);var l=document.createElement("canvas"),u=l.getContext("2d");l.width=n,l.height=a,u.drawImage(o,0,0,n,a),i.splice(0,0,{context2D:u,width:n,height:a}),o=l,s=u}return i},_freeupCanvasMemory:function(){for(var i=0;i<this.levels.length;i++)this.levels[i].context2D&&(this.levels[i].context2D.canvas.height=0,this.levels[i].context2D.canvas.width=0)}})}(e),function(t){t.TileSourceCollection=function(i,n,a,o){t.console.error("TileSourceCollection is deprecated; use World instead")}}(e),function(t){t.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},t.Button=function(u){var h=this;t.EventSource.call(this),t.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||t.makeNeutralElement("div"),u.element||(this.imgRest=t.makeTransparentImage(this.srcRest),this.imgGroup=t.makeTransparentImage(this.srcGroup),this.imgHover=t.makeTransparentImage(this.srcHover),this.imgDown=t.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,t.setElementPointerEventsNone(this.imgRest),t.setElementPointerEventsNone(this.imgGroup),t.setElementPointerEventsNone(this.imgHover),t.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",t.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",t.Browser.vendor===t.BROWSERS.FIREFOX&&t.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=t.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new t.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(f){f.insideElementPressed?(s(h,t.ButtonState.DOWN),h.raiseEvent("enter",{originalEvent:f.originalEvent})):f.buttonDownAny||s(h,t.ButtonState.HOVER)},focusHandler:function(f){h.tracker.enterHandler(f),h.raiseEvent("focus",{originalEvent:f.originalEvent})},leaveHandler:function(f){l(h,t.ButtonState.GROUP),f.insideElementPressed&&h.raiseEvent("exit",{originalEvent:f.originalEvent})},blurHandler:function(f){h.tracker.leaveHandler(f),h.raiseEvent("blur",{originalEvent:f.originalEvent})},pressHandler:function(f){s(h,t.ButtonState.DOWN),h.raiseEvent("press",{originalEvent:f.originalEvent})},releaseHandler:function(f){f.insideElementPressed&&f.insideElementReleased?(l(h,t.ButtonState.HOVER),h.raiseEvent("release",{originalEvent:f.originalEvent})):f.insideElementPressed?l(h,t.ButtonState.GROUP):s(h,t.ButtonState.HOVER)},clickHandler:function(f){f.quick&&h.raiseEvent("click",{originalEvent:f.originalEvent})},keyHandler:function(f){f.keyCode===13?(h.raiseEvent("click",{originalEvent:f.originalEvent}),h.raiseEvent("release",{originalEvent:f.originalEvent}),f.preventDefault=!0):f.preventDefault=!1}}),l(this,t.ButtonState.REST)},t.extend(t.Button.prototype,t.EventSource.prototype,{notifyGroupEnter:function(){s(this,t.ButtonState.GROUP)},notifyGroupExit:function(){l(this,t.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),t.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),t.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function i(u){t.requestAnimationFrame(function(){n(u)})}function n(u){var h,f,d;u.shouldFade&&(h=t.now(),f=h-u.fadeBeginTime,d=1-f/u.fadeLength,d=Math.min(1,d),d=Math.max(0,d),u.imgGroup&&t.setElementOpacity(u.imgGroup,d,!0),d>0&&i(u))}function a(u){u.shouldFade=!0,u.fadeBeginTime=t.now()+u.fadeDelay,window.setTimeout(function(){i(u)},u.fadeDelay)}function o(u){u.shouldFade=!1,u.imgGroup&&t.setElementOpacity(u.imgGroup,1,!0)}function s(u,h){u.element.disabled||(h>=t.ButtonState.GROUP&&u.currentState===t.ButtonState.REST&&(o(u),u.currentState=t.ButtonState.GROUP),h>=t.ButtonState.HOVER&&u.currentState===t.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=t.ButtonState.HOVER),h>=t.ButtonState.DOWN&&u.currentState===t.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=t.ButtonState.DOWN))}function l(u,h){u.element.disabled||(h<=t.ButtonState.HOVER&&u.currentState===t.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=t.ButtonState.HOVER),h<=t.ButtonState.GROUP&&u.currentState===t.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=t.ButtonState.GROUP),h<=t.ButtonState.REST&&u.currentState===t.ButtonState.GROUP&&(a(u),u.currentState=t.ButtonState.REST))}}(e),function(t){t.ButtonGroup=function(i){t.extend(!0,this,{buttons:[],clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},i);var n=this.buttons.concat([]),a=this,o;if(this.element=i.element||t.makeNeutralElement("div"),!i.group)for(this.element.style.display="inline-block",o=0;o<n.length;o++)this.element.appendChild(n[o].element);t.setElementTouchActionNone(this.element),this.tracker=new t.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(s){var l;for(l=0;l<a.buttons.length;l++)a.buttons[l].notifyGroupEnter()},leaveHandler:function(s){var l;if(!s.insideElementPressed)for(l=0;l<a.buttons.length;l++)a.buttons[l].notifyGroupExit()}})},t.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var i=this.buttons.pop();this.element.removeChild(i.element),i.destroy()}this.tracker.destroy(),this.element=null}}}(e),function(t){t.Rect=function(i,n,a,o,s){this.x=typeof i=="number"?i:0,this.y=typeof n=="number"?n:0,this.width=typeof a=="number"?a:0,this.height=typeof o=="number"?o:0,this.degrees=typeof s=="number"?s:0,this.degrees=t.positiveModulo(this.degrees,360);var l,u;this.degrees>=270?(l=this.getTopRight(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(l=this.getBottomRight(),this.x=l.x,this.y=l.y,this.degrees-=180):this.degrees>=90&&(l=this.getBottomLeft(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},t.Rect.fromSummits=function(i,n,a){var o=i.distanceTo(n),s=i.distanceTo(a),l=n.minus(i),u=Math.atan(l.y/l.x);return l.x<0?u+=Math.PI:l.y<0&&(u+=2*Math.PI),new t.Rect(i.x,i.y,o,s,u/Math.PI*180)},t.Rect.prototype={clone:function(){return new t.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new t.Point(this.x,this.y)},getBottomRight:function(){return new t.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new t.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new t.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new t.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new t.Point(this.width,this.height)},equals:function(i){return i instanceof t.Rect&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height&&this.degrees===i.degrees},times:function(i){return new t.Rect(this.x*i,this.y*i,this.width*i,this.height*i,this.degrees)},translate:function(i){return new t.Rect(this.x+i.x,this.y+i.y,this.width,this.height,this.degrees)},union:function(i){var n=this.getBoundingBox(),a=i.getBoundingBox(),o=Math.min(n.x,a.x),s=Math.min(n.y,a.y),l=Math.max(n.x+n.width,a.x+a.width),u=Math.max(n.y+n.height,a.y+a.height);return new t.Rect(o,s,l-o,u-s)},intersection:function(i){var n=1e-10,a=[],o=this.getTopLeft();i.containsPoint(o,n)&&a.push(o);var s=this.getTopRight();i.containsPoint(s,n)&&a.push(s);var l=this.getBottomLeft();i.containsPoint(l,n)&&a.push(l);var u=this.getBottomRight();i.containsPoint(u,n)&&a.push(u);var h=i.getTopLeft();this.containsPoint(h,n)&&a.push(h);var f=i.getTopRight();this.containsPoint(f,n)&&a.push(f);var d=i.getBottomLeft();this.containsPoint(d,n)&&a.push(d);var c=i.getBottomRight();this.containsPoint(c,n)&&a.push(c);for(var v=this._getSegments(),g=i._getSegments(),m=0;m<v.length;m++)for(var p=v[m],y=0;y<g.length;y++){var w=g[y],T=O(p[0],p[1],w[0],w[1]);T&&a.push(T)}function O(b,M,D,H){var k=M.minus(b),B=H.minus(D),U=-B.x*k.y+k.x*B.y;if(U===0)return null;var W=(k.x*(b.y-D.y)-k.y*(b.x-D.x))/U,J=(B.x*(b.y-D.y)-B.y*(b.x-D.x))/U;return-n<=W&&W<=1-n&&-n<=J&&J<=1-n?new t.Point(b.x+J*k.x,b.y+J*k.y):null}if(a.length===0)return null;for(var I=a[0].x,R=a[0].x,L=a[0].y,N=a[0].y,E=1;E<a.length;E++){var C=a[E];C.x<I&&(I=C.x),C.x>R&&(R=C.x),C.y<L&&(L=C.y),C.y>N&&(N=C.y)}return new t.Rect(I,L,R-I,N-L)},_getSegments:function(){var i=this.getTopLeft(),n=this.getTopRight(),a=this.getBottomLeft(),o=this.getBottomRight();return[[i,n],[n,o],[o,a],[a,i]]},rotate:function(i,n){if(i=t.positiveModulo(i,360),i===0)return this.clone();n=n||this.getCenter();var a=this.getTopLeft().rotate(i,n),o=this.getTopRight().rotate(i,n),s=o.minus(a);s=s.apply(function(u){var h=1e-15;return Math.abs(u)<h?0:u});var l=Math.atan(s.y/s.x);return s.x<0?l+=Math.PI:s.y<0&&(l+=2*Math.PI),new t.Rect(a.x,a.y,this.width,this.height,l/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var i=this.getTopLeft(),n=this.getTopRight(),a=this.getBottomLeft(),o=this.getBottomRight(),s=Math.min(i.x,n.x,a.x,o.x),l=Math.max(i.x,n.x,a.x,o.x),u=Math.min(i.y,n.y,a.y,o.y),h=Math.max(i.y,n.y,a.y,o.y);return new t.Rect(s,u,l-s,h-u)},getIntegerBoundingBox:function(){var i=this.getBoundingBox(),n=Math.floor(i.x),a=Math.floor(i.y),o=Math.ceil(i.width+i.x-n),s=Math.ceil(i.height+i.y-a);return new t.Rect(n,a,o,s)},containsPoint:function(i,n){n=n||0;var a=this.getTopLeft(),o=this.getTopRight(),s=this.getBottomLeft(),l=o.minus(a),u=s.minus(a);return(i.x-a.x)*l.x+(i.y-a.y)*l.y>=-n&&(i.x-o.x)*l.x+(i.y-o.y)*l.y<=n&&(i.x-a.x)*u.x+(i.y-a.y)*u.y>=-n&&(i.x-s.x)*u.x+(i.y-s.y)*u.y<=n},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(e),function(t){var i={};t.ReferenceStrip=function(d){var c=this,v=d.viewer,g=t.getElementSize(v.element),m,p,y;for(d.id||(d.id="referencestrip-"+t.now(),this.element=t.makeNeutralElement("div"),this.element.id=d.id,this.element.className="referencestrip"),d=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.referenceStripSizeRatio,position:t.DEFAULT_SETTINGS.referenceStripPosition,scroll:t.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold},d,{element:this.element}),t.extend(this,d),i[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,p=this.element.style,p.marginTop="0px",p.marginRight="0px",p.marginBottom="0px",p.marginLeft="0px",p.left="0px",p.bottom="0px",p.border="0px",p.background="#000",p.position="relative",t.setElementTouchActionNone(this.element),t.setElementOpacity(this.element,.8),this.viewer=v,this.tracker=new t.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:t.delegate(this,n),dragHandler:t.delegate(this,a),scrollHandler:t.delegate(this,o),enterHandler:t.delegate(this,l),leaveHandler:t.delegate(this,u),keyDownHandler:t.delegate(this,h),keyHandler:t.delegate(this,f),preProcessEventHandler:function(w){w.eventType==="wheel"&&(w.preventDefault=!0)}}),d.width&&d.height?(this.element.style.width=d.width+"px",this.element.style.height=d.height+"px",v.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):d.scroll==="horizontal"?(this.element.style.width=g.x*d.sizeRatio*v.tileSources.length+12*v.tileSources.length+"px",this.element.style.height=g.y*d.sizeRatio+"px",v.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=g.y*d.sizeRatio*v.tileSources.length+12*v.tileSources.length+"px",this.element.style.width=g.x*d.sizeRatio+"px",v.addControl(this.element,{anchor:t.ControlAnchor.TOP_LEFT})),this.panelWidth=g.x*this.sizeRatio+8,this.panelHeight=g.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},y=0;y<v.tileSources.length;y++)m=t.makeNeutralElement("div"),m.id=this.element.id+"-"+y,m.style.width=c.panelWidth+"px",m.style.height=c.panelHeight+"px",m.style.display="inline",m.style.float="left",m.style.cssFloat="left",m.style.styleFloat="left",m.style.padding="2px",t.setElementTouchActionNone(m),t.setElementPointerEventsNone(m),this.element.appendChild(m),m.activePanel=!1,this.panels.push(m);s(this,this.scroll==="vertical"?g.y:g.x,0),this.setFocus(0)},t.ReferenceStrip.prototype={setFocus:function(d){var c=this.element.querySelector("#"+this.element.id+"-"+d),v=t.getElementSize(this.viewer.canvas),g=Number(this.element.style.width.replace("px","")),m=Number(this.element.style.height.replace("px","")),p=-Number(this.element.style.marginLeft.replace("px","")),y=-Number(this.element.style.marginTop.replace("px","")),w;this.currentSelected!==c&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=c,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(w=Number(d)*(this.panelWidth+3),w>p+v.x-this.panelWidth?(w=Math.min(w,g-v.x),this.element.style.marginLeft=-w+"px",s(this,v.x,-w)):w<p&&(w=Math.max(0,w-v.x/2),this.element.style.marginLeft=-w+"px",s(this,v.x,-w))):(w=Number(d)*(this.panelHeight+3),w>y+v.y-this.panelHeight?(w=Math.min(w,m-v.y),this.element.style.marginTop=-w+"px",s(this,v.y,-w)):w<y&&(w=Math.max(0,w-v.y/2),this.element.style.marginTop=-w+"px",s(this,v.y,-w))),this.currentPage=d,l.call(this,{eventSource:this.tracker}))},update:function(){return!!i[this.id].animating},destroy:function(){if(this.miniViewers)for(var d in this.miniViewers)this.miniViewers[d].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function n(d){if(d.quick){var c;this.scroll==="horizontal"?c=Math.floor(d.position.x/this.panelWidth):c=Math.floor(d.position.y/this.panelHeight),this.viewer.goToPage(c)}this.element.focus()}function a(d){if(this.dragging=!0,this.element){var c=Number(this.element.style.marginLeft.replace("px","")),v=Number(this.element.style.marginTop.replace("px","")),g=Number(this.element.style.width.replace("px","")),m=Number(this.element.style.height.replace("px","")),p=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-d.delta.x>0?c>-(g-p.x)&&(this.element.style.marginLeft=c+d.delta.x*2+"px",s(this,p.x,c+d.delta.x*2)):-d.delta.x<0&&c<0&&(this.element.style.marginLeft=c+d.delta.x*2+"px",s(this,p.x,c+d.delta.x*2)):-d.delta.y>0?v>-(m-p.y)&&(this.element.style.marginTop=v+d.delta.y*2+"px",s(this,p.y,v+d.delta.y*2)):-d.delta.y<0&&v<0&&(this.element.style.marginTop=v+d.delta.y*2+"px",s(this,p.y,v+d.delta.y*2))}}function o(d){if(this.element){var c=Number(this.element.style.marginLeft.replace("px","")),v=Number(this.element.style.marginTop.replace("px","")),g=Number(this.element.style.width.replace("px","")),m=Number(this.element.style.height.replace("px","")),p=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?d.scroll>0?c>-(g-p.x)&&(this.element.style.marginLeft=c-d.scroll*60+"px",s(this,p.x,c-d.scroll*60)):d.scroll<0&&c<0&&(this.element.style.marginLeft=c-d.scroll*60+"px",s(this,p.x,c-d.scroll*60)):d.scroll<0?v>p.y-m&&(this.element.style.marginTop=v+d.scroll*60+"px",s(this,p.y,v+d.scroll*60)):d.scroll>0&&v<0&&(this.element.style.marginTop=v+d.scroll*60+"px",s(this,p.y,v+d.scroll*60)),d.preventDefault=!0}}function s(d,c,v){var g,m,p,y,w,T;for(d.scroll==="horizontal"?g=d.panelWidth:g=d.panelHeight,m=Math.ceil(c/g)+5,p=Math.ceil((Math.abs(v)+c)/g)+1,m=p-m,m=m<0?0:m,w=m;w<p&&w<d.panels.length;w++)if(T=d.panels[w],!T.activePanel){var O,I=d.viewer.tileSources[w];I.referenceStripThumbnailUrl?O={type:"image",url:I.referenceStripThumbnailUrl}:O=I,y=new t.Viewer({id:T.id,tileSources:[O],element:T,navigatorSizeRatio:d.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:d.viewer.loadTilesWithAjax,ajaxHeaders:d.viewer.ajaxHeaders,useCanvas:d.useCanvas}),t.setElementPointerEventsNone(y.canvas),t.setElementPointerEventsNone(y.container),y.innerTracker.setTracking(!1),y.outerTracker.setTracking(!1),d.miniViewers[T.id]=y,T.activePanel=!0}}function l(d){var c=d.eventSource.element;this.scroll==="horizontal"?c.style.marginBottom="0px":c.style.marginLeft="0px"}function u(d){var c=d.eventSource.element;this.scroll==="horizontal"?c.style.marginBottom="-"+t.getElementSize(c).y/2+"px":c.style.marginLeft="-"+t.getElementSize(c).x/2+"px"}function h(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 38:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 40:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 37:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 39:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}function f(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 61:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 45:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 48:case 119:case 87:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 115:case 83:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 97:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 100:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}}(e),function(t){t.DisplayRect=function(i,n,a,o,s,l){t.Rect.apply(this,[i,n,a,o]),this.minLevel=s,this.maxLevel=l},t.extend(t.DisplayRect.prototype,t.Rect.prototype)}(e),function(t){t.Spring=function(n){var a=arguments;typeof n!="object"&&(n={initial:a.length&&typeof a[0]=="number"?a[0]:void 0,springStiffness:a.length>1?a[1].springStiffness:5,animationTime:a.length>1?a[1].animationTime:1.5}),t.console.assert(typeof n.springStiffness=="number"&&n.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),t.console.assert(typeof n.animationTime=="number"&&n.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),n.exponential&&(this._exponential=!0,delete n.exponential),t.extend(!0,this,n),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:t.now()},t.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},t.Spring.prototype={resetTo:function(n){t.console.assert(!this._exponential||n!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=n,this.start.time=this.target.time=this.current.time=t.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(n){t.console.assert(!this._exponential||n!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=n,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(n){this.start.value+=n,this.target.value+=n,this._exponential&&(t.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(n){this._exponential=n,this._exponential&&(t.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=t.now();var n,a;this._exponential?(n=this.start._logValue,a=this.target._logValue):(n=this.start.value,a=this.target.value);var o=this.current.time>=this.target.time?a:n+(a-n)*i(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),s=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,s!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function i(n,a){return(1-Math.exp(n*-a))/(1-Math.exp(-n))}}(e),function(t){t.ImageJob=function(n){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null},n),this.data=null,this.userData={},this.errorMsg=null},t.ImageJob.prototype={start:function(){var n=this,a=this.abort;this.jobId=window.setTimeout(function(){n.finish(null,null,"Image load exceeded timeout ("+n.timeout+" ms)")},this.timeout),this.abort=function(){n.source.downloadTileAbort(n),typeof a=="function"&&a()},this.source.downloadTileStart(this)},finish:function(n,a,o){this.data=n,this.request=a,this.errorMsg=o,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(n){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},n)},t.ImageLoader.prototype={addJob:function(n){if(!n.source){t.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var a=t.TileSource.prototype;n.source={downloadTileStart:a.downloadTileStart,downloadTileAbort:a.downloadTileAbort}}var o=this,s=function(h){i(o,h,n.callback)},l={src:n.src,tile:n.tile||{},source:n.source,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.loadWithAjax?n.ajaxHeaders:null,crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,postData:n.postData,callback:s,abort:n.abort,timeout:this.timeout},u=new t.ImageJob(l);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var n=0;n<this.jobQueue.length;n++){var a=this.jobQueue[n];typeof a.abort=="function"&&a.abort()}this.jobQueue=[]}};function i(n,a,o){var s;n.jobsInProgress--,(!n.jobLimit||n.jobsInProgress<n.jobLimit)&&n.jobQueue.length>0&&(s=n.jobQueue.shift(),s.start(),n.jobsInProgress++),o(a.data,a.errorMsg,a.request)}}(e),function(t){t.Tile=function(i,n,a,o,s,l,u,h,f,d,c,v){this.level=i,this.x=n,this.y=a,this.bounds=o,this.sourceBounds=d,this.exists=s,this._url=l,this.postData=c,this.context2D=u,this.loadWithAjax=h,this.ajaxHeaders=f,v===void 0&&(t.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),v=t.TileSource.prototype.getTileHashKey(i,n,a,l,f,c)),this.cacheKey=v,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},t.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(i){if(!this.cacheImageRecord){t.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var n=this.getImage();if(!n)return;this.element=t.makeNeutralElement("div"),this.imgElement=n.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==i&&i.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),t.setElementOpacity(this.element,this.opacity)},get image(){return t.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return t.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(i,n,a,o,s,l){var u=this.position.times(t.pixelDensityRatio),h=this.size.times(t.pixelDensityRatio),f;if(!this.context2D&&!this.cacheImageRecord){t.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(f=this.getCanvasContext(),!this.loaded||!f){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}i.save(),i.globalAlpha=this.opacity,typeof a=="number"&&a!==1&&(u=u.times(a),h=h.times(a)),o instanceof t.Point&&(u=u.plus(o)),i.globalAlpha===1&&this.hasTransparency&&(s&&(u.x=Math.round(u.x),u.y=Math.round(u.y),h.x=Math.round(h.x),h.y=Math.round(h.y)),i.clearRect(u.x,u.y,h.x,h.y)),n({context:i,tile:this,rendered:f});var d,c;this.sourceBounds?(d=Math.min(this.sourceBounds.width,f.canvas.width),c=Math.min(this.sourceBounds.height,f.canvas.height)):(d=f.canvas.width,c=f.canvas.height),i.translate(u.x+h.x/2,0),this.flipped&&i.scale(-1,1),i.drawImage(f.canvas,0,0,d,c,-h.x/2,u.y,h.x,h.y),i.restore()},getScaleForEdgeSmoothing:function(){var i;if(this.cacheImageRecord)i=this.cacheImageRecord.getRenderedContext();else if(this.context2D)i=this.context2D;else return t.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return i.canvas.width/(this.size.x*t.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(i,n,a){var o=Math.max(1,Math.ceil((a.x-n.x)/2)),s=Math.max(1,Math.ceil((a.y-n.y)/2));return new t.Point(o,s).minus(this.position.times(t.pixelDensityRatio).times(i||1).apply(function(l){return l%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(e),function(t){t.OverlayPlacement=t.Placement,t.OverlayRotationMode=t.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),t.Overlay=function(i,n,a){var o;t.isPlainObject(i)?o=i:o={element:i,location:n,placement:a},this.element=o.element,this.style=o.element.style,this._init(o)},t.Overlay.prototype={_init:function(i){this.location=i.location,this.placement=i.placement===void 0?t.Placement.TOP_LEFT:i.placement,this.onDraw=i.onDraw,this.checkResize=i.checkResize===void 0?!0:i.checkResize,this.width=i.width===void 0?null:i.width,this.height=i.height===void 0?null:i.height,this.rotationMode=i.rotationMode||t.OverlayRotationMode.EXACT,this.location instanceof t.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=t.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new t.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(i,n){var a=t.Placement.properties[this.placement];!a||(a.isHorizontallyCentered?i.x-=n.x/2:a.isRight&&(i.x-=n.x),a.isVerticallyCentered?i.y-=n.y/2:a.isBottom&&(i.y-=n.y))},destroy:function(){var i=this.element,n=this.style;i.parentNode&&(i.parentNode.removeChild(i),i.prevElementParent&&(n.display="none",document.body.appendChild(i))),this.onDraw=null,n.top="",n.left="",n.position="",this.width!==null&&(n.width=""),this.height!==null&&(n.height="");var a=t.getCssPropertyWithVendorPrefix("transformOrigin"),o=t.getCssPropertyWithVendorPrefix("transform");a&&o&&(n[a]="",n[o]="")},drawHTML:function(i,n){var a=this.element;a.parentNode!==i&&(a.prevElementParent=a.parentNode,a.prevNextSibling=a.nextSibling,i.appendChild(a),this.style.position="absolute",this.size=t.getElementSize(a));var o=this._getOverlayPositionAndSize(n),s=o.position,l=this.size=o.size,u=o.rotate;if(this.onDraw)this.onDraw(s,l,this.element);else{var h=this.style;h.left=s.x+"px",h.top=s.y+"px",this.width!==null&&(h.width=l.x+"px"),this.height!==null&&(h.height=l.y+"px");var f=t.getCssPropertyWithVendorPrefix("transformOrigin"),d=t.getCssPropertyWithVendorPrefix("transform");f&&d&&(u?(h[f]=this._getTransformOrigin(),h[d]="rotate("+u+"deg)"):(h[f]="",h[d]="")),h.display="block"}},_getOverlayPositionAndSize:function(i){var n=i.pixelFromPoint(this.location,!0),a=this._getSizeInPixels(i);this.adjust(n,a);var o=0;if(i.getRotation(!0)&&this.rotationMode!==t.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var s=new t.Rect(n.x,n.y,a.x,a.y),l=this._getBoundingBox(s,i.getRotation(!0));n=l.getTopLeft(),a=l.getSize()}else o=i.getRotation(!0);return{position:n,size:a,rotate:o}},_getSizeInPixels:function(i){var n=this.size.x,a=this.size.y;if(this.width!==null||this.height!==null){var o=i.deltaPixelsFromPointsNoRotate(new t.Point(this.width||0,this.height||0),!0);this.width!==null&&(n=o.x),this.height!==null&&(a=o.y)}if(this.checkResize&&(this.width===null||this.height===null)){var s=this.size=t.getElementSize(this.element);this.width===null&&(n=s.x),this.height===null&&(a=s.y)}return new t.Point(n,a)},_getBoundingBox:function(i,n){var a=this._getPlacementPoint(i);return i.rotate(n,a).getBoundingBox()},_getPlacementPoint:function(i){var n=new t.Point(i.x,i.y),a=t.Placement.properties[this.placement];return a&&(a.isHorizontallyCentered?n.x+=i.width/2:a.isRight&&(n.x+=i.width),a.isVerticallyCentered?n.y+=i.height/2:a.isBottom&&(n.y+=i.height)),n},_getTransformOrigin:function(){var i="",n=t.Placement.properties[this.placement];return n&&(n.isLeft?i="left":n.isRight&&(i="right"),n.isTop?i+=" top":n.isBottom&&(i+=" bottom")),i},update:function(i,n){var a=t.isPlainObject(i)?i:{location:i,placement:n};this._init({location:a.location||this.location,placement:a.placement!==void 0?a.placement:this.placement,onDraw:a.onDraw||this.onDraw,checkResize:a.checkResize||this.checkResize,width:a.width!==void 0?a.width:this.width,height:a.height!==void 0?a.height:this.height,rotationMode:a.rotationMode||this.rotationMode})},getBounds:function(i){t.console.assert(i,"A viewport must now be passed to Overlay.getBounds.");var n=this.width,a=this.height;if(n===null||a===null){var o=i.deltaPointsFromPixelsNoRotate(this.size,!0);n===null&&(n=o.x),a===null&&(a=o.y)}var s=this.location.clone();return this.adjust(s,new t.Point(n,a)),this._adjustBoundsForRotation(i,new t.Rect(s.x,s.y,n,a))},_adjustBoundsForRotation:function(i,n){if(!i||i.getRotation(!0)===0||this.rotationMode===t.OverlayRotationMode.EXACT)return n;if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return n;var a=this._getOverlayPositionAndSize(i);return i.viewerElementToViewportRectangle(new t.Rect(a.position.x,a.position.y,a.size.x,a.size.y))}return n.rotate(-i.getRotation(!0),this._getPlacementPoint(n))}}}(e),function(t){t.Drawer=function(i){t.console.assert(i.viewer,"[Drawer] options.viewer is required");var n=arguments;if(t.isPlainObject(i)||(i={source:n[0],viewport:n[1],element:n[2]}),t.console.assert(i.viewport,"[Drawer] options.viewport is required"),t.console.assert(i.element,"[Drawer] options.element is required"),i.source&&t.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=i.viewer,this.viewport=i.viewport,this.debugGridColor=typeof i.debugGridColor=="string"?[i.debugGridColor]:i.debugGridColor||t.DEFAULT_SETTINGS.debugGridColor,i.opacity&&t.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=t.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=t.getElement(i.element),this.canvas=t.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var a=this._calculateCanvasSize();this.canvas.width=a.x,this.canvas.height=a.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",t.setElementOpacity(this.canvas,this.opacity,!0),t.setElementPointerEventsNone(this.canvas),t.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},t.Drawer.prototype={addOverlay:function(i,n,a,o){return t.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(i,n,a,o),this},updateOverlay:function(i,n,a){return t.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(i,n,a),this},removeOverlay:function(i){return t.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(i),this},clearOverlays:function(){return t.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(i){var n=this.viewport.pixelFromPointNoRotate(i,!0);return new t.Point(n.x*t.pixelDensityRatio,n.y*t.pixelDensityRatio)},clipWithPolygons:function(i,n){if(!!this.useCanvas){var a=this._getContext(n);a.beginPath(),i.forEach(function(o){o.forEach(function(s,l){a[l===0?"moveTo":"lineTo"](s.x,s.y)})}),a.clip()}},setOpacity:function(i){t.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var n=this.viewer.world,a=0;a<n.getItemCount();a++)n.getItemAt(a).setOpacity(i);return this},getOpacity:function(){t.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var i=this.viewer.world,n=0,a=0;a<i.getItemCount();a++){var o=i.getItemAt(a).getOpacity();o>n&&(n=o)}return n},needsUpdate:function(){return t.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return t.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return t.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return t.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var i=this._calculateCanvasSize();if((this.canvas.width!==i.x||this.canvas.height!==i.y)&&(this.canvas.width=i.x,this.canvas.height=i.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var n=this._calculateSketchCanvasSize();this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(i,n){if(!!this.useCanvas){var a=this._getContext(i);if(n)a.clearRect(n.x,n.y,n.width,n.height);else{var o=a.canvas;a.clearRect(0,0,o.width,o.height)}}},viewportToDrawerRectangle:function(i){var n=this.viewport.pixelFromPointNoRotate(i.getTopLeft(),!0),a=this.viewport.deltaPixelsFromPointsNoRotate(i.getSize(),!0);return new t.Rect(n.x*t.pixelDensityRatio,n.y*t.pixelDensityRatio,a.x*t.pixelDensityRatio,a.y*t.pixelDensityRatio)},drawTile:function(i,n,a,o,s,l,u){if(t.console.assert(i,"[Drawer.drawTile] tile is required"),t.console.assert(n,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var h=this._getContext(a);o=o||1,i.drawCanvas(h,n,o,s,l,u)}else i.drawHTML(this.canvas)},_getContext:function(i){var n=this.context;if(i){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var a=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=a.x,this.sketchCanvas.height=a.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var o=this;this.viewer.addHandler("rotate",function s(){if(o.viewport.getRotation()!==0){o.viewer.removeHandler("rotate",s);var l=o._calculateSketchCanvasSize();o.sketchCanvas.width=l.x,o.sketchCanvas.height=l.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}n=this.sketchContext}return n},saveContext:function(i){!this.useCanvas||this._getContext(i).save()},restoreContext:function(i){!this.useCanvas||this._getContext(i).restore()},setClip:function(i,n){if(!!this.useCanvas){var a=this._getContext(n);a.beginPath(),a.rect(i.x,i.y,i.width,i.height),a.clip()}},drawRectangle:function(i,n,a){if(!!this.useCanvas){var o=this._getContext(a);o.save(),o.fillStyle=n,o.fillRect(i.x,i.y,i.width,i.height),o.restore()}},blendSketch:function(i,n,a,o){var s=i;if(t.isPlainObject(s)||(s={opacity:i,scale:n,translate:a,compositeOperation:o}),!(!this.useCanvas||!this.sketchCanvas)){i=s.opacity,o=s.compositeOperation;var l=s.bounds;if(this.context.save(),this.context.globalAlpha=i,o&&(this.context.globalCompositeOperation=o),l)l.x<0&&(l.width+=l.x,l.x=0),l.x+l.width>this.canvas.width&&(l.width=this.canvas.width-l.x),l.y<0&&(l.height+=l.y,l.y=0),l.y+l.height>this.canvas.height&&(l.height=this.canvas.height-l.y),this.context.drawImage(this.sketchCanvas,l.x,l.y,l.width,l.height,l.x,l.y,l.width,l.height);else{n=s.scale||1,a=s.translate;var u=a instanceof t.Point?a:new t.Point(0,0),h=0,f=0;if(a){var d=this.sketchCanvas.width-this.canvas.width,c=this.sketchCanvas.height-this.canvas.height;h=Math.round(d/2),f=Math.round(c/2)}this.context.drawImage(this.sketchCanvas,u.x-h*n,u.y-f*n,(this.canvas.width+2*h)*n,(this.canvas.height+2*f)*n,-h,-f,this.canvas.width+2*h,this.canvas.height+2*f)}this.context.restore()}},drawDebugInfo:function(i,n,a,o){if(!!this.useCanvas){var s=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,l=this.context;l.save(),l.lineWidth=2*t.pixelDensityRatio,l.font="small-caps bold "+13*t.pixelDensityRatio+"px arial",l.strokeStyle=this.debugGridColor[s],l.fillStyle=this.debugGridColor[s],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),o.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:o.getRotation(!0),point:o.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0)}),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),l.strokeRect(i.position.x*t.pixelDensityRatio,i.position.y*t.pixelDensityRatio,i.size.x*t.pixelDensityRatio,i.size.y*t.pixelDensityRatio);var u=(i.position.x+i.size.x/2)*t.pixelDensityRatio,h=(i.position.y+i.size.y/2)*t.pixelDensityRatio;l.translate(u,h),l.rotate(Math.PI/180*-this.viewport.getRotation(!0)),l.translate(-u,-h),i.x===0&&i.y===0&&(l.fillText("Zoom: "+this.viewport.getZoom(),i.position.x*t.pixelDensityRatio,(i.position.y-30)*t.pixelDensityRatio),l.fillText("Pan: "+this.viewport.getBounds().toString(),i.position.x*t.pixelDensityRatio,(i.position.y-20)*t.pixelDensityRatio)),l.fillText("Level: "+i.level,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+20)*t.pixelDensityRatio),l.fillText("Column: "+i.x,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+30)*t.pixelDensityRatio),l.fillText("Row: "+i.y,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+40)*t.pixelDensityRatio),l.fillText("Order: "+a+" of "+n,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+50)*t.pixelDensityRatio),l.fillText("Size: "+i.size.toString(),(i.position.x+10)*t.pixelDensityRatio,(i.position.y+60)*t.pixelDensityRatio),l.fillText("Position: "+i.position.toString(),(i.position.x+10)*t.pixelDensityRatio,(i.position.y+70)*t.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),l.restore()}},debugRect:function(i){if(this.useCanvas){var n=this.context;n.save(),n.lineWidth=2*t.pixelDensityRatio,n.strokeStyle=this.debugGridColor[0],n.fillStyle=this.debugGridColor[0],n.strokeRect(i.x*t.pixelDensityRatio,i.y*t.pixelDensityRatio,i.width*t.pixelDensityRatio,i.height*t.pixelDensityRatio),n.restore()}},setImageSmoothingEnabled:function(i){this.useCanvas&&(this._imageSmoothingEnabled=i,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(i){i.msImageSmoothingEnabled=this._imageSmoothingEnabled,i.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(i){var n=this._getContext(i).canvas;return new t.Point(n.width,n.height)},getCanvasCenter:function(){return new t.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(i){var n=i.point?i.point.times(t.pixelDensityRatio):this.getCanvasCenter(),a=this._getContext(i.useSketch);a.save(),a.translate(n.x,n.y),this.viewer.viewport.flipped?(a.rotate(Math.PI/180*-i.degrees),a.scale(-1,1)):a.rotate(Math.PI/180*i.degrees),a.translate(-n.x,-n.y)},_flip:function(i){i=i||{};var n=i.point?i.point.times(t.pixelDensityRatio):this.getCanvasCenter(),a=this._getContext(i.useSketch);a.translate(n.x,0),a.scale(-1,1),a.translate(-n.x,0)},_restoreRotationChanges:function(i){var n=this._getContext(i);n.restore()},_calculateCanvasSize:function(){var i=t.pixelDensityRatio,n=this.viewport.getContainerSize();return{x:Math.round(n.x*i),y:Math.round(n.y*i)}},_calculateSketchCanvasSize:function(){var i=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return i;var n=Math.ceil(Math.sqrt(i.x*i.x+i.y*i.y));return{x:n,y:n}}}}(e),function(t){t.Viewport=function(i){var n=arguments;n.length&&n[0]instanceof t.Point&&(i={containerSize:n[0],contentSize:n[1],config:n[2]}),i.config&&(t.extend(!0,i,i.config),delete i.config),this._margins=t.extend({left:0,top:0,right:0,bottom:0},i.margins||{}),delete i.margins,i.initialDegrees=i.degrees,delete i.degrees,t.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:t.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:t.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:t.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:t.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:t.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:t.DEFAULT_SETTINGS.degrees,flipped:t.DEFAULT_SETTINGS.flipped,homeFillsViewer:t.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:t.DEFAULT_SETTINGS.silenceMultiImageWarnings},i),this._updateContainerInnerSize(),this.centerSpringX=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new t.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new t.Spring({initial:i.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new t.Rect(0,0,1,1),1),this.goHome(!0),this.update()},t.Viewport.prototype={get degrees(){return t.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(i){t.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(i)},resetContentSize:function(i){return t.console.assert(i,"[Viewport.resetContentSize] contentSize is required"),t.console.assert(i instanceof t.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),t.console.assert(i.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),t.console.assert(i.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new t.Rect(0,0,1,i.y/i.x),i.x),this},setHomeBounds:function(i,n){t.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(i,n)},_setContentBounds:function(i,n){t.console.assert(i,"[Viewport._setContentBounds] bounds is required"),t.console.assert(i instanceof t.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),t.console.assert(i.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),t.console.assert(i.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=i.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(n),this._contentBounds=i.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(n),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:n,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var i=this._contentAspectRatio/this.getAspectRatio(),n;return this.homeFillsViewer?n=i>=1?i:1:n=i>=1?1:i,n/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var i=this._contentBounds.getCenter(),n=1/this.getHomeZoom(),a=n/this.getAspectRatio();return new t.Rect(i.x-n/2,i.y-a/2,n,a)},goHome:function(i){return this.viewer&&this.viewer.raiseEvent("home",{immediately:i}),this.fitBounds(this.getHomeBounds(),i)},getMinZoom:function(){var i=this.getHomeZoom(),n=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*i;return n},getMaxZoom:function(){var i=this.maxZoomLevel;return i||(i=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,i/=this._contentBounds.width),Math.max(i,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new t.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return t.extend({},this._margins)},setMargins:function(i){t.console.assert(t.type(i)==="object","[Viewport.setMargins] margins must be an object"),this._margins=t.extend({left:0,top:0,right:0,bottom:0},i),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(i){return this.getBoundsNoRotate(i).rotate(-this.getRotation(i))},getBoundsNoRotate:function(i){var n=this.getCenter(i),a=1/this.getZoom(i),o=a/this.getAspectRatio();return new t.Rect(n.x-a/2,n.y-o/2,a,o)},getBoundsWithMargins:function(i){return this.getBoundsNoRotateWithMargins(i).rotate(-this.getRotation(i),this.getCenter(i))},getBoundsNoRotateWithMargins:function(i){var n=this.getBoundsNoRotate(i),a=this._containerInnerSize.x*this.getZoom(i);return n.x-=this._margins.left/a,n.y-=this._margins.top/a,n.width+=(this._margins.left+this._margins.right)/a,n.height+=(this._margins.top+this._margins.bottom)/a,n},getCenter:function(i){var n=new t.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),a=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),o,s,l,u,h,f,d,c;return i?n:this.zoomPoint?(o=this.pixelFromPoint(this.zoomPoint,!0),s=this.getZoom(),l=1/s,u=l/this.getAspectRatio(),h=new t.Rect(n.x-l/2,n.y-u/2,l,u),f=this._pixelFromPoint(this.zoomPoint,h),d=f.minus(o).rotate(-this.getRotation(!0)),c=d.divide(this._containerInnerSize.x*s),a.plus(c)):a},getZoom:function(i){return i?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(i){return Math.max(Math.min(i,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(i){var n=this.viewportToViewerElementRectangle(i).getBoundingBox(),a=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),o=!1,s=!1;if(!this.wrapHorizontal){var l=n.x+n.width,u=a.x+a.width,h,f,d;n.width>a.width?h=this.visibilityRatio*a.width:h=this.visibilityRatio*n.width,f=a.x-l+h,d=u-n.x-h,h>a.width?(n.x+=(f+d)/2,o=!0):d<0?(n.x+=d,o=!0):f>0&&(n.x+=f,o=!0)}if(!this.wrapVertical){var c=n.y+n.height,v=a.y+a.height,g,m,p;n.height>a.height?g=this.visibilityRatio*a.height:g=this.visibilityRatio*n.height,m=a.y-c+g,p=v-n.y-g,g>a.height?(n.y+=(m+p)/2,s=!0):p<0?(n.y+=p,s=!0):m>0&&(n.y+=m,s=!0)}var y=o||s,w=y?this.viewerElementToViewportRectangle(n):i.clone();return w.xConstrained=o,w.yConstrained=s,w.constraintApplied=y,w},_raiseConstraintsEvent:function(i){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:i})},applyConstraints:function(i){var n=this.getZoom(),a=this._applyZoomConstraints(n);n!==a&&this.zoomTo(a,this.zoomPoint,i);var o=this.getConstrainedBounds(!1);return o.constraintApplied&&(this.fitBounds(o,i),this._raiseConstraintsEvent(i)),this},ensureVisible:function(i){return this.applyConstraints(i)},_fitBounds:function(i,n){n=n||{};var a=n.immediately||!1,o=n.constraints||!1,s=this.getAspectRatio(),l=i.getCenter(),u=new t.Rect(i.x,i.y,i.width,i.height,i.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=s?u.height=u.width/s:u.width=u.height*s,u.x=l.x-u.width/2,u.y=l.y-u.height/2;var h=1/u.width;if(a)return this.panTo(l,!0),this.zoomTo(h,null,!0),o&&this.applyConstraints(!0),this;var f=this.getCenter(!0),d=this.getZoom(!0);this.panTo(f,!0),this.zoomTo(d,null,!0);var c=this.getBounds(),v=this.getZoom();if(v===0||Math.abs(h/v-1)<1e-8)return this.zoomTo(h,null,!0),this.panTo(l,a),o&&this.applyConstraints(!1),this;if(o){this.panTo(l,!1),this.zoomTo(h,null,!1);var g=this.getConstrainedBounds();this.panTo(f,!0),this.zoomTo(d,null,!0),this.fitBounds(g)}else{var m=u.rotate(-this.getRotation()),p=m.getTopLeft().times(h).minus(c.getTopLeft().times(v)).divide(h-v);this.zoomTo(h,p,a)}return this},fitBounds:function(i,n){return this._fitBounds(i,{immediately:n,constraints:!1})},fitBoundsWithConstraints:function(i,n){return this._fitBounds(i,{immediately:n,constraints:!0})},fitVertically:function(i){var n=new t.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(n,i)},fitHorizontally:function(i){var n=new t.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(n,i)},getConstrainedBounds:function(i){var n,a;return n=this.getBounds(i),a=this._applyBoundaryConstraints(n),a},panBy:function(i,n){var a=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(a.plus(i),n)},panTo:function(i,n){return n?(this.centerSpringX.resetTo(i.x),this.centerSpringY.resetTo(i.y)):(this.centerSpringX.springTo(i.x),this.centerSpringY.springTo(i.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:i,immediately:n}),this},zoomBy:function(i,n,a){return this.zoomTo(this.zoomSpring.target.value*i,n,a)},zoomTo:function(i,n,a){var o=this;return this.zoomPoint=n instanceof t.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,a?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(i)}):this.zoomSpring.springTo(i),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:i,refPoint:n,immediately:a}),this},setRotation:function(i,n){return this.rotateTo(i,null,n)},getRotation:function(i){return i?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(i,n,a){return this.rotateTo(i,n,a)},rotateTo:function(i,n,a){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===i&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=n instanceof t.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,a)if(this.rotationPivot){var o=i-this._oldDegrees;if(!o)return this.rotationPivot=null,this;this._rotateAboutPivot(i)}else this.degreesSpring.resetTo(i);else{var s=t.positiveModulo(this.degreesSpring.current.value,360),l=t.positiveModulo(i,360),u=l-s;u>180?l-=360:u<-180&&(l+=360);var h=s-l;this.degreesSpring.resetTo(i+h),this.degreesSpring.springTo(i)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:i,immediately:!!a,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(i,n,a){return this.rotateTo(this.degreesSpring.target.value+i,n,a)},resize:function(i,n){var a=this.getBoundsNoRotate(),o=a,s;return this.containerSize.x=i.x,this.containerSize.y=i.y,this._updateContainerInnerSize(),n&&(s=i.x/this.containerSize.x,o.width=a.width*s,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:i,maintain:n}),this.fitBounds(o,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new t.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var i=this;this._adjustCenterSpringsForZoomPoint(function(){i.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var n=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,n},_rotateAboutPivot:function(i){var n=i===!0,a=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(a.x),this.centerSpringY.shiftBy(a.y),n?this.degreesSpring.update():this.degreesSpring.resetTo(i);var o=this.degreesSpring.current.value-this._oldDegrees,s=a.rotate(o*-1).times(-1);this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y)},_adjustCenterSpringsForZoomPoint:function(i){if(this.zoomPoint){var n=this.pixelFromPoint(this.zoomPoint,!0);i();var a=this.pixelFromPoint(this.zoomPoint,!0),o=a.minus(n),s=this.deltaPointsFromPixels(o,!0);this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else i()},deltaPixelsFromPointsNoRotate:function(i,n){return i.times(this._containerInnerSize.x*this.getZoom(n))},deltaPixelsFromPoints:function(i,n){return this.deltaPixelsFromPointsNoRotate(i.rotate(this.getRotation(n)),n)},deltaPointsFromPixelsNoRotate:function(i,n){return i.divide(this._containerInnerSize.x*this.getZoom(n))},deltaPointsFromPixels:function(i,n){return this.deltaPointsFromPixelsNoRotate(i,n).rotate(-this.getRotation(n))},pixelFromPointNoRotate:function(i,n){return this._pixelFromPointNoRotate(i,this.getBoundsNoRotate(n))},pixelFromPoint:function(i,n){return this._pixelFromPoint(i,this.getBoundsNoRotate(n))},_pixelFromPointNoRotate:function(i,n){return i.minus(n.getTopLeft()).times(this._containerInnerSize.x/n.width).plus(new t.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(i,n){return this._pixelFromPointNoRotate(i.rotate(this.getRotation(!0),this.getCenter(!0)),n)},pointFromPixelNoRotate:function(i,n){var a=this.getBoundsNoRotate(n);return i.minus(new t.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/a.width).plus(a.getTopLeft())},pointFromPixel:function(i,n){return this.pointFromPixelNoRotate(i,n).rotate(-this.getRotation(n),this.getCenter(n))},_viewportToImageDelta:function(i,n){var a=this._contentBoundsNoRotate.width;return new t.Point(i*this._contentSizeNoRotate.x/a,n*this._contentSizeNoRotate.x/a)},viewportToImageCoordinates:function(i,n){if(i instanceof t.Point)return this.viewportToImageCoordinates(i.x,i.y);if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(a===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageCoordinates(i,n,!0)}}return this._viewportToImageDelta(i-this._contentBoundsNoRotate.x,n-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(i,n){var a=this._contentBoundsNoRotate.width;return new t.Point(i/this._contentSizeNoRotate.x*a,n/this._contentSizeNoRotate.x*a)},imageToViewportCoordinates:function(i,n){if(i instanceof t.Point)return this.imageToViewportCoordinates(i.x,i.y);if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(a===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportCoordinates(i,n,!0)}}var s=this._imageToViewportDelta(i,n);return s.x+=this._contentBoundsNoRotate.x,s.y+=this._contentBoundsNoRotate.y,s},imageToViewportRectangle:function(i,n,a,o){var s=i;if(s instanceof t.Rect||(s=new t.Rect(i,n,a,o)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(i,n,a,o,!0)}}var h=this.imageToViewportCoordinates(s.x,s.y),f=this._imageToViewportDelta(s.width,s.height);return new t.Rect(h.x,h.y,f.x,f.y,s.degrees)},viewportToImageRectangle:function(i,n,a,o){var s=i;if(s instanceof t.Rect||(s=new t.Rect(i,n,a,o)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(i,n,a,o,!0)}}var h=this.viewportToImageCoordinates(s.x,s.y),f=this._viewportToImageDelta(s.width,s.height);return new t.Rect(h.x,h.y,f.x,f.y,s.degrees)},viewerElementToImageCoordinates:function(i){var n=this.pointFromPixel(i,!0);return this.viewportToImageCoordinates(n)},imageToViewerElementCoordinates:function(i){var n=this.imageToViewportCoordinates(i);return this.pixelFromPoint(n,!0)},windowToImageCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var n=i.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var n=this.imageToViewerElementCoordinates(i);return n.plus(t.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(i){return this.pointFromPixel(i,!0)},viewportToViewerElementCoordinates:function(i){return this.pixelFromPoint(i,!0)},viewerElementToViewportRectangle:function(i){return t.Rect.fromSummits(this.pointFromPixel(i.getTopLeft(),!0),this.pointFromPixel(i.getTopRight(),!0),this.pointFromPixel(i.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(i){return t.Rect.fromSummits(this.pixelFromPoint(i.getTopLeft(),!0),this.pixelFromPoint(i.getTopRight(),!0),this.pixelFromPoint(i.getBottomLeft(),!0))},windowToViewportCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var n=i.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(n)},viewportToWindowCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var n=this.viewportToViewerElementCoordinates(i);return n.plus(t.getElementPosition(this.viewer.element))},viewportToImageZoom:function(i){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(n===1){var a=this.viewer.world.getItemAt(0);return a.viewportToImageZoom(i)}}var o=this._contentSizeNoRotate.x,s=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=s/o*l;return i*u},imageToViewportZoom:function(i){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(n===1){var a=this.viewer.world.getItemAt(0);return a.imageToViewportZoom(i)}}var o=this._contentSizeNoRotate.x,s=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=o/s/l;return i*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(i){return this.flipped===i?this:(this.flipped=i,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:i}),this)}}}(e),function(t){t.TiledImage=function(s){var l=this;t.console.assert(s.tileCache,"[TiledImage] options.tileCache is required"),t.console.assert(s.drawer,"[TiledImage] options.drawer is required"),t.console.assert(s.viewer,"[TiledImage] options.viewer is required"),t.console.assert(s.imageLoader,"[TiledImage] options.imageLoader is required"),t.console.assert(s.source,"[TiledImage] options.source is required"),t.console.assert(!s.clip||s.clip instanceof t.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),t.EventSource.call(this),this._tileCache=s.tileCache,delete s.tileCache,this._drawer=s.drawer,delete s.drawer,this._imageLoader=s.imageLoader,delete s.imageLoader,s.clip instanceof t.Rect&&(this._clip=s.clip.clone()),delete s.clip;var u=s.x||0;delete s.x;var h=s.y||0;delete s.y,this.normHeight=s.source.dimensions.y/s.source.dimensions.x,this.contentAspectX=s.source.dimensions.x/s.source.dimensions.y;var f=1;s.width?(f=s.width,delete s.width,s.height&&(t.console.error("specifying both width and height to a tiledImage is not supported"),delete s.height)):s.height&&(f=s.height/this.normHeight,delete s.height);var d=s.fitBounds;delete s.fitBounds;var c=s.fitBoundsPlacement||e.Placement.CENTER;delete s.fitBoundsPlacement;var v=s.degrees||0;delete s.degrees,t.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,immediateRender:t.DEFAULT_SETTINGS.immediateRender,blendTime:t.DEFAULT_SETTINGS.blendTime,alwaysBlend:t.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:t.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:t.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:t.DEFAULT_SETTINGS.iOSDevice,debugMode:t.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:t.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:t.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:t.DEFAULT_SETTINGS.placeholderFillStyle,opacity:t.DEFAULT_SETTINGS.opacity,preload:t.DEFAULT_SETTINGS.preload,compositeOperation:t.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:t.DEFAULT_SETTINGS.subPixelRoundingForTransparency},s),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new t.Spring({initial:u,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new t.Spring({initial:h,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new t.Spring({initial:f,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new t.Spring({initial:v,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),d&&this.fitBounds(d,c,!0),this._drawingHandler=function(g){l.viewer.raiseEvent("tile-drawing",t.extend({tiledImage:l},g))}},t.extend(t.TiledImage.prototype,t.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(s){s!==this._fullyLoaded&&(this._fullyLoaded=s,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=t.now(),this._needsDraw=!0},update:function(){var s=this._xSpring.update(),l=this._ySpring.update(),u=this._scaleSpring.update(),h=this._degreesSpring.update();return s||l||u||h?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(s){return this.getBoundsNoRotate(s).rotate(this.getRotation(s),this._getRotationPoint(s))},getBoundsNoRotate:function(s){return s?new t.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new t.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return t.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(s){var l=this.getBoundsNoRotate(s);if(this._clip){var u=s?this._worldWidthCurrent:this._worldWidthTarget,h=u/this.source.dimensions.x,f=this._clip.times(h);l=new t.Rect(l.x+f.x,l.y+f.y,f.width,f.height)}return l.rotate(this.getRotation(s),this._getRotationPoint(s))},getTileBounds:function(s,l,u){var h=this.source.getNumTiles(s),f=(h.x+l%h.x)%h.x,d=(h.y+u%h.y)%h.y,c=this.source.getTileBounds(s,f,d);return this.getFlip()&&(c.x=1-c.x-c.width),c.x+=(l-f)/h.x,c.y+=this._worldHeightCurrent/this._worldWidthCurrent*((u-d)/h.y),c},getContentSize:function(){return new t.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var s=this.imageToWindowCoordinates(new t.Point(0,0)),l=this.imageToWindowCoordinates(this.getContentSize());return new t.Point(l.x-s.x,l.y-s.y)},_viewportToImageDelta:function(s,l,u){var h=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(s*(this.source.dimensions.x/h),l*(this.source.dimensions.y*this.contentAspectX/h))},viewportToImageCoordinates:function(s,l,u){var h;return s instanceof t.Point?(u=l,h=s):h=new t.Point(s,l),h=h.rotate(-this.getRotation(u),this._getRotationPoint(u)),u?this._viewportToImageDelta(h.x-this._xSpring.current.value,h.y-this._ySpring.current.value):this._viewportToImageDelta(h.x-this._xSpring.target.value,h.y-this._ySpring.target.value)},_imageToViewportDelta:function(s,l,u){var h=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(s/this.source.dimensions.x*h,l/this.source.dimensions.y/this.contentAspectX*h)},imageToViewportCoordinates:function(s,l,u){s instanceof t.Point&&(u=l,l=s.y,s=s.x);var h=this._imageToViewportDelta(s,l);return u?(h.x+=this._xSpring.current.value,h.y+=this._ySpring.current.value):(h.x+=this._xSpring.target.value,h.y+=this._ySpring.target.value),h.rotate(this.getRotation(u),this._getRotationPoint(u))},imageToViewportRectangle:function(s,l,u,h,f){var d=s;d instanceof t.Rect?f=l:d=new t.Rect(s,l,u,h);var c=this.imageToViewportCoordinates(d.getTopLeft(),f),v=this._imageToViewportDelta(d.width,d.height,f);return new t.Rect(c.x,c.y,v.x,v.y,d.degrees+this.getRotation(f))},viewportToImageRectangle:function(s,l,u,h,f){var d=s;s instanceof t.Rect?f=l:d=new t.Rect(s,l,u,h);var c=this.viewportToImageCoordinates(d.getTopLeft(),f),v=this._viewportToImageDelta(d.width,d.height,f);return new t.Rect(c.x,c.y,v.x,v.y,d.degrees-this.getRotation(f))},viewerElementToImageCoordinates:function(s){var l=this.viewport.pointFromPixel(s,!0);return this.viewportToImageCoordinates(l)},imageToViewerElementCoordinates:function(s){var l=this.imageToViewportCoordinates(s);return this.viewport.pixelFromPoint(l,!0)},windowToImageCoordinates:function(s){var l=s.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(l)},imageToWindowCoordinates:function(s){var l=this.imageToViewerElementCoordinates(s);return l.plus(e.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(s){var l=this._scaleSpring.current.value;return s=s.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new t.Rect((s.x-this._xSpring.current.value)/l,(s.y-this._ySpring.current.value)/l,s.width/l,s.height/l,s.degrees)},viewportToImageZoom:function(s){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return l*s},imageToViewportZoom:function(s){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return s/l},setPosition:function(s,l){var u=this._xSpring.target.value===s.x&&this._ySpring.target.value===s.y;if(l){if(u&&this._xSpring.current.value===s.x&&this._ySpring.current.value===s.y)return;this._xSpring.resetTo(s.x),this._ySpring.resetTo(s.y),this._needsDraw=!0}else{if(u)return;this._xSpring.springTo(s.x),this._ySpring.springTo(s.y),this._needsDraw=!0}u||this._raiseBoundsChange()},setWidth:function(s,l){this._setScale(s,l)},setHeight:function(s,l){this._setScale(s/this.normHeight,l)},setCroppingPolygons:function(s){var l=function(h){return h instanceof t.Point||typeof h.x=="number"&&typeof h.y=="number"},u=function(h){return h.map(function(f){try{if(l(f))return{x:f.x,y:f.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!t.isArray(s))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=s.map(function(h){return u(h)})}catch(h){t.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),t.console.error(h),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(s,l,u){l=l||t.Placement.CENTER;var h=t.Placement.properties[l],f=this.contentAspectX,d=0,c=0,v=1,g=1;if(this._clip&&(f=this._clip.getAspectRatio(),v=this._clip.width/this.source.dimensions.x,g=this._clip.height/this.source.dimensions.y,s.getAspectRatio()>f?(d=this._clip.x/this._clip.height*s.height,c=this._clip.y/this._clip.height*s.height):(d=this._clip.x/this._clip.width*s.width,c=this._clip.y/this._clip.width*s.width)),s.getAspectRatio()>f){var m=s.height/g,p=0;h.isHorizontallyCentered?p=(s.width-s.height*f)/2:h.isRight&&(p=s.width-s.height*f),this.setPosition(new t.Point(s.x-d+p,s.y-c),u),this.setHeight(m,u)}else{var y=s.width/v,w=0;h.isVerticallyCentered?w=(s.height-s.width/f)/2:h.isBottom&&(w=s.height-s.width/f),this.setPosition(new t.Point(s.x-d,s.y-c+w),u),this.setWidth(y,u)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(s){t.console.assert(!s||s instanceof t.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),s instanceof t.Rect?this._clip=s.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(s){this.flipped=!!s,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(s){s!==this.opacity&&(this.opacity=s,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(s){this._preload=!!s,this._needsDraw=!0},getRotation:function(s){return s?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(s,l){this._degreesSpring.target.value===s&&this._degreesSpring.isAtTargetValue()||(l?this._degreesSpring.resetTo(s):this._degreesSpring.springTo(s),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(s){return this.getBoundsNoRotate(s).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(s){s!==this.compositeOperation&&(this.compositeOperation=s,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(s,l){var u=this._scaleSpring.target.value===s;if(l){if(u&&this._scaleSpring.current.value===s)return;this._scaleSpring.resetTo(s),this._updateForScale(),this._needsDraw=!0}else{if(u)return;this._scaleSpring.springTo(s),this._updateForScale(),this._needsDraw=!0}u||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var s=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),l=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,u=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(l/this.minPixelRatio)/Math.log(2))));return u=Math.max(u,this.source.minLevel||0),s=Math.min(s,u),{lowestLevel:s,highestLevel:u}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var s=this.lastDrawn.pop();s.beingDrawn=!1}var l=this.viewport,u=this._viewportToTiledImageRectangle(l.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var h=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(u=u.intersection(h),u===null)return}for(var f=this._getLevelsInterval(),d=f.lowestLevel,c=f.highestLevel,v=null,g=!1,m=t.now(),p=c;p>=d;p--){var y=!1,w=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!0).x*this._scaleSpring.current.value;if(p===d||!g&&w>=this.minPixelRatio)y=!0,g=!0;else if(!g)continue;var T=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!1).x*this._scaleSpring.current.value,O=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,I=this.immediateRender?1:O,R=Math.min(1,(w-.5)/.5),L=I/Math.abs(I-T);if(v=this._updateLevel(g,y,p,R,L,u,m,v),this._providesCoverage(this.coverage,p))break}this._drawTiles(this.lastDrawn),v&&!v.context2D?(this._loadTile(v,m),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(s,l,u){var h,f;this.wrapHorizontal?(h=t.positiveModulo(l.x,1),f=t.positiveModulo(u.x,1)):(h=Math.max(0,l.x),f=Math.min(1,u.x));var d,c,v=1/this.source.aspectRatio;this.wrapVertical?(d=t.positiveModulo(l.y,v),c=t.positiveModulo(u.y,v)):(d=Math.max(0,l.y),c=Math.min(v,u.y));var g=this.source.getTileAtPoint(s,new t.Point(h,d)),m=this.source.getTileAtPoint(s,new t.Point(f,c)),p=this.source.getNumTiles(s);return this.wrapHorizontal&&(g.x+=p.x*Math.floor(l.x),m.x+=p.x*Math.floor(u.x)),this.wrapVertical&&(g.y+=p.y*Math.floor(l.y/v),m.y+=p.y*Math.floor(u.y/v)),{topLeft:g,bottomRight:m}},_updateLevel:function(s,l,u,h,f,d,c,v){var g=d.getBoundingBox().getTopLeft(),m=d.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:s,level:u,opacity:h,visibility:f,drawArea:d,topleft:g,bottomright:m,currenttime:c,best:v}),this._resetCoverage(this.coverage,u),this._resetCoverage(this.loadingCoverage,u);var p=this._getCornerTiles(u,g,m),y=p.topLeft,w=p.bottomRight,T=this.source.getNumTiles(u),O=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(w.x+=1,this.wrapHorizontal||(w.x=Math.min(w.x,T.x-1)));for(var I=y.x;I<=w.x;I++)for(var R=y.y;R<=w.y;R++){var L;if(this.getFlip()){var N=(T.x+I%T.x)%T.x;L=I+T.x-N-N-1}else L=I;d.intersection(this.getTileBounds(u,L,R))!==null&&(v=this._updateTile(l,s,L,R,u,h,f,O,T,c,v))}return v},_updateTile:function(s,l,u,h,f,d,c,v,g,m,p){var y=this._getTile(u,h,f,m,g,this._worldWidthCurrent,this._worldHeightCurrent),w=l;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:y}),this._setCoverage(this.coverage,f,u,h,!1);var T=y.loaded||y.loading||this._isCovered(this.loadingCoverage,f,u,h);if(this._setCoverage(this.loadingCoverage,f,u,h,T),!y.exists||(s&&!w&&(this._isCovered(this.coverage,f,u,h)?this._setCoverage(this.coverage,f,u,h,!0):w=!0),!w))return p;if(this._positionTile(y,this.source.tileOverlap,this.viewport,v,c),!y.loaded)if(y.context2D)this._setTileLoaded(y);else{var O=this._tileCache.getImageRecord(y.cacheKey);O&&this._setTileLoaded(y,O.getData())}if(y.loaded){var I=this._blendTile(y,u,h,f,d,m);I&&(this._needsDraw=!0)}else y.loading?this._tilesLoading++:T||(p=this._compareTiles(p,y));return p},_getTile:function(s,l,u,h,f,d,c){var v,g,m,p,y,w,T,O,I,R,L=this.tilesMatrix,N=this.source;return L[u]||(L[u]={}),L[u][s]||(L[u][s]={}),(!L[u][s][l]||!L[u][s][l].flipped!=!this.flipped)&&(v=(f.x+s%f.x)%f.x,g=(f.y+l%f.y)%f.y,m=this.getTileBounds(u,s,l),p=N.getTileBounds(u,v,g,!0),y=N.tileExists(u,v,g),w=N.getTileUrl(u,v,g),T=N.getTilePostData(u,v,g),this.loadTilesWithAjax?(O=N.getTileAjaxHeaders(u,v,g),t.isPlainObject(this.ajaxHeaders)&&(O=t.extend({},this.ajaxHeaders,O))):O=null,I=N.getContext2D?N.getContext2D(u,v,g):void 0,R=new t.Tile(u,s,l,m,y,w,I,this.loadTilesWithAjax,O,p,T,N.getTileHashKey(u,v,g,w,O,T)),this.getFlip()?v===0&&(R.isRightMost=!0):v===f.x-1&&(R.isRightMost=!0),g===f.y-1&&(R.isBottomMost=!0),R.flipped=this.flipped,L[u][s][l]=R),R=L[u][s][l],R.lastTouchTime=h,R},_loadTile:function(s,l){var u=this;s.loading=!0,this._imageLoader.addJob({src:s.getUrl(),tile:s,source:this.source,postData:s.postData,loadWithAjax:s.loadWithAjax,ajaxHeaders:s.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(h,f,d){u._onTileLoad(s,l,h,f,d)},abort:function(){s.loading=!1}})},_onTileLoad:function(s,l,u,h,f){if(!u){t.console.error("Tile %s failed to load: %s - error: %s",s,s.getUrl(),h),this.viewer.raiseEvent("tile-load-failed",{tile:s,tiledImage:this,time:l,message:h,tileRequest:f}),s.loading=!1,s.exists=!1;return}if(l<this.lastResetTime){t.console.warn("Ignoring tile %s loaded before reset: %s",s,s.getUrl()),s.loading=!1;return}var d=this,c=function(){var v=d.source,g=v.getClosestLevel();d._setTileLoaded(s,u,g,f)};this._midDraw?window.setTimeout(c,1):c()},_setTileLoaded:function(s,l,u,h){var f=0,d=this;function c(){return f++,v}function v(){f--,f===0&&(s.loading=!1,s.loaded=!0,s.hasTransparency=d.source.hasTransparency(s.context2D,s.getUrl(),s.ajaxHeaders,s.postData),s.context2D||d._tileCache.cacheTile({data:l,tile:s,cutoff:u,tiledImage:d}),d._needsDraw=!0)}this.viewer.raiseEvent("tile-loaded",{tile:s,tiledImage:this,tileRequest:h,get image(){return t.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),l},data:l,getCompletionCallback:c}),c()()},_positionTile:function(s,l,u,h,f){var d=s.bounds.getTopLeft();d.x*=this._scaleSpring.current.value,d.y*=this._scaleSpring.current.value,d.x+=this._xSpring.current.value,d.y+=this._ySpring.current.value;var c=s.bounds.getSize();c.x*=this._scaleSpring.current.value,c.y*=this._scaleSpring.current.value;var v=u.pixelFromPointNoRotate(d,!0),g=u.pixelFromPointNoRotate(d,!1),m=u.deltaPixelsFromPointsNoRotate(c,!0),p=u.deltaPixelsFromPointsNoRotate(c,!1),y=g.plus(p.divide(2)),w=h.squaredDistanceTo(y);l||(m=m.plus(new t.Point(1,1))),s.isRightMost&&this.wrapHorizontal&&(m.x+=.75),s.isBottomMost&&this.wrapVertical&&(m.y+=.75),s.position=v,s.size=m,s.squaredDistance=w,s.visibility=f},_blendTile:function(s,l,u,h,f,d){var c=1e3*this.blendTime,v,g;if(s.blendStart||(s.blendStart=d),v=d-s.blendStart,g=c?Math.min(1,v/c):1,this.alwaysBlend&&(g*=f),s.opacity=g,this.lastDrawn.push(s),g===1)this._setCoverage(this.coverage,h,l,u,!0),this._hasOpaqueTile=!0;else if(v<c)return!0;return!1},_compareTiles:function(s,l){return!s||l.visibility>s.visibility||l.visibility===s.visibility&&l.squaredDistance<s.squaredDistance?l:s},_drawTiles:function(s){if(!(this.opacity===0||s.length===0&&!this.placeholderFillStyle)){var l=s[0],u;l&&(u=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(l.context2D,l.getUrl(),l.ajaxHeaders,l.postData));var h,f,d=this.viewport.getZoom(!0),c=this.viewportToImageZoom(d);s.length>1&&c>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&t.supportsCanvas&&this.viewer.useCanvas&&(u=!0,h=l.getScaleForEdgeSmoothing(),f=l.getTranslationForEdgeSmoothing(h,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var v;u&&(h||(v=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(v.x=this._drawer.viewer.container.clientWidth-(v.x+v.width)),v=v.times(t.pixelDensityRatio)),this._drawer._clear(!0,v)),h||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:u}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:u}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var g=!1;if(this._clip){this._drawer.saveContext(u);var m=this.imageToViewportRectangle(this._clip,!0);m=m.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var p=this._drawer.viewportToDrawerRectangle(m);h&&(p=p.times(h)),f&&(p=p.translate(f)),this._drawer.setClip(p,u),g=!0}if(this._croppingPolygons){var y=this;this._drawer.saveContext(u);try{var w=this._croppingPolygons.map(function(E){return E.map(function(C){var b=y.imageToViewportCoordinates(C.x,C.y,!0).rotate(-y.getRotation(!0),y._getRotationPoint(!0)),M=y._drawer.viewportCoordToDrawerCoord(b);return h&&(M=M.times(h)),M})});this._drawer.clipWithPolygons(w,u)}catch(E){t.console.error(E)}g=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var T=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));h&&(T=T.times(h)),f&&(T=T.translate(f));var O=null;typeof this.placeholderFillStyle=="function"?O=this.placeholderFillStyle(this,this._drawer.context):O=this.placeholderFillStyle,this._drawer.drawRectangle(T,O,u)}var I=o(this.subPixelRoundingForTransparency),R=!1;if(I===t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)R=!0;else if(I===t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var L=this.viewer&&this.viewer.isAnimating();R=!L}for(var N=s.length-1;N>=0;N--)l=s[N],this._drawer.drawTile(l,this._drawingHandler,u,h,f,R,this.source),l.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:l});g&&this._drawer.restoreContext(u),h||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u)),u&&(h&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:h,translate:f,compositeOperation:this.compositeOperation,bounds:v}),h&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),h||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(s)}},_drawDebugInfo:function(s){if(this.debugMode)for(var l=s.length-1;l>=0;l--){var u=s[l];try{this._drawer.drawDebugInfo(u,s.length,l,this)}catch(h){t.console.error(h)}}},_providesCoverage:function(s,l,u,h){var f,d,c,v;if(!s[l])return!1;if(u===void 0||h===void 0){f=s[l];for(c in f)if(Object.prototype.hasOwnProperty.call(f,c)){d=f[c];for(v in d)if(Object.prototype.hasOwnProperty.call(d,v)&&!d[v])return!1}return!0}return s[l][u]===void 0||s[l][u][h]===void 0||s[l][u][h]===!0},_isCovered:function(s,l,u,h){return u===void 0||h===void 0?this._providesCoverage(s,l+1):this._providesCoverage(s,l+1,2*u,2*h)&&this._providesCoverage(s,l+1,2*u,2*h+1)&&this._providesCoverage(s,l+1,2*u+1,2*h)&&this._providesCoverage(s,l+1,2*u+1,2*h+1)},_setCoverage:function(s,l,u,h,f){if(!s[l]){t.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",l);return}s[l][u]||(s[l][u]={}),s[l][u][h]=f},_resetCoverage:function(s,l){s[l]={}}});var i=t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function n(s){return s!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&s!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&s!==t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function a(s){return n(s)?i:s}function o(s){if(typeof s=="number")return a(s);if(!s||!t.Browser)return i;var l=s[t.Browser.vendor];return n(l)&&(l=s["*"]),a(l)}}(e),function(t){var i=function(a){t.console.assert(a,"[TileCache.cacheTile] options is required"),t.console.assert(a.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(a.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=a.tile,this.tiledImage=a.tiledImage},n=function(a){t.console.assert(a,"[ImageRecord] options is required"),t.console.assert(a.data,"[ImageRecord] options.data is required"),this._tiles=[],a.create.apply(null,[this,a.data,a.ownerTile]),this._destroyImplementation=a.destroy.bind(null,this),this.getImage=a.getImage.bind(null,this),this.getData=a.getData.bind(null,this),this.getRenderedContext=a.getRenderedContext.bind(null,this)};n.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(a){t.console.assert(a,"[ImageRecord.addTile] tile is required"),this._tiles.push(a)},removeTile:function(a){for(var o=0;o<this._tiles.length;o++)if(this._tiles[o]===a){this._tiles.splice(o,1);return}t.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",a)},getTileCount:function(){return this._tiles.length}},t.TileCache=function(a){a=a||{},this._maxImageCacheCount=a.maxImageCacheCount||t.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},t.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(a){t.console.assert(a,"[TileCache.cacheTile] options is required"),t.console.assert(a.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(a.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),t.console.assert(a.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var o=a.cutoff||0,s=this._tilesLoaded.length,l=this._imagesLoaded[a.tile.cacheKey];if(l||(a.data||(t.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),a.data=a.image),t.console.assert(a.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),l=this._imagesLoaded[a.tile.cacheKey]=new n({data:a.data,ownerTile:a.tile,create:a.tiledImage.source.createTileCache,destroy:a.tiledImage.source.destroyTileCache,getImage:a.tiledImage.source.getTileCacheDataAsImage,getData:a.tiledImage.source.getTileCacheData,getRenderedContext:a.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),l.addTile(a.tile),a.tile.cacheImageRecord=l,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,h=-1,f=null,d,c,v,g,m,p,y=this._tilesLoaded.length-1;y>=0;y--)if(p=this._tilesLoaded[y],d=p.tile,!(d.level<=o||d.beingDrawn)){if(!u){u=d,h=y,f=p;continue}g=d.lastTouchTime,c=u.lastTouchTime,m=d.level,v=u.level,(g<c||g===c&&m>v)&&(u=d,h=y,f=p)}u&&h>=0&&(this._unloadTile(f),s=h)}this._tilesLoaded[s]=new i({tile:a.tile,tiledImage:a.tiledImage})},clearTilesFor:function(a){t.console.assert(a,"[TileCache.clearTilesFor] tiledImage is required");for(var o,s=0;s<this._tilesLoaded.length;++s)o=this._tilesLoaded[s],o.tiledImage===a&&(this._unloadTile(o),this._tilesLoaded.splice(s,1),s--)},getImageRecord:function(a){return t.console.assert(a,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[a]},_unloadTile:function(a){t.console.assert(a,"[TileCache._unloadTile] tileRecord is required");var o=a.tile,s=a.tiledImage;o.unload(),o.cacheImageRecord=null;var l=this._imagesLoaded[o.cacheKey];l.removeTile(o),l.getTileCount()||(l.destroy(),delete this._imagesLoaded[o.cacheKey],this._imagesLoadedCount--),s.viewer.raiseEvent("tile-unloaded",{tile:o,tiledImage:s})}}}(e),function(t){t.World=function(i){var n=this;t.console.assert(i.viewer,"[World] options.viewer is required"),t.EventSource.call(this),this.viewer=i.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(a){n._autoRefigureSizes?n._figureSizes():n._needsSizesFigured=!0},this._figureSizes()},t.extend(t.World.prototype,t.EventSource.prototype,{addItem:function(i,n){if(t.console.assert(i,"[World.addItem] item is required"),t.console.assert(i instanceof t.TiledImage,"[World.addItem] only TiledImages supported at this time"),n=n||{},n.index!==void 0){var a=Math.max(0,Math.min(this._items.length,n.index));this._items.splice(a,0,i)}else this._items.push(i);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,i.addHandler("bounds-change",this._delegatedFigureSizes),i.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:i})},getItemAt:function(i){return t.console.assert(i!==void 0,"[World.getItemAt] index is required"),this._items[i]},getIndexOfItem:function(i){return t.console.assert(i,"[World.getIndexOfItem] item is required"),t.indexOf(this._items,i)},getItemCount:function(){return this._items.length},setItemIndex:function(i,n){t.console.assert(i,"[World.setItemIndex] item is required"),t.console.assert(n!==void 0,"[World.setItemIndex] index is required");var a=this.getIndexOfItem(i);if(n>=this._items.length)throw new Error("Index bigger than number of layers.");n===a||a===-1||(this._items.splice(a,1),this._items.splice(n,0,i),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:i,previousIndex:a,newIndex:n}))},removeItem:function(i){t.console.assert(i,"[World.removeItem] item is required");var n=t.indexOf(this._items,i);n!==-1&&(i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy(),this._items.splice(n,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(i))},removeAll:function(){this.viewer._cancelPendingImages();var i,n;for(n=0;n<this._items.length;n++)i=this._items[n],i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy();var a=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,n=0;n<a.length;n++)i=a[n],this._raiseRemoveItem(i)},resetItems:function(){for(var i=0;i<this._items.length;i++)this._items[i].reset()},update:function(){for(var i=!1,n=0;n<this._items.length;n++)i=this._items[n].update()||i;return i},draw:function(){for(var i=0;i<this._items.length;i++)this._items[i].draw();this._needsDraw=!1},needsDraw:function(){for(var i=0;i<this._items.length;i++)if(this._items[i].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(i){this._autoRefigureSizes=i,i&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(i){i=i||{};var n=i.immediately||!1,a=i.layout||t.DEFAULT_SETTINGS.collectionLayout,o=i.rows||t.DEFAULT_SETTINGS.collectionRows,s=i.columns||t.DEFAULT_SETTINGS.collectionColumns,l=i.tileSize||t.DEFAULT_SETTINGS.collectionTileSize,u=i.tileMargin||t.DEFAULT_SETTINGS.collectionTileMargin,h=l+u,f;!i.rows&&s?f=s:f=Math.ceil(this._items.length/o);var d=0,c=0,v,g,m,p,y;this.setAutoRefigureSizes(!1);for(var w=0;w<this._items.length;w++)w&&w%f===0&&(a==="horizontal"?(c+=h,d=0):(d+=h,c=0)),v=this._items[w],g=v.getBounds(),g.width>g.height?m=l:m=l*(g.width/g.height),p=m*(g.height/g.width),y=new t.Point(d+(l-m)/2,c+(l-p)/2),v.setPosition(y,n),v.setWidth(m,n),a==="horizontal"?d+=h:c+=h;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var i=this._homeBounds?this._homeBounds.clone():null,n=this._contentSize?this._contentSize.clone():null,a=this._contentFactor||0;if(!this._items.length)this._homeBounds=new t.Rect(0,0,1,1),this._contentSize=new t.Point(1,1),this._contentFactor=1;else{var o=this._items[0],s=o.getBounds();this._contentFactor=o.getContentSize().x/s.width;for(var l=o.getClippedBounds().getBoundingBox(),u=l.x,h=l.y,f=l.x+l.width,d=l.y+l.height,c=1;c<this._items.length;c++)o=this._items[c],s=o.getBounds(),this._contentFactor=Math.max(this._contentFactor,o.getContentSize().x/s.width),l=o.getClippedBounds().getBoundingBox(),u=Math.min(u,l.x),h=Math.min(h,l.y),f=Math.max(f,l.x+l.width),d=Math.max(d,l.y+l.height);this._homeBounds=new t.Rect(u,h,f-u,d-h),this._contentSize=new t.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==a||!this._homeBounds.equals(i)||!this._contentSize.equals(n))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(i){this.raiseEvent("remove-item",{item:i})}})}(e)})(qh);const Yh=qh.exports;Vo.use(IT);AT(Vo);const _T=()=>{fetch("./data/medical_mss.csv").then(r=>r.text()).then(r=>{fd(r,{columns:!0},(e,t)=>{if(e)return console.log(e.message);new FT(t).draw(),new BT(t).draw()})}),zT(),document.addEventListener("click",HT)},Hi=r=>r.trim().replace(/\*$/,"").replace(/\s+/g,"_"),$n=r=>{const e=r.trim().replace(/\*$/,""),[t,i]=e.split("-");return i?parseInt(t)+parseInt(i)/2:parseInt(t)},Wo=[{selector:"node",style:{"background-color":"#666",label:"data(label)","font-family":"brill, et-book, Palatino, Palatino Linotype, Palatino LT STD, Book Antiqua, Georgia, serif"}},{selector:"node.place",style:{"background-opacity":"0",label:"data(id)","text-valign":"center","font-size":"40px"}},{selector:"node.manuscript",style:{label:"",shape:"rectangle",width:"data(width)",height:"data(height)","background-opacity":"0.5"}},{selector:"node.manuscript.clicked",style:{label:"data(popup)"}},{selector:"edge",style:{width:1,label:"","font-family":"brill, et-book, Palatino, Palatino Linotype, Palatino LT STD, Book Antiqua, Georgia, serif","text-rotation":"autorotate","line-color":"#ccc","target-arrow-color":"#ccc","target-arrow-shape":"none","line-opacity":"0.5","text-opacity":"1","curve-style":"bezier"}},{selector:"edge.scribe, edge.editor, edge.procurer",style:{"line-opacity":"0.8"}},{selector:"edge.clicked",style:{label:"data(popup)","line-opacity":"1"}},{selector:"edge.scribe",style:{width:2,"line-color":"#1b9e77","target-arrow-color":"#1b9e77"}},{selector:"edge.editor",style:{width:2,"line-color":"#d95f02","target-arrow-color":"#d95f02"}},{selector:"edge.procurer",style:{width:2,"line-color":"#7570b3","target-arrow-color":"#7570b3"}},{selector:"node.scribe, node.procurer, node.editor",style:{width:10,height:10,"background-opacity":"0.8"}}],ea=[["scribe","#1b9e77"],["editor","#d95f02"],["procurer","#7570b3"]];for(const r of ea)Wo.push({selector:`node.${r[0]}`,style:{"background-color":r[1]}});Wo.push({selector:"node.scribe.editor",style:{"background-fill":"linear-gradient","background-gradient-stop-colors":`${ea[0][1]} ${ea[1][1]}`}});class FT{constructor(e){const t=[{nodeId:"Jammu",position:{x:74.91114,y:32.64393}},{nodeId:"Calcutta",position:{x:88.35035,y:22.55523}},{nodeId:"Poona",position:{x:73.83604,y:18.51827}},{nodeId:"Benares",position:{x:82.99792,y:25.32882}},{nodeId:"Madras",position:{x:80.28337,y:13.06681}},{nodeId:"Pondicherry",position:{x:79.83411,y:11.92781}},{nodeId:"Tanjore",position:{x:79.13659,y:10.79187}},{nodeId:"Alwar",position:{x:76.59406,y:27.56964}},{nodeId:"Bikaner",position:{x:73.32865,y:28.01687}}];this.coords_scaled=t.map(i=>({nodeId:i.nodeId,position:{x:i.position.x*100,y:-i.position.y*100}})),this.mss=new Map,this.people=new Map,this.places=new Map,this.edges=[],this.parseData(e)}addPerson(e,t,i){const n=e[i].replace(/\[.+\]/,"").split(";"),a=i.toLowerCase();for(const o of n){const s=Hi(o);if(!!s){if(!this.people.has(s))this.people.set(s,{data:{id:Hi(o),label:o.replace(/\*$/,""),roles:new Set([i])},classes:a});else{const l=this.people.get(s);l.data.roles.add(a),l.classes=[...l.data.roles].join(" ")}this.edges.push({data:{id:`${s}-${t}`,source:s,target:t,popup:a},classes:a})}}}parseData(e){for(const t of e){const i=(s=>s==="Chandernagor"?"Calcutta":s)(Hi(t["Copy place"]));if(i===""||i==="Besan\xE7on")continue;const n=Hi(t.Shelfmark),a=$n(t.Width),o=$n(t.Height);this.mss.set(n,{data:{id:n,width:a/10,height:o/10,popup:t.Shelfmark},classes:"manuscript"}),i&&(this.places.has(i)||this.places.set(i,{data:{id:i,label:i},classes:"place"}),this.edges.push({data:{id:`${i}-${n}`,source:i,target:n,popup:"copy place"},classes:"place"})),this.addPerson(t,n,"Scribe"),this.addPerson(t,n,"Procurer"),this.addPerson(t,n,"Editor")}}draw(){const e=new Image;e.onload=()=>{const t=Vo({container:document.getElementById("fig-people"),elements:[...this.mss.values(),...this.places.values(),...this.people.values(),...this.edges],layout:{name:"fcose",nodeDimensionsIncludeLabels:!0,idealEdgeLength:s=>s.hasClass("place")?50:150,edgeElasticity:s=>s.hasClass("place")?1.5:.2,fixedNodeConstraint:this.coords_scaled,relativePlacementConstraint:[{top:"Calcutta",bottom:"Palmyr_Cordier",gap:500},{right:"Calcutta",left:"Palmyr_Cordier",gap:400}],stop:()=>t.minZoom(t.zoom())},style:Wo}),i=t.cyCanvas({zIndex:-1}),a=i.getCanvas().getContext("2d");t.on("render cyCanvas.resize",s=>{i.resetTransform(a),i.clear(a),i.setTransform(a),a.globalAlpha=.5,a.rotate(5*Math.PI/180),a.drawImage(e,5900,-3430,5200,3900)}),t.$("node.place").ungrabify(),t.on("mouseup",this.mouseUp.bind(null,t));const o=document.getElementById("fig-people-legend");o&&kT(o)},e.src="img/map-reduced.png"}mouseUp(e,t){e.$(".clicked").removeClass("clicked"),xl.remove(t),t.target.data("popup")&&(xl.make(t),t.target.addClass("clicked"))}}const xl={make:function(r){const e=r.target;if(!e.data())return;var i=document.getElementById("tooltip");const n=document.createElement("div");if(i){for(const a of i.childNodes)if(a.myTarget===e)return;n.appendChild(document.createElement("hr"))}else i=document.createElement("div"),i.id="tooltip",i.style.top=r.renderedPosition.y+10+"px",i.style.left=r.renderedPosition.x+10+"px",i.style.opacity=0,i.style.transition="opacity 0.2s ease-in",document.body.appendChild(i);n.myTarget=e,i.appendChild(n),i.animate([{opacity:0},{opacity:1,easing:"ease-in"}],1e3)},remove:function(r){const e=document.getElementById("tooltip");e&&e.remove()}};class BT{constructor(e){this.places=new Map([["Jammu",{mss:[],width:[],height:[]}],["Bikaner",{mss:[],width:[],height:[]}],["Madras",{mss:[],width:[],height:[]}],["Tanjore",{mss:[],width:[],height:[]}]]);for(const t of e){const i=(o=>o==="Chandernagor"?"Calcutta":o)(Hi(t["Copy place"]));if(i===""||i==="Besan\xE7on")continue;const n=$n(t.Width)/3,a=$n(t.Height)/3;if(this.places.has(i)){const o=this.places.get(i);n>o.width&&(o.width=n),a>o.height&&(o.height=a),o.mss.push({width:n,height:a})}}}draw(){const e=document.getElementById("fig-size");for(const[t,i]of this.places){const n=document.createElement("figure"),a=document.createElement("div");a.style.width=`${i.width}px`,a.style.height=`${i.height}px`,i.mss.sort((s,l)=>s.width*s.height>l.width*l.height?-1:1);for(const s of i.mss){const l=document.createElement("div");l.className="ms",l.style.width=`${s.width}px`,l.style.height=`${s.height}px`,a.append(l)}const o=document.createElement("figcaption");o.append(t),n.append(a),n.append(o),e.append(n)}}}const kT=r=>{for(const e of ea){const t=document.createElement("div"),i=document.createElement("span");i.style.color=e[1],i.append("\u25CF"),t.append(i),t.append(e[0]),r.append(t)}},zT=()=>{const r=(e,t)=>{const i=t.width/t.height;e.style.aspectRatio=i,e.id||(e.id=`zoom-${Date.now()}`),t.style.display="none",new Yh.Viewer({id:e.id,prefixUrl:"node_modules/openseadragon/build/openseadragon/images/",tileSources:{type:"image",url:t.src}})};for(const e of document.getElementsByClassName("inline-zoom")){const t=e.querySelector("img");!t||(t.src,t.onload=r(e,t))}},HT=r=>{r.target.classList.contains("popup-toggle")?UT(r):r.target.id==="blackout"&&GT(r)},UT=r=>{const e=r.target.nextElementSibling;if(!e||!e.classList.contains("popup-zoom"))return;const t=document.createElement("div");t.id="blackout";const i=document.createElement("div");i.id="popup";const n=document.createElement("div");n.id="popup-viewer",i.appendChild(n),t.appendChild(i),document.body.appendChild(t);const a=e.querySelector("img");new Yh.Viewer({id:"popup-viewer",prefixUrl:"node_modules/openseadragon/build/openseadragon/images/",tileSources:{type:"image",url:a.src}});const o=e.cloneNode(!0);o.firstChild.remove(),i.appendChild(o)},GT=r=>{r.target.remove()},VT={init:_T};VT.init();
